<!DOCTYPE HTML>
<html lang="zh-CN" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ricardo&#x27;s Wiki</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="我在北京邮电大学计算机科学与技术专业学习三年的部分笔记">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="katex.min.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">主页</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="ai-principle/index.html"><strong aria-hidden="true">1.</strong> 人工智能原理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ai-principle/intro.html"><strong aria-hidden="true">1.1.</strong> 概述</a></li><li class="chapter-item expanded "><a href="ai-principle/question-knowledge.html"><strong aria-hidden="true">1.2.</strong> 问题和知识表示</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="algorithm/index.html"><strong aria-hidden="true">2.</strong> 算法</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="algorithm/intro.html"><strong aria-hidden="true">2.1.</strong> 概述</a></li><li class="chapter-item expanded "><a href="algorithm/recurse-divide.html"><strong aria-hidden="true">2.2.</strong> 分治算法</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="compiler/index.html"><strong aria-hidden="true">3.</strong> 编译原理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler/intro.html"><strong aria-hidden="true">3.1.</strong> 概述</a></li><li class="chapter-item expanded "><a href="compiler/lexical-analyzer.html"><strong aria-hidden="true">3.2.</strong> 词法分析</a></li><li class="chapter-item expanded "><a href="compiler/grammar-analyzer.html"><strong aria-hidden="true">3.3.</strong> 语法分析</a></li><li class="chapter-item expanded "><a href="compiler/grammar-driven-translation.html"><strong aria-hidden="true">3.4.</strong> 语法制导翻译</a></li><li class="chapter-item expanded "><a href="compiler/syntax-analyser.html"><strong aria-hidden="true">3.5.</strong> 语义分析</a></li><li class="chapter-item expanded "><a href="compiler/runtime.html"><strong aria-hidden="true">3.6.</strong> 运行环境</a></li><li class="chapter-item expanded "><a href="compiler/intermediate-code.html"><strong aria-hidden="true">3.7.</strong> 中间代码生成</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="computer-architecture/index.html"><strong aria-hidden="true">4.</strong> 计算机组成原理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="computer-architecture/overview.html"><strong aria-hidden="true">4.1.</strong> 计算机系统概论</a></li><li class="chapter-item expanded "><a href="computer-architecture/calculator.html"><strong aria-hidden="true">4.2.</strong> 运算方法和运算器</a></li><li class="chapter-item expanded "><a href="computer-architecture/instruction.html"><strong aria-hidden="true">4.3.</strong> 指令系统</a></li><li class="chapter-item expanded "><a href="computer-architecture/cpu.html"><strong aria-hidden="true">4.4.</strong> 中央处理器</a></li><li class="chapter-item expanded "><a href="computer-architecture/memory.html"><strong aria-hidden="true">4.5.</strong> 存储系统</a></li><li class="chapter-item expanded "><a href="computer-architecture/io.html"><strong aria-hidden="true">4.6.</strong> 输入输出设备</a></li><li class="chapter-item expanded "><a href="computer-architecture/external.html"><strong aria-hidden="true">4.7.</strong> 外部设备</a></li><li class="chapter-item expanded "><a href="computer-architecture/bus.html"><strong aria-hidden="true">4.8.</strong> 总线</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="computer-networks/index.html"><strong aria-hidden="true">5.</strong> 计算机网络</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="computer-networks/overview.html"><strong aria-hidden="true">5.1.</strong> 引言</a></li><li class="chapter-item expanded "><a href="computer-networks/physical-layer.html"><strong aria-hidden="true">5.2.</strong> 物理层</a></li><li class="chapter-item expanded "><a href="computer-networks/data-link-layer.html"><strong aria-hidden="true">5.3.</strong> 数据链路层</a></li><li class="chapter-item expanded "><a href="computer-networks/mac.html"><strong aria-hidden="true">5.4.</strong> 介质访问控制层</a></li><li class="chapter-item expanded "><a href="computer-networks/network-layer.html"><strong aria-hidden="true">5.5.</strong> 网络层</a></li><li class="chapter-item expanded "><a href="computer-networks/transport-layer.html"><strong aria-hidden="true">5.6.</strong> 传输层</a></li><li class="chapter-item expanded "><a href="computer-networks/mid-term.html"><strong aria-hidden="true">5.7.</strong> 期中复习</a></li><li class="chapter-item expanded "><a href="computer-networks/final-term.html"><strong aria-hidden="true">5.8.</strong> 期末复习</a></li><li class="chapter-item expanded "><a href="computer-networks/lab2.html"><strong aria-hidden="true">5.9.</strong> 实验二</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="csapp/index.html"><strong aria-hidden="true">6.</strong> 计算机系统基础</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="csapp/bits.html"><strong aria-hidden="true">6.1.</strong> 数据的位级表示</a></li><li class="chapter-item expanded "><a href="csapp/machine.html"><strong aria-hidden="true">6.2.</strong> 程序的机器级表示</a></li><li class="chapter-item expanded "><a href="csapp/assembly-data.html"><strong aria-hidden="true">6.3.</strong> 程序的机器级表示——数据</a></li><li class="chapter-item expanded "><a href="csapp/assembly-control.html"><strong aria-hidden="true">6.4.</strong> 程序的机器级表示——控制</a></li><li class="chapter-item expanded "><a href="csapp/assembly-procedure.html"><strong aria-hidden="true">6.5.</strong> 程序的机器级表示——过程</a></li><li class="chapter-item expanded "><a href="csapp/assembly-advanced.html"><strong aria-hidden="true">6.6.</strong> 程序的机器级表示——高级话题</a></li><li class="chapter-item expanded "><a href="csapp/exception-control-flow.html"><strong aria-hidden="true">6.7.</strong> 异常控制流</a></li><li class="chapter-item expanded "><a href="csapp/linking.html"><strong aria-hidden="true">6.8.</strong> 链接</a></li><li class="chapter-item expanded "><a href="csapp/io.html"><strong aria-hidden="true">6.9.</strong> 输入输出系统</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="data-structure/index.html"><strong aria-hidden="true">7.</strong> 数据结构</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="data-structure/foundation.html"><strong aria-hidden="true">7.1.</strong> 算法基础</a></li><li class="chapter-item expanded "><a href="data-structure/inner-sort.html"><strong aria-hidden="true">7.2.</strong> 内部排序</a></li><li class="chapter-item expanded "><a href="data-structure/outer-sort.html"><strong aria-hidden="true">7.3.</strong> 外部排序</a></li><li class="chapter-item expanded "><a href="data-structure/array-and-list.html"><strong aria-hidden="true">7.4.</strong> 数组和广义表</a></li><li class="chapter-item expanded "><a href="data-structure/list.html"><strong aria-hidden="true">7.5.</strong> 线性表</a></li><li class="chapter-item expanded "><a href="data-structure/stack-and-dequeue.html"><strong aria-hidden="true">7.6.</strong> 栈和队列</a></li><li class="chapter-item expanded "><a href="data-structure/tree.html"><strong aria-hidden="true">7.7.</strong> 树</a></li><li class="chapter-item expanded "><a href="data-structure/graph.html"><strong aria-hidden="true">7.8.</strong> 图</a></li><li class="chapter-item expanded "><a href="data-structure/string.html"><strong aria-hidden="true">7.9.</strong> 字符串</a></li><li class="chapter-item expanded "><a href="data-structure/find.html"><strong aria-hidden="true">7.10.</strong> 查找表</a></li><li class="chapter-item expanded "><a href="data-structure/lab.html"><strong aria-hidden="true">7.11.</strong> 实验</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="database/index.html"><strong aria-hidden="true">8.</strong> 数据库</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="database/intro.html"><strong aria-hidden="true">8.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="database/relation-model.html"><strong aria-hidden="true">8.2.</strong> Relation Model</a></li><li class="chapter-item expanded "><a href="database/relation-database-design.html"><strong aria-hidden="true">8.3.</strong> Relation Database Design</a></li><li class="chapter-item expanded "><a href="database/sql.html"><strong aria-hidden="true">8.4.</strong> SQL</a></li><li class="chapter-item expanded "><a href="database/intermediate-sql.html"><strong aria-hidden="true">8.5.</strong> Intermediate SQL</a></li><li class="chapter-item expanded "><a href="database/entity-relation-model.html"><strong aria-hidden="true">8.6.</strong> Entity Relation Model</a></li><li class="chapter-item expanded "><a href="database/data-storage-structure.html"><strong aria-hidden="true">8.7.</strong> Data Storage Structure</a></li><li class="chapter-item expanded "><a href="database/database-index.html"><strong aria-hidden="true">8.8.</strong> Index</a></li><li class="chapter-item expanded "><a href="database/query-processing.html"><strong aria-hidden="true">8.9.</strong> Query Processing</a></li><li class="chapter-item expanded "><a href="database/query-optimization.html"><strong aria-hidden="true">8.10.</strong> Query Optimization</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="discrete-math/index.html"><strong aria-hidden="true">9.</strong> 离散数学</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="discrete-math/relation.html"><strong aria-hidden="true">9.1.</strong> Relation</a></li><li class="chapter-item expanded "><a href="discrete-math/advanced-counting.html"><strong aria-hidden="true">9.2.</strong> Advanced Counting</a></li><li class="chapter-item expanded "><a href="discrete-math/tree.html"><strong aria-hidden="true">9.3.</strong> Tree</a></li><li class="chapter-item expanded "><a href="discrete-math/graph.html"><strong aria-hidden="true">9.4.</strong> Graph</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="formal-language/index.html"><strong aria-hidden="true">10.</strong> 形式语言和自动机</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="formal-language/fa.html"><strong aria-hidden="true">10.1.</strong> 有限状态自动机</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="missing-semester/index.html"><strong aria-hidden="true">11.</strong> 计算机教学中缺少的一课</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="missing-semester/missing-the-shell.html"><strong aria-hidden="true">11.1.</strong> Shell</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-shell-scripts.html"><strong aria-hidden="true">11.2.</strong> Shell Scripts</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-vim.html"><strong aria-hidden="true">11.3.</strong> Vim</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-data-wrangling.html"><strong aria-hidden="true">11.4.</strong> Data Wrangling</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-command-line.html"><strong aria-hidden="true">11.5.</strong> Command Line</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-potpourri.html"><strong aria-hidden="true">11.6.</strong> Potpourri</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-version-control.html"><strong aria-hidden="true">11.7.</strong> Version Control</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-debugging.html"><strong aria-hidden="true">11.8.</strong> Debug</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-metaprogramming.html"><strong aria-hidden="true">11.9.</strong> Metaprogram</a></li><li class="chapter-item expanded "><a href="missing-semester/missing-security.html"><strong aria-hidden="true">11.10.</strong> Security</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="operating-system/index.html"><strong aria-hidden="true">12.</strong> 操作系统</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="operating-system/intro.html"><strong aria-hidden="true">12.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="operating-system/os-structures.html"><strong aria-hidden="true">12.2.</strong> OS Structure</a></li><li class="chapter-item expanded "><a href="operating-system/processes.html"><strong aria-hidden="true">12.3.</strong> Process</a></li><li class="chapter-item expanded "><a href="operating-system/process-synchronization.html"><strong aria-hidden="true">12.4.</strong> Process Synchronization</a></li><li class="chapter-item expanded "><a href="operating-system/cpu-scheduling.html"><strong aria-hidden="true">12.5.</strong> CPU Scheduling</a></li><li class="chapter-item expanded "><a href="operating-system/threads.html"><strong aria-hidden="true">12.6.</strong> Thread</a></li><li class="chapter-item expanded "><a href="operating-system/memory-management.html"><strong aria-hidden="true">12.7.</strong> Memory Management</a></li><li class="chapter-item expanded "><a href="operating-system/virtual-memory.html"><strong aria-hidden="true">12.8.</strong> Virtual Memory</a></li><li class="chapter-item expanded "><a href="operating-system/fs-interface.html"><strong aria-hidden="true">12.9.</strong> Filesystem Interface</a></li><li class="chapter-item expanded "><a href="operating-system/fs-implementation.html"><strong aria-hidden="true">12.10.</strong> Filesystem Implementation</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="socialist/index.html"><strong aria-hidden="true">13.</strong> 毛泽东思想和中国特色理论体系概论</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="socialist/maozedong.html"><strong aria-hidden="true">13.1.</strong> 毛概期末总结</a></li><li class="chapter-item expanded "><a href="socialist/others.html"><strong aria-hidden="true">13.2.</strong> 课后大题</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ricardo&#x27;s Wiki</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="wiki"><a class="header" href="#wiki">wiki</a></h1>
<p>我在北京邮电大学计算机科学与技术专业学习中所撰写的课程笔记。主要为大二和大三两个学年中学习的部分专业课和部分选修课，其中还包含课余时间自学的MIT公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>。</p>
<p>限于笔记为上课过程中实时撰写，仅有部分笔记在课余时间进行了校对，因此存在大量的<strong>错漏</strong>，仅供参考。基于同样的原因，本次笔记中覆盖的内容仅为<strong>部分课程</strong>的<strong>部分内容</strong>，所记录的内容无法覆盖上课中的所有实际内容，不能作为教学范围和考试范围的参考，亦不能代表相关课程中的重点内容。同时，本笔记中涉及的课程内容仅代表2022至2023学年的大二年级和2023至2024学年的大三年级的课程内容。</p>
<p>在笔记中涉及到各位授课老师授课过程中的PPT截图，这些截图的版权归诸位授课老师和PPT作者所有，如有侵权请和我们联系，我们会立即删除相关内容。</p>
<p>在本笔记中，源远流长同学(<a href="https://github.com/112292454">@112292454</a>)贡献了部分其自己的笔记，包括形式语言与自动机课程的笔记、计算机网络课程的复习笔记等的内容，在这里一并表示感谢。</p>
<p>笔记使用<a href="https://rust-lang.github.io/mdBook/index.html">mdbook</a>工具生成静态网页，生成的静态网页可以在<a href="https://jackfiled.github.io/wiki/">Github Pages</a>上查看。</p>
<h2 id="协议"><a class="header" href="#协议">协议</a></h2>
<p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p>
<p>本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a>进行许可。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="人工智能原理"><a class="header" href="#人工智能原理">人工智能原理</a></h1>
<p>大三上学期专业选修课——人工智能原理。</p>
<h2 id="授课教师"><a class="header" href="#授课教师">授课教师</a></h2>
<ul>
<li>邓芳</li>
<li>王晓茹</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概述"><a class="header" href="#概述">概述</a></h1>
<h2 id="本学期的主要内容"><a class="header" href="#本学期的主要内容">本学期的主要内容</a></h2>
<ul>
<li>问题和知识表示方式</li>
<li>搜索和推理</li>
<li>典型应用</li>
<li>机器学习</li>
</ul>
<p>要求：</p>
<ul>
<li>课堂练习</li>
<li>作业</li>
<li>开卷考试</li>
</ul>
<h2 id="人工智能及发展"><a class="header" href="#人工智能及发展">人工智能及发展</a></h2>
<p>人工智能(Artificial Intelligence)是研究如何在机器上实现人类智能的学科。</p>
<p>智能：有效获取、传递、处理、再生和利用信息，从而在任意给定的环境达到预定目的的能力。</p>
<p>智能的特征：</p>
<ul>
<li>具有感知能力</li>
<li>具有记忆和思维的能力</li>
</ul>
<p>可以将智能分为：</p>
<ul>
<li>计算智能</li>
<li>感知智能</li>
<li>认知智能</li>
</ul>
<h3 id="人工智能的研究方法"><a class="header" href="#人工智能的研究方法">人工智能的研究方法</a></h3>
<ul>
<li>
<p>结构派：神经计算、生理学派、连接主义。</p>
<p>智能活动的基础是神经细胞。</p>
<p>智能活动过程是神经网络的状态演化过程。</p>
<p>智能活动的基础是神经细胞的突触相互连接。</p>
</li>
<li>
<p>功能派：符号主义、心理学派、逻辑学派</p>
<p>思维的基础是符号。</p>
<p>思维的过程是符号运算。</p>
<blockquote>
<p>相较于神经网络，拥有可解释性。</p>
</blockquote>
</li>
<li>
<p>行为模拟派：行为主义、进化主义、控制论学派</p>
<p>基于感知-行为模型的研究途径和方法。</p>
<p>智能行为是感知-行为的反射机制。</p>
</li>
</ul>
<h3 id="人工智能的发展历史"><a class="header" href="#人工智能的发展历史">人工智能的发展历史</a></h3>
<ul>
<li>1956 人工智能的诞生</li>
<li>1956~1974 黄金之年，人工智能的第一次热潮</li>
<li>1974~1980 第一个AI冬天</li>
<li>1980~1987 人工智能的繁荣，人工智能的第二次热潮</li>
<li>1987~1993 第二个AI冬天</li>
<li>1993~现在 人工智能的突破</li>
</ul>
<h2 id="研究基础内容"><a class="header" href="#研究基础内容">研究基础内容</a></h2>
<p>按照研究的角度分：</p>
<ul>
<li>符号智能</li>
<li>计算智能</li>
<li>人工生命</li>
</ul>
<p>按照功能分：</p>
<ul>
<li>机器感知/知识获取</li>
<li>机器思维/知识获取</li>
<li>机器行为/知识运用</li>
</ul>
<h3 id="目前研究遇到的问题"><a class="header" href="#目前研究遇到的问题">目前研究遇到的问题</a></h3>
<ul>
<li>数据瓶颈</li>
<li>泛化问题</li>
<li>能耗</li>
<li>语义鸿沟</li>
<li>可解释性</li>
<li>可靠性</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="问题和知识表示"><a class="header" href="#问题和知识表示">问题和知识表示</a></h1>
<h2 id="知识的基本内容"><a class="header" href="#知识的基本内容">知识的基本内容</a></h2>
<h3 id="数据和信息知识"><a class="header" href="#数据和信息知识">数据和信息、知识</a></h3>
<p>数据：包含事实和数字、未经加工的事实和符号。</p>
<p>信息：从数据中提炼出来的有关信息、经过分析处理的数据形成信息。数据是信息的载体和表示，信息是数据在特定场合下的具体含义。</p>
<p>知识：是有关信息关联在一起所形成的信息结构，反映客观世界中事物之间的关系。</p>
<p><img src="ai-principle/./question-knowledge/image-20230918110030799.png" alt="image-20230918110030799" /></p>
<p>知识具有一下的特点：</p>
<ul>
<li>客观性</li>
<li>相对正确性：在一定条件、时间、环境下</li>
<li>进化性</li>
<li>依附性：离开载体的知识是不存在的</li>
<li>不确定性</li>
<li>经验性</li>
<li>可表示性</li>
<li>可利用性</li>
<li>可重用性</li>
<li>共享性</li>
</ul>
<h3 id="知识的层次"><a class="header" href="#知识的层次">知识的层次</a></h3>
<ul>
<li>事实</li>
<li>概念</li>
<li>规则</li>
<li>启发式知识</li>
</ul>
<h3 id="知识的分类"><a class="header" href="#知识的分类">知识的分类</a></h3>
<ol>
<li>作用范围：常识性知识，领域性知识</li>
<li>作用及表示：事实性知识、过程性执行、控制性知识</li>
<li>确定性：确定性知识、不确定性知识</li>
<li>...</li>
</ol>
<h2 id="知识表达方法"><a class="header" href="#知识表达方法">知识表达方法</a></h2>
<p>知识表示是如何将以获得的有关知识以计算机易于接受的形式加以合理的描述、存储、有效的利用。</p>
<h3 id="状态空间的表示"><a class="header" href="#状态空间的表示">状态空间的表示</a></h3>
<p>利用状态变量和操作符号，表示系统和问题的有关知识的符号体系。</p>
<p>使用三元组<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>表示：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>是初始状态向量</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>是操作，表示引起状态变化的过程性知识的一组关系或者函数</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>是目标状态向量</li>
</ul>
<p>这种状态空间的变化可以使用<strong>图</strong>的方式表示出来：</p>
<p>图中的：</p>
<ul>
<li>节点：相应的状态描述</li>
<li>弧线：表示操作和状态的变化</li>
</ul>
<p>寻找操作系统等价于寻求图中的某一路径。最佳路径就是两节点间具有最小的代价。</p>
<h3 id="在状态描述中引入变量"><a class="header" href="#在状态描述中引入变量">在状态描述中引入变量</a></h3>
<h3 id="与或树表示"><a class="header" href="#与或树表示">与或树表示</a></h3>
<p><strong>问题归约法</strong>：已知问题描述，通过一系列的变换将问题转换为一个子问题的集合，并可以直接求解，解决初始问题。</p>
<p>与或图：使用类似于图的结构来表示把问题归约为后继问题的替换集合。</p>
<ul>
<li>与图：将复杂的大问题分解为一组简单的小问题</li>
<li>或图：将复杂的大问题变化为等价或者等效的问题</li>
</ul>
<p>或与图由以下四个部分组成：</p>
<ul>
<li>初始节点：原始问题</li>
<li>终叶节点：本原问题，没有后继节点</li>
<li>与节点：子问题对应的节点为与逻辑</li>
<li>或节点：子问题对应的节点为或逻辑</li>
<li>可解节点：
<ul>
<li>终叶节点为可解节点</li>
<li>非终叶节点为或节点，后继节点中至少存在一个可解节点</li>
<li>非终叶节点为与节点，后继节点均为可解节点</li>
</ul>
</li>
<li>不可解节点：同可解节点对应的节点</li>
</ul>
<h3 id="产生式规则"><a class="header" href="#产生式规则">产生式规则</a></h3>
<p>产生式规则也称为基于规则的知识表示。产生式规则的基本结构分为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">前提状态</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">结论动作</span></span></span></span></span>
产生式规则的特点：</p>
<ul>
<li>善于表达领域知识</li>
<li>控制和知识相分离</li>
<li>知识的模块性强</li>
<li>便于实现解释推理</li>
<li>便于使用启发性知识</li>
</ul>
<p>同时产生式规则的缺点是：</p>
<ul>
<li>单条规则容易解释，但是规则之间的逻辑关系难以确定</li>
<li>规则数太大时，知识库的一致性难以维护</li>
<li>某些类型的知识难以表示，如结构性的知识</li>
</ul>
<h3 id="谓词表示法"><a class="header" href="#谓词表示法">谓词表示法</a></h3>
<p>命题逻辑和谓词逻辑是人工智能应用中的两种逻辑。</p>
<ul>
<li>命题：具有真假意义的语句。常常使用大写字母表示。</li>
</ul>
<h2 id="知识的组织与管理"><a class="header" href="#知识的组织与管理">知识的组织与管理</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="算法设计与分析"><a class="header" href="#算法设计与分析">算法设计与分析</a></h1>
<p>大三上学期专业必修课——算法设计与分析。</p>
<p>授课教师：邵蓥侠</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="算法导论"><a class="header" href="#算法导论">算法导论</a></h1>
<h2 id="算法"><a class="header" href="#算法">算法</a></h2>
<p>算法是指解决问题的一种方法或者一个过程。</p>
<p>算法是若干指令的有穷序列：</p>
<ul>
<li>输入</li>
<li>输出</li>
<li>确定性</li>
<li>有限性</li>
</ul>
<h2 id="算法的时间复杂度分析"><a class="header" href="#算法的时间复杂度分析">算法的时间复杂度分析</a></h2>
<h3 id="渐进性原理及表示符号"><a class="header" href="#渐进性原理及表示符号">渐进性原理及表示符号</a></h3>
<p>使用渐进性原理对于算法的时间复杂度进行分析，反映算法的时间复杂度随着<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>变化发生变化的情况，衡量了算法的规模。</p>
<p>使用渐进分析的专用记号对于渐进性进行分析：</p>
<ul>
<li>渐进上界记号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></li>
<li>渐进下界记号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span></span></span></span></li>
<li>非紧上界记号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">o</span></span></span></span></li>
<li>非紧下界记号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></li>
<li>紧渐进界记号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Θ</span></span></span></span></li>
</ul>
<p>渐进分析中中的符号类似于比较：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">o</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></li>
</ul>
<p>同时渐进分析记号还具有若干性质：</p>
<ol>
<li>
<p>传递性</p>
</li>
<li>
<p>反身性</p>
</li>
<li>
<p>对称性</p>
</li>
<li>
<p>互对称性</p>
</li>
<li>
<p>支持算术运算</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)})</span></span></span></span></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></p>
</li>
</ol>
<p>在算法中存在这些常见的复杂性函数：</p>
<div class="table-wrapper"><table><thead><tr><th>函数</th><th>名称</th></tr></thead><tbody>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></td><td>常数</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></td><td>对数</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></td><td>对数平方</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></td><td>线性</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></td><td></td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></td><td>平方</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></td><td>立方</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></td><td>指数</td></tr>
</tbody></table>
</div>
<p>对于小规模的数据，这些复杂性函数的图像：</p>
<p><img src="algorithm/./intro/image-20230919084245845.png" alt="image-20230919084245845" /></p>
<p>对于较大规模的数据，则图像为：</p>
<p><img src="algorithm/./intro/image-20230919084325548.png" alt="image-20230919084325548" /></p>
<h3 id="递归方程渐进阶的求解"><a class="header" href="#递归方程渐进阶的求解">递归方程渐进阶的求解</a></h3>
<h4 id="代入法"><a class="header" href="#代入法">代入法</a></h4>
<p>先推测递归方法的显式解，然后使用数学归纳法证明这一推测的正确性。</p>
<p><strong>例</strong>： 求证<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>的渐进阶。</p>
<p>首先，推测<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>， 即存在正的常数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>和自然数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，使得当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>时：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span></span></span></span></span>
假设当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9991em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9991em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>是，上面的推论成立，那么当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9991em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9991em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>时，有：
\[
\begin{eqnarray}
T(n) &amp;=&amp; 2T(\lfloor \frac{n}{2} \rfloor) + n \
&amp;\le&amp; 2 C \lfloor \frac{n}{2} \rfloor log(\lfloor \frac{n}{2} \rfloor) + n \
&amp;&lt;&amp; 2C\frac{n}{2} log(\frac{n}{2}) + n \
&amp;=&amp; Cnlogn - Cn + n \
&amp;=&amp; Cnlogn - (c-1)n \
&amp;\le&amp; Cnlogn
\end{eqnarray}
\]
原假设成立。</p>
<h4 id="迭代法"><a class="header" href="#迭代法">迭代法</a></h4>
<p>迭代展开递归方程的右端，使之成为一个非递归的合式，然后通过对合式的估计来达到对于方程左端解的估计。</p>
<p><strong>例</strong>：求
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">5</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
的渐进阶。
\[
\begin{eqnarray}
T(n) &amp;=&amp; 2T(\frac{n}{2}) + 5n^2 \
&amp;=&amp; 2(2T(\frac{n}{4}) + 5(\frac{n}{2}))^2 + 5n^2 \
&amp;=&amp; 2(2(2T(\frac{n}{8}) + 5 (\frac{n}{4}) ^ 2) + 5(\frac{n}{2}))^2 + 5n^2 \
&amp;=&amp; 2^kT(1) + 2^{k-1} 5(\frac{n}{2^{k-1}}) ^ 2 + \cdots + 2 \times 5 (\frac{n}{2})^2 + 5n^2
\end{eqnarray}
\]
不难发现：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
迭代法还有一个衍生的方法——<strong>递归树法</strong>：</p>
<p><img src="algorithm/./intro/image-20230919090748751.png" alt="image-20230919090748751" /></p>
<p>实际上就是使用树的方式表示整个递推公式。</p>
<p><img src="algorithm/./intro/image-20230919090826548.png" alt="image-20230919090826548" /></p>
<h4 id="套用公式法"><a class="header" href="#套用公式法">套用公式法</a></h4>
<p>针对如下的递推方程
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
我们有
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.88em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385em;"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
这个公式还有一般化的情况：</p>
<p>如果递归方程的形式为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
则针对<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>进行讨论：</p>
<ol>
<li>
<p>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∃</span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>, 使得<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">a</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">ϵ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，那么我们有
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，那么我们有
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∃</span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，使得<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">ϵ</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，且当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∃</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>时，当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>充分大时有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，那么我们有
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span></p>
</li>
</ol>
<h4 id="母函数法"><a class="header" href="#母函数法">母函数法</a></h4>
<blockquote>
<p>通用的方法总是复杂的。</p>
</blockquote>
<p>设<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是任意的数列，那么称下面这个函数为数列的母函数：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8644em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>
如果数列是算法的复杂性函数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)}</span></span></span></span>，则其母函数为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>
如果能由<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>也就是的数列的递归方程求出母函数，那么其第<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>项系数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="递归和分治"><a class="header" href="#递归和分治">递归和分治</a></h1>
<h2 id="递归算法"><a class="header" href="#递归算法">递归算法</a></h2>
<p>直接或者间接调用自己的算法是递归算法。</p>
<p>递归算法的特点是：</p>
<ul>
<li>结构清晰，可读性强，容易使用数学归纳法证明正确性</li>
<li>运行效率低</li>
</ul>
<p>我们有几种方法来优化递归算法：</p>
<ul>
<li>采用用户定义的栈来模拟系统的递归调用</li>
<li>用递推来实现递归函数</li>
<li>使用<code>Cooper</code>变换、反演变换将递归转换为尾递归，进而用迭代求解</li>
</ul>
<h2 id="分治算法"><a class="header" href="#分治算法">分治算法</a></h2>
<p>将一个难以解决的问题分成一些规模较小的问题，以便分而治之，各个击破。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="编译原理和技术"><a class="header" href="#编译原理和技术">编译原理和技术</a></h1>
<p>大三上学期专业必修课——编译原理和技术。</p>
<p>授课教师：王雅文</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="编译概述"><a class="header" href="#编译概述">编译概述</a></h1>
<h2 id="翻译和解释"><a class="header" href="#翻译和解释">翻译和解释</a></h2>
<h3 id="程序设计语言"><a class="header" href="#程序设计语言">程序设计语言</a></h3>
<p>程序设计语言可以分成两种：</p>
<ul>
<li>低级语言：机器语言、符号语言、汇编语言</li>
<li>高级语言</li>
</ul>
<h3 id="翻译程序"><a class="header" href="#翻译程序">翻译程序</a></h3>
<p>扫面所输入的源程序，并将其转换为目标程序，或者直接将源程序之间翻译成结果。</p>
<p>翻译程序可以分成两个大类：</p>
<ul>
<li>编译程序：将源程序翻译为目标程序</li>
<li>解释程序：直接执行源代码</li>
</ul>
<p>一种有效的方法是：现将源程序转换为某种中间形式、然后对中间形式的程序解释执行。</p>
<h2 id="编译的阶段和任务"><a class="header" href="#编译的阶段和任务">编译的阶段和任务</a></h2>
<p>编译可以被分成两个阶段。</p>
<p><strong>分析阶段</strong>，更具源语言的定义，分析源程序。包括词法分析，语法分析和语义分析。</p>
<p><strong>综合阶段</strong>，根据分析结果构造目标程序。包括中间代码生成、代码优化和目标代码生成等阶段。</p>
<p>符号表的管理。</p>
<p>错误诊断和处理。</p>
<p><img src="compiler/./intro/image-20230912104643877.png" alt="image-20230912104643877" /></p>
<h3 id="分析阶段"><a class="header" href="#分析阶段">分析阶段</a></h3>
<h4 id="词法分析"><a class="header" href="#词法分析">词法分析</a></h4>
<p>线性分析和扫描。</p>
<p>词法分析程序需要对构成源程序的字符串进行分析，识别出每个具有独立意义的<strong>单词</strong>，将其转换成<strong>记号</strong>，并组织为记号流。同时把需要存放的单词放到符号表，如变量名、标号、常量名等。</p>
<p>词法分析程序的工作依据就是<strong>构词规则</strong>，也称为<strong>模式</strong>。</p>
<p>对于空格、注释的处理和其他：</p>
<ul>
<li>分隔单词的空格：被跳过</li>
<li>源程序中的注释：被跳过</li>
<li>识别出来的标识符需要放入符号表中</li>
<li>某些记号还需要具有属性值</li>
</ul>
<h4 id="语法分析"><a class="header" href="#语法分析">语法分析</a></h4>
<p>层次结构分析。</p>
<p>将记号流按照语言的语法结构层次的分组，形成语法短语。源程序的语法短语通过使用分析树表示。</p>
<p>语法分析的层次结构通过由递归的规则表示。</p>
<p>例：<code>total := total + rate * 4</code>的分析树如下所示：</p>
<p><img src="compiler/./intro/image-20230912105950601.png" alt="image-20230912105950601" /></p>
<h4 id="语义分析"><a class="header" href="#语义分析">语义分析</a></h4>
<p>对于语法成分的意义进行检查分析。语法成分就是语法分析确定的层次结构。同时收集必要的信息：类型、作用域等。工作依据是<strong>语义规则</strong>。</p>
<p>语义分析的一个重要人物是完成类型检查。</p>
<h3 id="综合阶段"><a class="header" href="#综合阶段">综合阶段</a></h3>
<h4 id="中间代码生成"><a class="header" href="#中间代码生成">中间代码生成</a></h4>
<p>中间代码是一种抽象的机器程序。，具有易于产生和易于翻译为目标代码等的特点。中间代码可以拥有多种形式。</p>
<p>常用三地址代码作为中间代码。</p>
<h4 id="代码优化"><a class="header" href="#代码优化">代码优化</a></h4>
<p>对于代码进行改进，占用空间少，运行速度快。</p>
<h4 id="目标代码生成"><a class="header" href="#目标代码生成">目标代码生成</a></h4>
<p>目标代码是可重定位的机器代码，一般就是汇编语言代码。</p>
<p>目标代码生成涉及到两个重要的问题：</p>
<ul>
<li>对程序中使用的每个变量指定存储单元</li>
<li>对变量进行寄存器分配</li>
</ul>
<h3 id="符号表管理"><a class="header" href="#符号表管理">符号表管理</a></h3>
<p>符号表管理是编译程序中的一项重要工作，需要记录在源程序中使用的标识符和每个标识符相关的各种属性信息。</p>
<p><strong>符号表</strong>是由若干记录组成的数据结构，每个标识符都在表中有一条记录，记录的域是标识符的属性。要求可以快速在符号表中可以找到标识符的记录，并且可以存取数据。</p>
<p>标识符的各种属性是在编译的各个不同的阶段填入符号表的。</p>
<h3 id="错误处理"><a class="header" href="#错误处理">错误处理</a></h3>
<p>在编译的各个阶段都可能检测到源程序中存在的错误。</p>
<p>在发现源程序中的错误之后，编译器还需要判断错误的位置和性质，同时进行适当的恢复。</p>
<h2 id="编译有关的其他概念"><a class="header" href="#编译有关的其他概念">编译有关的其他概念</a></h2>
<h3 id="前端和后端"><a class="header" href="#前端和后端">前端和后端</a></h3>
<p><strong>前端</strong>：与源语言有关而与目标机器无关的部分。</p>
<p>前端包括词法分析、语法分析、符号表的建立、语义分析和中间代码的生成。与机器无关的代码优化工作和相应的错误处理工作和符号表操作也在前端完成。</p>
<p><strong>后端</strong>：和目标代码有关的部分，进行目标代码的生成、与机器有关的代码优化，相应的错误处理和符号表操作。</p>
<p>划分前端和后端的优点：</p>
<ul>
<li>便于编译程序的<strong>移植</strong></li>
<li>便于编译程序的<strong>构造</strong></li>
</ul>
<h3 id="遍"><a class="header" href="#遍">遍</a></h3>
<p><strong>一遍</strong>：对源程序或者其中间形式从头到尾扫描一遍，并作相关的加工处理，生成新的中间形式或者目标程序。</p>
<p>编译程序的结构受到遍的影响。</p>
<p>典型的一遍扫描的编译程序如图所示：</p>
<p><img src="compiler/./intro/image-20230912113937024.png" alt="image-20230912113937024" /></p>
<p>典型的多遍编译程序如图所示：</p>
<p><img src="compiler/./intro/image-20230912114021025.png" alt="image-20230912114021025" /></p>
<p>将编译程序分遍的优点：</p>
<ul>
<li>减少对于主存容量的要求</li>
<li>编译程序的结构清晰</li>
<li>优化工作更加充分，获得高质量的目标程序</li>
<li>为编译程序的移植创造条件</li>
</ul>
<p>将编译程序分遍也增加了不少重复性的工作。</p>
<h3 id="编译程序的伙伴工具"><a class="header" href="#编译程序的伙伴工具">编译程序的伙伴工具</a></h3>
<h4 id="预处理器"><a class="header" href="#预处理器">预处理器</a></h4>
<p>进行宏处理、文件包含、语言扩充等的功能。</p>
<h4 id="汇编程序"><a class="header" href="#汇编程序">汇编程序</a></h4>
<p>汇编语言用助记符表示操作码，用标识符表示存储地址。</p>
<p>最简单的汇编程序需要对输入进行两遍扫描：</p>
<ol>
<li>找出表示存储单元的所有标识符，并将它们写入汇编符号表。在符号表中记录该标识符所对应的存储单元地址，此地址是在首次遇到该标识符的时候确定的。</li>
<li>把每个用助记符表示的操作码翻译为二进制表示的机器代码。将用标识符表示的存储地址翻译为汇编符号表中该标识符对应的地址。</li>
</ol>
<p>汇编程序需要输出可重定位的机器代码，同时需要对哪些需要重定位的指令做出标记。</p>
<h4 id="连接装配程序"><a class="header" href="#连接装配程序">连接装配程序</a></h4>
<p>将多个经过编译或者汇编的目标模块连接装配成一个完整的可执行程序。</p>
<p>可将连接装配程序分成两个程序：</p>
<ul>
<li>连接编辑程序：扫描外部符号表，寻找所连接的程序段，根据重定位信息表解决外部引用和重定位，最终将中整个程序涉及的目标模块逐个调入内存并连接在一起，组合成一个待装入的程序。</li>
<li>重定位装配程序：把目标模块的相对地址转换为绝对地址。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="词法分析-1"><a class="header" href="#词法分析-1">词法分析</a></h1>
<p>词法分析任务由词法分析程序完成。</p>
<h2 id="词法分析程序的作用"><a class="header" href="#词法分析程序的作用">词法分析程序的作用</a></h2>
<p>词法分析程序扫描源程序的字符流，按照源语言的词法规则识别出各类单词符号，产生用于语法分析的记号序列。</p>
<ul>
<li>词法检查</li>
<li>同用户接口的一些任务：
<ul>
<li>跳过源程序中的注释和空白</li>
<li>把错误信息和源程序联系起来</li>
</ul>
</li>
<li>创建符号表</li>
</ul>
<h3 id="词法分析程序和语法分析程序的关系"><a class="header" href="#词法分析程序和语法分析程序的关系">词法分析程序和语法分析程序的关系</a></h3>
<p>存在三种关系：</p>
<ul>
<li>
<p>词法分析程序作为独立的一遍</p>
<p><img src="compiler/./lexical-analyzer/image-20230919100626069.png" alt="image-20230919100626069" /></p>
<p>输出放到一个中间文件中，可以时磁盘文件/内存文件。</p>
</li>
<li>
<p>词法分析程序作为语法分析程序的子程序</p>
<p><img src="compiler/./lexical-analyzer/image-20230919100722222.png" alt="image-20230919100722222" /></p>
<p>这种关系避免了中间文件，省去了取送符号的工作，有利于条编译程序的效率。</p>
<blockquote>
<p>是否在词法分析阶段生成符号表由源程序是否由块结构语言决定。块结构语言是变量含有作用域的语言，而非块结构语言是变量没有作用域的语言。</p>
</blockquote>
</li>
<li>
<p>词法分析程序与语法分析程序作为协同程序</p>
<p>词法分词程序与语法分析程序在同一遍中工作，以生产者和消费者的关系同步运行。</p>
</li>
</ul>
<p>在上述三种关系中，词法分析程序都是作为一个单独的程序存在，这样的好处为：</p>
<ul>
<li>简化设计</li>
<li>改进编译程序的效率</li>
<li>加强编译程序的可移植性</li>
</ul>
<h2 id="源程序的输入与词法分析程序的输出"><a class="header" href="#源程序的输入与词法分析程序的输出">源程序的输入与词法分析程序的输出</a></h2>
<h3 id="词法分析程序的实现方法"><a class="header" href="#词法分析程序的实现方法">词法分析程序的实现方法</a></h3>
<ol>
<li>
<p>利用词法分析程序自动生成器</p>
<p>从基于正规表达式的规范说明自动生成词法分析程序</p>
<p>生成器提供用于源程序字符流读入和缓冲的若干子程序</p>
</li>
<li>
<p>利用系统程序设计语言来编写</p>
</li>
<li>
<p>利用汇编语言编写</p>
</li>
</ol>
<h3 id="缓冲区"><a class="header" href="#缓冲区">缓冲区</a></h3>
<p>为了得到某一个单词符号的确切性质，需要超前扫面若干个字符。</p>
<p>把一个缓冲区分为大小相同的两半，每半各含N个字符，这被称为<strong>缓冲区配对</strong>。</p>
<p><img src="compiler/./lexical-analyzer/image-20230919102239480.png" alt="image-20230919102239480" /></p>
<p>使用配对缓冲区的意义是为了避免在缓冲区的结束处读取到不完成的单词。测试的过程如下的伪代码所示：</p>
<p><img src="compiler/./lexical-analyzer/image-20230919102516995.png" alt="image-20230919102516995" /></p>
<p>我们还可以在每半个缓冲区的最后添加结束标记来提高测试的效率：</p>
<p><img src="compiler/./lexical-analyzer/image-20230919102614761.png" alt="image-20230919102614761" /></p>
<h3 id="词法分析程序的输出"><a class="header" href="#词法分析程序的输出">词法分析程序的输出</a></h3>
<h4 id="记号模式和单词"><a class="header" href="#记号模式和单词">记号、模式和单词</a></h4>
<p>记号是某一类单词符号的类别编码。如标识符的记号为<code>id</code>，常数的记号是<code>num</code>。</p>
<p>模式是某一类单词符号的构词规则。如标识符的模式是“由字母开头的字母数字串”。</p>
<p>单词是某一类单词符号的一个特例。</p>
<h4 id="记号的属性"><a class="header" href="#记号的属性">记号的属性</a></h4>
<p>词法分析程序在识别出一个记号后，要将与之有关的信息作为属性保存下来。</p>
<p><strong>记号影响语法分析的决策，属性影响记号的翻译</strong>。</p>
<p>在词法分析阶段，对一个记号只能确定一种属性。</p>
<ul>
<li>标识符：单词在符号表中的入口指针</li>
<li>常数：表示的值</li>
<li>关键词：一符一种/一类一种</li>
<li>运算符：一符一种/一类一种</li>
<li>分界符：一符一种/一类一种</li>
</ul>
<p>由于关键词、运算符和分节符，由于确定的编程语言只能有有限的关键词、与运算符和分界符，因此可以使用一符一种。</p>
<p><strong>例</strong>：<code>total := total * rate * 4</code>的词法分析结果</p>
<ul>
<li>标识符，指向标识符total`在符号表中的入口指针</li>
<li>赋值运算符，</li>
<li>标识符，指向标识符<code>total</code>在符号表的入口指针</li>
<li>加法运算符，</li>
<li>标识符，指向标识符<code>rate</code>在符号表中的入口指针</li>
<li>乘法运算符，</li>
<li>常数，整数值4</li>
</ul>
<blockquote>
<p>输出实际上就是一个<code>&lt;记号，属性&gt;</code>的二元组。</p>
</blockquote>
<h2 id="单词符号的描述及识别"><a class="header" href="#单词符号的描述及识别">单词符号的描述及识别</a></h2>
<p>识别单词是按照记号的模式进行的，一种种记号的模型匹配一类单词的集合。</p>
<p>正规表达式和正规文法是描述模式的重要工具。</p>
<blockquote>
<p>词法：描述语言的标识符、常数、运算法和标点符号等记号的文法，使用正规文法。</p>
<p>语法：借助于记号来描述语言的结构的文法，使用上下文无关的文法。</p>
</blockquote>
<h3 id="记号的文法"><a class="header" href="#记号的文法">记号的文法</a></h3>
<h4 id="标识符"><a class="header" href="#标识符">标识符</a></h4>
<p>假设标识符定义为“由字母开头的，由字母或数字组成的符号串”。</p>
<p>则描述标识符集合的正规表达式为：
$$
\rm{letter(letter|digit) ^*}
$$
转换为正规文法：
$$
id \to {\rm letter}\ rid
$$</p>
<p>$$
rid \to \epsilon | {\rm letter}\ rid | {\rm digit}\ rid
$$</p>
<h4 id="常数"><a class="header" href="#常数">常数</a></h4>
<ol>
<li>
<p>整数
$$
（digit)^+
$$
转换为正规文法：</p>
<p><img src="compiler/./lexical-analyzer/image-20230919112342404.png" alt="image-20230919112342404" /></p>
</li>
<li>
<p>无符号数
$$
\rm (digit)^+(.(digit)^+)?(E(+|-)?(digit)^+)?
$$
转换为正规文法：</p>
<p><img src="compiler/./lexical-analyzer/image-20230919112436216.png" alt="image-20230919112436216" /></p>
</li>
<li>
<p>运算符
$$
\rm &lt;|&lt;=|=|&lt;&gt;|&gt;=|&gt;
$$
<img src="compiler/./lexical-analyzer/image-20230919113035359.png" alt="image-20230919113035359" /></p>
</li>
</ol>
<h3 id="状态转换图与记号的识别"><a class="header" href="#状态转换图与记号的识别">状态转换图与记号的识别</a></h3>
<p>状态转换图是一张有限的方向图。</p>
<p>由上文中无符号数的右线性文法可以画出状态转换图：</p>
<p><img src="compiler/./lexical-analyzer/image-20230919113245748.png" alt="image-20230919113245748" /></p>
<h2 id="词法分析程序的设计与实现"><a class="header" href="#词法分析程序的设计与实现">词法分析程序的设计与实现</a></h2>
<blockquote>
<p>就是写一个程序。</p>
</blockquote>
<h3 id="文法和状态转换图"><a class="header" href="#文法和状态转换图">文法和状态转换图</a></h3>
<p>首先根据语言的说明写出记号的正规文法、画出状态转换图。</p>
<p><img src="compiler/./lexical-analyzer/image-20230919115534099.png" alt="image-20230919115534099" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="语法分析-1"><a class="header" href="#语法分析-1">语法分析</a></h1>
<h2 id="语法分析简介"><a class="header" href="#语法分析简介">语法分析简介</a></h2>
<p>语法分析是编译程序的核心规则，按照源语言的语法规则进行分析，输出分析树并进行语法分析阶段的错误处理。</p>
<ul>
<li>从源程序记号序列中识别出各类的语法成分</li>
<li>进行语法检查</li>
</ul>
<p>鉴于分析树的树状数据结构，我们有两种分析方法：</p>
<ul>
<li>自顶向下的分析方法</li>
<li>自底向上的分析方法</li>
</ul>
<h3 id="语法错误的处理"><a class="header" href="#语法错误的处理">语法错误的处理</a></h3>
<p>错误处理的目标是：</p>
<ul>
<li>报告错误的位置和性质</li>
<li>迅速从错误中恢复</li>
<li>不应该明显影响对于正确程序的分析速度</li>
</ul>
<p>错误处理有如下的策略：</p>
<ul>
<li>
<p>紧急恢复：一旦发现错误，分析程序每次抛弃一个输入记号，直到扫描到的记号属于某个指定的同步记号集合。</p>
<p>同步记号集合往往是定界符，如语句结束符（分号），语句起始符，块结束符（END）。</p>
</li>
<li>
<p>短语级恢复</p>
</li>
<li>
<p>出错产生式</p>
</li>
<li>
<p>全局纠正</p>
</li>
</ul>
<h2 id="自顶向下的分析防范"><a class="header" href="#自顶向下的分析防范">自顶向下的分析防范</a></h2>
<h3 id="递归下降分析"><a class="header" href="#递归下降分析">递归下降分析</a></h3>
<p>从文法的开发符号出发，进行推导，试图推导出要分析的输入串的过程。对于给定的输入符号串，从对应于文法开始符号的根节点出来，建立分析树。整个过程是一个试探的过程，反复使用不同的产生式谋求匹配输入符号串的过程。</p>
<p><strong>例</strong>：按照如下的文法分析<code>abbcde</code>
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">aAcBe</span></span><span class="mspace newline"></span><span class="mord"><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">b∣Ab</span></span><span class="mspace newline"></span><span class="mord"><span class="mord"><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">d</span></span></span></span></span></span></span></span></span>
首先尝试<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">aAcBe</span></span></span></span></span></span>，对于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>分别尝试两种生成情况递归生成中间两个<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">b</span></span></span></span></span></span>，依次类推递归尝试所有的生成式。</p>
<p>使用递归下降分析可以得到一个<strong>最左推导序列</strong>。</p>
<blockquote>
<p>关于<strong>推导</strong>的补充知识：</p>
<p>现在有
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathrm">A</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></span>
其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">=&gt;</span></span></span></span> 表示<strong>一步推导</strong>，其中称左边直接推导出右边，也可以说右边是左边的直接推导，或者右边直接归约到左边。</p>
</blockquote>
<blockquote>
<p>关于<strong>短语</strong>的补充知识：</p>
<p>假定<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span></span></span> 是文法的一个句型，如果存在：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8213em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>
就称<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 是句型<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span></span></span>关于非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>的短语。</p>
<p>如果存在：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>
那么就称<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 是句型<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span></span></span>关于非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>的直接短语。</p>
<p>一个句型的最左直接短语称为该局性的句柄。</p>
</blockquote>
<p>因此对于输入串的扫描是自左至右进行的，只有使用最左推导，才能保证按照扫描的顺序匹配输入串。</p>
<p>但是递归下降分析方法存在缺陷：</p>
<ul>
<li>左递归的文法，可能导致分析过程陷入死循环</li>
<li>回溯</li>
<li>工作的重复</li>
<li>效率低</li>
</ul>
<h3 id="递归调用预测分析"><a class="header" href="#递归调用预测分析">递归调用预测分析</a></h3>
<p>一个确定的，不带回溯的递归下降分析方法。</p>
<ol>
<li>
<p>如何克服回溯？</p>
<p>根据所面临的输入符号准确的指派一个候选式去执行任务。</p>
</li>
<li>
<p>那么如何准确指派，首先对文法存在要求。</p>
<ul>
<li>不含有左递归</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span> 其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></li>
</ul>
<blockquote>
<p>解释一下<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span></span></span></span>的规定：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>
也就是非终结符<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>能够推出的一个终结符。</p>
</blockquote>
</li>
</ol>
<h4 id="预测分析程序的构造"><a class="header" href="#预测分析程序的构造">预测分析程序的构造</a></h4>
<ol>
<li>
<p>构造预测分析程序转换图</p>
<p>每个非终结符号都有一张图，边的标记可以使终结符号和非终结符号。</p>
<p>对于非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>的转移表示对<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>的过程调用。</p>
<p>对于终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>的转移，表示下一个输入符号应该是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></p>
<p>为了从文法构造一个转换图，我们需要首先对文法进行改写：</p>
<ul>
<li>重写文法</li>
<li>消除左递归</li>
<li>提取左公因子</li>
</ul>
<blockquote>
<p>消除左递归：</p>
<p>首先考虑简单情况。如果存在产生式：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathrm">A</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathrm">∣</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></span>
可以改写为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9963em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>
<img src="compiler/./grammar-analyzer/image-20230926113422832.png" alt="image-20230926113422832" /></p>
</blockquote>
<blockquote>
<p>提取左公因子：</p>
<p>如果存在产生式：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathrm">∣</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></span>
那么提取左公因子<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，有：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span></p>
</blockquote>
<p>然后对于每个非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>：创建一个初始状态和一个终结状态，对于每一个产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>创建一条从初态到终态的路径。</p>
</li>
<li>
<p>转换图的工作过程</p>
<p>从文法开始符号所对应的转换图的开始状态开始分析。</p>
<p>经过若干动作之后，处于状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，指针指向符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>:</p>
<p><img src="compiler/./grammar-analyzer/image-20230926114657078.png" alt="image-20230926114657078" /></p>
</li>
<li>
<p>转换图的化简</p>
<p>反复代入化简。</p>
<p><img src="compiler/./grammar-analyzer/image-20230926114931452.png" alt="image-20230926114931452" /></p>
</li>
<li>
<p>预测分析程序的实现</p>
<p><img src="compiler/./grammar-analyzer/image-20230926115738715.png" alt="image-20230926115738715" /></p>
<pre><code class="language-c">void procE()
{
    procT();
    if (input == '+')
    {
        pointer.forward();
        procE();
    }
}
</code></pre>
</li>
</ol>
<h3 id="非递归预测分析"><a class="header" href="#非递归预测分析">非递归预测分析</a></h3>
<p>使用一张分析表和一个栈联合控制，输入对输入符号的自顶向下分析。</p>
<p>预测分析程序的模型如图所示：</p>
<p><img src="compiler/./grammar-analyzer/image-20231010101812965.png" alt="image-20231010101812965" /></p>
<ul>
<li>输入缓冲区：存储被分析的输入符号串</li>
<li>符号栈：存放文法符号</li>
<li>分析表：存储产生式，根据给定的栈顶和当前指针定位产生式</li>
<li>输出流</li>
</ul>
<blockquote>
<p>说明，<code>$</code>表示起始和终结符号</p>
</blockquote>
<h4 id="预测分析控制程序"><a class="header" href="#预测分析控制程序">预测分析控制程序</a></h4>
<p>根据栈顶符号<code>X</code>和当前输入符号<code>a</code>，分析动作存在四种可能：</p>
<ol>
<li><code>X</code>和<code>a</code>都是终结符号，停止分析</li>
<li><code>X=a</code>但是不为终结符号，弹栈并向前移动输入指针</li>
<li><code>X</code>在分析表中但是<code>a</code>不是，调用错误处理程序报告错误并进行错误恢复</li>
<li>访问分析表获得产生式，先弹栈，并将生成式的右部符号串按反序压入栈中</li>
</ol>
<p>可以写出伪代码：</p>
<p><img src="compiler/./grammar-analyzer/image-20231010102924356.png" alt="image-20231010102924356" /></p>
<h4 id="预测分析表的构造"><a class="header" href="#预测分析表的构造">预测分析表的构造</a></h4>
<ol>
<li>
<p>首先进行文法的改写，同递归调用分析预测的要求和步骤一致。</p>
</li>
<li>
<p><code>FIRST</code>集合及其构造</p>
<p><code>FIRST</code>集合的定义为：</p>
<p>对于任何文法符号串<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>可以推导出的开头终结符号集合。
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">}</span></span></span></span></span>
特别需要注意的是，如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>可以推出空串，那么<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>。</p>
<p>构造<code>FIRST</code>集合：</p>
<ul>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 那么<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mclose">}</span></span></span></span></li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>， 那么针对所有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>的生成式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span>，将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>加入</li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> ,加入空串</li>
<li>如果存在<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span> ，加入<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>中所有非空的元素</li>
</ul>
<p>重复该过程，知道所有的集合不再变化为止。</p>
</li>
<li>
<p><code>FOLLOW</code>集合及其构造</p>
<p><code>FOLLOW</code>集合的定义为：</p>
<p>假定<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>为文法的开始符号，对于文法中的任何非终结符，集合<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>式在所有句型中紧跟<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>之后出现的终结符号或者<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">$</span></span></span></span>组成的集合。
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">}</span></span></span></span></span>
特别的，如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span></span></span></span>，那么规定<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">$</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>，注意集合中不能存在空串。</p>
<p>构造<code>FOLLOW</code>集合：</p>
<ul>
<li>对于文法开始符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>，将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">$</span></span></span></span>放入<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span></span>中</li>
<li>如果存在产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">Bβ</span></span></span></span>，那么将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span></span>中的所有非空元素加入<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>中</li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，或者<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">Bβ</span></span></span></span>且存在<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>，那么将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>中的所有元素加入到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>中</li>
</ul>
<p>重复此过程，直到所有集合不再变化为止。</p>
</li>
<li>
<p>预测分析表的构造</p>
<p><img src="compiler/./grammar-analyzer/image-20231010111718252.png" alt="image-20231010111718252" /></p>
</li>
</ol>
<p><strong>LL(1文法</strong>：如果一个文法的预测分析表不含有多重定义的表项，则称该文法为LL(1)文法。</p>
<p>LL(1)文法的判定方法：</p>
<p>当且仅当对于该文法的每一个产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> ，都有：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span></li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>, 那么 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span></li>
</ul>
<p>或者根据分析表来判断。</p>
<h2 id="自底向上的分析方法"><a class="header" href="#自底向上的分析方法">自底向上的分析方法</a></h2>
<p>从左到右进行对输入串的扫描，自底向上的进行分析树的构造。分析的过程如下：</p>
<ul>
<li>从输入符号串开始分析</li>
<li>查找当前句型的<strong>可归约串</strong></li>
<li>使用规则，把它归约成相对应的非终结符号</li>
<li>重复</li>
</ul>
<h3 id="优先分析法"><a class="header" href="#优先分析法">优先分析法</a></h3>
<p>优先分析法分成简单优先分析法和算符优先分析法。</p>
<ol>
<li>
<p>简单优先分析法
按照文法符号之间的优先关系确定当前句型的可归约串。但是存在分析效率低且只适用于简单优先文法的问题。</p>
<blockquote>
<p>简单优先文法：
任何两个文法符号之间最多存在一种优先关系。
不存在具有相同右部的产生式。</p>
</blockquote>
</li>
<li>
<p>算符优先分析法
只考虑中介符号之间的优先关系。分析速度快，但是只适用于<strong>算符优先文法</strong>。</p>
<blockquote>
<p>算符文法： 没有形如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span>的产生 式的文法。</p>
</blockquote>
<blockquote>
<p>算符优先文法：算符文法，且不含有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>生成式。任何两个构成有序对的终结符号之间最多有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span></span></span></span>、<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span>、<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span>三种优先关系中的一种成立。</p>
</blockquote>
<p><strong>可归约串</strong>是句型的最左素短语。<strong>素短语</strong>是句型的一个短语，至少含有一个中介符号，并且除它自身之外不存在其他更小的素短语。<strong>最左素短语</strong>就是处在句型最左边的素短语。</p>
</li>
</ol>
<h4 id="移进归约分析方法"><a class="header" href="#移进归约分析方法">移进——归约分析方法</a></h4>
<p>该方法需要设置一个符号栈存放文法符号。</p>
<ol>
<li>
<p>将输入符号一个个地移进栈中；</p>
</li>
<li>
<p>当栈顶的符号串形成某个产生式的一个候选式时，<em>在一定条件下</em>，把该符号串替换为该产生式的左部符号；</p>
</li>
<li>
<p>重复2，直到栈顶符号不再是可归约串为止；</p>
</li>
<li>
<p>重复1~3，直到最终归约出开始符号。</p>
</li>
</ol>
<h4 id="规范归约"><a class="header" href="#规范归约">规范归约</a></h4>
<p>假设<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>是文法<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>的一个句子，存在右句型序列<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>的一个规范归约，如果序列满足：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></li>
<li>对于任何<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>是经过把<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的句柄替换成相应产生式的左部符号而得到的</li>
</ul>
<h2 id="lr分析方法"><a class="header" href="#lr分析方法">LR分析方法</a></h2>
<p>首先介绍<code>LR(k)</code>的含义：<code>L</code>表示自左向右扫描输入字符串，<code>R</code>表示为输入符号串构造一个最右推导的逆过程，<code>k</code>表示为作出分析决定而向前看的输入符号个数。</p>
<p>LR分析方法的基本思想：</p>
<ul>
<li>历史信息：记住已经移进和归约出的整个符号串</li>
<li>预测信息：根据所用的产生式推测未来可能遇到的输入符号</li>
</ul>
<p>根据历史信息和预测信息，以及现实的输入符号确定栈顶的符号串是否构成相对于某一产生式的句柄。</p>
<h3 id="lr分析程序的模型和工作过程"><a class="header" href="#lr分析程序的模型和工作过程">LR分析程序的模型和工作过程</a></h3>
<ul>
<li>栈</li>
<li>控制程序</li>
<li>分析表</li>
<li>输入</li>
<li>输出</li>
</ul>
<h4 id="分析表"><a class="header" href="#分析表">分析表</a></h4>
<p>LR分析控制程序工作的依据，有着两张表：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span></span></span></span> 状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>经过<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>转移的后继状态</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>遇到输入符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>应该采取的分析动作。</li>
</ul>
<p>分析动作可以有四种：</p>
<ul>
<li><code>shift S</code>：将当前输入符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>推进栈中，向前扫描指针前移，其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></li>
<li><code>reduce by</code>：生成式为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>的长度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>，则从栈顶向下弹出<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>项，使得<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>成为栈顶状态，然后把文法符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>以及状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>推进栈中，其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mclose">]</span></span></span></span></li>
<li><code>accept</code>：宣布分析成功</li>
<li><code>error</code>：调用出错处理程序，进行错误恢复</li>
</ul>
<h4 id="分析控制程序"><a class="header" href="#分析控制程序">分析控制程序</a></h4>
<p><img src="compiler/./grammar-analyzer/image-20231024101050918.png" alt="image-20231024101050918" /></p>
<blockquote>
<p>活前缀：一个规范句型的一个前缀，如果不含句柄之后的任何符号，则称它为该句型的一个活前缀。</p>
</blockquote>
<h3 id="slr分析表的构造"><a class="header" href="#slr分析表的构造">SLR分析表的构造</a></h3>
<p>为给定的文法构造一个识别它所有活前缀的<code>DFA</code>，根据这个<code>DFA</code>构造文法的分析表。</p>
<p><code>LR(0)</code>项目：右部某个位置上标有圆点的产生式成为文法<code>G</code>的一个<code>LR(0)</code>项目。例如生成式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>对应有4个<code>LR(0)</code>项目：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">⋅</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord">⋅</span></span></span></span></li>
</ul>
<p>各种<code>LR(0)</code>项目可以分为：</p>
<ul>
<li>归约项目：远点在产生式最右端的项目</li>
<li>接受项目：对文法开始符号的归约项目</li>
<li>待约项目：圆点后第一个符号为非终结符号的项目</li>
<li>移进项目：圆点后第一个符号为终结符浩的项目</li>
</ul>
<p>下面再定义<code>LR(0)</code>有效项目：</p>
<p>对于项目<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord">2</span></span></span></span>，活前缀<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，如果存在
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></span>
则称该项目对于该前缀是有效的。</p>
<p>文法<code>G</code>·的某个活前缀<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span>的所有<code>LR(0)</code>有效项目组成的集合称为该活前缀的<code>LR(0)</code>有效项目集。</p>
<p>文法<code>G</code>的所有<code>LR(0)</code>有效项目集组成的集合称为<code>G</code>的<code>LR(0)</code>项目集规范族。</p>
<p><code>SLR</code>分析方法的一个特征：如果文法的有效项目集中有冲突动作，多数冲突可以通过考查有关非终结符号的<code>FOLLOW</code>集合可以解决。</p>
<p>例如对于项目集
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord">⋅</span><span class="mclose">}</span></span></span></span></span>
同时存在移进-归约冲突和归约-归约冲突。</p>
<p>通过查看<code>FOLLOW(A)</code>和<code>FOLLOW(B)</code>解决：如果
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord">&amp;&amp;</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></span>
决策：</p>
<ul>
<li>当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>，将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>入栈</li>
<li>当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>时，使用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>进行归约</li>
<li>当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>时，使用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>进行归约</li>
</ul>
<h3 id="lr1分析表的构造"><a class="header" href="#lr1分析表的构造">LR(1)分析表的构造</a></h3>
<p>首先给出<code>LR(K)</code>项目：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> 是一个<code>LR(0)</code>项目</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">⋅</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是<strong>向前看符号串</strong></li>
</ul>
<p>注意，向前看符号串只对归约项目起作用。</p>
<p><code>LR(k)</code>项目意味着当它所属的项目集状态在栈顶且后续的输入符号序列和向前看符号串匹配的时候才允许归约。</p>
<p><strong>定义</strong>：<code>LR(1)</code>有效项目</p>
<p>对于一个<code>LR(1)</code>项目<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">]</span></span></span></span>，如果存在一个规范推导：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⇒</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></span>
其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span>的第一个符号为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，则该项目对于活前缀<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>是有效的</p>
<p><strong>推广</strong>：</p>
<p>如果项目<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Bβ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">]</span></span></span></span>对于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>是有效的，并且由产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span></span></span></span>，则对于任何的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">RST</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> ，项目
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">⋅</span><span class="mord mathnormal" style="margin-right:0.03588em;">η</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></span>
对于该活前缀也是有效的。</p>
<p>利用定义和推广获得项目集的闭包：</p>
<p><img src="compiler/./grammar-analyzer/image-20231024112353800.png" alt="image-20231024112353800" /></p>
<p>构造<code>LR(1)</code>分析表</p>
<p><img src="compiler/./grammar-analyzer/image-20231024114920114.png" alt="image-20231024114920114" /></p>
<h3 id="lalr1分析表的构造"><a class="header" href="#lalr1分析表的构造">LALR(1)分析表的构造</a></h3>
<p>首先给出两个描述<code>LR(1)</code>项目集特征的定义：</p>
<ul>
<li><strong>同心集</strong>：如果两个<code>LR(1)</code>项目集在去掉搜索符号之后是相同的，则称这两个项目具有相同的心。</li>
<li><strong>项目集的核</strong>：除了初态项目集之后，一个项目集的核是由该项目集中那些圆点不在最左边的项目组成。</li>
</ul>
<p>构造<code>LALR(1)</code>分析表的基本思想：</p>
<ul>
<li>合并项目集规范族中的同心集，减少分析表的状态数</li>
<li>用核代替项目集，减少项目集所需的存储空间</li>
</ul>
<blockquote>
<p>注意，同心集的合并可能会导致新的归约-归约冲突。</p>
</blockquote>
<p>因此，构造<code>LALR(1)</code>分析表的过程如下：</p>
<ol>
<li>
<p>首先构造<code>LR(1)</code>项目集的规范族</p>
</li>
<li>
<p>检查<code>LR(1)</code>项目集规范族</p>
<p>如果存在冲突，不是<code>LR(1)</code>文法。</p>
<p>不存在冲突。</p>
</li>
<li>
<p>检查是否存在同心集，合并同心集</p>
</li>
<li>
<p>检查合并之后的项目集是否存在冲突</p>
<p>如果存在冲突，不是<code>LALR(1)</code>文法</p>
<p>不存在冲突。</p>
</li>
<li>
<p>根据<code>LALR(1)</code>项目集规范族构造分析表</p>
</li>
</ol>
<blockquote>
<p>文法的分类：</p>
<p><img src="compiler/./grammar-analyzer/image-20231031100516481.png" alt="image-20231031100516481" /></p>
</blockquote>
<h3 id="lr分析方法对于二义文法的应用"><a class="header" href="#lr分析方法对于二义文法的应用">LR分析方法对于二义文法的应用</a></h3>
<p><strong>定理</strong>：任何二义文法绝不是LR文法，因而也不是SLR或者LALR文法。</p>
<p>但是在程序设计语言中的某些结构使用二义性文法来描述比较直观，使用方便。可以定义一些规则来解决文法的二义性，例如：</p>
<ul>
<li>
<p>算数表达式</p>
<p>使用运算符优先级或者运算结合规则</p>
</li>
<li>
<p><code>if</code>语句</p>
<p><code>else</code>的最近最后匹配规则</p>
</li>
</ul>
<h3 id="lr分析的错误处理与恢复"><a class="header" href="#lr分析的错误处理与恢复">LR分析的错误处理与恢复</a></h3>
<p>当分析文法发生错误时，可以采用如下的恢复策略：从栈顶开始弹栈，可能会弹出若干个状态直到出现状态<code>S</code>。其中状态<code>S</code>满足以下某一个条件：</p>
<ul>
<li>
<p>状态<code>S</code>有相对于当前输入符号的转移</p>
<p>移进，分析继续</p>
</li>
<li>
<p><code>goto</code>表中有<code>S</code>相对于某非终结符号<code>A</code>的后继</p>
<p>跳过若干个输入符号，直到出现符号<code>a</code>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">FO</span><span class="mord mathnormal">LL</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>，然后将状态<code>goto[S, A]</code>压入栈顶，分析继续</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="语法制导翻译技术"><a class="header" href="#语法制导翻译技术">语法制导翻译技术</a></h1>
<p>语法制导翻译的整体思路：</p>
<ol>
<li>根据翻译目标确定每个产生式的语义</li>
<li>根据产生式的含义确定每个符号的含义</li>
<li>将这些语义以属性的形式附加到相应的文法符号上，将语义和语言结构联系起来</li>
<li>根据产生式的语义给出符号属性的求值规则形成语法制导定义</li>
</ol>
<p><strong>翻译目标决定了产生式的含义，决定文法符号应该具有的属性，也决定了产生式的语义规则。</strong></p>
<p>翻译目标决定语义规则：翻译目标决定产生式的含义，决定文法符号应该具有的属性，也决定了产生式的语义规则。</p>
<p>翻译目标可以是：</p>
<ul>
<li>生成代码</li>
<li>对输入符号串进行解释执行</li>
<li>向符号表中存放信息</li>
<li>给出错误信息</li>
</ul>
<p>翻译结果依赖于语义规则：使用语义规则进行计算所得到的结果就是对输入符号串进行翻译的结果。</p>
<p>语法制导翻译的一般步骤是：</p>
<p><img src="compiler/./grammar-driven-translation/image-20231107115417003.png" alt="image-20231107115417003" /></p>
<p>语义规则的执行时机：</p>
<h2 id="语法制导定义及翻译方法"><a class="header" href="#语法制导定义及翻译方法">语法制导定义及翻译方法</a></h2>
<h3 id="语法制导定义"><a class="header" href="#语法制导定义">语法制导定义</a></h3>
<blockquote>
<p>对于上下文无关文法的推广。</p>
</blockquote>
<p>每个文法符号都可以拥有一个属性集，其中可以包括两类属性：</p>
<ul>
<li>
<p>综合属性</p>
<p>左部符号的综合属性是从该产生式的右部文法符号的属性值计算处理的</p>
<p>在分析树中，一个内部结点的综合属性是从其子节点的属性值计算出来的</p>
</li>
<li>
<p>继承属性</p>
<p>对于每一个文法产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，都有与之相联系的一组语义规则，其形式为</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>是一个函数，而且：</p>
<p>如果b是A的一个综合属性，则<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是产生式右部文法符号的属性或者是A的继承属性；如果b是右部某个文法符号的继承属性，那么<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是A或者产生式右部任何文法符号的属性。</p>
</li>
</ul>
<p>在一般情况下，语义规则函数可以写成表达式的形式： <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>。但是在某些特定的情况下，一个语义规则的目的就是完成一个特定的动作，例如打印一个值或者向符号表中插入一条记录。这样的属性称为<strong>虚拟综合属性</strong>，写成过程调用或者是程序段的形式，例如<code>print(E.val)</code>。</p>
<h3 id="依赖图"><a class="header" href="#依赖图">依赖图</a></h3>
<p>分析树中，结点的继承属性和综合属性之间的相互依赖关系可以由依赖图表示。在依赖图中，</p>
<ul>
<li>为每个属性设置一个结点</li>
<li>如果属性b依赖于属性c，那么从属性c的结点由一条有向边连接到属性b的结点。</li>
</ul>
<p><img src="compiler/./grammar-driven-translation/image-20231114102858830.png" alt="image-20231114102858830" /></p>
<h3 id="计算次序"><a class="header" href="#计算次序">计算次序</a></h3>
<p>依赖图的任何拓扑排序给出了分析树中结点的语义规则计算的有效顺序。</p>
<p>综上，语法制导翻译过程为：</p>
<ol>
<li>最基本的文法用于建立输入符号串的分析树</li>
<li>为分析树构造依赖图</li>
<li>对依赖图进行拓扑排序</li>
<li>从这个序列得到语义规则的计算顺序</li>
<li>照此计算顺序进行求值，得到对于输入符号串的求值。</li>
</ol>
<h3 id="s属性定义和l属性定义"><a class="header" href="#s属性定义和l属性定义">S属性定义和L属性定义</a></h3>
<p>S属性定义：仅涉及到综合属性的语法制导定义。</p>
<p>L属性定义：一个语法制导定义如果满足每个产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>对应的每条语义规则计算的属性都是：</p>
<ul>
<li>A的综合属性</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>的继承属性，且该继承属性仅继承于A的继承属性或者产生式中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>左边的符号属性</li>
</ul>
<blockquote>
<p>按照定义，每个S属性定义都是L属性定义。</p>
</blockquote>
<p>L属性定义的属性都可以用深度优先遍历的顺序计算：</p>
<ul>
<li>在进入结点前，计算继承属性</li>
<li>在从结点返回时，计算他的综合属性</li>
</ul>
<h3 id="翻译方案"><a class="header" href="#翻译方案">翻译方案</a></h3>
<p>上下文无关文法的一种便于翻译的书写形式。</p>
<ul>
<li>属性和文法符号相对应</li>
<li>语义动作写在花括号中，并插入到产生式右部某个合适的位置上</li>
<li>给出了使用语义规则进行属性计算的顺序</li>
<li>分析过程中翻译的注释</li>
</ul>
<p><img src="compiler/./grammar-driven-translation/image-20231114104757413.png" alt="image-20231114104757413" /></p>
<blockquote>
<p>深度优先遍历树中的结点，执行动作，打印出<code>95-2+</code>。</p>
</blockquote>
<p>翻译方案的设计：</p>
<ol>
<li>
<p>对于S属性定义：</p>
<p>为每一个语义规则建立一个包含赋值的动作，把这个动作放在相应的产生式右边末尾。</p>
</li>
<li>
<p>对于L属性定义：</p>
<p>左部符号的综合属性只有在它所引用的所有属性都计算出来之后才能计算，因此这种属性的计算动作要放在产生式的末尾。</p>
<p>右部符号的继承属性必须在这个符号以前的动作中计算出来，因此计算该继承属性的动作必须出现在相应文法符号之前。</p>
</li>
</ol>
<h2 id="s-属性定义的自底向上翻译"><a class="header" href="#s-属性定义的自底向上翻译">S-属性定义的自底向上翻译</a></h2>
<h3 id="为表达式构造语法树的语法制导定义"><a class="header" href="#为表达式构造语法树的语法制导定义">为表达式构造语法树的语法制导定义</a></h3>
<h3 id="s-属性定义的自底向上实现"><a class="header" href="#s-属性定义的自底向上实现">S-属性定义的自底向上实现</a></h3>
<p>基于LR分析方法。</p>
<p>在LR分析方法中，分析程序使用<strong>栈</strong>存放已经分析过的子树的信息。因此，在分析栈中增加一个域保存综合属性值。</p>
<p>修改分析程序：</p>
<ul>
<li>
<p>对于终结符号：</p>
<p>综合属性值由词法分析程序产生。</p>
<p>当分析程序执行移进操作时，属性值随着状态符号一起入栈。</p>
</li>
<li>
<p>为每个语义规则编写一段代码计算属性值</p>
</li>
<li>
<p>对于每个产生式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>:</p>
<p>在进行归约动作时执行属性值的计算代码。将右部符号的相应状态和属性出栈，左部符号的相应状态和属性入栈。</p>
</li>
</ul>
<h2 id="l-属性定义的自底向上翻译"><a class="header" href="#l-属性定义的自底向上翻译">L-属性定义的自底向上翻译</a></h2>
<p>在自底向上的分析过程实现L属性定义的翻译。</p>
<ul>
<li>可以实现任何基于LL(1)文法的L属性定义</li>
<li>可以实现许多基于LR(1)文法的L属性定义</li>
</ul>
<p>下面介绍四种实现方法。</p>
<h4 id="移走翻译方案中嵌入的语义规则"><a class="header" href="#移走翻译方案中嵌入的语义规则">移走翻译方案中嵌入的语义规则</a></h4>
<p>自底向上地处理继承属性。对翻译方案进行等价变换，使所有嵌入的动作都出现在产生式的右端末尾。</p>
<p>方法：</p>
<ul>
<li>在基础文法中引入新的产生式，形如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>，即只生成空串</li>
<li>将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>称为<strong>标记非终结符号</strong>，用来代替嵌入在产生式中的动作</li>
<li>把被<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>替代的动作放在产生式的末尾</li>
</ul>
<p>例如对于下列文法进行等价变换：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">TR</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord">+</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)}</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mbin">−</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)}</span><span class="mord">∣</span><span class="mord mathnormal">ϵ</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)}</span></span></span></span></span>
引入非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>和<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>，形成新的翻译方案
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">TR</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">+</span><span class="mord mathnormal" style="margin-right:0.00773em;">TMR</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">TNR</span><span class="mord">∣</span><span class="mord mathnormal">ϵ</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)}</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mbin">+</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)}</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mopen">{</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mbin">−</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)}</span></span></span></span></span>
可以画出等价变化之后的分析树：</p>
<p><img src="compiler/./grammar-driven-translation/image-20231121110556621.png" alt="image-20231121110556621" /></p>
<h4 id="直接使用分析栈中的继承属性"><a class="header" href="#直接使用分析栈中的继承属性">直接使用分析栈中的继承属性</a></h4>
<p>利用<strong>复制规则</strong>传递继承属性。</p>
<h4 id="变换继承属性的计算规则"><a class="header" href="#变换继承属性的计算规则">变换继承属性的计算规则</a></h4>
<p>当且仅当属性值在栈中存放的位置可以预测时，可以从栈中取得继承属性。</p>
<p>例如对于语法制导定义：</p>
<p><img src="compiler/./grammar-driven-translation/image-20231121112315519.png" alt="image-20231121112315519" /></p>
<p>当使用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>进行归约时，属性<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord">.</span><span class="mord mathnormal">i</span></span></span></span>可能出现在<code>top - 1</code>和<code>top - 2</code>中。</p>
<p>因此使用<strong>模拟继承属性</strong>的计算：</p>
<p>引入标记非终结符号<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>，</p>
<p><img src="compiler/./grammar-driven-translation/image-20231121113501083.png" alt="image-20231121113501083" /></p>
<p>这样使用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>进行归约时，属性<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord">.</span><span class="mord mathnormal">i</span></span></span></span>一直在<code>top - 1</code>的位置上。</p>
<p>​</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="语义分析概述"><a class="header" href="#语义分析概述">语义分析概述</a></h2>
<p>程序设计语言的结构常常使用上下文无关文法来描述，基于此开发的语法分析程序可以检查程序中存在的语法错误。但是语法正确的程序<strong>不一定</strong>时完全正确的，程序的正确还和程序中的上下文有关系：</p>
<ul>
<li>变量的作用于问题</li>
<li>同一作用域中的同名变量问题</li>
<li>表达式和赋值语句中的类型一致问题</li>
</ul>
<blockquote>
<p>注意：</p>
<p>设计使用<strong>上下文有关文法</strong>来描述语言中的上下文结构在理论上是可行的，但是实践上非常困难。</p>
</blockquote>
<p>因此，使用<strong>语法制导的翻译技术</strong>实现语义的分析，设计专门的语义动作补充山下文无关文法的分析程序。</p>
<h3 id="语义分析的任务"><a class="header" href="#语义分析的任务">语义分析的任务</a></h3>
<p>语义分析程序通过将变量的定义和变量的引用联系起来，对源程序的含义进行检查。</p>
<p>语义分析程序会在分析声明语句时，将所声明标识符的信息收集到<strong>符号表</strong>中，收集到信息包括：类型、存储位置、作用域等。主要编译时控制处在声明该标识符的程序块中，就可以从符号表中查到该标识符的记录。</p>
<p><strong>类型检查</strong>可以分成两种：在目标程序运行时进行的检查称为<strong>动态检查</strong>。而读入源程序但不执行源程序的情况下进行的检查就是<strong>静态检查</strong>。类型检查的内容包括：</p>
<ul>
<li>检验结构的类型是否和上下文所期望的一致、检查操作的合法性和数据类型的相容性</li>
<li>唯一性检查：一个标识符在同一作用域中只能被声明一次</li>
<li>控制流检查：控制语句是否转移到一个合法的位置</li>
</ul>
<h3 id="语义分析程序的位置"><a class="header" href="#语义分析程序的位置">语义分析程序的位置</a></h3>
<p><img src="compiler/./syntax-analyser/image-20231128103218847.png" alt="image-20231128103218847" /></p>
<p>以语法树作为基础，根据语言的语义，检查每个语法程序在语义上是否满足上下文对于它的要求。</p>
<p>同时，语义分析的结果也有利于生成正确的目标代码，例如在存在<strong>重载运算符</strong>和<strong>类型强制转换</strong>的场景中。</p>
<h3 id="错误处理-1"><a class="header" href="#错误处理-1">错误处理</a></h3>
<p>语义分析程序在发现错误时，需要显示出错信息，报告错误出现的位置和错误的性质。在完成报告之后还需要恢复分析器，继续对后面的结构进行检查。</p>
<h2 id="符号表"><a class="header" href="#符号表">符号表</a></h2>
<p>符号表在翻译过程中有着两方面的作用：</p>
<ul>
<li>检查语义的正确性</li>
<li>辅助正确的生成代码</li>
</ul>
<p>符号表是一张动态表，在编译期间符号表的入口会不断的增加或者删除。编译程序需要频繁和符号表进行交互，符号表的效率会直接影响到编译程序的效率。</p>
<h3 id="符号表的建立和访问时机"><a class="header" href="#符号表的建立和访问时机">符号表的建立和访问时机</a></h3>
<p>对于多遍的编译程序：</p>
<p><img src="compiler/./syntax-analyser/image-20231128105649683.png" alt="image-20231128105649683" /></p>
<p>在词法分析的阶段建立符号表，标识符在符号表中的位置作为记号的属性。<strong>适用于非块结构语言的编译</strong>。</p>
<p>对于合并遍的编译程序：</p>
<p><img src="compiler/./syntax-analyser/image-20231128105836091.png" alt="image-20231128105836091" /></p>
<h3 id="符号表的内容"><a class="header" href="#符号表的内容">符号表的内容</a></h3>
<h3 id="符号表的操作"><a class="header" href="#符号表的操作">符号表的操作</a></h3>
<h3 id="符号表组织"><a class="header" href="#符号表组织">符号表组织</a></h3>
<h4 id="非块结构语言"><a class="header" href="#非块结构语言">非块结构语言</a></h4>
<h4 id="块结构语言"><a class="header" href="#块结构语言">块结构语言</a></h4>
<p>对于夸结构语言来说，模块中可嵌套字块，每个块中均可以定义局部变量。每个程序块中有一个字表，保存该块中声明的变量和属性。</p>
<p>符号表使用栈式符号表或者栈式哈希符号表组织。</p>
<p>例如，对于如下的<code>PASCAL</code>程序：</p>
<p><img src="compiler/./syntax-analyser/image-20231128110125604.png" alt="image-20231128110125604" /></p>
<p>根据上述程序可以</p>
<p><img src="compiler/./syntax-analyser/image-20231128110556373.png" alt="image-20231128110556373" /></p>
<blockquote>
<p>栈式符号表简介：</p>
<p>当遇到变量声明时，将包含变量属性的记录入栈；当到达块结尾时，将该块中声明的所有变量的记录出栈。在块索引表中记录每个块开始的栈位置。</p>
<p><img src="compiler/./syntax-analyser/image-20231128111227682.png" alt="image-20231128111227682" /></p>
<p>在栈式符号表中的各种操作：</p>
<ol>
<li>插入：需要检查字表中是否有重名的变量，如果没有就正常入栈，反之报告错误</li>
<li>检索：从栈顶到栈底线性检索。如果在当前字表中找到就是局部变量，在其他字表中找到就是非局部变量。通过遍历顺序实现了最近嵌套作用域的原则。</li>
<li>定位：将栈顶战阵的位置压入块索引表，块索引表中的元素就指向相应块的字表中第一个记录在栈中的位置。</li>
<li>重定位：用块索引表中顶端元素的值恢复栈顶指针，直接清除了刚刚编译完的块在栈中的记录。</li>
</ol>
</blockquote>
<blockquote>
<p>栈式哈希表符号表的简介：</p>
<p>使用哈希函数将符号名字映射到符号表中的地址。</p>
</blockquote>
<h2 id="类型检查"><a class="header" href="#类型检查">类型检查</a></h2>
<p>对于类型检查，不同的语言有着不同的观点。</p>
<ul>
<li>强调最大程序的限制，执行严格的类型检查。</li>
<li>强调数据类型应用的灵活性，建议采用隐式类型，在编译时不进行类型检查，在程序运行期间对类型进行扩展检查。</li>
</ul>
<h2 id="一个简单的类型检查程序"><a class="header" href="#一个简单的类型检查程序">一个简单的类型检查程序</a></h2>
<p>假设现在存在一个简单语言的文法如下：</p>
<p><img src="compiler/./syntax-analyser/image-20231205100305672.png" alt="image-20231205100305672" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="运行环境"><a class="header" href="#运行环境">运行环境</a></h1>
<h2 id="程序运行时的存储组织"><a class="header" href="#程序运行时的存储组织">程序运行时的存储组织</a></h2>
<h2 id="存储分配策略"><a class="header" href="#存储分配策略">存储分配策略</a></h2>
<p>在运行时存储代码的划分一般为：</p>
<p><img src="compiler//home/ricardo/.config/Typora/typora-user-images/image-20231212100051914.png" alt="image-20231212100051914" /></p>
<p>其中除了目标代码之后，其余三种数据空间采用的存储分配策略是不同的：</p>
<ul>
<li>静态存储分配</li>
<li>栈式存储分配</li>
<li>堆式存储分配</li>
</ul>
<h3 id="静态存储分配"><a class="header" href="#静态存储分配">静态存储分配</a></h3>
<p>使用静态存储分配的条件式在<strong>编译时</strong>源程序中声明的各种数据对象所需的存储空间的大小可以确定。</p>
<p>因此在编译时，为静态存储分配的变量分配<strong>固定</strong>的存储空间：</p>
<ul>
<li>每个过程的活动记录的大小及位置</li>
<li>活动记录中每一个名字所占用存储空间的大小及位置</li>
<li>数据对象的地址可以生成在目标代码中</li>
</ul>
<p>使用静态存储分配时，名字的左值在运行期间时保存不变的。</p>
<p>使用静态存储分配对于源程序有一定的限制：</p>
<ul>
<li>数据对象的大小和位置必须在编译时可以确定</li>
<li>不允许出现过程递归调用</li>
<li>不能建立动态的数据结构</li>
</ul>
<h3 id="栈式存储分配"><a class="header" href="#栈式存储分配">栈式存储分配</a></h3>
<p>存储空间按照栈的方式组织：</p>
<ul>
<li>活动开始的时候，活动相对应的活动记录入栈。局部变量的存储空间分配在活动记录中，同一过程中声明的名字在不同的活动中绑定到不同的存储空间中。</li>
<li>活动结束时，活动记录出栈，分配给局部名字的存储空间被释放，名字的值丢失不再可用。</li>
</ul>
<p>在栈式存储分配中存在调用序列和返回序列：</p>
<ul>
<li>
<p>调用序列：目标程序中实现控制从调用程序进入被调用程序的一段代码。</p>
<p>用于实现活动记录的入栈和控制的转移。</p>
</li>
<li>
<p>返回序列：目标程序中实现控制从被调用过程返回到调用过程的一段代码。</p>
<p>用于实现活动记录的出栈和控制的转移。</p>
</li>
</ul>
<h2 id="非局部名字的访问"><a class="header" href="#非局部名字的访问">非局部名字的访问</a></h2>
<p>如何处理非局部名字的应用取决于作用域规则：</p>
<ul>
<li>静态作用域规则：词法作用域规则、最近嵌套规则：由程序中名字的声明的位置决定</li>
<li>动态作用域规则：由运行时最近的活动决定应用到一个名字上的声明</li>
</ul>
<p>对于非局部名字的访问通过访问链来实现，因此关键是如何创建、使用、维护访问链。</p>
<h3 id="程序块"><a class="header" href="#程序块">程序块</a></h3>
<p>程序块时符合语句的基本结构：</p>
<pre><code>begin
	声明语句
	语句序列
end
</code></pre>
<p>块之间的关系可以使并列和嵌套。</p>
<p><img src="compiler//home/ricardo/.config/Typora/typora-user-images/image-20231212105356131.png" alt="image-20231212105356131" /></p>
<h2 id="参数传递机制"><a class="header" href="#参数传递机制">参数传递机制</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="中间代码生成-1"><a class="header" href="#中间代码生成-1">中间代码生成</a></h1>
<p>中间代码生成的任务是将分析之后得到的源程序的中间表示形式翻译成中间代码表示。</p>
<p><img src="compiler/./intermediate-code/image-20231219095859932.png" alt="image-20231219095859932" /></p>
<p>使用中间代码的缺点：</p>
<ul>
<li>便于编译程序的建立和移植，可以将编译程序分离为前端和后端两个部分，针对不同的语言可以复用针对同一个机器的后端，针对不同的机器可以复用针对同一个语言的前端。</li>
<li>便于记性于机器无关的代码优化工作。</li>
</ul>
<p>但是使用中间代码的表示增加了IO操作的数量，编译程序的效率有所降低。</p>
<h2 id="中间代码形式"><a class="header" href="#中间代码形式">中间代码形式</a></h2>
<h3 id="图形表示形式"><a class="header" href="#图形表示形式">图形表示形式</a></h3>
<p>分成两种形式：</p>
<ul>
<li>语法树：描绘了源程序的自然层次结构</li>
<li>DAG图：以更紧凑的形式给出了和语法树相同的信息，<em>公共子表达式</em>也被标示出来</li>
</ul>
<h3 id="三地址代码"><a class="header" href="#三地址代码">三地址代码</a></h3>
<p>使用<strong>三地址语句</strong>组成的代码描述中间代码。</p>
<p>三地址语句是一种类似于汇编语句的代码，有赋值语句和空间语句，语句可以有标号。三地址语句的一般形式为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace"> </span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span>
其中<code>x</code>可以是临时变量或者是名字，<code>y</code>和<code>z</code>可以是名字、常数或者是临时变量。<code>op</code>是运算符号，如算数运算符或者是逻辑运算符。语句中最多有三个地址。</p>
<p>三地址语句的种类和形式如下所示：</p>
<ol>
<li>
<p>简单赋值语句：</p>
<p><code>x := y op z</code></p>
<p><code>x := op y</code></p>
<p><code>x := y</code></p>
</li>
<li>
<p>含有变址的赋值语句：</p>
<p><code>x := y[i]</code></p>
</li>
<li>
<p>含有地址和指针的赋值语句：</p>
<p><code>x := &amp;y</code></p>
<p><code>x := *y</code></p>
</li>
<li>
<p>转移语句：</p>
<p><code>goto L</code></p>
<p><code>if x relop y goto L</code></p>
</li>
<li>
<p>过程调用语句：</p>
<p><code>param x</code></p>
<p><code>call p, n</code></p>
</li>
<li>
<p>返回语句：</p>
<p><code>return y</code></p>
</li>
</ol>
<p>例如，对于赋值语句<code>x := (-y) * z + (-y) * z</code>：</p>
<ol>
<li>
<p>对应语法树的三地址代码为：</p>
<p><img src="compiler/./intermediate-code/image-20231219101157463.png" alt="image-20231219101157463" /></p>
</li>
<li>
<p>对于DAG图的三地址代码为：</p>
<p><img src="compiler/./intermediate-code/image-20231219101215573.png" alt="image-20231219101215573" /></p>
</li>
</ol>
<h4 id="三地址语句的实现"><a class="header" href="#三地址语句的实现">三地址语句的实现</a></h4>
<ol>
<li>
<p>四元式</p>
<p>使用四元组<code>(op, arg1, arg2, result)</code> 表示。</p>
<p>例如对于三地址语句<code>x := y + z</code>，其的四元式表示为：</p>
<pre><code>('+', y, z, x)
</code></pre>
</li>
<li>
<p>三元式</p>
<p>使用三元组<code>(op, arg1, arg2)</code>表示，相对于四元式省略了返回值的临时变量，减少了符号表的空间，用语句的指针代替存放中间结果的临时变量。</p>
<p>例如，对于赋值语句<code>x := (-y) * z + (-y) * z</code>:</p>
<p><img src="compiler/./intermediate-code/image-20231219101937767.png" alt="image-20231219101937767" /></p>
</li>
<li>
<p>间接三元式</p>
<p>为三元式的序列增加了一个间接码表，其每个元素依次指向三元式序列中的一个元素。</p>
<p>对于赋值语句<code>x := (-y) * z + (-y) * z</code>:</p>
<p><img src="compiler/./intermediate-code/image-20231219102157167.png" alt="image-20231219102157167" /></p>
</li>
</ol>
<h2 id="赋值语句的翻译"><a class="header" href="#赋值语句的翻译">赋值语句的翻译</a></h2>
<h2 id="布尔表达式的翻译"><a class="header" href="#布尔表达式的翻译">布尔表达式的翻译</a></h2>
<h2 id="控制语句的翻译"><a class="header" href="#控制语句的翻译">控制语句的翻译</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机组成原理课程笔记"><a class="header" href="#计算机组成原理课程笔记">计算机组成原理课程笔记</a></h1>
<p>大二下学期专业课《计算机组成原理》课程笔记。</p>
<p>授课教师：王玉龙</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机系统概论"><a class="header" href="#计算机系统概论">计算机系统概论</a></h1>
<h2 id="预备知识"><a class="header" href="#预备知识">预备知识</a></h2>
<h3 id="组成计算机的硬件设备"><a class="header" href="#组成计算机的硬件设备">组成计算机的硬件设备</a></h3>
<ul>
<li>输入输出设备</li>
<li>中央处理设备</li>
<li>接口转换卡</li>
<li>存储设备</li>
<li>部件连接线</li>
</ul>
<p>一个完整的计算机系统应该包括硬件系统和软件系统两个部分。</p>
<h2 id="计算机的分类"><a class="header" href="#计算机的分类">计算机的分类</a></h2>
<ul>
<li>
<p>数字计算机：处理数字量的信息，按位进行计算</p>
<ul>
<li>
<p>专用计算机：针对某一任务设计的最有效、最经济和最快速的计算机，但是适应性比较差。</p>
</li>
<li>
<p>通用计算机：适应性很大，但是牺牲了效率、速度和经济性。</p>
<ul>
<li>单片机</li>
<li>微型机</li>
<li>服务器</li>
<li>大型机</li>
<li>超级计算机</li>
</ul>
<p>从上到小：更加复杂、性能更加强大</p>
</li>
</ul>
</li>
<li>
<p>模拟计算机：处理模拟量系统，数值连续</p>
</li>
</ul>
<p>‍</p>
<h2 id="计算机的发展历史"><a class="header" href="#计算机的发展历史">计算机的发展历史</a></h2>
<ul>
<li>第一代计算机：1946~1957年，电子管计算机</li>
<li>第二代计算机：1958~1964年，晶体管计算机</li>
<li>第三代计算机：1965~1971年：中小规模集成电路</li>
<li>第四代计算机：1972~1990年：超大规模集成电路</li>
<li>第五代计算：1991年~，巨大规模集成电路</li>
</ul>
<h3 id="第一代计算机"><a class="header" href="#第一代计算机">第一代计算机</a></h3>
<p>采用电子管制造。代表机型：<code>ENIAC</code>​，1946年诞生在宾夕法尼亚大学。</p>
<h3 id="第二代计算机"><a class="header" href="#第二代计算机">第二代计算机</a></h3>
<p>采用晶体管制造。</p>
<blockquote>
<p>摩尔定律：每18个月，集成电路的性能就会提高一倍，价格将下降一半。</p>
</blockquote>
<h2 id="半导体存储器的发展"><a class="header" href="#半导体存储器的发展">半导体存储器的发展</a></h2>
<ul>
<li>磁芯存储器：20世纪50~60年代</li>
<li>半导体存储器：1970年出现。</li>
</ul>
<h2 id="微处理器的历史发展"><a class="header" href="#微处理器的历史发展">微处理器的历史发展</a></h2>
<p>4004-8008-8080-8086-8088</p>
<p>80286-386TM DX-386TM SX-486TM DX</p>
<p>Pentium- Pentium Pro - Pentium 2 - Pentium 3 - Pentium 4</p>
<h2 id="计算机的性能指标"><a class="header" href="#计算机的性能指标">计算机的性能指标</a></h2>
<ul>
<li>
<p>吞吐量：表征一台计算机在某一时间内能狗狗处理得的信息量</p>
</li>
<li>
<p>响应时间：从输入有效到系统产生响应之间的时间度量，用时间单位表示</p>
</li>
<li>
<p>利用率：在指定的时间间隔内，系统被完全利用的时间所占的比率，用百分比表示</p>
</li>
<li>
<p>处理器字长（机器字长）：处理器运算器中一次能够完成二进制运算的位数，比如32位，64位</p>
</li>
<li>
<p>总线宽度：运算器与存储器之间的数据总线宽度</p>
</li>
<li>
<p>主存储器容量：主存储器能存储的二进制数据的位数</p>
</li>
<li>
<p>主存储器带宽：单位时间从主存储器读出的二进制信息量，一般用<code>bit/s</code>​来表示</p>
</li>
<li>
<p>主频/时钟周期：CPU主时钟的频率，其倒数为CPU的时钟周期</p>
</li>
<li>
<p>CPU的运算速度：</p>
<ul>
<li>
<p>CPU执行时间：CPU执行一般程序所占用的CPU时间</p>
</li>
<li>
<p>CPI：执行一条指令所需要的平均时钟周期数</p>
</li>
<li>
<p>MIPS：每秒百万指令数，也就是单位时间内执行的指令数</p>
<p>对于标量机，一次运算只能得到一个结构</p>
</li>
<li>
<p>MFLOPS：每秒百万次浮点操作数</p>
<p>对于向量机：一次运算往往可以得到多个结果</p>
</li>
</ul>
</li>
</ul>
<p>CPU的运算速度可以用以下两种方式来计算：</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">CP</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord cjk_fallback">时间</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">时钟频率</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">一个程序的</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">CP</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord cjk_fallback mtight">时钟周期数</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">CP</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord cjk_fallback">时间</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">CP</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">时钟周期</span></span></span></span></p>
<p>因此CPU时间主要和三个参数有关系：</p>
<ul>
<li>时钟周期的长度是由硬件技术和计算机组成决定的</li>
<li>CPI是由计算机组成和指令集的系统结构决定</li>
<li>指令数是由指令集的系统结构和编译器决定</li>
</ul>
<h2 id="计算机的硬件"><a class="header" href="#计算机的硬件">计算机的硬件</a></h2>
<h3 id="硬件的组成要素"><a class="header" href="#硬件的组成要素">硬件的组成要素</a></h3>
<p>冯诺以曼计算机特点：</p>
<ul>
<li>
<p>由运算器、存储器、控制器、输入设备和输出设备五个部分组成</p>
</li>
<li>
<p>存储器以二进制形式存储的指令和数据</p>
</li>
<li>
<p>指令由操作码和地址码组成</p>
</li>
<li>
<p>存储程序并按地址顺序执行</p>
<p>冯诺以曼计算机的核心设计思想，让计算机自动工作的基础</p>
</li>
<li>
<p>以运算器为核心</p>
</li>
</ul>
<p>而现代计算机和冯诺以曼计算机的主要区别就是现代计算机以存储器位核心。</p>
<p>现代计算机的特点：</p>
<ul>
<li>
<p>将运算器、控制器和片内的高速缓存统称为CPU，将CPU，主存储器、输入/输出接口和系统总线统称为主机，其余的设备均为外设</p>
<p>主机内仅包含主存储器，辅助存储器属于辅助IO</p>
</li>
</ul>
<h3 id="运算器"><a class="header" href="#运算器">运算器</a></h3>
<p>处理所有的算数及逻辑运算。通常称作<code>ALU</code>​，算数逻辑单元。</p>
<ul>
<li>采用二进制数据进行运算</li>
<li>运算器一次可以处理的数据位数成为机器字长</li>
<li>机器字长一般为8，16，32，64位，机器字长直接决定运算的精度和能力</li>
<li>运算器主要有<code>ALU</code>​和各类通用寄存器构成</li>
</ul>
<h3 id="存储器"><a class="header" href="#存储器">存储器</a></h3>
<p>保存所有的程序和数据。</p>
<ul>
<li>二进制形式保存程序和数据</li>
<li>存储器是按照存储单元组织的，读写存储单元必须给出单元地址</li>
</ul>
<p>相关的概念：</p>
<ul>
<li>存储元：用于保存一位二进制数据的物理器件</li>
<li>存储单元：能够保存一个字数据的器件，由若干个存储元构成</li>
<li>单元地址：能区分每一个存储单元的编号，一般从0开始</li>
<li>存储容量：一个存储器能保存的二进制数据量</li>
</ul>
<p>存储器一般分成几类：</p>
<ul>
<li>外存，又称作辅助存储器，例如磁盘存储器，光盘存储器。但是<code>CPU</code>​不能直接访问外存.</li>
<li>内存：也就是主存储器，是半导体，<code>CPU</code>​可以直接访问</li>
</ul>
<p>还有两个和内存相关的寄存器：</p>
<ul>
<li>​<code>MAR</code>​，存储器地址七寸其，接受由CPU送来的地址信息</li>
<li>​<code>MDR</code>​，存储器数据寄存器，作为外界与存储器之间的数据通路</li>
</ul>
<h3 id="控制器"><a class="header" href="#控制器">控制器</a></h3>
<p>根据所要执行指令的功能，按顺序发出各种控制指令，协调各个部件的工作。</p>
<p>主要的任务是：</p>
<ul>
<li>解释并执行指令</li>
<li>控制指令的执行顺序</li>
<li>负责指令执行过程中，操作数的寻址</li>
<li>根据指令的执行，协调相关部件的工作</li>
</ul>
<p>其中指令一般的形式为：</p>
<p>操作码+地址码</p>
<ul>
<li>
<p>操作码：指出指令锁进行的操作，如加减，数据传送</p>
</li>
<li>
<p>地址码：指出进行以上操作的数据存放位置</p>
</li>
</ul>
<p>存储器的工作周期：</p>
<ul>
<li>取值周期：取指定的一段时间</li>
<li>执行周期：执行指令的一段时间</li>
</ul>
<p>使指令按照顺序指定的控制部件：指令计数器。每取出一条指令，指令计数器就加一步（一条指令的字节数）。如果遇到转移类的指令，控制器根据所执行的指令设置指令计数器的值。</p>
<p>其中相关的概念有：</p>
<ul>
<li>数据字：该字代表要处理的数据</li>
<li>指令字：该字为一条指令</li>
<li>指令流：取值周期中，从内存中读出的信息流</li>
<li>数据流，执行周期中，从内存中读出的数据流</li>
</ul>
<h3 id="适配器和输入输出设备"><a class="header" href="#适配器和输入输出设备">适配器和输入输出设备</a></h3>
<p>输入设备：将么某种信息形式转换为机器能够识别的二进制信息的设备。</p>
<p>输出设备：将计算机处理的结果变成人或者其他机器设备所能够接受和识别的信息形式的设备。</p>
<p>适配器：保证外围设别用计算机系统特性要求的形式发送或者接受信息。</p>
<p>系统总线：将计算机各个部分连接在一起，并且提供数据传送的功能。</p>
<h2 id="计算机中的软件"><a class="header" href="#计算机中的软件">计算机中的软件</a></h2>
<h3 id="系统程序"><a class="header" href="#系统程序">系统程序</a></h3>
<p>用来简化程序设计，简化使用方法，提高计算机的使用效率，发挥和扩大计算机的功能及用途。</p>
<p>比如操作系统。</p>
<h3 id="应用程序"><a class="header" href="#应用程序">应用程序</a></h3>
<p>用户为了解决实际问题而编写的软件。</p>
<h2 id="计算机系统的层次结构"><a class="header" href="#计算机系统的层次结构">计算机系统的层次结构</a></h2>
<h3 id="从不同角度看到的计算机的构成"><a class="header" href="#从不同角度看到的计算机的构成">从不同角度看到的计算机的构成</a></h3>
<ul>
<li>微程序设计级</li>
<li>一般机器级</li>
<li>操作系统级</li>
<li>汇编语言级</li>
<li>高级语言级</li>
</ul>
<h3 id="软件与硬件的逻辑等价性"><a class="header" href="#软件与硬件的逻辑等价性">软件与硬件的逻辑等价性</a></h3>
<p>硬件：计算机系统的电子电路</p>
<p>软件：编写的程序</p>
<p>固件：通常存储在<code>ROM</code>​中的软件，可以当作硬件来使用</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="运算方法和运算器"><a class="header" href="#运算方法和运算器">运算方法和运算器</a></h1>
<h2 id="数据的类型"><a class="header" href="#数据的类型">数据的类型</a></h2>
<p>在日常生活中通常使用十进制，但是十进制在计算机中实现非常的困难。</p>
<p>二进制在计算机系统中占用的存储空间小，在硬件上易于实现，易于计算。</p>
<p>十六进制便于用来表示二进制数，因为一位十六进制数恰好就是4位二进制数。</p>
<p>定点数：小数点位置固定的数，数据表示的范围比较小。</p>
<p>浮点数：小数点位置不固定，数据表示的范围很大。</p>
<p>无符号数：所有位均表示数值，直接用二进制数表示。</p>
<p>有符号数：有正负之分，一般最高位表示符号位，剩下的位数是符号位。</p>
<h3 id="定点数"><a class="header" href="#定点数">定点数</a></h3>
<p>小数点固定在某一位置的数据。</p>
<p>通过约定小数点在某一个固定的位置，小数点之前为2的正次幂，小数点之后为2的负次幂。</p>
<blockquote>
<p>小数点的位置是事先约定的，实际上不用保存小数点的信息。</p>
</blockquote>
<h3 id="数的机器码表示"><a class="header" href="#数的机器码表示">数的机器码表示</a></h3>
<ol>
<li>
<p>原码表示法</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>第一位是符号位，余下的位数才表示数值。</p>
<p>在这种表示法中，0存在着两种表示方法，<code>+0</code>​和<code>-0</code>​。</p>
<p>这种表示方法非常的简单，但是才参与运算非常的复杂。</p>
</li>
<li>
<p>补码表示法</p>
<p>在计算机中的运算都有最大的范围，从数学上来说就是含有模运算。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">补</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>从二进制的角度上来说，补码一般就是数值部分的反码加1。</p>
<p>补码不影响加减运算，也就是补码的加减等于加减的补码。</p>
<p>0具有唯一的表示。</p>
<p>最小值的补码和原值一样，补码的补码是原码。</p>
<p>求相反数的补码：对原数的补码每位求反再加1，注意这里需要对符号位也取反。</p>
</li>
<li>
<p>移码表示法</p>
<p>通常用在表示浮点数的阶码，用定点整数形式的移码，把真值平移<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>个单位。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">移</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span></p>
<p>同补码直接只有符号位取反的区别。</p>
</li>
</ol>
<h3 id="浮点数"><a class="header" href="#浮点数">浮点数</a></h3>
<p>小数点的位置可以变化，如同科学计数法中的数据表示。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></p>
<ul>
<li><code>M</code>​​称做尾数，为一个纯小数，表示数据的全部有效数位，决定着数值的精度</li>
<li><code>R</code>​​称做基数，可以取2，4，8，16，表示当前的数制。在计算机中一般默认取2</li>
<li><code>e</code>​​称做阶码，为一个整数，表示小数点在数中的位置，决定着数据的大小</li>
</ul>
<h4 id="浮点数的规格化"><a class="header" href="#浮点数的规格化">浮点数的规格化</a></h4>
<p>当尾数使用原码表示的时候：</p>
<ul>
<li>尾数数值最高位一定是1</li>
<li>尾数形如0xxxxx(正)或者1xxxxxxx(负)</li>
<li>这样做能让表达的精度更高</li>
</ul>
<p>当尾数使用补码表示的时候：</p>
<ul>
<li>尾数的最高数值位和尾数符号位符号相反</li>
<li>尾数就会形如01xxxxxx（正）或者10xxxxxx（负）</li>
</ul>
<h4 id="浮点数的表示范围"><a class="header" href="#浮点数的表示范围">浮点数的表示范围</a></h4>
<p><img src="computer-architecture/./assets/image-20230309155458-ds1pb7z.png" alt="image" />​</p>
<p>‍</p>
<p>浮点数存在上溢出和下溢出两种情况。</p>
<p>上溢出：阶码大于所能表示的最大值，表示无穷</p>
<p>下溢出：阶码小于所能表示的最小值，表示0</p>
<blockquote>
<p>当尾数为0或者阶码小于所能表示的最小值时均表示0</p>
</blockquote>
<h4 id="浮点数的最值"><a class="header" href="#浮点数的最值">浮点数的最值</a></h4>
<p>阶码采用移码，表示范围是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">+</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)]</span></span></span></span></span></p>
<p>尾数采用补码，表示范围是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<blockquote>
<p>在实际做题中，不同的题目不同字段的含义可能不同。</p>
</blockquote>
<h3 id="ieee754-浮点数"><a class="header" href="#ieee754-浮点数">IEEE754 浮点数</a></h3>
<p>该标准规定了32位浮点数和64位浮点数。</p>
<h4 id="32位浮点数"><a class="header" href="#32位浮点数">32位浮点数</a></h4>
<p><img src="computer-architecture/./assets/image-20230309164343-3kjarqr.png" alt="image" />​</p>
<ul>
<li>符号位表示浮点数的符号。0表示正数，1表示负数</li>
<li>尾数：23位。原码纯小数表示，小数点在尾数的最前面。由于规格化的要求，最高位应该始终为1，因此标准中隐藏了这个值，实际值应为<code>1.M</code>​</li>
<li>阶码：8位，采用有偏移值和移码表示，移动的位数是127。</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1.</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span><span class="mbin mtight">−</span><span class="mord mtight">127</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="64位浮点数"><a class="header" href="#64位浮点数">64位浮点数</a></h4>
<ul>
<li>符号位的规定和32位时的情况是一致的。</li>
<li>尾数：52位。</li>
<li>阶码：11位，移动的位数为1023。</li>
</ul>
<h4 id="特殊数据的表示"><a class="header" href="#特殊数据的表示">特殊数据的表示</a></h4>
<p><img src="computer-architecture/./assets/image-20230309165859-cgkto37.png" alt="image" /></p>
<p>‍</p>
<h3 id="十进制数串的表示方法"><a class="header" href="#十进制数串的表示方法">十进制数串的表示方法</a></h3>
<p>采用字符串的形式来表示：</p>
<ul>
<li>每个十进制数位使用一个字节来表示</li>
<li>需要注明串的起止位置和长度</li>
</ul>
<p>采用<code>8421BCD</code>​码表示。</p>
<h3 id="字符和字符串的表示方法"><a class="header" href="#字符和字符串的表示方法">字符和字符串的表示方法</a></h3>
<p>字符一般采用<code>ASCII</code>​码的方式表示。</p>
<p>字符串就是一串连续的字符，每个字节存储一个字符。</p>
<h2 id="数据传输中的校验"><a class="header" href="#数据传输中的校验">数据传输中的校验</a></h2>
<p>为了避免在删除传输的过程中发生错误，在数据的编码上添加检错和纠正的能力。</p>
<p>数据校验的基本原理是扩大码距。</p>
<h3 id="奇偶校验码"><a class="header" href="#奇偶校验码">奇偶校验码</a></h3>
<p>在数据中增加一位冗余位，将码距从1增加到2。</p>
<p>如果编码中发生了奇数个错误，就可以被发现。</p>
<p>奇偶校验有着两种类型：</p>
<ul>
<li>奇校验：每个字中包含1的数目是奇数</li>
<li>偶校验：每个字中包含1的个数是偶数</li>
</ul>
<p>在发送方发送数据之前，按照提前约定的校验类型在数据后添加校验位。接收方接受数据之后按照于约定的校验方式进行校验。</p>
<h2 id="定点加法减法运算"><a class="header" href="#定点加法减法运算">定点加法减法运算</a></h2>
<h3 id="补码加法"><a class="header" href="#补码加法">补码加法</a></h3>
<p>加法的补码就是补码的加法。</p>
<h3 id="补码的减法"><a class="header" href="#补码的减法">补码的减法</a></h3>
<p>相反数的补码就是补码的相反数。</p>
<h2 id="定点数的乘除法"><a class="header" href="#定点数的乘除法">定点数的乘除法</a></h2>
<h3 id="串行乘法"><a class="header" href="#串行乘法">串行乘法</a></h3>
<img src="computer-architecture/assets/image-20230618213216235.png" alt="image-20230618213216235" style="zoom:67%;" />
<img src="computer-architecture/assets/image-20230618213319614.png" alt="image-20230618213319614" style="zoom:67%;" />
<p>如图，乘数是0.1011，那么总共四轮，<strong>从低位往高位</strong>看。初始我们取部分积为0</p>
<p>乘数最低位是1，所以第一轮，部分积=<strong>0+A</strong>。然后将部分积<strong>右移一位</strong></p>
<p>第二轮，同上</p>
<p>第三轮，乘数的对应位是0，所以部分积不变，只有右移一位的操作。第四轮同第一轮，结束</p>
<h3 id="并行乘法"><a class="header" href="#并行乘法">并行乘法</a></h3>
<img src="computer-architecture/assets/image-20230618213807448.png" alt="image-20230618213807448" style="zoom:67%;" />
<img src="computer-architecture/assets/image-20230618213820590.png" alt="image-20230618213820590" style="zoom:67%;" />
<p>逃课：不去管上面两个图讲的原理是怎么用电路实现的。反正我们考试写过程应该就可以写最后一图，也就是我们<strong>普通的计算多位数乘法</strong>时的方式。<strong>速通.jpg</strong></p>
<img src="computer-architecture/assets/image-20230618222341020.png" alt="image-20230618222341020" style="zoom:80%;" />
<p>若为带求补器的（即可以乘负数的），那么算前取绝对值，然后上述乘。符号位单独运算，算后再根据符号来变成补码</p>
<h3 id="并行除法"><a class="header" href="#并行除法">并行除法</a></h3>
<p>加减交替法</p>
<p>应该不考.jpg</p>
<h2 id="浮点数的运算"><a class="header" href="#浮点数的运算">浮点数的运算</a></h2>
<h3 id="加法"><a class="header" href="#加法">加法</a></h3>
<h4 id="1检查0操作数"><a class="header" href="#1检查0操作数">1.检查0操作数</a></h4>
<p>如有，那不用算了。</p>
<h4 id="2-对阶"><a class="header" href="#2-对阶">2. 对阶</a></h4>
<p>将<strong>阶码较小的操作数的阶码放大</strong>，同时它的尾数<strong>右移</strong>对应的位数</p>
<h4 id="3尾数相加"><a class="header" href="#3尾数相加">3.尾数相加</a></h4>
<p>如题，用双符号位的尾数加起来即可</p>
<h4 id="4-尾数的规格化"><a class="header" href="#4-尾数的规格化">4. 尾数的规格化</a></h4>
<ul>
<li>首先，如果双符号位出现了10或01这种非法值，那么右规直到合法，同时阶码增加对应的值</li>
<li>然后，检查是否符合规格化小数的要求，比如00.001001，小数点两边相同，那么就左规直到不同（即00.100100），阶码对应。（就是正数的前缀0和负数的前缀1其实在浮点数里都没有表示实际的意义，可以直接移位消掉）</li>
</ul>
<h4 id="5-尾数的舍入"><a class="header" href="#5-尾数的舍入">5. 尾数的舍入</a></h4>
<ul>
<li>尾数最后一位恒置为1</li>
<li>或者看一下前面操作过程中（可能的）右移出去的内容，0舍1入——此时可能再次导致尾数溢出从而右规，比如00.1111，舍入+1</li>
</ul>
<h4 id="6-阶码的溢出检查"><a class="header" href="#6-阶码的溢出检查">6. 阶码的溢出检查</a></h4>
<p>若阶码下溢，置0返回</p>
<p>若阶码上溢，报告异常</p>
<p>结束</p>
<img src="computer-architecture/assets/image-20230618215033078.png" alt="image-20230618215033078" style="zoom:80%;" />
<h3 id="减法"><a class="header" href="#减法">减法</a></h3>
<p>即加上减数的补码，略</p>
<h3 id="乘法"><a class="header" href="#乘法">乘法</a></h3>
<p>阶码相加，尾数用定点数的相乘</p>
<h3 id="除法"><a class="header" href="#除法">除法</a></h3>
<p>阶码相减，尾数用定点数的相除</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="指令系统"><a class="header" href="#指令系统">指令系统</a></h1>
<h2 id="指令系统的发展与性能要求"><a class="header" href="#指令系统的发展与性能要求">指令系统的发展与性能要求</a></h2>
<h3 id="指令系统的发展"><a class="header" href="#指令系统的发展">指令系统的发展</a></h3>
<p>程序：用于解决实际问题的一系列的指令。</p>
<p>指令：使计算机执行某种操作的命令。</p>
<p>从组成的层次结构来说，计算机中的指令可以分为以下几类：</p>
<ul>
<li>
<p>微指令：微程序级的命令，属于硬件层级</p>
</li>
<li>
<p>机器指令：简称指令。可完成一个独立的算术或者逻辑指令</p>
</li>
<li>
<p>宏指令：由若干条机器指令组成的软件指令，属于软件</p>
</li>
</ul>
<p>指令系统：一台计算机中所有机器指令的集合。直接影响机器的硬件结构、软件结构以及机器的使用范围。</p>
<h4 id="计算机指令系统的发展过程"><a class="header" href="#计算机指令系统的发展过程">计算机指令系统的发展过程</a></h4>
<ul>
<li>
<p>50年代：</p>
<p>只有定点加减、逻辑运算、数据传送、转移等几十条指令</p>
</li>
<li>
<p>60年代后期：</p>
<p>增加了乘除指令，浮点运算、十进制运算，字符串处理等指令，指令数量大大增加，寻址方式也趋向于多样化。</p>
<p>出现了系列计算机。</p>
<blockquote>
<p>系列计算机简介：</p>
<p>基本指令系统、基本系统结构相同的一系列计算机，但是具体的器件、结构和性能不会完全相同。一般来说，新的机种在各种方面优于原来的机种</p>
<p>一个系统往往有多种型号，但是都是向后兼容的。</p>
</blockquote>
</li>
<li>
<p>70年代中期：</p>
<p>复杂指令系统计算机<code>CISC</code></p>
<blockquote>
<p>采用复杂的指令系统，来达到增强计算机的功能，提高机器速度的目的。</p>
</blockquote>
<p>精简指令系统计算机<code>RISC</code></p>
<blockquote>
<p>从简化指令系统和优化硬件设计的角度来提高系统的性能与速度。</p>
</blockquote>
</li>
</ul>
<h3 id="指令系统性能的要求"><a class="header" href="#指令系统性能的要求">指令系统性能的要求</a></h3>
<p>指令系统的性能决定了计算机的基本功能，关系到计算机的硬件结构和用户的需求。</p>
<p>完善的指令系统应该满足以下的要求：</p>
<ul>
<li>
<p>完备性：常用指令齐全，编程方便</p>
</li>
<li>
<p>有效性：程序占用内存少，运行速度快</p>
</li>
<li>
<p>规整性：指令和数据的使用规则统一，易学易记</p>
<p>规整性包括对称性，匀齐性，指令格式和数据格式的一致性。</p>
<ul>
<li>
<p>对称性：所有指令都可以使用各种寻址方式</p>
</li>
<li>
<p>匀齐性：一种操作性质的指令可以支持各种数据类型</p>
</li>
<li>
<p>指令格式和数据格式的一致性：指令长度和数据长度有一定的关系</p>
</li>
</ul>
</li>
<li>
<p>兼容性：同一系列的计算机均可以运行编写的程序</p>
</li>
</ul>
<h3 id="低级语言与硬件结构的关系"><a class="header" href="#低级语言与硬件结构的关系">低级语言与硬件结构的关系</a></h3>
<p>低级语言：面向机器的语言，和具体机器的指令系统密切相关。</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>比较内容</th><th>高级语言</th><th>低级语言</th></tr></thead><tbody>
<tr><td>1</td><td>通用算法</td><td>有</td><td>有</td></tr>
<tr><td>2</td><td>语言规则</td><td>较少</td><td>较多</td></tr>
<tr><td>3</td><td>硬件知识</td><td>不要</td><td>要</td></tr>
<tr><td>4</td><td>对机器独立的程度</td><td>独立</td><td>不独立</td></tr>
<tr><td>5</td><td>编制程序的难易程度</td><td>易</td><td>难</td></tr>
<tr><td>6</td><td>编制程序所需的时间</td><td>短</td><td>较长</td></tr>
<tr><td>7</td><td>程序执行时间</td><td>较长</td><td>短</td></tr>
<tr><td>8</td><td>编译过程中对计算机资源的要求</td><td>多</td><td>少</td></tr>
</tbody></table>
</div>
<h2 id="指令格式"><a class="header" href="#指令格式">指令格式</a></h2>
<h3 id="指令的一般格式"><a class="header" href="#指令的一般格式">指令的一般格式</a></h3>
<p>指令字：表示一条指令的机器字</p>
<p>指令格式：用二进制代码表示的指令字结构形式，由操作码字段和地址码字段组成。</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-21-33-image.png" alt="" /></p>
<p>操作码：表征指令的操作特性与功能</p>
<p>地址码字段：通常指令参与操作的操作数的地址</p>
<h3 id="操作码"><a class="header" href="#操作码">操作码</a></h3>
<p>操作码字段的位数取决与指令系统的规模。</p>
<p>操作码可以分成两种类型：</p>
<ul>
<li>
<p>固定长度的操作码：</p>
<p>所有指令的长度均相同。</p>
<p>控制简单，速度快，适用于指令条数不多的场合。</p>
</li>
<li>
<p>可变长度的操作码：</p>
<p>频繁使用的指令用位数较少的操作码。</p>
<p>不常使用的指令可利用<strong>操作码扩展技术</strong>进行扩展。</p>
<p>充分利用软硬件资源，适用于大规模的指令系统。</p>
</li>
</ul>
<h3 id="地址码"><a class="header" href="#地址码">地址码</a></h3>
<p>一条指令格式中有几个地址码字段，就称为是几地址指令。</p>
<ul>
<li>
<p>零地址指令</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-41-21-image.png" alt="" /></p>
<p>没有任何操作数运算，比如<code>NOP</code>。</p>
<p>单操作数运算，隐含了一个操作数，比如<code>CBW</code>。</p>
</li>
<li>
<p>一地址指令</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-41-51-image.png" alt="" /></p>
<p>单操作数运算: <code>OP(A1)-&gt; A1</code></p>
<p>双操作数运算，但是隐含了一个操作数</p>
</li>
<li>
<p>两地址指令</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-43-40-image.png" alt="" /></p>
<p><code>(A1) OP (A2)-&gt;A1</code></p>
</li>
<li>
<p>三地址指令</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-44-17-image.png" alt="" /></p>
<p><code>(A1)OP(A2)-&gt;A3</code></p>
</li>
<li>
<p>多地址指令</p>
<p>这类指令功能比较强，一般用于中大型机，用于实现批数据处理，字符串处理或者向量和矩阵运算。</p>
</li>
</ul>
<h4 id="两地址指令的分类"><a class="header" href="#两地址指令的分类">两地址指令的分类</a></h4>
<p>一般根据操作数的物理位置分。</p>
<ul>
<li>
<p>存储器——存储器</p>
</li>
<li>
<p>寄存器——寄存器</p>
</li>
<li>
<p>寄存器——存储器</p>
</li>
</ul>
<h4 id="指令的操作码扩展技术"><a class="header" href="#指令的操作码扩展技术">指令的操作码扩展技术</a></h4>
<p>在指令系统中，如果操作码的长度固定但是指令格式不同，那么对于地址码较少的指令就存在编码浪费。</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-49-20-image.png" alt="" /></p>
<p>因此就诞生了操作码扩展技术：</p>
<ul>
<li>对于不需要某个地址码的指令，将它们的操作码扩充到地址字段</li>
</ul>
<p>操作码扩展技术即充分利用指令字的各字段，又在不增加指令长度的情况下扩展操作码的长度。</p>
<p><img src="computer-architecture/./instruction/2023-03-30-16-55-35-image.png" alt="" /></p>
<h3 id="指令字长度"><a class="header" href="#指令字长度">指令字长度</a></h3>
<p>机器字长：运算器一次能处理的二进制数的位数。</p>
<p>机器指令的长度直接决定着CPU运算的精度和直接寻址的能力。</p>
<p>指令字长：一个指令字中包含二进制代码的位数。指令字长由操作码长度、操作数个数和个数共同决定。</p>
<p>指令含有半字长、单字长、双字长、多字长等不同的长度类型。</p>
<p>指令系统可以分为等长指令字结构、变长指令字结构。</p>
<h3 id="指令助记符"><a class="header" href="#指令助记符">指令助记符</a></h3>
<p>使用3~4个英文缩写字母来表示的指令操作码。</p>
<p>在不同的计算机中指令助记符的规定是不一样的。</p>
<h2 id="操作数类型"><a class="header" href="#操作数类型">操作数类型</a></h2>
<p>机器指令对数据进行操作，数据通常分为以下四类：</p>
<ul>
<li>
<p>地址数据：无符号整数，通过某种运算确定操作数在主存中的有效地址</p>
</li>
<li>
<p>数值数据：定点整数，小数，浮点数</p>
</li>
<li>
<p>字符数据：文本数据或者字符串</p>
</li>
<li>
<p>逻辑数据：由若干二进制位组成</p>
</li>
</ul>
<h2 id="指令和数据的寻址方式"><a class="header" href="#指令和数据的寻址方式">指令和数据的寻址方式</a></h2>
<h3 id="指令的寻址方式"><a class="header" href="#指令的寻址方式">指令的寻址方式</a></h3>
<ol>
<li>
<p>顺寻寻址方式</p>
<p>当程序按顺序执行时的指令寻址方式。</p>
<p>需要用<strong>程序计数器</strong><code>PC</code>记录所要执行指令的存放单元地址。</p>
<ul>
<li>
<p>一般做顺序加1的操作，这里的“加1”表示加上指令的长度。</p>
</li>
<li>
<p>程序计数器又称做<strong>指令指针寄存器</strong>。</p>
</li>
</ul>
</li>
<li>
<p>跳跃寻址方式</p>
<p>当程序转移控制执行时的指令寻址方式。</p>
<p>程序计数器的内容由本条指令提供，而不是顺序改变。</p>
</li>
</ol>
<h3 id="操作数的寻址方式"><a class="header" href="#操作数的寻址方式">操作数的寻址方式</a></h3>
<p>一种单地址码指令的结构如图所示：</p>
<p><img src="computer-architecture/./instruction/2023-03-30-17-12-12-image.png" alt="" /></p>
<p>将指令中的形式地址变换为操作数有效地址的过程就是<strong>寻址过程</strong>。</p>
<h4 id="隐含寻址"><a class="header" href="#隐含寻址">隐含寻址</a></h4>
<p>操作数地址隐含在操作码中。在指令字中减少了一个地址字段，可以缩短指令字长。</p>
<h4 id="立即寻址"><a class="header" href="#立即寻址">立即寻址</a></h4>
<p>形式地址就是操作数。</p>
<p>指令执行阶段不需要访存，速度快，但是形式地址字段的位数限制了立即数的范围。</p>
<h4 id="直接寻址"><a class="header" href="#直接寻址">直接寻址</a></h4>
<p>有效地址由形式地址字段直接给出。</p>
<p>在执行结构需要访问一次存储器，形式地址的位数决定了指令操作数的寻址范围，而且操作数的地址不易修改。</p>
<h4 id="间接寻址"><a class="header" href="#间接寻址">间接寻址</a></h4>
<p>有效地址由形式地址字段简介提供。</p>
<p>可以扩大寻址的范围。寻址时，可以根据需要进行多次间接寻址，存在一个<strong>寻址特制字段</strong>区分直接寻址和间接寻址。</p>
<h4 id="寄存器寻址"><a class="header" href="#寄存器寻址">寄存器寻址</a></h4>
<p>形式地址字段为寄存器的编号。</p>
<p>在执行阶段不需要访存，只访问寄存器，执行速度较快。寄存器的个数有限，可以缩短指令的字长。</p>
<h4 id="寄存器间接寻址"><a class="header" href="#寄存器间接寻址">寄存器间接寻址</a></h4>
<p>形式地址字段用于指出存放有效地址的寄存器编号。</p>
<p>在执行阶段需要访问内存，便于编写循环的程序。</p>
<h4 id="偏移寻址"><a class="header" href="#偏移寻址">偏移寻址</a></h4>
<p>常用的偏移寻址：</p>
<ul>
<li>
<p>相对寻址：指令转移发生的时候常用。</p>
<p><code>Address=A+(PC)</code></p>
</li>
<li>
<p>基址寻址：</p>
<p><code>Address=(R)+A</code>，其中A每次加1</p>
</li>
<li>
<p>变址寻址：</p>
<p><code>Address=A+(R)</code>，其中R每次加1</p>
</li>
</ul>
<h2 id="典型指令"><a class="header" href="#典型指令">典型指令</a></h2>
<blockquote>
<p>老师说讲题更重要，所以没讲。</p>
</blockquote>
<h2 id="本章练习题"><a class="header" href="#本章练习题">本章练习题</a></h2>
<h3 id="设计指令系统"><a class="header" href="#设计指令系统">设计指令系统</a></h3>
<p><img src="computer-architecture/./instruction/2023-03-30-17-53-08-image.png" alt="" /></p>
<p>按照操作码的长度分别设计。</p>
<p><img src="computer-architecture/./instruction/2023-03-30-17-53-48-image.png" alt="" /></p>
<p><img src="computer-architecture/./instruction/2023-03-30-17-54-03-image.png" alt="" /></p>
<h3 id="计算程序计数器的值"><a class="header" href="#计算程序计数器的值">计算程序计数器的值</a></h3>
<p>计算本身简单，但是需要考虑指令的长度。</p>
<p><img src="computer-architecture/./instruction/2023-03-30-17-55-00-image.png" alt="" /></p>
<h3 id="计算不同操作数指令的最大数量"><a class="header" href="#计算不同操作数指令的最大数量">计算不同操作数指令的最大数量</a></h3>
<p><img src="computer-architecture/./instruction/2023-03-30-17-56-21-image.png" alt="" /></p>
<h3 id="不同寻址方式设计指令格式"><a class="header" href="#不同寻址方式设计指令格式">不同寻址方式设计指令格式</a></h3>
<p><img src="computer-architecture/./instruction/2023-03-30-17-56-53-image.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="中央处理器"><a class="header" href="#中央处理器">中央处理器</a></h1>
<h2 id="中央处理器的组成和功能"><a class="header" href="#中央处理器的组成和功能">中央处理器的组成和功能</a></h2>
<h3 id="cpu的功能"><a class="header" href="#cpu的功能">CPU的功能</a></h3>
<p>中央处理器：控制程序按设定方式执行。</p>
<p>CPU的主要功能：</p>
<ul>
<li>
<p>指令控制：顺序寻址和跳跃寻址</p>
<p>控制程序的执行顺序</p>
</li>
<li>
<p>操作控制：对指令操作码译码之后产生控制信号。</p>
<p>产生和发送各操作信号</p>
</li>
<li>
<p>时间控制：维持各类操作的时序关系</p>
<p>控制指令或操作的实施时间</p>
</li>
<li>
<p>数据加工：ALU完成具体的运算</p>
<p>对数据进行算术和逻辑运算</p>
</li>
</ul>
<h3 id="cpu的基本组成"><a class="header" href="#cpu的基本组成">CPU的基本组成</a></h3>
<p>现代CPU的组成：运算器、控制器、片内cache</p>
<p>控制器的主要功能：</p>
<ul>
<li>
<p>从内存中取出一条指令，并指出下条指令的存放位置</p>
<p><code>PC</code>， <code>IR</code>寄存器</p>
</li>
<li>
<p>对指令进行译码，产生相应的控制信号</p>
</li>
<li>
<p>控制CPU、内存和输入输出设备之间的数据流动</p>
</li>
</ul>
<p>运算器的主要功能（ALU、DR、寄存器组）：</p>
<ul>
<li>
<p>执行所有的算术运算</p>
</li>
<li>
<p>执行所有的逻辑运算并进行逻辑测试</p>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-16-02-15-image.png" alt="" /></p>
<h3 id="cpu中的主要寄存器"><a class="header" href="#cpu中的主要寄存器">CPU中的主要寄存器</a></h3>
<ol>
<li>
<p>数据缓冲寄存器<strong>DR</strong></p>
<p><strong>运算器使用。ALU的缓存，一切待运算数据先存放到DR，然后送入寄存器组，然后送给ALU</strong></p>
<p>暂时存放ALU的运算结果或者CPU与外界传输的数据</p>
<ul>
<li>
<p>作为ALU运算结果同通用寄存器之间的信息传送中时间上的缓冲</p>
</li>
<li>
<p>补偿CPU和内存、外围设备之间在操作速度上的差别</p>
</li>
</ul>
</li>
<li>
<p>通用寄存器</p>
<p>如x86的%rsp、%rdi、%rax等</p>
<p>暂时存放ALU的运算结果或者运算数据</p>
</li>
<li>
<p>状态条件寄存器<code>PSW</code></p>
<p>保存各种状态和条件控制信号，例如进位标志<code>C</code>，溢出标志<code>V</code></p>
<p>每个信号由一个触发器保存，从而拼成一个寄存器</p>
</li>
<li>
<p>地址寄存器<strong>AR</strong></p>
<p><strong>存放待访存的地址。如（R1）则先将R1寄存器的值移到AR，然后根据此地址去内存（实为cache，但是可以当成内存）中读数，然后送DBUS、DR、PC等</strong></p>
<p>保存当前CPU所访问数据的内存单元地址。</p>
<p>主要用于解决主存/外设同CPU之间的速度差异，使地址信息能够保持到主存/外设的读写操作完成</p>
</li>
<li>
<p>程序计数器<strong>PC</strong></p>
<p>始终存放下一条指令的地址，对于指令Cache的访问</p>
<p>内容变化有着两种情况：</p>
<ul>
<li>
<p>顺序执行：PC+1-&gt;PC</p>
</li>
<li>
<p>转移执行：指令-&gt;PC</p>
</li>
</ul>
</li>
<li>
<p>指令寄存器<strong>IR</strong></p>
<p><strong>控制器使用。存放待执行指令，OP部分送去译码，然后给出控制信号，地址码部分送到DBUS</strong></p>
<p>保存当前正在执行的指令</p>
<p>指令寄存器中操作码字段的输出就是指令译码器的输入</p>
</li>
</ol>
<h3 id="操作控制器与时序产生器"><a class="header" href="#操作控制器与时序产生器">操作控制器与时序产生器</a></h3>
<p>数据通路：寄存器之间传送信息的通路</p>
<p>操作控制器：根据指令操作码和时序信号，产生各种操作控制信号。建立正确的数据通路，从而完成指令的执行。</p>
<ul>
<li>
<p>硬布线控制器：利用时序逻辑实现</p>
</li>
<li>
<p>微程序控制器：采用存储逻辑实现</p>
</li>
<li>
<p>前两种方式的结合</p>
</li>
</ul>
<p>时序控制器：对各种操作实施时间的限制。</p>
<h2 id="指令周期"><a class="header" href="#指令周期">指令周期</a></h2>
<h3 id="指令周期的基本概念"><a class="header" href="#指令周期的基本概念">指令周期的基本概念</a></h3>
<p>CPU执行程序是一个”取指令-执行指令“的循环过程。</p>
<p>指令周期：CPU从内存中取出一条指令并执行的时间总和。</p>
<blockquote>
<p>CPU周期：机器周期，一般为从内存中读取一条指令字的最短时间。一个CPU周期可以完成CPU的一个基本操作。</p>
<p>时钟周期：也叫节拍脉冲或者T周期，是计算机处理操作的基本时间单位。</p>
</blockquote>
<p>一个完成的指令周期由若干机器周期构成：</p>
<p>取值周期-&gt;间值周期-&gt;执行周期-&gt;中断周期</p>
<blockquote>
<p>本教材上间址周期和执行周期统称为执行周期。</p>
</blockquote>
<h3 id="mov-r0-r1指令的指令周期"><a class="header" href="#mov-r0-r1指令的指令周期"><code>MOV R0, R1</code>指令的指令周期</a></h3>
<p><code>mov</code>是一条RR型指令，它需要两个CPU周期。</p>
<ul>
<li>
<p>取值周期：从储存器中取出指令，程序计数器加1，译码或者测试指令操作码，输出控制信号。</p>
<ol>
<li>
<p>PC-&gt;指令Cache, 译码并启动</p>
</li>
<li>
<p>指令Cache-&gt;ABUS-&gt;IR</p>
</li>
<li>
<p>PC-&gt;PC+1, 为取下一条指令做好准备</p>
</li>
<li>
<p>IR中的操作码被译码或者测试，识别出是指令<code>mov</code></p>
</li>
</ol>
</li>
<li>
<p>执行周期：在控制信号的作用下，将R1中的数据通过ALU送入R0</p>
<ol>
<li>
<p>R1-&gt;ALU, 数据是通过ALU传送的</p>
</li>
<li>
<p>ALU-&gt;DBUS-&gt;DR-&gt;R0</p>
</li>
</ol>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-16-50-04-image.png" alt="" /></p>
<h3 id="lad-r1-6指令的周期"><a class="header" href="#lad-r1-6指令的周期"><code>LAD R1, 6</code>指令的周期</a></h3>
<p><code>LAD</code>指令是RS型指令，需要方寸获取操作数，共包含三个CPU周期。</p>
<ul>
<li>
<p>取值周期</p>
</li>
<li>
<p>间址周期：从IR的地址码字段获得操作数的地址</p>
<ol>
<li>
<p>IR-&gt;DBUS-&gt;AR 该过程为寻址周期</p>
</li>
<li>
<p>AR-&gt;ABUS-&gt;数据cache 译码并启动</p>
</li>
<li>
<p>数据cache-&gt;DBUS-&gt;DR-&gt;R1</p>
</li>
</ol>
</li>
<li>
<p>执行周期：访存获取操作数送入通用寄存器</p>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-17-19-37-image.png" alt="" /></p>
<h3 id="add-r1-r2指令的指令周期"><a class="header" href="#add-r1-r2指令的指令周期"><code>ADD R1, R2</code>指令的指令周期</a></h3>
<p><code>ADD</code>指令的指令周期由两个CPU周期组成。</p>
<ul>
<li>
<p>取值周期</p>
</li>
<li>
<p>执行周期</p>
<ol>
<li>
<p>R1, R2 -&gt; ALU</p>
</li>
<li>
<p>ALU 进行加运算，将两数相加</p>
</li>
<li>
<p>ALU-&gt;DBUS-&gt;DR-&gt;R2，保存结果</p>
</li>
</ol>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-17-28-10-image.png" alt="" /></p>
<h3 id="sto-r2-r3指令的指令周期"><a class="header" href="#sto-r2-r3指令的指令周期"><code>STO R2, (R3)</code>指令的指令周期</a></h3>
<p><code>STO</code>指令是RS型指令，需要3个CPU周期。</p>
<ul>
<li>
<p>取值周期</p>
</li>
<li>
<p>间址周期：根据R3中的地址寻址所要访问的存储单元</p>
<ol>
<li>
<p>R3-&gt;DBUS-&gt;AR, 发送地址启动数据Cache</p>
</li>
<li>
<p>R2-&gt;DBUS-&gt;数据Cache</p>
</li>
</ol>
</li>
<li>
<p>执行周期：将寄存器R2中的数据送入指定的存储单元</p>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-17-31-07-image.png" alt="" /></p>
<h3 id="jmp-101指令的指令周期"><a class="header" href="#jmp-101指令的指令周期"><code>JMP 101</code>指令的指令周期</a></h3>
<p><code>JMP</code>指令是一条无条件转移指令，用来改变程序的执行顺序</p>
<ul>
<li>
<p>取值周期</p>
</li>
<li>
<p>执行周期：使用<code>JMP</code>指令中的直接地址为PC赋值</p>
<p>IR-&gt;DBUS-&gt;PC</p>
</li>
</ul>
<p><img src="computer-architecture/./cpu/2023-04-06-17-33-12-image.png" alt="" /></p>
<h3 id="用方框图语言表示指令周期"><a class="header" href="#用方框图语言表示指令周期">用方框图语言表示指令周期</a></h3>
<p>方框：代表一个CPU周期，内容表示数据通路的操作或者某种控制操作</p>
<p>菱形：通常表示某种判别或者测试，时间上依附于之前一个方框的CPU周期，而不单独占用一个CPU周期</p>
<p>公操作符号<code>~</code>：表示一条指令已经执行完毕，转入公操作</p>
<blockquote>
<p>所谓公操作就是对一条指令执行完毕之后，CPU所开始的一些操作，比如对外围设备请求的处理等</p>
</blockquote>
<h2 id="微程序控制器"><a class="header" href="#微程序控制器">微程序控制器</a></h2>
<h3 id="微程序控制原理"><a class="header" href="#微程序控制原理">微程序控制原理</a></h3>
<h4 id="微命令和微操作"><a class="header" href="#微命令和微操作">微命令和微操作</a></h4>
<p>是控制部件和执行部件之间的联系，包括发出控制信号和返回状态信息。</p>
<ul>
<li>
<p>微命令：控制部件通过控制线向执行部件发出的各种控制命令</p>
</li>
<li>
<p>微操作：执行部件接受微命令之后执行的操作</p>
</li>
<li>
<p>状态操作：执行部件通过反馈线向控制部件告知当前状态，方便决定下一步的操作</p>
</li>
</ul>
<blockquote>
<p>微命令就是控制电路中一个个不同的控制信号。</p>
</blockquote>
<p>微操作可以分为：</p>
<ul>
<li>相容性微操作：在同时/同一个CPU周期内可以并行执行的微操作</li>
<li>相斥性微操作：不能在同时或不能在同一个CPU周期内并行执行的微操作</li>
</ul>
<h4 id="微指令和微程序"><a class="header" href="#微指令和微程序">微指令和微程序</a></h4>
<p>微指令：在一个CPU周期内，实现一定操作功能的一组微命令的组合。</p>
<ul>
<li>操作控制：用于管理和指挥全机工作的控制信号</li>
<li>顺序控制：用于决定产生下一条微指令的地址</li>
</ul>
<p>微指令都在存储控制器中存储，使用地址<strong>微地址</strong>访问。</p>
<p>每段机器指令都对对应这一段微程序，而微程序就是实现一条机器指令的多条微指令序列。</p>
<h4 id="微指令的基本格式"><a class="header" href="#微指令的基本格式">微指令的基本格式</a></h4>
<p><img src="computer-architecture/./cpu/image-20230413170806246.png" alt="image-20230413170806246" /></p>
<h4 id="微程序控制器原理"><a class="header" href="#微程序控制器原理">微程序控制器原理</a></h4>
<p><img src="computer-architecture/./cpu/image-20230413171233171.png" alt="image-20230413171233171" /></p>
<ul>
<li>取指微指令是所有指令的公用微指令，通常存放在<code>0000</code>的位置，所有机器指令的最后一条微指令的直接地址都指向这个地址单元，用来取下一条微指令。</li>
<li>取得机器指令之后，经过<code>p1</code>测试——操作码测试，产生对应的微程序入口指令，并送入微地址寄存器。</li>
<li>指令执行的过程中，通过<code>p2</code>测试，修正下一条微指令的地址，逐条读取微指令执行。</li>
<li>执行完对应于一条机器指令的微程序之后，返回到取值微指令，不断重复知道程序执行完成。</li>
</ul>
<h4 id="机器指令与微指令的关系"><a class="header" href="#机器指令与微指令的关系">机器指令与微指令的关系</a></h4>
<p>一条机器指令对应一个微程序，一个微程序由若干条微指令序列组成的。</p>
<p>指令存储在内存中，而微指令存储在控制存储器中。</p>
<p>每一个CPU周期对应一条微指令。</p>
<h3 id="微程序设计技术"><a class="header" href="#微程序设计技术">微程序设计技术</a></h3>
<h4 id="微命令编码"><a class="header" href="#微命令编码">微命令编码</a></h4>
<p>微指令中操作控制字段的编码表示方法，以及如何将编码翻译到对应的微指令。</p>
<p>采用编码表示微指令的原因主要是：</p>
<ul>
<li>有效缩短微指令字长</li>
<li>缩短微程序的长度，减小所需的空存空间</li>
<li>提高微程序的执行速度</li>
</ul>
<p>一般常用的微命令编码方式有以下三种：</p>
<ol>
<li>
<p>直接表示法</p>
<p>操作控制字段中的每一位代表一个微命令。</p>
<p>简单直观，输出直接用于控制，执行速度快。但是微指令比较长，似的控制存储器的容量必须比较大。</p>
</li>
<li>
<p>编码表示法</p>
<p>将微指令操作控制字段划分为若干个子字段，将每个子字段的所有微命令统一编码，每个子字段的不同编码表示不同的微命令。</p>
<p>其中设计编码还需要满足下面这些要求：</p>
<ul>
<li>把相斥的微命令划分到同一个字段，相容的微命令划分到不同的字段。</li>
</ul>
<blockquote>
<p>感觉设计子字段的目的就是为了方便相容指令的并行</p>
</blockquote>
<ul>
<li>字段的划分应该和数据通路相吻合</li>
<li>每个子字段应该留出一个空操作状态</li>
<li>每个子字段所定义的微命令不宜太多</li>
</ul>
<p>使用这种方式可以大大缩短微指令的字长，但是在执行过程中需要对微命令进行译码，所以执行的速度会较慢。</p>
</li>
</ol>
<h4 id="微地址的形成方法"><a class="header" href="#微地址的形成方法">微地址的形成方法</a></h4>
<ul>
<li>微程序的入口地址：微程序的第一条微指令所在控存单元的地址</li>
<li>现行微指令：在执行微程序的过程中，当前正在执行的微指令，这个指令的地址就是先行微地址</li>
<li>后继微地址：现行微指令执行完之后再执行的微指令地址</li>
</ul>
<p>确定下一条微指令地址的方法：</p>
<ol>
<li>
<p>计数器方式</p>
<p>同CPU中程序计数器产生机器指令地址的方法类似。</p>
<p>这样微指令的顺序控制字段较短，微地址产生结构简单，但是多路并行转移的功能比较弱，速度慢，灵活性差。</p>
</li>
<li>
<p>根据判断测试标志和状态条件信息选定某一个候选微地址的方法。</p>
<p>这种方法能够以较短的顺序控制字段配合，实现多路并行，灵活性比价好，速度快，但是转移地址的逻辑需要比较复杂的组合逻辑实现。</p>
</li>
</ol>
<h4 id="微指令格式"><a class="header" href="#微指令格式">微指令格式</a></h4>
<p>微指令格式有以下两种：</p>
<ol>
<li>
<p>水平型微指令：</p>
<p>一次能定义并执行多个并行操作微命令的微指令。一般有操作控制字段，判断测试字段和下地址字段构成。</p>
<p>根据控制字段编码方式不同，可以分为全水平型，字段译码水平型和直接译码混合型。</p>
</li>
<li>
<p>垂直型微指令</p>
<p>类似于机器指令的结构，设置微操作码字段，采用微操作码编译法，由微操作码规定微指令的功能。</p>
</li>
</ol>
<p>水平型微指令并行操作能力比较强，执行一条指令的时间段，而垂直型微指令则较差。</p>
<p>但是由水平型微指令解释指令的微程序，微指令字比较长但是程序短，而垂直型刚好相反。</p>
<p>垂直型微指令和指令相似，利于用户掌握。</p>
<h4 id="动态微程序设计"><a class="header" href="#动态微程序设计">动态微程序设计</a></h4>
<ol>
<li>
<p>静态微程序设计：</p>
<p>对于一台计算机的机器指令只有一组微程序，而且设计好之后，无需改变也不易改变。</p>
</li>
<li>
<p>动态微程序设计：</p>
<p>通过改变微指令和微程序来改变机器的指令系统</p>
</li>
</ol>
<h2 id="硬布线控制器"><a class="header" href="#硬布线控制器">硬布线控制器</a></h2>
<p>直接用组合逻辑完成从指令到微命令的控制器。</p>
<p>同微程序控制器相比，硬布线控制器更快。</p>
<h2 id="流水线cpu"><a class="header" href="#流水线cpu">流水线CPU</a></h2>
<h3 id="并行处理技术"><a class="header" href="#并行处理技术">并行处理技术</a></h3>
<p>并行性具有两种含义：</p>
<ul>
<li>同时性：两个以上事件在同一时刻发生</li>
<li>并发性：两个以上事件在同时间间隔发生</li>
</ul>
<p>并行性具有三种形式：</p>
<ul>
<li>时间并行：使用流水处理部件，时间重叠</li>
<li>空间并行：设置重复资源，同时工作</li>
<li>时间并行和空间并行</li>
</ul>
<p>对于微指令来说：</p>
<p><img src="computer-architecture/./cpu/image-20230413180203031.png" alt="image-20230413180203031" /></p>
<h3 id="流水cpu的结构"><a class="header" href="#流水cpu的结构">流水CPU的结构</a></h3>
<h4 id="流水计算机的系统组成"><a class="header" href="#流水计算机的系统组成">流水计算机的系统组成</a></h4>
<p>指令部件：本身构成一个流水想，由取指令、指令译码、计算操作数地址、去操作数等过程段组成。</p>
<p>指令队列：指令队列是一个先进先出的寄存器队列，用于存放经过译码的指令和取来的操作数。</p>
<p>执行部件：执行部件可以具有多个算术逻辑运算部件，这些部件本身又用流水线方式构成。</p>
<p>主存采用多体交叉存储器，以提高访问速度。</p>
<blockquote>
<p>执行段的速度匹配问题：</p>
<p>将执行部件分成定点执行部件和浮点执行部件两个可并行执行部分，在浮点执行部件还可以分成浮点加法部件和浮点乘除部件，他们也可以同时执行不同的指令。</p>
<p>浮点运算部件本身也是流水线。</p>
<p>这样基本上解决了执行速度不匹配的问题。</p>
</blockquote>
<h4 id="流行cpu的时空图"><a class="header" href="#流行cpu的时空图">流行CPU的时空图</a></h4>
<p>流水线具有下面三种特点：</p>
<ul>
<li>一般流水线<code>pipeline</code>：只有一条指令流水线</li>
<li>超流水线<code>superpipeline</code>：多级流水线，每个阶段内部还可以继续划分</li>
<li>超标量流水线<code>superscale</code>：具有两条以上的指令流水线</li>
</ul>
<p><img src="computer-architecture/./cpu/image-20230413190507839.png" alt="image-20230413190507839" /></p>
<h4 id="流水线分类"><a class="header" href="#流水线分类">流水线分类</a></h4>
<p>流水线可以分成以下三类：</p>
<ol>
<li>
<p>指令流水线：指令执行的并行处理。</p>
<p>指令流水线可以划分成取值、译码、取操作数、执行和写回等等过程。</p>
</li>
<li>
<p>算术流水线：在运算步骤中的并行处理</p>
<p>为了提供速度，现代计算机多采用流水的算术运算器，而不是传统的组合逻辑。</p>
</li>
<li>
<p>处理机流水线：程序步骤的并行处理。</p>
<p>将每一阶段的处理分散在不同的计算机上。</p>
</li>
</ol>
<h3 id="流水线中的主要问题"><a class="header" href="#流水线中的主要问题">流水线中的主要问题</a></h3>
<p>在设计流水线CPU是，会遇到不少的问题，我们分成几个不同的类别来查看。</p>
<ul>
<li>
<p>资源相关的问题：</p>
<p>多条指令进入流水线后在同一机器时钟周期内争用同一个功能部件造成的冲突。</p>
<p>解决这类问题的思路：</p>
<ul>
<li>推迟指令的执行</li>
<li>设置重复的资源</li>
</ul>
</li>
<li>
<p>数据相关的问题：</p>
<p>在一个程序中，必须等待上一条指令执行完毕之后才能执行下一条指令，例如下一条指令使用了上一条指令得到的结果。</p>
<p>数据相关有着三种不同的类型：</p>
<ul>
<li>先读后写：前一条指令读取某一个数据，后一条指令写入这个数据，但是在异步执行的过程中，后一条指令写入数据可能会发生在前一条指令读取数据之后，造成程序执行错误。</li>
<li>写写：前后两条指令都会写入同一个数据单元，但是由于在异步执行的过程中后一条指令可能优于前一条指令执行，导致最后该数据单元的数据和期望的不同。</li>
<li>先读后写类似。</li>
</ul>
<p>解决这类问题的思路：</p>
<ul>
<li>推迟指令的执行</li>
<li>定向传送技术</li>
</ul>
</li>
<li>
<p>控制相关的问题：</p>
<p>在执行转移指令是，根据转移条件是否发生来控制指令的执行顺序。</p>
<p>解决这类问题的思路：</p>
<ul>
<li>延迟转移法</li>
<li>转移预测法</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="存储系统"><a class="header" href="#存储系统">存储系统</a></h1>
<h2 id="存储器概述"><a class="header" href="#存储器概述">存储器概述</a></h2>
<h3 id="存储器分类"><a class="header" href="#存储器分类">存储器分类</a></h3>
<p>按存储介质分类：</p>
<ul>
<li>半导体存储器：使用MOS管组成的存储器</li>
<li>磁表面存储器：使用磁性材料做成的存储器</li>
<li>光盘存储器：使用光介质构成的存储器</li>
</ul>
<p>按存取方式分：</p>
<ul>
<li>
<p>随机存储器：存取时间和存储单元的物理位置无关：比如半导体存储器</p>
</li>
<li>
<p>顺序存储器：存取时间和存储单元的物理位置有关：比如磁盘存储器</p>
</li>
<li>
<p>半顺序存储器：存取时间部分依赖于存储单元的位置：硬盘</p>
</li>
</ul>
<p>按照存储内容可变性分：</p>
<ul>
<li>只读存储器<code>ROM</code>​</li>
<li>随机读写存储器<code>RAM</code>​</li>
</ul>
<p>按信息易失性分：</p>
<ul>
<li>易失性存储器：断电后信息即消失的存储器</li>
<li>非易失性存储器：断电后仍能保存信息的存储器</li>
</ul>
<p>按在计算机系统中的作用：</p>
<ul>
<li>
<p>主存储器：能够被CPU直接访问，速度较快，用于保存系统在当前运行所需的所有程序和数据。一般情况下使用半导体存储器实现。</p>
</li>
<li>
<p>辅助存储器：不能被CPU直接访问，速度较慢，用于保存系统中所有的程序和数据。</p>
</li>
<li>
<p>高速缓冲存储器：能够直接被CPU访问，速度快，用于保存系统当前运行中频繁使用的程序和数据。</p>
</li>
<li>
<p>控制存储器（寄存器）：CPU内部的存储单元。</p>
</li>
</ul>
<h3 id="存储器的分级结构"><a class="header" href="#存储器的分级结构">存储器的分级结构</a></h3>
<p>计算机对存储器的要求：大容量、高速度和低成本。为了解决这个问题，提出了计算机的分级存储结构。</p>
<p>计算机中有着三级存储结构：</p>
<p>缓存——主存结构</p>
<p>主存——辅存结构</p>
<ol>
<li>加上缓存<code>cache</code>​的目的是提高速度</li>
<li>内存包括缓存和主存</li>
<li>多层次的存储结构降低了成本，提高了容量</li>
</ol>
<p>但是采用分级结构需要解决一些问题：</p>
<ul>
<li>从辅存中寻找指定的内容放入主存应该如何定位？</li>
<li>当CPU访问缓存而需要的内容并不在缓存中，应该如何处理？</li>
</ul>
<blockquote>
<p>以上的问题由操作系统解决</p>
</blockquote>
<h3 id="主存储器的技术指标存储容量"><a class="header" href="#主存储器的技术指标存储容量">主存储器的技术指标——存储容量</a></h3>
<p>存储容量：存储器中能存放的二进制代码总量</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">存储容量</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord cjk_fallback">储存单元个数</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">存储字长</span></span></span></span></span></p>
<h3 id="主存储器的技术指标存储速度"><a class="header" href="#主存储器的技术指标存储速度">主存储器的技术指标——存储速度</a></h3>
<p>存取时间：从启动一次访问操作到完成该操作为止所经历的时间。一般以<code>ns</code>​为单元，分为读出时间和写入时间。</p>
<p>存取周期：存储器连续启动两次独立的访问操作所需的最小间隔时间。以<code>ns</code>​为单元。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">存取周期</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord cjk_fallback">存取时间</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">复原时间</span></span></span></span></span></p>
<p>存储器带宽：单位时间能够读取或者写入的数据量。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">存储器带宽</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">周期时长</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">每周期的信息量</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="存储器容量的扩充"><a class="header" href="#存储器容量的扩充">存储器容量的扩充</a></h3>
<p>单个存储芯片的容量有限，实际存储器由多个芯片扩展而成。</p>
<blockquote>
<p>SRAM、DRAM、ROM均可以进行容量扩充</p>
</blockquote>
<h4 id="存储器同cpu的连接"><a class="header" href="#存储器同cpu的连接">存储器同CPU的连接</a></h4>
<p>数据、地址、控制三个总线的连接。</p>
<p>那么多个存储芯片同CPU之间的连接应该如何处理？</p>
<ul>
<li>
<p>首先不是一一对应连接</p>
</li>
<li>
<p>关注存储器和CPU的外部引脚</p>
</li>
<li>
<p>存储器的容量扩充</p>
</li>
</ul>
<h4 id="存储芯片与cpu的引脚"><a class="header" href="#存储芯片与cpu的引脚">存储芯片与CPU的引脚</a></h4>
<p>存储芯片的外部引脚：</p>
<ul>
<li>
<p>数据总线：位数和存储单元的字长相同，传输数据信息</p>
</li>
<li>
<p>地址总线，位数和存储单元的个数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>关系，用于选择存储单元</p>
</li>
<li>
<p>读写信号<code>WE</code>：决定当前对芯片的访问类型</p>
</li>
<li>
<p>片选信号<code>CS</code>：决定当前芯片是否正在被访问</p>
</li>
</ul>
<p>CPU与存储器连接的外部引脚：</p>
<ul>
<li>数据总线：位数和机器字长相同，用于传输数据信息</li>
</ul>
<blockquote>
<p>注意：机器字长和存储单元的字长不一定一致。机器字长往往是存储单元字长的整数倍</p>
</blockquote>
<ul>
<li>
<p>地址总线：位数与系统中可访问单元个数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>的关系，用于选择访问单元</p>
</li>
<li>
<p>读写信号<code>WE</code>：决定当前CPU的访问类型</p>
</li>
<li>
<p>访存允许信号<code>MREQ</code>：内存控制器决定是否允许CPU访问内存</p>
</li>
</ul>
<h4 id="存储器容量的位扩展"><a class="header" href="#存储器容量的位扩展">存储器容量的位扩展</a></h4>
<p>存储单元数量不变，每个单元的位数增加。</p>
<p>例：将1Kx4的存储器芯片扩展为1Kx8的存储器芯片：</p>
<p>将地址线增加为原来的两倍，将前四根分配给第一个存储芯片，后四根分配给第二个存储芯片。即：</p>
<ul>
<li>
<p>各芯片的地址线直接和CPU的地址线相连</p>
</li>
<li>
<p>各芯片的数据线分别和CPU数据线的不同位相连</p>
</li>
<li>
<p>片选信号和读写线直接和CPU的对应接口相连接。</p>
</li>
</ul>
<p>CPU对存储器的访问是对所有扩展芯片的同一单元的同时访问。</p>
<h4 id="存储器的字扩展"><a class="header" href="#存储器的字扩展">存储器的字扩展</a></h4>
<p>每隔单元的位数不变，但是总的单元个数增加。</p>
<p>例如，使用1Kx8的存储芯片构成2Kx8的存储器：</p>
<ul>
<li>
<p>各芯片的地址线和CPU的地位地址线相连</p>
</li>
<li>
<p>数据线和CPU的数据线直接相连</p>
</li>
<li>
<p>读写线直接和CPU的读写线</p>
</li>
<li>
<p>片选信号：片选信号由CPU地址的高位地址和访存信号产生</p>
</li>
</ul>
<p>CPU对于存储器的访问是对于某个扩展芯片的一个单元的访问。</p>
<h4 id="存储芯片的字位扩展"><a class="header" href="#存储芯片的字位扩展">存储芯片的字位扩展</a></h4>
<p>每隔存储单元位数和总的单元个数都会增加。</p>
<ul>
<li>
<p>首先进行位扩展，得到满足位要求的存储芯片组</p>
</li>
<li>
<p>再使用存储芯片组进行字扩展</p>
</li>
</ul>
<p>因此，需要计算出需要的存储芯片个数。</p>
<p>如果需要利用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>的芯片构成<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>的存储系统，需要的芯片个数为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h4 id="存储器容量扩展例题"><a class="header" href="#存储器容量扩展例题">存储器容量扩展例题</a></h4>
<p><img src="computer-architecture/./memory/2023-03-23-20-08-24-image.png" alt="" /></p>
<p><img src="computer-architecture/./memory/2023-03-23-20-08-52-image.png" alt="" /></p>
<p><img src="computer-architecture/./memory/2023-03-23-20-09-12-image.png" alt="" /></p>
<p><img src="computer-architecture/./memory/2023-03-23-20-09-29-image.png" alt="" /></p>
<h2 id="sram存储器概述"><a class="header" href="#sram存储器概述">SRAM存储器概述</a></h2>
<blockquote>
<p>SRAM: static Random Access Memory</p>
</blockquote>
<h3 id="主存储器的构成"><a class="header" href="#主存储器的构成">主存储器的构成</a></h3>
<ul>
<li>
<p>SRAM：由MOS电路构成的双稳态触发器保存的二进制信息。</p>
<p>优点：访问速度快，不掉电可以永久保存信息</p>
<p>缺点：集成度低，功耗大，价格高</p>
</li>
<li>
<p>DRAM：用MOS电路中的栅极电容保存二进制信息</p>
<p>优点：集成度高，功耗低，价格低</p>
<p>缺点：访问速度慢，电容的放电作用会使信息丢失，需要定期刷新</p>
<p>可以分为SDRAM，DDR SDRAM。</p>
</li>
</ul>
<h3 id="基本的静态存储元阵列"><a class="header" href="#基本的静态存储元阵列">基本的静态存储元阵列</a></h3>
<p>基本存储元：由6个MOS管组成，可以存储一位信号。</p>
<p>基本存储元组成存储阵列，但是不一定完全完全按照存储单元形式组织</p>
<p>在封装完成之后，阵列会引出三种控制线</p>
<ul>
<li>地址线：确定需要读写的存储单元</li>
<li>数据线：输入输出需要读取写入的数据</li>
<li>控制线：控制是读取还是写入</li>
</ul>
<p>地址线的译码方式有两种：</p>
<ul>
<li>单译码：地址由一根地址线直接指定</li>
<li>双译码：地址线由两根地址线共同制定</li>
</ul>
<p>SRAM存储器的组成结构：</p>
<ul>
<li>
<p>存储体：存储单元的集合，将各个存储元组成一个存储矩阵。大容量存储器中，通常使用双译码的方式来确定存储单元。</p>
</li>
<li>
<p>地址译码器：将CPU发出的地址信号转换为确定存储单元的信号</p>
</li>
<li>
<p>驱动器</p>
</li>
<li>
<p>片选：确定当前芯片是否被CPU选中</p>
</li>
<li>
<p>读写电路：读写选定的存储单元</p>
</li>
</ul>
<h3 id="读写周期波形图"><a class="header" href="#读写周期波形图">读写周期波形图</a></h3>
<p>存储器读写原则：</p>
<ul>
<li>读写信号要在地址信号和片选信号起作用，经过一段时间之后才有效</li>
<li>读写信号有效期间不允许地址、数据发生变化</li>
<li>地址、数据要维持整个周期内有效</li>
</ul>
<p>读周期操作过程：</p>
<ul>
<li>CPU发出有效的地址信号</li>
<li>译码电路产生有效的片选信号</li>
<li>读信号控制下，从存储单元中读出数据</li>
<li>各个控制信号撤销，数据维持一段时间</li>
</ul>
<p>读出时间：从地址有效到外部数据总线上数据信号稳定的时间</p>
<p>片选有效时间：从片选信号有效到数据信号稳定的时间</p>
<p>读出信号有效时间：从读出信号到数据信号稳定的时间</p>
<p><img src="computer-architecture/./assets/image-20230316171911-huablas.png" alt="image" />​</p>
<p>写周期操作过程：</p>
<ul>
<li>CPU发出有效的地址信号，提供需要写入的数据</li>
<li>译码电路延迟产生有效的片选信号</li>
<li>写信号控制下，数据写入存储单元中</li>
<li>控制信号撤销，数据维持一段时间</li>
</ul>
<p><img src="computer-architecture/./assets/image-20230316172002-9js80cw.png" alt="image" />​</p>
<h2 id="dram存储器"><a class="header" href="#dram存储器">DRAM存储器</a></h2>
<p>DRAM存储器必须定时刷新，维持其中的信息不变。</p>
<p>DRAM的存储元是MOS管和电容组成的记忆电路，利用电容中的电量来表示存储的信息。</p>
<h3 id="dram存储元的记忆原理"><a class="header" href="#dram存储元的记忆原理">DRAM存储元的记忆原理</a></h3>
<p>利用MOS管控制对于电容的充放电，利用电容中的电量来表示存储的信息。</p>
<p>行线（字线）控制MOS管的开关，位线读出电容中的数据。</p>
<h3 id="dram控制电路的组成"><a class="header" href="#dram控制电路的组成">DRAM控制电路的组成</a></h3>
<ul>
<li>地址多路开关：刷新时需要提供刷新地址，非刷新时提供读写地址</li>
<li>刷新定时器：定时进行刷新操作</li>
<li>刷新地址计数器：刷新按行进行，对所要刷新的行进行计数</li>
<li>仲裁电路：对CPU访问存储器的请求和刷新存储器的请求优先级进行仲裁</li>
</ul>
<h3 id="dram的读写周期"><a class="header" href="#dram的读写周期">DRAM的读写周期</a></h3>
<p>读时序为：</p>
<ul>
<li>行地址信号有效</li>
<li>列地址有效</li>
<li>读写信号置为读信号</li>
<li>输出信号有效</li>
</ul>
<p><img src="computer-architecture/./assets/image-20230316174156-jvy5ldk.png" alt="image" />​</p>
<p>写时序：</p>
<ul>
<li>行地址信号有效</li>
<li>列地址有效</li>
<li>读写信号置为写信号</li>
<li>输入信号有效</li>
</ul>
<p><img src="computer-architecture/./assets/image-20230316174214-epebob4.png" alt="image" />​</p>
<h3 id="dram的刷新周期"><a class="header" href="#dram的刷新周期">DRAM的刷新周期</a></h3>
<p>在固定的时间内对所有的存储单元，通过读取——写入的方式恢复信息的操作过程，刷新过程中不可进行读写操作。</p>
<p>DRAM的刷新有着以下几种方式：</p>
<ul>
<li>集中式刷新：在一个刷新周期内，利用一段固定时间对存储矩阵中的所有行逐一刷新，在此期间停止所有的读写操作</li>
<li>分散式刷新：将系统工作周期分成两部分，前半部分用户读写操作，后半部分用于存储器的刷新</li>
<li>异步式刷新：计算需要刷新的频率，在需要刷新的时候再进行刷新操作</li>
</ul>
<h3 id="rom存储器"><a class="header" href="#rom存储器">ROM存储器</a></h3>
<p>掩模式ROM：数据在芯片制造的过程中写入，不能更改</p>
<ul>
<li>
<p>优点：可靠，集成度高，价格比较低</p>
</li>
<li>
<p>缺点：通用性差，不能改写</p>
</li>
</ul>
<p>一次编程ROM<code>PROM</code>:用户第一次使用时写入确定内容</p>
<ul>
<li>
<p>优点：用户可根据需要对ROM进行编程</p>
</li>
<li>
<p>缺点：只能编程一次</p>
</li>
</ul>
<p>多次编程ROM：可用紫外光照射<code>EROM</code>或者电擦除<code>EEPROM</code>，多次改写其中的内容</p>
<ul>
<li>优点：通用性好，可反复使用</li>
</ul>
<p>闪存存储器<code>Flash</code>：一种高密度，非易失性的读写半导体存储器，即常用的U盘</p>
<h2 id="高速存储器"><a class="header" href="#高速存储器">高速存储器</a></h2>
<h3 id="双端口存储器"><a class="header" href="#双端口存储器">双端口存储器</a></h3>
<p>双端口存储器采用空间并行技术，同一个存储体使用两组相互独立的读写控制线路，可并行操作。</p>
<p>读写特点：</p>
<ul>
<li>无冲突读写：访问不同的存储单元，可以并行读写存储体</li>
<li>有冲突读写：访问同一存储单元，通过特定的信号控制读写的先后顺序</li>
</ul>
<h3 id="多模块交叉存储器"><a class="header" href="#多模块交叉存储器">多模块交叉存储器</a></h3>
<p>多模块交叉存储器采用时间并行技术。</p>
<p>存储器的有两种模块化的组织方式：</p>
<ul>
<li>
<p>顺序方式</p>
<p>每个模块中的单元地址是连续的。某个模块在进行存取的时候，其他模块不工作，某一模块出现故障，其他模块可以照常工作。</p>
<p>存储单元的地址就可以分成两部分：高位是模块号，低位是模块内的字号。</p>
<p><img src="computer-architecture/./memory/image-20230525155208073.png" alt="image-20230525155208073" /></p>
</li>
<li>
<p>交叉方式</p>
<p>每个模块的单元地址是不连续的，连续地址分布在相邻的不同模块内。对于数据的成块传送，各模块可以实现多模块流水式并行存取。</p>
<p>存储单元的地址恰好和顺序方式相反：低位是模块号，高位是模块内的字号。</p>
<p><img src="computer-architecture/./memory/image-20230525155438919.png" alt="image-20230525155438919" /></p>
</li>
</ul>
<h2 id="cache存储器"><a class="header" href="#cache存储器"><code>Cache</code>存储器</a></h2>
<h3 id="cache的基本原理"><a class="header" href="#cache的基本原理"><code>Cache</code>的基本原理</a></h3>
<p>由于CPU的运算速度越来越快，主存储器的速度和CPU之间的差距越来越大。</p>
<p>基于<strong>程序访问的局部性原理</strong>，即在一段时间内，CPU所执行的程序和访问的数据大部分都在某一段地址范围内，而在该段范围之外的地址访问很少，在CPU和主存之间加一块高速的<code>SRAM</code>，称为<code>Cache</code>。将主存中将要被访问的数据提前送到缓存中，CPU在访问数据中，优先在缓存中寻找，如果没有命中再到主存甚至更低的存储层次中寻找。</p>
<p>缓存在实现过程中使用<strong>结构模块化</strong>的思想。CPU访问<code>Cache</code>或者主存时，<strong>以字为单位</strong>，当<code>Cache</code>和主存交换信息时，<strong>以块/行为单位</strong>，一次读入一块或者多块内容。此部分完全由硬件实现，对程序员透明。</p>
<p>缓存由以下的几个部分组成：</p>
<ul>
<li>存储体，基本单位为字，若干个字构成一个数据块</li>
<li>地址映射变换机构：用于将主存地址变换为缓存地址，以利用CPU发送的主存地址访问缓存</li>
<li>替换机构：更新缓存中数据时使用的机制</li>
<li>相联存储器，缓存的块表，快速指示所访问的信息是否在缓存中</li>
<li>读写控制逻辑</li>
</ul>
<p>缓存的读操作大致会经过以下几个步骤：</p>
<ol>
<li>
<p>CPU发出有效的主存地址</p>
</li>
<li>
<p>经过地址变换机构，成为可能的缓存地址</p>
</li>
<li>
<p>查找块表，判断访问的信息是否在缓存中</p>
</li>
<li>
<p>如果在，CPU直接读取缓存获得数据</p>
<p>如果不在，CPU访问主存，并判断缓存是否已满。如果缓存未满，将该数据所在块放入缓存中，如果缓存已满，使用某种替换机制，使用当前数据块替换缓存中的某些块</p>
</li>
</ol>
<p>缓存的写操作：</p>
<ol>
<li>
<p>CPU发出有效的主存地址</p>
</li>
<li>
<p>经过地址变换机构，称为可能的缓存地址</p>
</li>
<li>
<p>查找相联存储器，判断访问的信息是否在缓存中</p>
</li>
<li>
<p>如果不在，则CPU直接写入主存</p>
<p>如果不在，使用某种写策略将数据写入缓存</p>
</li>
</ol>
<p>判断缓存性能由两个指标：</p>
<ul>
<li>命中率：CPU要访问信息在缓存中的比率</li>
<li>主存系统的平均访问时间</li>
</ul>
<p>“<strong>cache-主存系统的效率</strong>”：用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">平均访问时间</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">的访问时间</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>来衡量，通常为百分比，越接近100越好</p>
<h3 id="主存到缓存中的地址映射"><a class="header" href="#主存到缓存中的地址映射">主存到缓存中的地址映射</a></h3>
<h4 id="全相联映射"><a class="header" href="#全相联映射">全相联映射</a></h4>
<p>主存中的任意字块可调进缓存中的任一行中。</p>
<p>使用这种方式的块表就是缓存行号和主存块号的对应表，因此块表的大小就是缓存中行的数量乘以主存块号的长度。</p>
<p><img src="computer-architecture/./memory/image-20230525170641486.png" alt="image-20230525170641486" /></p>
<p>这种方式的优点是灵活性号，在缓存中只要存在空行，就可以调入所需要的主存数据块。</p>
<p>缺点比较多：</p>
<ul>
<li>成本高，标记需要的位数比较多，使得缓存的标记容量变大</li>
<li>速度慢，访问缓存时需要同所有的标记进行比较，才能判断出所需要的数据是否在缓存中</li>
</ul>
<h4 id="直接映射"><a class="header" href="#直接映射">直接映射</a></h4>
<p>主存中的每一块数据只能调入缓存的特定行中。</p>
<p>有点类似于将缓存当作一个哈希表来使用：如果主存的块号为<code>i</code>，缓存的行数为<code>c</code>，那么主存当前行号对应的缓存行号为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">i</span><span class="mspace"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">c</span></span></span></span></span>
<img src="computer-architecture/./memory/image-20230525171923817.png" alt="image-20230525171923817" /></p>
<p>直接映射的优点是映射函数的实现简单，查找速度快，但是灵活性差。</p>
<h4 id="组相联映射"><a class="header" href="#组相联映射">组相联映射</a></h4>
<p>组相联映射是直接映射和全相联映射的一种折中方案。</p>
<p>将缓存中的行等分为若干组，主存中的每一块只能映射到缓存中的特定组中，但是可调入该组中的任一行中。也就是组间为直接映射，组内为全相联映射。</p>
<p>一般上缓存中的一组含有<code>r</code>行时，称为<code>r</code>路组相联映射。</p>
<p><img src="computer-architecture/./memory/image-20230525175638295.png" alt="image-20230525175638295" /></p>
<h3 id="缓存的替换策略"><a class="header" href="#缓存的替换策略">缓存的替换策略</a></h3>
<ol>
<li>
<p>最不经常使用算法<code>LFU</code></p>
<p>将一段时间内被访问次数最少的那行数据替换出去。</p>
<p>为每行设置一个计数器，每访问一次，被访问行的计数器自增，当需要替换时，将计数值最小的行换出，清空计数器。</p>
<p>缺点：这种算法将技术周期限制在对这些特定行的两次替换中，不能严格反映近期访问情况</p>
</li>
<li>
<p>近期最少使用算法<code>LRU</code></p>
<p>将近期内长久未使用的行替换出去。</p>
<p>为每行设置一个计数器，没访问一次，将被访问行的计数器清空，其他行自增。在需要替换时，将计数器最大的行替换出去。</p>
<p>这种方式保护了刚进入缓存的新数据行，效率高。</p>
</li>
<li>
<p>随机替换算法</p>
<p>随机选一行替换。</p>
<p>在硬件上容易实现，速度也快，但是命中路和工作效率低。</p>
</li>
</ol>
<h3 id="缓存的写策略"><a class="header" href="#缓存的写策略">缓存的写策略</a></h3>
<p>修改缓存中的内容之后，需要将数据写入主存中保存起来。</p>
<ol>
<li>
<p>写回式</p>
<p>只修改缓存中的内容，不立即写入内存，只有当该行被替换时才写入内存。</p>
<p>减少了访问内存的次数，但是存在缓存和主存不一致的问题。且需要设置一个标志位，标识这个行是否被修改过。</p>
</li>
<li>
<p>全写式</p>
<p>缓存和主存同时发生写修改，维护缓存和主存的一致性。</p>
<p>缓存的功效被降低，但是实现简单。</p>
</li>
<li>
<p>写一次式</p>
<p>基于写回法，但是结合了全写法的特点。</p>
<p>在第一次写命中的时候，写入主存。</p>
<p>第一次写命中时，启动一个主存的写周期，目的是其他缓存可以及时更新或者废止该块内容。</p>
</li>
</ol>
<h2 id="虚拟内存"><a class="header" href="#虚拟内存">虚拟内存</a></h2>
<p><del>别的班都讲了在复习，就我们没有讲。赌一把它不考</del></p>
<p>https://zhuanlan.zhihu.com/p/498675124</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="输入输出设备"><a class="header" href="#输入输出设备">输入输出设备</a></h1>
<h2 id="外围设备的速度分级与信息交换方式"><a class="header" href="#外围设备的速度分级与信息交换方式">外围设备的速度分级与信息交换方式</a></h2>
<h3 id="外围设备的速度分级"><a class="header" href="#外围设备的速度分级">外围设备的速度分级</a></h3>
<p>根据外设的工作射速，CPU和外设的定时方式有三种：</p>
<ul>
<li>
<p>速度极慢或者简单的外围设备，使用CPU世界接收和发送数据</p>
<p>机械开关和LDE</p>
</li>
<li>
<p>慢速或者中速的外围设备，采用异步定时方式/应答式数据交换，CPU与外设之间通过两个相互的联络信号来决定开始数据传送的时间</p>
<p>键盘，显示器</p>
</li>
<li>
<p>高速的外围设备，采用同步定时的方式，CPU以等间隔的速度执行输入/输出指令</p>
<p>主存，辅存</p>
</li>
</ul>
<h3 id="外设信息交换方式"><a class="header" href="#外设信息交换方式">外设信息交换方式</a></h3>
<ul>
<li>
<p>程序查询方式</p>
<p>早期计算机中使用，效率低。</p>
</li>
<li>
<p>程序中断方式</p>
<p>适用于随机出现的服务</p>
</li>
<li>
<p>直接内存访问<code>DMA</code>方式</p>
<p>适用于内存和高速外围设备之间大批量数据交换的场合</p>
</li>
<li>
<p>通道方式</p>
<p>增加一个具有特殊功能的处理器——通道，将CPU输入输出的权力下方</p>
</li>
</ul>
<h2 id="程序查询方式"><a class="header" href="#程序查询方式">程序查询方式</a></h2>
<p>数据的输入输出完全由程序控制。</p>
<h3 id="设备编制"><a class="header" href="#设备编制">设备编制</a></h3>
<ol>
<li>
<p>统一编址方式</p>
<p>将I/O系统与主存系统作为一个整体进行编址。</p>
<p>访问I/O端口可以使用访存指令，操作类型多样，使用灵活，且I/O端口也有较大的编址空间。</p>
<p>但是占用了主存空间，使得实际主存容量减小。I/O访问的指令字长较长，执行的速度慢。</p>
</li>
<li>
<p>独立编址方式</p>
<p>将I/O系统和主存系统分别编址。</p>
<p>I/O端口不占用主存空间，使用专用的I/O指令，执行速度快，与主存空间容易区分。</p>
</li>
</ol>
<h3 id="输入输出指令"><a class="header" href="#输入输出指令">输入输出指令</a></h3>
<p>输入指令：<code>IN AL/AX, DX/PORT</code>，从指定的端口读入一个字节/字数到累加器</p>
<p>输出指令：<code>OUT DX/PORT, AL/AX</code>，将累加器中的一个字节/字数送到指定端口输出</p>
<p>指令一般的功能有：</p>
<ul>
<li>对于接口的控制触发器置0或者1，控制其进行某些操作</li>
<li>测试设备的某些状态</li>
<li>输入或者输出数据</li>
</ul>
<h3 id="程序查询方式的接口"><a class="header" href="#程序查询方式的接口">程序查询方式的接口</a></h3>
<p><img src="computer-architecture/./io/image-20230511165257132.png" alt="image-20230511165257132" /></p>
<p>CPU通过地址信号选中某设备接口。</p>
<p>CPU通过向该接口发送命令字的方式，启动外设。</p>
<p>当外设开始工作之后，设置当前“忙”状态。</p>
<p>CPU和外设通过接口内部的数据缓冲器传送数据。</p>
<h3 id="程序查询输入输出方式"><a class="header" href="#程序查询输入输出方式">程序查询输入/输出方式</a></h3>
<ol>
<li>CPU请求数据传送</li>
<li>CPU从I/O接口读入状态字</li>
<li>检查状态字中的标志</li>
<li>为就绪，则重复2.3.步</li>
<li>CPU输入或者输出数据，同时复位接口中的状态标志。</li>
</ol>
<p>可以通过改变查寻顺序修改设备的优先权。</p>
<h2 id="程序中断方式"><a class="header" href="#程序中断方式">程序中断方式</a></h2>
<h3 id="中断的概念"><a class="header" href="#中断的概念">中断的概念</a></h3>
<p>中断是指CPU正常运行程序时，由系统内/外部非预期事件或程序中预先安排好的指令性事件引起的，CPU暂停当前程序的执行，转去为该事件服务的程序中执行，服务完毕后，再返回原程序继续执行的过程。</p>
<p>需要注意的是：</p>
<ul>
<li>中断是CPU执行程序的变化过程</li>
<li>所有能够引起中断的事件称为中断源</li>
<li>处理中断事件的中断服务程序是预先设计的</li>
<li>结束中断处理元程序之后，要以原状态附后返回暂停处继续执行</li>
</ul>
<p>中断处理过程是由硬件和软件结合来完成的。</p>
<p>使用中断的好处为：</p>
<ul>
<li>解决速度问题，使用CPU和I/O并行工作</li>
<li>对于意外的情况可以即使处理，例如磁盘损坏，运算溢出</li>
<li>在实时控制领域中，即时响应外来信号的干扰。</li>
</ul>
<p>CPU的中断处理流程：</p>
<ol>
<li>
<p>中断请求</p>
<p>CPU在结束一个指令周期后，检测中断请求信号。</p>
<blockquote>
<p>就是CPU的公操作检测保存中断请求信号的寄存器</p>
</blockquote>
</li>
<li>
<p>中断响应</p>
<p>关闭中断，保护断电现场，判断中断源，获取中断向量，根据中断向量转入中断服务程序运行。</p>
<blockquote>
<p>关闭中断的目的是为了避免再次中断影响当前中断响应，屏蔽中断源。</p>
<p>保护断电现场是为了CPU还能回到主程序</p>
</blockquote>
</li>
<li>
<p>中断服务</p>
<p>保护CPU现场，执行中断服务程序，打开中断，恢复CPU现场</p>
</li>
<li>
<p>中断返回</p>
<p>恢复断点现场，返回主程序继续执行。</p>
</li>
</ol>
<p><img src="computer-architecture/./io/image-20230511173943915.png" alt="image-20230511173943915" /></p>
<p><strong>中断向量</strong>：中断服务程序的入口地址，一共4个字节的内容，包括段地址和段内偏移地址。在CPU响应中断时，将中断源对应的中断向量送入段地址<code>CS</code>、段内偏移地址<code>IP</code>寄存器中，以跟踪中断服务程序的执行。</p>
<p>集中存放系统中所有中断向量的存储器就是<strong>中断向量表</strong>。<strong>中断类型号</strong>是中断向量在表中的编号，乘上中断向量的长度4字节，就是中断向量在表中的偏移地址。</p>
<p>硬件产生中断向量的方式有三种：</p>
<ol>
<li>
<p>向量中断</p>
<p>由硬件直接产生一个与该中断源对应的向量地址，该向量地址就是中断源对应的中断服务程序入口地址。</p>
<p>但是这种方式要求在硬件设计时考虑所有中断源的向量地址。</p>
</li>
<li>
<p>位移量中断</p>
<p>由硬件产生一个位移量，该位移量加上CPU中某寄存器的基地址就是中断处理程序的入口地址。</p>
</li>
<li>
<p>向量地址转移</p>
<p>由硬件直接产生</p>
</li>
</ol>
<h3 id="程序中断方式的基本io接口"><a class="header" href="#程序中断方式的基本io接口">程序中断方式的基本I/O接口</a></h3>
<p>接口内部有下列组成部件：</p>
<ul>
<li>数据缓冲寄存器</li>
<li>就绪触发器<code>RD</code>，忙状态触发器<code>BS</code>，允许中断触发器<code>EI</code></li>
<li>中断向量产生逻辑</li>
</ul>
<p>CPU中响应的处理部件是</p>
<ul>
<li>中断请求触发器<code>IR</code></li>
<li>中断屏蔽触发器<code>IM</code></li>
</ul>
<p><img src="computer-architecture/./io/image-20230511174519308.png" alt="image-20230511174519308" /></p>
<h3 id="单级中断"><a class="header" href="#单级中断">单级中断</a></h3>
<p>计算机系统中一般拥有多个中断。在处理时，有着如下两种处理策略：</p>
<ul>
<li>单级中断：所有的中断源属于同一个中断，不允许有中断嵌套</li>
<li>多级中断：中断源分成不同的级别，可以发生中断嵌套，高优先权的中断源请求可以打断低优先权的中断服务</li>
</ul>
<p>我们先分析单级中断：</p>
<p><img src="computer-architecture/./io/image-20230511175945021.png" alt="image-20230511175945021" /></p>
<p>在收到中断时识别中断源来源的方法是串行排队链法。</p>
<p><img src="computer-architecture/./io/image-20230511180154643.png" alt="image-20230511180154643" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="外围设备"><a class="header" href="#外围设备">外围设备</a></h1>
<h2 id="外围设备概述"><a class="header" href="#外围设备概述">外围设备概述</a></h2>
<h3 id="外围设备的一般功能"><a class="header" href="#外围设备的一般功能">外围设备的一般功能</a></h3>
<p>在计算机系统中，除CPU和主存之外的部件都可看作外设。</p>
<p>外设的功能是在计算机之间、计算机和用户之间提供联系。</p>
<h3 id="外围设备的分类"><a class="header" href="#外围设备的分类">外围设备的分类</a></h3>
<ul>
<li>输入/输出设备</li>
<li>外存设备</li>
<li>数据通信设备</li>
<li>过程控制设备</li>
</ul>
<p>外设都是通过<strong>适配器</strong>与主机连接的。外围设备在自己的设备控制器控制下进行工作，控制器通过接口与主机利恩加，并受主机控制。</p>
<h2 id="磁盘存储设备"><a class="header" href="#磁盘存储设备">磁盘存储设备</a></h2>
<h3 id="磁记录原理"><a class="header" href="#磁记录原理">磁记录原理</a></h3>
<p><strong>磁表面存储器</strong>：将磁性材料均匀的涂抹在金属铝或者塑料表示作为载磁体来存储信息。</p>
<p>磁表面存储器的优点为：</p>
<ul>
<li>存储容量大，位价格低</li>
<li>记录介质可以重复使用</li>
<li>记录信息可以重复使用</li>
<li>记录信息可以长期保存而不丢失</li>
<li>非破坏性的读出，读出时不需要再生信息</li>
</ul>
<p>同时磁表面存储器也有一些缺点：</p>
<ul>
<li>存取速度较慢，机械机构复杂</li>
<li>非接触式读写，对于工作环境要求较高</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="总线系统"><a class="header" href="#总线系统">总线系统</a></h1>
<h2 id="总线的概念和结构形态"><a class="header" href="#总线的概念和结构形态">总线的概念和结构形态</a></h2>
<h3 id="总线的基本概念"><a class="header" href="#总线的基本概念">总线的基本概念</a></h3>
<p>总线是构成计算机系统的互联机构，是系统内各功能不见之间进行信息传送的公共通路。</p>
<p>按照不同的分类依据，总线有着不同的分类结果：</p>
<p>如果按照传送信息分类：</p>
<ul>
<li>
<p>地址总线：</p>
<p>单向的三态总线，用于传送地址信息。其的位数决定可执行寻址的范围。</p>
</li>
<li>
<p>数据总线：</p>
<p>双向的三态总线，用于传送数据信息。位数有很多种。</p>
</li>
<li>
<p>控制总线：</p>
<p>传送控制和状态信息。</p>
</li>
</ul>
<p>如果按照连接部件分类的总线</p>
<ul>
<li>内部总线：CPU内部逻辑不见的连接总线</li>
<li>局部总线：CPU与其他部件的连接总线，介于CPU内部总线和系统总线之间</li>
<li>系统总线：计算机各功能不见的连接总线</li>
<li>通信总线（IO总线）：微机系统之间，微机系统和其他设备之间的连接总线</li>
</ul>
<h4 id="总线的特性"><a class="header" href="#总线的特性">总线的特性</a></h4>
<ol>
<li>
<p>物理特性：</p>
<p>总线的位数，总线插头、插座的形状，引脚的排列方式。</p>
</li>
<li>
<p>功能特性</p>
<p>确定每一根总线的名称、定义、功能与逻辑关系等。</p>
</li>
<li>
<p>电器特性</p>
<p>规定每一根总线上信号的传送方向及有效电平范围等内容。</p>
</li>
<li>
<p>时间特性</p>
<p>总线上各信号有效的时序关系。</p>
</li>
</ol>
<h4 id="总线标准"><a class="header" href="#总线标准">总线标准</a></h4>
<p>为了保证总线的性能充分发挥以及兼容问题将总线标准化，主要包括总线的各种特性：数据传输率，总线通信协议、仲裁协议等一系列规定和约定。</p>
<p>总线标准的来源可以分为权威组织正式公布的标准和实际存在的工业标准。</p>
<p>按照总线标准设计的总线结构就是<strong>通用接口</strong>。</p>
<h4 id="总线的性能指标"><a class="header" href="#总线的性能指标">总线的性能指标</a></h4>
<ol>
<li>
<p>总线宽度</p>
<p>在一次总线操作中，最多可以传送的数据位数。</p>
</li>
<li>
<p>总线周期</p>
<p>一次总线操作所需要的最小间隔时间。</p>
<blockquote>
<p>总线周期与总线的时钟频率成反比。</p>
</blockquote>
</li>
<li>
<p>总线带宽</p>
<p>单位时间内通过总线的数据位数，总线的数据传输率。</p>
</li>
</ol>
<h3 id="总线的连接方式"><a class="header" href="#总线的连接方式">总线的连接方式</a></h3>
<p>总线之间需要通过<strong>适配器</strong>连接起来。</p>
<p>适配器（接口）：实现高速CPU同低速的外设之间工作速度上的匹配和同步，并完成计算机和外设之间的所有数据传送和控制。</p>
<p>在单机结构中，总线的结构比较多样。</p>
<h4 id="单总线结构"><a class="header" href="#单总线结构">单总线结构</a></h4>
<p>系统内的所有不见均由系统总线连接。</p>
<p><img src="computer-architecture/./bus/image-20230504164241891.png" alt="image-20230504164241891" /></p>
<p>优点：各部件之间可直接进行通信，系统易于扩充。</p>
<p>缺点：总线负载重，如果系统中存在慢速设备，则会产生较大的时间延迟，降低系统的工作效率。</p>
<h4 id="双总线设备"><a class="header" href="#双总线设备">双总线设备</a></h4>
<p>系统内的所有部件均由系统总线连接，在CPU和主存之间再设置一组高速的存储总线。</p>
<p><img src="computer-architecture/./bus/image-20230504164455933.png" alt="image-20230504164455933" /></p>
<p>特点：</p>
<ul>
<li>保持了单总线的优点：简单，易于扩充。</li>
<li>减轻了系统总线的工作负担，使CPU工作效率有所提高。</li>
<li>增加了硬件成本。</li>
</ul>
<h4 id="三总线结构"><a class="header" href="#三总线结构">三总线结构</a></h4>
<p>系统总线负责连接CPU、主存、IO通道，存储总线负责连接CPU与主存，IO总线负责连接各个IO适配器。</p>
<p><img src="computer-architecture/./bus/image-20230504164830672.png" alt="image-20230504164830672" /></p>
<p>特点：</p>
<ul>
<li>设置了通道，对外设进行统一的管理，分担了CPU的负担。</li>
<li>提高了CPU的工作效率，同时也最大限度提高了外设的工作速度。</li>
<li>但是硬件的成本进一步增加。</li>
</ul>
<p>三总线结构还有下面这种形式：</p>
<p><img src="computer-architecture/./bus/image-20230504165139674.png" alt="image-20230504165139674" /></p>
<h4 id="多总线结构"><a class="header" href="#多总线结构">多总线结构</a></h4>
<p><img src="computer-architecture/./bus/image-20230504165213500.png" alt="image-20230504165213500" /></p>
<h3 id="总线的内部结构"><a class="header" href="#总线的内部结构">总线的内部结构</a></h3>
<p>早期的总线内部实际上就是CPU引脚的物理延伸。</p>
<p><img src="computer-architecture/./bus/image-20230504165316581.png" alt="image-20230504165316581" /></p>
<p>CPU是总线上唯一的控制者。这种方式让总线结构和CPU紧密相关，通用性比较差。</p>
<p>现代总线多采用标准总线。标准总线和结构、CPU、技术无关，亦被称作<strong>底板总线</strong>。</p>
<p><img src="computer-architecture/./bus/image-20230504165656450.png" alt="image-20230504165656450" /></p>
<p>现代总线可以分成四个部分：</p>
<ul>
<li>数据传送总线：地址线、数据线和控制线</li>
<li>仲裁总线：总线请求线，总线授权线</li>
<li>中断和同步总线：中断请求线，中断认可线</li>
<li>公用线：时钟信号，电源</li>
</ul>
<h3 id="总线结构实例"><a class="header" href="#总线结构实例">总线结构实例</a></h3>
<p><img src="computer-architecture/./bus/image-20230504170438566.png" alt="image-20230504170438566" /></p>
<h2 id="总线接口"><a class="header" href="#总线接口">总线接口</a></h2>
<h3 id="信息的传送方式"><a class="header" href="#信息的传送方式">信息的传送方式</a></h3>
<ol>
<li>串行传输：使用一条传输线，采用脉冲传输。成本低廉，但是信息的传送速度慢。</li>
<li>并行传输：每一个数据位使用一条传输线，一般使用电位传送。系统总线的信息传送方式。</li>
<li>分时传输：总线传输信息的分时复用，共享总线部件对总线的分时复用。</li>
</ol>
<h3 id="接口的基本概念"><a class="header" href="#接口的基本概念">接口的基本概念</a></h3>
<p>接口是IO设备的适配器，CPU和主存，外围设备之间通过总线进行连接的逻辑部件。</p>
<p><img src="computer-architecture/./bus/image-20230504172745331.png" alt="image-20230504172745331" /></p>
<p>接口一般具有下面这些功能：控制，缓冲，状态，转换，中断等。</p>
<p>一个适配器必须要有两个接口：</p>
<ul>
<li>一个同系统总线相连接，采用并行的方式</li>
<li>一个同设备相连，可能采用并行或者串行方式</li>
</ul>
<h2 id="总线的仲裁"><a class="header" href="#总线的仲裁">总线的仲裁</a></h2>
<p>连接到总线上的功能模块有<strong>主动</strong>和<strong>被动</strong>两种形态：</p>
<ul>
<li>主方可以启动一个总线周期</li>
<li>从方只能响应主方请求</li>
<li>每次总线操作，只能有一个主方，但是可能存在多个从方</li>
<li>主方持续控制总线的时间就是总线占用期</li>
</ul>
<p>多个功能部件争用总线时，需要由<strong>总线仲裁部件</strong>选择一个设备使用总线。</p>
<p>总线仲裁有以下两种方式：</p>
<ul>
<li>集中式：由中央仲裁其决定总线使用权的归属</li>
<li>分布式：多个仲裁器竞争使用总线</li>
</ul>
<h3 id="集中式仲裁"><a class="header" href="#集中式仲裁">集中式仲裁</a></h3>
<ol>
<li>
<p>链式查询方式</p>
<p>采用<strong>菊花链</strong>的方式连接所有具有总线使用能力的部件，各设备公用一根总线请求信号线<code>BR</code>，总线授权信号线<code>BG</code>，总线忙信号性<code>BS</code>和中央仲裁器连接。总线授权信号<code>BG</code>串行的从一个接口连接到下一个接口。</p>
<p><img src="computer-architecture/./bus/image-20230504173912747.png" alt="image-20230504173912747" /></p>
<p>在这种控制模式下，设备的优先权同与总线控制器的距离有关系。</p>
<p><img src="computer-architecture/./bus/image-20230504174033750.png" alt="image-20230504174033750" /></p>
<p>使用这种方式的特点是：</p>
<ul>
<li>硬件连接简单，判断优先级容易，设备的增删容易</li>
<li>对电路故障敏感，各个部件的优先级固定</li>
</ul>
</li>
<li>
<p>计数器定时查询方式</p>
<p>在链式查询方式的基础上省去了总线授权信号<code>BG</code>，增加了计数器和设备地址线，每次收到总线申请，由计数器决定响应的顺序。</p>
<p><img src="computer-architecture/./bus/image-20230504174504835.png" alt="image-20230504174504835" /></p>
<p>在有总线请求时，发出计数值，选择设备查询请求状态，依次查询每一个设备的状态。</p>
<p>在这种仲裁方式下，设备的优先级由计数值决定，计数值为0时同链式查询方式一样，</p>
<p>这种方式的特点是：</p>
<ul>
<li>优先权控制灵活，对电路故障不敏感</li>
<li>硬件成本增加，控制复杂度高</li>
</ul>
</li>
<li>
<p>独立请求方式</p>
<p>每个部件均由独立的请求和响应信号线，由中央仲裁器的部分排队逻辑决定响应顺序。</p>
<p><img src="computer-architecture/./bus/image-20230504175136601.png" alt="image-20230504175136601" /></p>
<p>设备的优先权有中央仲裁器的内部排队逻辑决定</p>
<p>使用这种仲裁方式的特点为：</p>
<ul>
<li>响应时间快，确定优先响应的设备花费的时间少，对优先次序的控制也相当的灵活</li>
<li>硬件的复杂程度高</li>
</ul>
</li>
</ol>
<h3 id="分布式仲裁"><a class="header" href="#分布式仲裁">分布式仲裁</a></h3>
<p>分布式仲裁不需要使用中央仲裁器，由分布在各部件中的多个仲裁器竞争使用总线。</p>
<p>每个潜在的主模块都有<strong>独立的仲裁器</strong>和<strong>唯一的仲裁号</strong>，通过仲裁总线上仲裁号大小的比较，决定可占用总线的部件。具体的仲裁步骤如下：</p>
<ul>
<li>某部件有总线申请，将其仲裁号发送到共享仲裁总线上</li>
<li>每个仲裁器将仲裁总线上得到的号和自己的号相比较</li>
<li>如果仲裁总线上的号大，则它的总线请求不予响应，并撤销它的仲裁号</li>
<li>最后，获胜者的仲裁号保留在仲裁总线上</li>
</ul>
<p>分布式仲裁是以<strong>优先级仲裁策略</strong>为基础的。</p>
<h2 id="总线的定时和数据传送模式"><a class="header" href="#总线的定时和数据传送模式">总线的定时和数据传送模式</a></h2>
<h3 id="总线的定时"><a class="header" href="#总线的定时">总线的定时</a></h3>
<p>总线的一次信息传送过程，大致可以分成以下五个阶段：</p>
<ul>
<li>请求总线</li>
<li>总线仲裁</li>
<li>寻址</li>
<li>信息传送</li>
<li>状态返回/错误报告</li>
</ul>
<p><strong>定时</strong>就是指事件出现在总线上的时序关系，为了同步主方、从方的操作，需要通过定时协定。在数据传送过程中，有下面几种定时协定：</p>
<ul>
<li>同步定时协定</li>
<li>异步定时协定</li>
<li>半同步定时协定</li>
<li>周期分裂式总线协定</li>
</ul>
<p>下面介绍前两种定时协定：</p>
<ol>
<li>
<p>同步定时协议：</p>
<p><img src="computer-architecture/./bus/image-20230504180422070.png" alt="image-20230504180422070" /></p>
<p>优点：简单，传输的频率高</p>
<p>缺点：只适用于总线长度短，功能模块存取时间接近的场景</p>
</li>
<li>
<p>异步定时协定</p>
<p><img src="computer-architecture/./bus/image-20230504180534999.png" alt="image-20230504180534999" /></p>
<p>优点：总线周期长度可变，允许快慢速功能模块都连接到同一总线上</p>
<p>缺点：增加了总线的复杂性和成本</p>
</li>
</ol>
<h3 id="总线数据传送模式"><a class="header" href="#总线数据传送模式">总线数据传送模式</a></h3>
<p><img src="computer-architecture/./bus/image-20230504180906059.png" alt="image-20230504180906059" /></p>
<h4 id="读写操作"><a class="header" href="#读写操作">读、写操作</a></h4>
<p>读操作是由从方到主方的数据传输，写操作是从主方到从方的大数据传送。</p>
<p>一般的，主方先以一个总线周期发送命令和从方地址，经过一定的演示再开始数据传送总线周期。</p>
<p>为了提高总线利用效率，减少延时损失，主方在完成寻址总线周期后可让出总线控制权，让其他主方完成更急迫的操作，然后再重新竞争总线控制权，完成数据传送总线周期。</p>
<h4 id="块传送操作"><a class="header" href="#块传送操作">块传送操作</a></h4>
<p>只需给定块的起始地址，然后对固定块长度的数据一个接一个的读出和写入。CPU读取存储器的块传送操作常称作猝发是传送。块的长度一般固定为数据线宽度（存储器字长）的4倍。</p>
<h4 id="写后读读修改写操作"><a class="header" href="#写后读读修改写操作">写后读、读修改写操作</a></h4>
<p>两种组合操作模式，只给出地址一次，或者进行先写后读操作，或者进行先读后写操作。先写后读操作常常用于校验目的，先读后写操作用于多程序系统中对于共享存储资源的保护。</p>
<p>块传送操作和写后读、读修改写操作都是主方控制总线直到整个操作结束。</p>
<h4 id="广播广集操作"><a class="header" href="#广播广集操作">广播、广集操作</a></h4>
<p>广播、广集操作是一个较为特殊的操作。一般来说，总线只允许一个主方和一个从方之间进行通信，但是一些总线允许一个主方对多个从方进行操作。如果是对于多个从方进行写操作，这种操作称为<strong>广播</strong>，如果是从多个从方读取，并在总线上完成<code>and</code>或者<code>or</code>操作再被读取，这种操作称为<strong>广集</strong>。广集操作在检测多个中断源时非常好用。</p>
<h2 id="pci总线和pcie总线"><a class="header" href="#pci总线和pcie总线">PCI总线和PCIe总线</a></h2>
<h3 id="多总线结构-1"><a class="header" href="#多总线结构-1">多总线结构</a></h3>
<p><img src="computer-architecture/./bus/image-20230504205644399.png" alt="image-20230504205644399" /></p>
<h4 id="host总线"><a class="header" href="#host总线">Host总线</a></h4>
<p>有CPU总线，系统总线，主存总线，前端总线等等名称。</p>
<p>连接北桥芯片和CPU之间的信息通路，是一个64位数据线和32位地址线的同步总线。</p>
<h4 id="pci总线"><a class="header" href="#pci总线">PCI总线</a></h4>
<p>连接各种高速的PCI设备，是一个与处理器无关的高速外围总线。</p>
<p>采用同步时序协议和集中式仲裁策略，并且可以自动配置。PCI设备可以是主设备，也可以是从设备，或者兼而有之。</p>
<h4 id="lagacy总线"><a class="header" href="#lagacy总线">LAGACY总线</a></h4>
<p>此处疑有讹误，应为LEGACY总线。</p>
<p>一般是<code>ISA</code>，<code>EISA</code>和<code>MCA</code>这类性能较低的传统总线，在这里的主要意义是提供向前的兼容性。</p>
<h4 id="pci总线中的桥"><a class="header" href="#pci总线中的桥">PCI总线中的桥</a></h4>
<p>桥起着将两条总线连接起来的作用。桥同时也是一个总线转换部件，将一条总线上的地址空间映射到另一条总线的地址空间中，使用两条总线上的设备可以直接通信。</p>
<h3 id="pci-总线信号"><a class="header" href="#pci-总线信号">PCI 总线信号</a></h3>
<p>PCI总线的基本传输机制是猝发式传输。</p>
<p>在进行写操作时，桥把上层总线的写周期缓存起来，以后再在下层总线上生成写周期，即<strong>写延迟</strong>。当进行读操作时，桥可以早于上层总线，直接在下层总线上<strong>预读</strong>。无论延迟写还是预读，桥的作用可使所有的存取都按照CPU的要求出现在总线上。</p>
<h3 id="pci总线仲裁"><a class="header" href="#pci总线仲裁">PCI总线仲裁</a></h3>
<p>PCI总线采用集中式仲裁方式。每个设备都有总线请求<code>nREQ</code>线和总线授权<code>nGNT</code>线和中央仲裁器连接，中央仲裁器根据算法对设备的申请做出仲裁。</p>
<h3 id="pcie总线"><a class="header" href="#pcie总线">PCIe总线</a></h3>
<p>对于PCI总线的扩展，提供了更快的传输速度，在软件和应用上兼容PCI设备。</p>
<p>PCIe总线相对于PCI总线做出了如下的改进：</p>
<ul>
<li>高速差分传输</li>
<li>串行传输</li>
<li>全双工端到端传输</li>
<li>基于多通道的数据传递方式</li>
<li>基于多通道的数据传递方式</li>
<li>基于数据包的传输</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机网络课程笔记"><a class="header" href="#计算机网络课程笔记">计算机网络课程笔记</a></h1>
<p>大二下学期专业课《计算机网络》课程笔记。</p>
<p>授课教师：程莉</p>
<h3 id="说明"><a class="header" href="#说明">说明</a></h3>
<p>由于<code>Internet</code>“粗糙的约定和可以运行的代码”的特点，所以笔记中可能出现，逻辑混乱，上下文毫无关系，语无伦次等等问题。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="引言"><a class="header" href="#引言">引言</a></h1>
<h2 id="什么是计算机网络"><a class="header" href="#什么是计算机网络">什么是计算机网络</a></h2>
<p>通过<strong>同一种技术</strong>​相互连接的计算机就构成一种计算机网络。</p>
<blockquote>
<p>容易被混淆的概念：</p>
<ul>
<li>
<p>通信\计算机</p>
<p>通信处理数据从一个实体到另外一个实体的传输</p>
<p>计算机负责帮助人类处理信息</p>
</li>
<li>
<p>通信网络\计算机网络</p>
<p>通信网络就是一个负责传输信息的链接和节点</p>
<p>计算机网络是一组相互链接的互联网</p>
</li>
<li>
<p>分布式系统\计算机网络</p>
<p>分布式系统：将一系列独立的计算机组成一个逻辑上的计算机</p>
<p>系统内部是对用户<strong>透明的</strong>​</p>
</li>
</ul>
</blockquote>
<p>计算机网络<strong>不是：</strong></p>
<ul>
<li>Internet：全球唯一的巨大互联网</li>
<li>internet：多个计算机网络链接构成的计算机网络</li>
<li>www：一种基于计算机网络提供的服务\应用</li>
</ul>
<h3 id="计算机网络的硬件组成"><a class="header" href="#计算机网络的硬件组成">计算机网络的硬件组成</a></h3>
<ul>
<li>计算机\主机<code>host</code>​​\终端系统<code>End System</code>​​</li>
<li>通信链接：有线\无线</li>
<li>交换机<code>switch</code>​​\路由器<code>router</code>​​</li>
</ul>
<h3 id="拓扑结构"><a class="header" href="#拓扑结构">拓扑结构</a></h3>
<p>通过图的形式表示网络中节点，包括交换机和路由器，之间的连接关系。</p>
<h3 id="计算机网络的组成"><a class="header" href="#计算机网络的组成">计算机网络的组成</a></h3>
<ul>
<li>硬件</li>
<li>软件：操作系统以及一些应用软件</li>
<li>计算机的标识：IP地址、域名</li>
<li>通信规则</li>
</ul>
<h2 id="计算机网络的应用"><a class="header" href="#计算机网络的应用">计算机网络的应用</a></h2>
<h3 id="商业应用"><a class="header" href="#商业应用">商业应用</a></h3>
<ul>
<li>资源共享</li>
<li>同用户的交流通信</li>
</ul>
<h3 id="移动网络用户"><a class="header" href="#移动网络用户">移动网络用户</a></h3>
<h2 id="计算机网络的分类"><a class="header" href="#计算机网络的分类">计算机网络的分类</a></h2>
<h3 id="按照使用的范围进行分类"><a class="header" href="#按照使用的范围进行分类">按照使用的范围进行分类</a></h3>
<ul>
<li>
<p>个域网</p>
<p>通常采用蓝牙等技术进行链接</p>
</li>
<li>
<p>局域网<code>LAN</code>​</p>
<p>将主机同边缘路由器连接起来</p>
<p>共有一个链接链路，一般是星型组网</p>
</li>
<li>
<p>城域网<code>MAN</code>​</p>
<p>通常是广电网络</p>
<p>通常是树形组网</p>
</li>
<li>
<p>广域网<code>WAN</code>​</p>
<p>存储转发、分组交换、通过路由算法决定路由路径</p>
<p>为了保证可靠性通常采用网孔型组网</p>
</li>
</ul>
<h3 id="按照传输技术分类"><a class="header" href="#按照传输技术分类">按照传输技术分类</a></h3>
<ul>
<li>
<p>广播网络</p>
<p>将数据包发送给所有的目标主机，每个主机再来检查数据包的目标地址，如果这个数据包就是发给这台主机的就接受这个数据包，反之忽略这个数据包</p>
<p>在局域网中广泛应用</p>
<p>同时发送数据包可能存在冲突</p>
</li>
<li>
<p>点对点网络</p>
<p>数据包直接从源地址发送到目的地址</p>
<p>在广域网中应用广泛。</p>
</li>
</ul>
<h3 id="按照在互联网络中的位置"><a class="header" href="#按照在互联网络中的位置">按照在互联网络中的位置</a></h3>
<ul>
<li>
<p>接入网<code>Access Networks</code>​</p>
<p>在网络的边缘，主要辅助用户来接入互联网</p>
</li>
<li>
<p>核心网<code>Core Networks</code>​</p>
<p>将接入网和其他核心网连接在一起</p>
</li>
</ul>
<h2 id="网络架构和网络协议"><a class="header" href="#网络架构和网络协议">网络架构和网络协议</a></h2>
<h3 id="分层的网络体系结构"><a class="header" href="#分层的网络体系结构">分层的网络体系结构</a></h3>
<p>网络是按照一个层栈的方式组成起来的。这样做可以：</p>
<ul>
<li>
<p>这样设计简化了设计的复杂性</p>
</li>
<li>
<p>每一层向更高层提供来具体的服务，同时屏蔽了具体实现的细节</p>
</li>
<li>
<p>每一层都会和相邻的层之间进行交互（不是通信），每一层都和对方的对等层<code>Peers</code>​之间有着通信，<strong>协议</strong>就规定来对等层之间通信的协议</p>
</li>
<li>
<p>相邻的两层直接通过<strong>接口</strong>定义了允许的操作和服务</p>
</li>
<li>
<p>数据的流向实际上是U型的，发送系统自顶向下，最底层实际传输数据，接受系统自底向上</p>
</li>
<li>
<p>每层可能在上一层交付数据的基础上进行<strong>封装</strong>，加上本层的控制信息，构成本层的数据包，控制信息和添加的方式是由协议规定的。每次构成的数据包称作协议数据包<code>PDU</code>​</p>
</li>
</ul>
<h4 id="层次设计过程中需要注意的问题"><a class="header" href="#层次设计过程中需要注意的问题">层次设计过程中需要注意的问题</a></h4>
<ul>
<li>
<p>可靠性</p>
<ul>
<li>差错检测和回复</li>
<li>路由选择</li>
</ul>
</li>
<li>
<p>网络演进</p>
<ul>
<li>协议的分层设计：将问题细分，隐藏每层实现的细节</li>
<li>地址：标识不同的发送者和接受者</li>
<li>网络的互通性</li>
<li>协议的可扩展性</li>
</ul>
</li>
<li>
<p>资源定位</p>
<ul>
<li>统计复用<code>Statistical Multiplexing</code>​</li>
<li>流量控制：防止过快的发送倒是数据在接受方丢失</li>
</ul>
</li>
<li>
<p>服务质量<code>QoS</code>​</p>
</li>
<li>
<p>安全</p>
</li>
</ul>
<h4 id="层需要指定的标准"><a class="header" href="#层需要指定的标准">层需要指定的标准</a></h4>
<p>同层之间通信的协议：</p>
<ul>
<li>语法<code>Syntax</code>​：协议的消息格式</li>
<li>语义<code>Semantics</code>​：消息的字段区某个值的含义</li>
</ul>
<p>向上一层提供的服务接口</p>
<p>服务接口可以分成两种类型：</p>
<ul>
<li>
<p>面向连接的<code>Connection-oriented</code>​</p>
<p>在连接的过程中连接就被建立起来，需要的资源就已经被分配好了，后续的数据将按照这条已经建立的道路前进</p>
<p>连接将会使可靠的</p>
<p>在建立连接的时候需要完整的地址，在之后只需要指定连接的就可以完全发送</p>
</li>
<li>
<p>无连接的<code>Connectionless</code>​</p>
<p>资源将会是动态分配的</p>
<p>但是连接是不可靠的，数据包可以会丢失、放弃和乱序</p>
<p>每次连接都需要完整的地址来建立连接</p>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>连接类型</th><th>服务</th><th>例子</th></tr></thead><tbody>
<tr><td>面向连接的</td><td>可靠的消息流</td><td>页面序列</td></tr>
<tr><td>面向连接的</td><td>可靠的字节流</td><td>远程登录</td></tr>
<tr><td>面向连接的</td><td>不可靠的连接</td><td>数字通话</td></tr>
<tr><td>无连接的</td><td>不可靠的数据报</td><td>电子垃圾邮件</td></tr>
<tr><td>无连接的</td><td>订阅数据报</td><td>注册邮件</td></tr>
<tr><td>无连接的</td><td>查询-回复</td><td>数据库查询</td></tr>
</tbody></table>
</div>
<p><strong>服务原语</strong>​<code>Service Primitives</code>​：描述层与层之间提供服务的方法。一个服务就是有一组服务原语来定义的。</p>
<p>在计算机中实现服务原语：</p>
<p>如果协议栈是由操作系统实现的：服务原语通过是通过系统调用的方式提供的。</p>
<p>如果需要定义一个简单的面向连接的服务，一般需要5个服务原语：</p>
<ul>
<li>监听：阻塞直到收到一个连接请求</li>
<li>连接：同对应层建立一个连接</li>
<li>接收：阻塞直到收到数据</li>
<li>发送：发送数据</li>
<li>断开连接：终止一个连接</li>
</ul>
<h4 id="服务和协议的关系"><a class="header" href="#服务和协议的关系">服务和协议的关系</a></h4>
<p>服务定义了本层对外提供的操作，而协议定义了同层之间通信的方式。</p>
<p>服务是通过协议实现的，在服务不变的情况下，层可以自由改变协议。</p>
<h2 id="参考模型"><a class="header" href="#参考模型">参考模型</a></h2>
<h3 id="osi参考模型"><a class="header" href="#osi参考模型">OSI参考模型</a></h3>
<p>模型将设备分为两类：主机和节点。</p>
<p>主机不负责数据的转发，但是需要负责数据的处理，主机具有完整的七层。</p>
<p>节点负责数据的转发，不具有处理数据的能力，节点只具有三层。</p>
<p>参看模型的七层具体为：</p>
<ul>
<li>
<p>物理层<code>Physical</code>​​</p>
<p>直接通过通信设备处理字节流。</p>
<p>定义了<code>1</code>​位和<code>0</code>​位的电压范围和位的数据率，定义了传输是全双工还是半双工的，定义了初始连接如何建立和终止，定义了接口的物理规格。</p>
</li>
<li>
<p>数据链路层<code>Data Link</code>​​</p>
<p>通过逻辑通道进行原始数据的传输。</p>
<p>发送者会将数据封装为<strong>帧</strong>发送，接受者会在收到数据之后发送确认帧给发送者以确保服务的可靠性。数据链路层还会提供流量控制的功能，避免过快的发送阻塞了接受者。广播网络和单点网络的区分也是在数据链路层产生的。</p>
</li>
<li>
<p>网络层<code>Network</code>​​</p>
<p>控制子网上的操作。</p>
<p>网络层主要的功能就是转发数据，<strong>路由</strong>的功能就主要在网络层实现。除此之外，网络层还提供拥塞控制，服务质量的控制等功能。</p>
</li>
<li>
<p>传输层<code>Transport</code>​​</p>
<p><strong>端到端层</strong>。从上层接受数据，将数据分成较小的数据包并且通过网络层正确的传输到对方。</p>
<p>同一计算机上不同进程的区分也是在传输层完成的。</p>
</li>
<li>
<p>会话层<code>Session</code></p>
<p>提供会话控制、令牌管理和同步的功能。</p>
</li>
<li>
<p>表示层<code>Presentation</code>​</p>
<p>获得传输信息的语法和语义。</p>
<p>在这层可以提供数据加密和数据压缩等的功能。</p>
</li>
<li>
<p>应用层<code>Application</code>​​</p>
<p>直接被用户使用的各种应用协议。</p>
</li>
</ul>
<h3 id="tcpip参考模型"><a class="header" href="#tcpip参考模型">TCP/IP参考模型</a></h3>
<p>该模型一般只有四层：</p>
<ul>
<li>链路层<code>Link</code>​</li>
<li>网络层/网际层<code>Internet</code>​</li>
<li>传输层<code>Transport</code>​</li>
<li>应用层<code>Application</code>​</li>
</ul>
<h4 id="链路层"><a class="header" href="#链路层">链路层</a></h4>
<p>协议并未强制规定，具体的实现由其他的机构规定，比如<code>Ethernet</code>​，<code>WiFi</code>​和<code>SDH</code>​。</p>
<p>只负责传输<code>IP</code>​数据包。</p>
<h4 id="网络层"><a class="header" href="#网络层">网络层</a></h4>
<p>主要协议是<code>IP</code>​协议，是一个不可靠的传输协议。</p>
<h4 id="传输层"><a class="header" href="#传输层">传输层</a></h4>
<p>​<code>TCP</code>​传输协议：面向连接的可靠传输协议，传输字节流。</p>
<p>​<code>UDP</code>​传输协议：无连接的不可靠传输协议，传输字节流。</p>
<h4 id="应用层"><a class="header" href="#应用层">应用层</a></h4>
<p>由用户使用的各种应用协议。</p>
<h3 id="osi和tcpip参考模型的对比"><a class="header" href="#osi和tcpip参考模型的对比">OSI和TCP/IP参考模型的对比</a></h3>
<p>​<img src="computer-networks/./assets/image-20230303101525-fcvns6w.png" alt="image" /></p>
<h4 id="osi模型的特点优缺点"><a class="header" href="#osi模型的特点优缺点">OSI模型的特点、优缺点</a></h4>
<p>特点：</p>
<ul>
<li>服务：某层实体对于上一层实体的支持</li>
<li>结构：定义某层实体对于上一层提供的原语操作</li>
<li>协议：两个系统同层之间同喜需要遵守的规范</li>
</ul>
<p>OSI模型没有能够取得主导地位的问题：</p>
<ul>
<li>生不逢时</li>
<li>技术设计上有缺陷，比如会话层和展示层比较简单而且和应用关系密切，不算是很合适的抽象</li>
</ul>
<h4 id="tcpip模型的特点优缺点"><a class="header" href="#tcpip模型的特点优缺点">TCP/IP模型的特点、优缺点</a></h4>
<ul>
<li>服务、接口和协议没有很清晰的划分</li>
<li>不算是很通用的模型</li>
<li>链路层实际上不算层，并没有严格的规定</li>
<li>物理层和数据链路层上没有区分</li>
<li>部分老旧协议</li>
</ul>
<h3 id="混合模型"><a class="header" href="#混合模型">混合模型</a></h3>
<blockquote>
<p>注意：这个模型并不是实际标准化的模型，只是学习的过程中便于学习而提出的。</p>
</blockquote>
<p>两个模型都存在缺陷，因此为了较好的描述整个体系，我们将两个模型混合在一起：</p>
<ul>
<li>应用层</li>
<li>传输层</li>
<li>网络层</li>
<li>数据链路层</li>
<li>物理层</li>
</ul>
<p>‍</p>
<p>‍</p>
<p>‍</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="物理层"><a class="header" href="#物理层">物理层</a></h1>
<h2 id="物理层的位置和功能"><a class="header" href="#物理层的位置和功能">物理层的位置和功能</a></h2>
<p>网络架构中最低的层，定义了字节如何通过转换为信号并通过各种通道传输。</p>
<h2 id="基础概念和数据传输"><a class="header" href="#基础概念和数据传输">基础概念和数据传输</a></h2>
<ul>
<li>
<p>信道<code>Channel</code>​：传送信息的媒体（介质）</p>
</li>
<li>
<p>带宽<code>Bandwidth</code>​：可以稳定传输的频率范围</p>
</li>
<li>
<p>速率<code>bps</code>​：每秒内传输的位数量</p>
</li>
<li>
<p>波特率<code>baud</code>​：每秒钟能能够发送的信号单元数量</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span></span></span></span></p>
<p><code>T</code>​是发送信号单元之间的间隔</p>
</li>
</ul>
<p>速率和波特率之间存在着关系，主要取决于单个信号单元能够携带的位数量，而单个信号单元能够携带的位数量由取决于单个信号单元的有效状态<code>V</code>​，而且有：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Bp</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p>
<ul>
<li>
<p>信道容量：信道的最大数据率</p>
</li>
<li>
<p>吞吐量：单位时间内网络可以传送的数据位数</p>
</li>
<li>
<p>负载：单位时间内进入网络的数据位数</p>
</li>
<li>
<p>误码率：传输出错的数量占总传输量的时间</p>
</li>
<li>
<p>时延：从向网络中发送数据块的第一位开始，到数据块的最后一位被接受为止，中间经过的时间</p>
<p>时延一般由以下这些部分组成：发送时延、传播时延、节点处理时延、排队时延</p>
<ul>
<li>发送时延：设备发送一个数据块需要的时间，和数据块的长度和发送的速率有关</li>
<li>传播时延：信号通过传输介质的时间</li>
<li>节点处理时延：交换机和路由器检查数据和选路的时间</li>
<li>排队时延：在交换机和路由器中排队等待的时间</li>
</ul>
</li>
</ul>
<h3 id="单工半双工全双工"><a class="header" href="#单工半双工全双工">单工、半双工、全双工</a></h3>
<ul>
<li>单工<code>simplex</code>​：传输只能单向发生。</li>
<li>半双工<code>half-duplx</code>​：传输可以双向发生，但是同一时间只能单向传输</li>
<li>全双工<code>full-duplx</code>​：双向传输可以同时发生</li>
</ul>
<h3 id="并行传输和串行传输异步传输和同步传输"><a class="header" href="#并行传输和串行传输异步传输和同步传输">并行传输和串行传输、异步传输和同步传输</a></h3>
<p>并行传输同时传输多个字符，串行传输同时传输一个字符。</p>
<ul>
<li>
<p>异步串行传输</p>
<p>拥有独立的时钟，两个设备之间不需要进行同步。</p>
<p>以字符位单位进行传输。</p>
<p>发送两个字符之间的间隔是任意的。</p>
<p>接受方依靠字符中中的起始位和停止位进行同步。</p>
</li>
<li>
<p>同步串行传输</p>
<p>以时钟信号线对传输的数据线上的信号进行同步。</p>
<p>按照数据块（帧）为单位进行传输</p>
</li>
</ul>
<h3 id="传输损伤"><a class="header" href="#传输损伤">传输损伤</a></h3>
<p>收到的信号同发出的信号不同的现象称作传输损伤。这种损伤表现在模拟型号中就是信号质量的下降，在数据信号中表现为位错误。</p>
<p>传输损伤通常是由信号衰减、失真，传输时延和通信噪声造成的。</p>
<h2 id="传输数据的理论基础"><a class="header" href="#传输数据的理论基础">传输数据的理论基础</a></h2>
<h4 id="nyquist定理"><a class="header" href="#nyquist定理">Nyquist定理</a></h4>
<p><code>Nyquist</code>​定理：如果一个随机的信号通过一个带宽为<code>B</code>​的低通滤波器，那么只需要<code>2B</code>​的采样率就能够重建出这个信号。</p>
<p>于是对于一个无噪声，带宽为<code>B</code>​​的信道，可以支持的最高波特率就是<code>2B</code>​​。</p>
<p>如果单个信号单元包含了<code>V</code>​状态，那么最大传输速率为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">a</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ban</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></span></p>
<p>‍</p>
<h4 id="香农公式"><a class="header" href="#香农公式">香农公式</a></h4>
<p>利用香农公式可以得到一个指定的信道最大的传输带宽，这是从物理的角度上给出的一个信道的极限带宽。</p>
<p>香农公式：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">a</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ban</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3904em;vertical-align:-0.996em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">i</span><span class="mord mathnormal">se</span><span class="mord" style="margin-right:0.02778em;"><em></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">na</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord" style="margin-right:0.02778em;"></em></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>而在具体实践中信噪比<code>SNR</code>​常常使用<strong>分贝</strong>作为单位进行表示：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>在计算中需要注意换算。</p>
<h2 id="传输介质"><a class="header" href="#传输介质">传输介质</a></h2>
<ul>
<li>双绞线<code>Twisted Pair</code>​</li>
<li>同轴电缆<code>Coaxial Cable</code>​</li>
<li>光纤<code>Fiber</code>​</li>
<li>电力线<code>Power Line</code>​</li>
<li><code>射频Radio</code>​</li>
</ul>
<h4 id="双绞线utp"><a class="header" href="#双绞线utp">双绞线UTP</a></h4>
<p>最常见的通信介质，可以传输模拟信号和数字信号。</p>
<p>双绞线的带宽取决于：</p>
<ul>
<li>
<p>线缆的粗细</p>
</li>
<li>
<p>传输的距离</p>
</li>
<li>
<p>每米的匝数</p>
<p>双绞线通过两根相互缠绕的铜线来抗干扰，因此缠绕的越密集，抗干扰的能力就越强，带宽就更宽。</p>
</li>
</ul>
<h4 id="同轴电缆"><a class="header" href="#同轴电缆">同轴电缆</a></h4>
<p>比双绞线有着更好的屏蔽性能和更广的带宽。</p>
<p>在局域网组网中使用很少，但是在核心交换机之间比较常用。</p>
<h4 id="光纤"><a class="header" href="#光纤">光纤</a></h4>
<p>相较于使用电信号进行通信的前两者，光纤具有高带宽，轻量和安全等特点。</p>
<h4 id="电力线"><a class="header" href="#电力线">电力线</a></h4>
<p>通过家庭电路进行网络的传输，提高电线的利用效率。</p>
<h4 id="射频"><a class="header" href="#射频">射频</a></h4>
<p>无线的传输方式。相较于有线的传输方式，射频传输会有更高的误码率和更高的延迟。</p>
<h2 id="数字调试和编码"><a class="header" href="#数字调试和编码">数字调试和编码</a></h2>
<h3 id="信号调制技术"><a class="header" href="#信号调制技术">信号调制技术</a></h3>
<ul>
<li>电话：模拟信号到模拟信号</li>
<li>调制：数字信号到模拟信号</li>
</ul>
<h3 id="调制"><a class="header" href="#调制">调制</a></h3>
<p>通过模拟信号来传输数字信号：</p>
<ul>
<li>通过不同的频率来表示不同的比特位</li>
<li>通过不同的振幅来表示不同的比特位</li>
<li>通过不同的相位来表示不同的比特位</li>
</ul>
<h4 id="多级调制技术"><a class="header" href="#多级调制技术">多级调制技术</a></h4>
<p>通过同时利用不同的振幅和相位来表示传输的比特位，提高单个信号单元能携带的信息数量。</p>
<p>通常使用星云图来表示：</p>
<p><img src="computer-networks/./assets/image-20230307155947-uhhx3r7.png" alt="image" />​</p>
<p>而且相同的调制级数可能存在不同的实现。</p>
<h3 id="编码"><a class="header" href="#编码">编码</a></h3>
<h4 id="使用电平表示状态"><a class="header" href="#使用电平表示状态">使用电平表示状态</a></h4>
<p>使用高电平表示1， 使用低电平表示0。这种编码方式被称作<strong>不归零</strong><code>NRZ</code>。</p>
<p>但是使用这种方式可能会导致同步失败：</p>
<p><img src="computer-networks/./assets/image-20230307161007-d759fgv.png" alt="image" /></p>
<p>一段连续的高电平/低电平可能会被误判。</p>
<h4 id="使用电平翻转表示状态"><a class="header" href="#使用电平翻转表示状态">使用电平翻转表示状态</a></h4>
<p>在时钟开始的时候如果发生调变就是1，不发生调变就是0。</p>
<h4 id="曼彻斯特编码"><a class="header" href="#曼彻斯特编码">曼彻斯特编码</a></h4>
<p>指定电平的变化必须发生在时钟周期的中间。这样同时传输来信号和时钟，有着自同步功能。</p>
<p>电平由高变低表示1，电平由低变高表示0。</p>
<p><img src="computer-networks/./assets/image-20230314150036-let9asb.png" alt="image" />​</p>
<blockquote>
<p>是现在局域网编码使用的编码格式。</p>
<p>但是目前的高速局域网已经不适用了，因为需求的频率较高。<strong>（十兆网升级到百兆网仍然使用曼彻斯特编码，只是同时将线路缩短十倍，但是千兆网及更高就不用了（或帧突发、载波扩展？））</strong></p>
</blockquote>
<h3 id="数字化模拟信号pcm"><a class="header" href="#数字化模拟信号pcm">数字化模拟信号PCM</a></h3>
<p>通过记录一系列离散的点来表示原来的模拟信号。</p>
<p>PCM一般具有三个步骤：</p>
<ul>
<li>
<p>采样</p>
<p>按照<code>Nyquist</code>​定理，采样率需要是最高频率的两倍。</p>
</li>
<li>
<p>量化</p>
<p>将信号强度对应为指定好的量级。</p>
<p>不同的国家和地区可能有着不同的量化方式。</p>
</li>
<li>
<p>编码</p>
</li>
</ul>
<h2 id="复用"><a class="header" href="#复用">复用</a></h2>
<h3 id="频分复用fdm"><a class="header" href="#频分复用fdm">频分复用FDM</a></h3>
<p>将不同频率的信号合并在一起传输，最大化提高信道的利用效率。</p>
<h3 id="时分复用tdm"><a class="header" href="#时分复用tdm">时分复用TDM</a></h3>
<p>将时间分为若干个不同的时间片<code>timeslot</code>​，信号将被分配到不同的时间片发送。</p>
<h4 id="静态时分复用static"><a class="header" href="#静态时分复用static">静态时分复用（static）</a></h4>
<p>在每一个发送帧中都为每个用户保留空间以进行复用，一种同步的时分复用方式。</p>
<p>但是这样做可能会导致比较大的浪费。在电话网络中应用比较广泛，而在计算机网络中应用比较少。</p>
<h4 id="统计时分复用synchronous"><a class="header" href="#统计时分复用synchronous">统计时分复用（synchronous）</a></h4>
<p>只发送需要发送的数据，在需要时分复用的时候才进行复用。</p>
<p><img src="computer-networks/./assets/image-20230310101319-3bkz665.png" alt="image" />​</p>
<p>但是这样需要加上地址头以区分不同的用户发送的数据。</p>
<h3 id="码分复用"><a class="header" href="#码分复用">码分复用</a></h3>
<p>每一个用户都可以使用整个信号在任意时间发送信息，不同用户之间传输的数据是通过编码理论的方式分开的。</p>
<h2 id="物理网络例子pstn"><a class="header" href="#物理网络例子pstn">物理网络例子：PSTN</a></h2>
<blockquote>
<p>就是最原始的电话网络，相关：<strong>T1链路标准</strong></p>
</blockquote>
<p><img src="computer-networks/./assets/image-20230310102105-m4qp2d8.png" alt="image" />​</p>
<ul>
<li>本地环路<code>Local Loop</code>​：一般还是采用模拟双绞线传输，从端局到用户。</li>
<li>中继线路<code>Trunk</code>​：一般是数字同轴线/光纤传输，在端局和不同交换机之间传输。</li>
<li>交换机<code>Switch Offices</code>​：将电话呼叫在不同的端局之间联通。</li>
</ul>
<h3 id="传输的速率"><a class="header" href="#传输的速率">传输的速率</a></h3>
<p>当计算机利用电话网络进行通信的时候，需要采用调制解调器进行数字信号和模拟信号之间的转换。端局还需要进行一次数模转换，那么如果两台采用调制解调器的计算机之间直接通信，由于数模转换之间产生的噪声，通过香农公示进行计算得到的最大传输速度大概是<code>35kpbs</code>​。如果之间和ISP的服务器之间通信，这是就可以省去一般的数模转换，这里的传输速率就可以达到<code>56kpbs</code>​。</p>
<h3 id="xdsl-服务"><a class="header" href="#xdsl-服务">xDSL 服务</a></h3>
<p>为了提高电话网上网的速度，同时也解决上网的时候就不能打电话，传真的问题，非对称数字用户线<code>ADSL</code>​技术出现了。</p>
<p><code>ADSL</code>​技术采用频分复用技术，将大概1.1Mhz的信号分成256个4312.5Hz的信道，其中信道0用于电话通信，信道1~5不被使用，而是用作电话信号和数字信号之间的隔离带。剩下的250个信道都被用于数据通信，其中两个信道用于控制，剩下的信道都是用来通信。</p>
<p>每个信道都采用类似于<code>V.34</code>​的编码方式，采样率为<code>4000 baud</code>​，通过正交调幅发送的数据大概为<code>15 bit/buad</code>​，在极限情况下的最大传输速度能达到<code>13Mpbs</code>​左右。同时为了提高用户体验，ISP往往都会把更多的信道用来作为下行信道，使提供的下载带宽大于上传带宽。</p>
<h2 id="物理网络例子有线电视网络"><a class="header" href="#物理网络例子有线电视网络">物理网络例子：有线电视网络</a></h2>
<p><img src="computer-networks/./assets/image-20230310105207-129pbhi.png" alt="image" />​</p>
<p>同样采用频分复用的技术。</p>
<p>下载链路采用<code>QAM-64</code>​编码，传输速度大概能达到30Mbps，上传链路采用<code>QPSK</code>​编码，传输速度大概能达到12Mpbs。</p>
<h2 id="链路交换和分组交换"><a class="header" href="#链路交换和分组交换">链路交换和分组交换</a></h2>
<h3 id="链路交换"><a class="header" href="#链路交换">链路交换</a></h3>
<p>在需要交换时，在通信的双方之间建立专用的通路，资源提前分配。通信有着三个阶段：链接建立，数据传输，链接中止。</p>
<p>电话网络交换中常采用这种方式。</p>
<p>优点是延迟比较低，服务的质量比较好，缺点是在建立链接的时候需要花费比较长的时间，固定的带宽也不适合计算机使用，当双方都不发送数据的时候，建立数据链路就会被浪费。</p>
<h3 id="分组交换"><a class="header" href="#分组交换">分组交换</a></h3>
<p>数据在发送之初就被分成不同的组，每个包单独进行路由选择，每个节点都会先存储收到的数据包再发送给下一个节点（存储——转发策略），在这过程中资源是动态分配的。每个包都需要携带路由需要的信息。</p>
<h3 id="链路交换和分组交换所花费的时间"><a class="header" href="#链路交换和分组交换所花费的时间">链路交换和分组交换所花费的时间</a></h3>
<p><img src="computer-networks/./assets/image-20230310111017-huo2u80.png" alt="image" />​</p>
<h2 id="物理层协议示例10baset"><a class="header" href="#物理层协议示例10baset">物理层协议示例：10BaseT</a></h2>
<p>物理层需要规定物理接口：</p>
<ul>
<li>机械特性</li>
<li>电气特性</li>
<li>功能特性</li>
<li>过程特性</li>
</ul>
<h3 id="ieee802310baset"><a class="header" href="#ieee802310baset">IEEE802.3——10BaseT</a></h3>
<p>以双绞线作为传输介质，传输速度能够达到10Mpbs的协议。</p>
<ul>
<li>机械特性：使用<code>RJ-45</code>​接口作为物理接口</li>
<li>电气特性：使用曼彻斯特编码，电压范围在<code>-2.5V~2.5V</code>​之间</li>
<li>功能特性：使用接口中的<code>pin1&amp;2</code>​对线作为发送线，<code>pin3&amp;6</code>​对线作为接受线</li>
</ul>
<p>‍</p>
<p>‍</p>
<p>‍</p>
<p>‍</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据链路层"><a class="header" href="#数据链路层">数据链路层</a></h1>
<h2 id="数据链路层的位置功能和服务"><a class="header" href="#数据链路层的位置功能和服务">数据链路层的位置、功能和服务</a></h2>
<h3 id="数据链路层和位置和功能"><a class="header" href="#数据链路层和位置和功能">数据链路层和位置和功能</a></h3>
<p>数据链路层负责通过物理层以可靠、高效的方式将数据包（帧）在相邻节点之间传输。</p>
<p>数据链路层提供了打包，流量控制，地址索引，错误控制，介质访问控制等的功能。</p>
<blockquote>
<p>其中介质访问控制是专属于局域网的技术，主要负责处理数据包广播中遇到的问题，而在广域网中常用点对点链接的方式，故没有相关的问题。</p>
</blockquote>
<p>设计目标就是在两个响铃的节点之间实现可靠、高效的通信。</p>
<h3 id="封装"><a class="header" href="#封装">封装</a></h3>
<p>​<img src="computer-networks/./assets/image-20230314152006-xcqa5cb.png" alt="image" /></p>
<p>在数据链路层的封装：将上一层传输过来的<strong>净荷</strong>附加上帧头和帧尾构成一个帧。</p>
<p>数据链路层中的传输是逐级进行的，被称作逐级通信<code>hop-to-hop communication</code>​。</p>
<h3 id="数据链路层一般由网卡实现"><a class="header" href="#数据链路层一般由网卡实现">数据链路层一般由网卡实现</a></h3>
<ul>
<li>发送方：将网络层的包打包为一个帧，在加上错误纠正，可靠传输和流量控制等的功能</li>
<li>接收方：首先检验传输过程中是否发生错误，并进行流量控制和可靠传输等的功能</li>
<li>数据链路层常常通过硬件实体——网卡实现</li>
</ul>
<h3 id="数据链路层提供的服务"><a class="header" href="#数据链路层提供的服务">数据链路层提供的服务</a></h3>
<ul>
<li>
<p>无连接的服务：</p>
<ul>
<li>无确认的无连接服务：没有确认帧和逻辑链接，大多数的局域网属于这种方式</li>
<li>有确认的无连接服务：含有一个确认帧，在不可靠的传输信道中应用比较广泛，比如Wi-Fi</li>
</ul>
</li>
<li>
<p>面向连接的服务：</p>
<p>需要建立连接，每一个传输的帧都会被编号。常见的有<code>ATM</code>​和<code>HDLC</code>​</p>
</li>
</ul>
<h2 id="设计中处理的问题"><a class="header" href="#设计中处理的问题">设计中处理的问题</a></h2>
<h3 id="成帧控制"><a class="header" href="#成帧控制">成帧控制</a></h3>
<p>如何从物理层中传输的字节流中识别出不同的帧。</p>
<h4 id="设计成帧功能的要求"><a class="header" href="#设计成帧功能的要求">设计成帧功能的要求</a></h4>
<ul>
<li>简单：易于实现</li>
<li>透明：同传输的内容无关</li>
<li>高效：使用的字节尽量少</li>
<li>鲁棒：不易出错，即使出错也应该尽快恢复</li>
</ul>
<h4 id="字符计数法"><a class="header" href="#字符计数法">字符计数法</a></h4>
<p>​<img src="computer-networks/./assets/image-20230314154546-j6vsp0v.png" alt="image" />​</p>
<p>在帧头中添加一个表示内容中字符的数量（包括帧头）。但是如果传输的时候帧头中字符数量的字段发生了错误，这个错误不易纠正。</p>
<h4 id="字节字符填充"><a class="header" href="#字节字符填充">字节/字符填充</a></h4>
<p>在帧的首尾添加标志符以标记帧的开始和结束。标志符往往是传输内容中不常使用的字符。</p>
<p>这种方式实现透明传输比较复杂：因为作为标志符的字符在传输内容中也可能使用。于是为了实现透明传输，在传输内容中使用标志符时需要在前面加上转义字符，通知接受者后面的标志符并不是标志符。</p>
<p>这种方式在<code>PPP</code>​协议中得到使用。</p>
<p>这种方式同传输内容的编码方式高度相关，而且往往都是字符编码，直接传输字节就显得不太可能。</p>
<h4 id="比特填充"><a class="header" href="#比特填充">比特填充</a></h4>
<p>使用固定的二进制位串位置帧开始和结束的标志：<code>01111110</code>​。</p>
<p>但是在传输的数据中也会存在出现标志位串的可能性，于是为了避免这种问题，硬件会在内容中每遇到5个连续的1就在后面添加一个0。在接受方接受数据的时候，每接受到五个连续的1就去掉后面的0。</p>
<p>​<img src="computer-networks/./assets/image-20230314155848-rx0uorr.png" alt="image" />​</p>
<p>但是如果在传输的过程中遇到<code>01110110</code>​这种位串，其中发生了一次位翻转成为标志位，或者反过来，就可能导致传输错误。</p>
<h4 id="物理层编码违例法"><a class="header" href="#物理层编码违例法">物理层编码违例法</a></h4>
<p>利用物理层编码中违法的编码作为帧的开始和结束标志。</p>
<h3 id="错误控制"><a class="header" href="#错误控制">错误控制</a></h3>
<h4 id="错误的类型"><a class="header" href="#错误的类型">错误的类型</a></h4>
<ul>
<li>帧丢失：发出的帧就没有达到接收方。这种错误属于流量控制的部分。</li>
<li>帧损坏：接受帧的部分比特错误。</li>
</ul>
<p>单比特错误就是只有一个比特发生了错误。</p>
<p>突发错误意味着至少两个比特在传输过程中发生了错误。突发错误的长度不是指错误比特的数量。</p>
<p>​<img src="computer-networks/./assets/image-20230314161242-g7oi433.png" alt="image" />​</p>
<h4 id="错误的侦测"><a class="header" href="#错误的侦测">错误的侦测</a></h4>
<ul>
<li>奇偶校验检测单个比特错误</li>
<li>循环冗余校验可以检测部分突发性的错误</li>
</ul>
<h5 id="奇偶校验"><a class="header" href="#奇偶校验">奇偶校验</a></h5>
<p>通过添加一个奇偶校验位来验证数据的传输过程中是否发生错误。</p>
<p>奇偶校验只能检验奇数的错误。</p>
<h5 id="汉明码"><a class="header" href="#汉明码">汉明码</a></h5>
<p>为了校验单个错误需要的校验码位数：</p>
<p>设<code>m</code>​表示信息的位数，<code>r</code>​表示校验码的位置，<code>n</code>​为传输的位置，即<code>n=m+r</code>​。</p>
<p>为了纠正单个的错误，需要有下列的不等式成立：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>化简得到：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>为了设计汉明码，首先需要给每一位编号：从左到右，从1开始依次编号。</p>
<p>在编码中，2的次方位（2，4，8，16）是校验码位，剩下的位数就是传输的数据位。其中每一个校验位覆盖的数据为是不同的，例如对于8位的ASCII码的进行编码：</p>
<div class="table-wrapper"><table><thead><tr><th>编号</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th></tr></thead><tbody>
<tr><td>码字</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td></tr>
</tbody></table>
</div>
<p>发送前编码：</p>
<p>3=1+2，5=1+4，6=2+4，7=1+2+4，9=1+8，10=2+8，11=1+2+8</p>
<p>所以校验码1就需要检验1，3，5，7，9，11，所以值就是0，其他的检验码依次类推，需要检验所有编码中设计的位。</p>
<p>生成汉明码还有一种简便方法：</p>
<p>在需要生成编码时，将码字中为1的各位码字表示为二进制码，再按模2求和，所得的结果就是校验码，下图中是将数据<code>1011</code>进行编码的示例：</p>
<p><img src="computer-networks/./data-link-layer/2023-03-25-14-53-15-image.png" alt="" /></p>
<blockquote>
<p>需要注意的是，得到的校验码是倒序的。</p>
</blockquote>
<p>在需要阶码的时候，将码字中为1的各位码字位号表示为二进制码，再按模2求和，如果和为0表示无差错，如果不为0表示差错的位号。</p>
<h5 id="crc循环冗余校验"><a class="header" href="#crc循环冗余校验">CRC循环冗余校验</a></h5>
<p>CRC主要用于突发错误的侦测。</p>
<p>将位串当作多项式项目的系数。例如<code>110001</code>​就可以写成多项式：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>发送方和接收方首先需要约定好一个相同的校验多项式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>。校验码的位数同校验多项式最高次项的次数相同。</p>
<p>发送方在生成校验码时，首先在数据的后面补上同校验码位数相同的零，再和校验多项式做除法取余数，余数就是生成的校验位。</p>
<p>​<img src="computer-networks/./assets/image-20230317104513-wcl187o.png" alt="image" /></p>
<p>接受方在接收到数据之后利用校验多项式计算除法的余数，如果余数为0则说明传输中没有问题，反之则存在错误。</p>
<p>​<code>r</code>​位的校验码可以发现所有长度在<code>r</code>​以下的错误。</p>
<p>所有奇数个比特翻转的错误一定能够被发现。</p>
<p>对于长度大于<code>r</code>​的错误被遗漏的概率为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span>。</p>
<h4 id="错误的纠正"><a class="header" href="#错误的纠正">错误的纠正</a></h4>
<p>当传输的介质比较可靠的时候，使用错误侦测再进行重传是更加便宜的方式。</p>
<p>当传输的介质不是特别可靠的时候，比如无线网络，最好使用错误纠正码来确保接受者能够纠正少量的错误。</p>
<h3 id="流量控制"><a class="header" href="#流量控制">流量控制</a></h3>
<p>流量控制的目的就是为了防止接收方被发送方过快的发送阻塞，导致传输的数据丢失。</p>
<p>数据链路层的流量控制都是基于反馈的流量控制，即通过发送方通过接受接受方发送的<code>ACK</code>​信息来决定怎么发送数据。</p>
<h4 id="基础流量控制协议"><a class="header" href="#基础流量控制协议">基础流量控制协议</a></h4>
<p>使用<code>C</code>​语言编写代码表示协议，定义一个头文件<code>protocol.h</code>​：</p>
<pre><code class="language-java">//
// Created by ricardo on 23-3-17.
//

#ifndef DATA_LINK_LAYER_PROTOCOL_H
#define DATA_LINK_LAYER_PROTOCOL_H

#define MAX_PKT 1024

typedef enum {
    false,
    true
} boolean;

typedef unsigned int seq_nr;

typedef struct {
    unsigned char data[MAX_PKT];
} packet;

typedef enum {
    data,
    ack,
    nck,
} frame_kind;

typedef struct {
    frame_kind kind;
    seq_nr seq;
    seq_nr ack;
    packet info;
} frame;

void wait_for_event(event_type *event);

void from_network_layer(packet *p);

void to_network_layer(packet* p);

void from_physical_layer(packet *p);

void to_physical_layer(packet* p);

void start_timer(seq_nr k);

void end_timer(seq_nr k);

void start_ack_time();

void end_ack_time();

void enable_network_layer();

void disable_network_layer();

#endif //DATA_LINK_LAYER_PROTOCOL_H
</code></pre>
<h5 id="协议1-乌托邦单工协议"><a class="header" href="#协议1-乌托邦单工协议">协议1 乌托邦单工协议</a></h5>
<p>这个协议假设：</p>
<ul>
<li>通信的单工的</li>
<li>通信是无错的</li>
<li>接收方有着无限的缓存</li>
</ul>
<p>即：这个协议不需要任何的错误控制和流量控制</p>
<p>​<img src="computer-networks/./assets/image-20230317131231-0xw9d7m.png" alt="image" />​</p>
<pre><code class="language-java">//
// Created by ricardo on 23-3-17.
//

typedef enum {
    frame_arrival
} event_type;
#include "protocol.h"

void send() {
    frame s;
    packet buffer;

    while (true) {
        from_network_layer(&amp;buffer);
        s.info = buffer;
        to_physical_layer(&amp;s);
    }
}

void receive() {
    frame r;
    event_type event;

    while (true) {
        wait_for_event(&amp;event);

        from_physical_layer(&amp;r);
        to_network_layer(&amp;r.info);
    }
}
</code></pre>
<h5 id="协议2-单工发送等待协议"><a class="header" href="#协议2-单工发送等待协议">协议2 单工发送——等待协议</a></h5>
<p>这个协议假设：</p>
<ul>
<li>通信是单工的</li>
<li>通信是没有错误的</li>
<li>接受者有着有限的缓存</li>
</ul>
<p>这个协议使用了一种发送——等待机制：</p>
<ul>
<li>发送方发送数据开始等待</li>
<li>接收方接受数据并发送确认帧<code>ACK</code>​​</li>
<li>发送方收到确认帧，继续发送</li>
</ul>
<p>​<img src="computer-networks/./assets/image-20230317131347-otg5vff.png" alt="image" />​</p>
<pre><code class="language-java">//
// Created by ricardo on 23-3-17.
//

typedef enum {
    frame_arrival
} event_type;

#include "protocol.h"

void send()
{
    frame s;
    packet buffer;
    event_type event;

    while (true)
    {
        from_network_layer(&amp;buffer);
        s.info = buffer;
        to_physical_layer(&amp;s);
        wait_for_event(&amp;event);
    }
}

void receive()
{
    frame r, s;
    event_type event;

    while (true) {
        wait_for_event(&amp;event);
        from_physical_layer(&amp;r);
        to_network_layer(&amp;r.info);
        to_physical_layer(&amp;s);
    }
}
</code></pre>
<h5 id="协议3-带有重试的主动确认协议"><a class="header" href="#协议3-带有重试的主动确认协议">协议3 带有重试的主动确认协议</a></h5>
<p>如果将协议2应用在不可靠的传输信道上：</p>
<ul>
<li>
<p>传输过程中帧损坏了：</p>
<p>接受者可以使用<code>CRC</code>​纠错码发现和丢弃这个损坏的帧</p>
<p>发送者在等待<code>ACK</code>​帧的过程中超时之后重新发送这个帧</p>
</li>
<li>
<p>传输过程中帧丢失了：</p>
<p>如果是数据帧丢失了：发送者超时之后重新发送</p>
<p>如果是<code>ACK</code>​帧丢失了：发送者超时之后重新发送</p>
</li>
</ul>
<p>但是<code>ACK</code>​帧丢失之后重传可能遇到一个问题：发送者重新发送的数据帧会被接受者当作是新的数据帧。</p>
<p>​<img src="computer-networks/./assets/image-20230317132728-bl3crdb.png" alt="image" />​</p>
<p>为了解决这个问题，我们可以在数据帧的帧头上添加序列编号。</p>
<p>在这里由于实际上只需要两种状态，序列编号只需要一个比特，传输0或者1就可以了。</p>
<p>这样就将这个协议改造成了一个自动重传协议<code>Automatic Repeat reQuest aka ARQ</code>​。</p>
<p>这个协议称为：单向传输数据的停止等待ARQ协议</p>
<ul>
<li>发送方在数据帧中添加校验字段，发送之后启动超时定时器</li>
<li>接受方在接受数据之后利用校验码检查错误，出错就丢弃数据，校验无误的情况下发送确认帧</li>
<li>发送法收到确认帧，发送下一帧，重启定时器</li>
<li>如果发送方定时器超时，发送方重新发送刚发送的数据帧</li>
<li>在数据帧还携带一个序号，接受方根据序号来判断是否是重复发送的数据帧</li>
<li>确认帧中也携带序号，发送方通过序号确定是否是重复的确认帧</li>
</ul>
<p>‍那么确认帧是必须携带序号吗：</p>
<p>在确认帧发送比较缓慢的时候，缺少序号的确认帧就可能导致问题。</p>
<p><img src="computer-networks/./data-link-layer/2023-03-21-14-55-47-image.png?msec=1679391165957" alt="" /></p>
<p>因此确认帧是需要序号的，发送方通过序确认是否是重复的确认帧。</p>
<pre><code class="language-c">#define MAX_SEQ 1
typedef enum
{
    frame_arrival,
    cksum_err,
    timeout
} event_type;

#include "protocol.h"

void send()
{
    seq_nr next_frame_to_send;
    frame s;
    packet buffer;
    event_type event;

    next_frame_to_send = 0;
    from_network_layer(&amp;buffer);
    while (true)
    {
        s.info = buffer;
        s.seq = next_frame_to_send;
        to_physical_layer(&amp;s);
        start_timer(s.seq);
        wait_for_event(&amp;event);

        if (event == frame_arrival)
        {
            from_physical_layer(&amp;s);
            if (s.ack == next_frame_to_send)
            {
                stop_timer(s.ack);
                from_network_layer(&amp;buffer);
                next_frame_to_send = 1 - next_frame_to_send;
            }
        }
    }
}

void receive()
{
    seq_nr frame_expected;
    frame r, s;
    event_type event;

    frame_expected = 0;
    while (true)
    {
        wait_for_event(&amp;event);

        if (event == frame_arrival)
        {
            from_physical_layer(&amp;r);
            if (r.seq == frame_expected)
            {
                to_network_layer(&amp;r.info);
                frame_expected = 1 - frame_expected;
            }
            s.ack = 1 - frame_expected;
            to_physical_layer(&amp;s);
        }
    }
}
</code></pre>
<h5 id="协议4-实用的停止等待arq协议"><a class="header" href="#协议4-实用的停止等待arq协议">协议4 实用的停止等待ARQ协议</a></h5>
<p>设计原则：</p>
<ul>
<li>
<p>在数据帧中增加校验字段，发送帧之后启动超时定时器</p>
</li>
<li>
<p>接收方对于收到的数据进行校验，如果出错则丢弃，如果校验无错，就发送确认帧或者通过下一个帧进行捎带确认</p>
</li>
<li>
<p>收到确认之后发送下一帧，重启定时器</p>
</li>
<li>
<p>如果定时器超时，则重新发送刚发送的数据帧</p>
</li>
<li>
<p>数据帧中携带发送序号，根据需要判断是否需要是重复的数据帧</p>
</li>
<li>
<p>根据确认帧判断是否重复的确认帧</p>
</li>
</ul>
<p>捎带应答：</p>
<p>当收到一个数据帧时，不同于立刻发送一个确认帧，而是等待网络层给出下一个需要发送的数据包，并把确认帧附在需要发送的数据帧之后一同发送出去。</p>
<p>在这个过程中，发送方和确认方都需要维持一个滑动窗口。</p>
<pre><code class="language-c">#define MAX_SEQ 1
typedef enum
{
    frame_arrival,
    cksum_err,
    timeout
} event_type;

#include "protocol.h"

void protocol()
{
    seq_nr next_frame_to_send;
    seq_nr frame_expected;

    frame r, s;
    packet buffer;
    event_type event;

    from_network_layer(&amp;buffer);
    s.info = buffer;
    s.seq = next_frame_to_send;
    s.ack = 1 - frame_expected;
    to_physical_layer(&amp;s);
    start_timer(s.seq);

    while (true)
    {
        wait_for_event(&amp;event);

        if (event == frame_arrival)
        {
            from_physical_layer(&amp;r);

            if (r.seq = frame_expected)
            {
                to_network_layer(&amp;r.info);
                frame_expected = 1 - frame_expected;
            }

            if (r.ack == next_frame_to_send)
            {
                stop_timer(r.ack);
                from_network_layer(&amp;buffer);
                next_frame_to_send = 1 - next_frame_to_send;
            }

            s.info = buffer;
            s.seq = next_frame_to_send;
            s.ack = 1 - frame_expected;
            to_physical_layer(&amp;s);
            start_timer(s.seq);
        }
    }
}
</code></pre>
<p>但是这个协议的效率非常的低。</p>
<p>在大部分的时间里，使用这个协议的信道都被阻塞等待确认帧。</p>
<h5 id="协议5-回退n步协议"><a class="header" href="#协议5-回退n步协议">协议5 回退N步协议</a></h5>
<p>设计原则：</p>
<ul>
<li>
<p>发送方和接收方都需要维持一个滑动窗口：</p>
<p>发送窗口： 发送帧的缓冲队列</p>
<p>接受窗口：接受帧的缓冲队列</p>
</li>
<li>
<p>发送者将被允许在收到确认帧之前发送多个数据帧</p>
</li>
<li>
<p>如果接收方发现了传输错误，那么发送方必须回退到这个错误的帧重发进行纠错，已经发送的数据帧就废弃了</p>
</li>
</ul>
<p>‍发送窗口大小的约束：</p>
<p>当序号的位数只有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>时，假设发送窗口的大小达到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>。</p>
<p>如果发送方发送所有可以发送的帧，而接收方在接受所有的数据之后发送确认帧时失败了，但是此时接受者的序号和发送者的序号相同，接受者会把发送者重新发送的帧当作新发送的帧接受。</p>
<p><img src="computer-networks/./data-link-layer/2023-03-21-16-18-52-image.png?msec=1679391165968" alt="" /></p>
<p>‍因此该协议的发送窗口大小必须满足：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal">Win</span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.05764em;">wS</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7977em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>式子中的<code>n</code>表示序号的位数。</p>
<p>协议5的示例实现：</p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-05-39-image.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-07-39-image.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-07-52-image.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-08-08-image.png" alt="" /></p>
<h5 id="协议6-选择重传协议"><a class="header" href="#协议6-选择重传协议">协议6 选择重传协议</a></h5>
<p><code>Select Repeat/Select Reject</code>。</p>
<p>接收方的缓存大于1，可以接受乱序的帧，并且只要求重传错误的帧。</p>
<p>选择重传中对于窗口大小的限制：</p>
<ul>
<li>发送窗口和接受窗口大小之和不能大于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>:</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>
<p>发送窗口的大小大于接受窗口的大小</p>
</li>
<li>
<p>一般来说，取发送窗口和接受窗口大小为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
</ul>
<p>协议6相对于协议5的改进：</p>
<ul>
<li>
<p>设置确认帧定时器：</p>
<p>在收到数据帧之后，等待一段时间的回传帧以进行捎带确认。如果定时器超时还没有等到回传的数据，直接发送确认帧。</p>
<p>利用这种方式减少单独确认帧的发送，提高信道的使用效率。</p>
</li>
<li>
<p><code>NAK</code>帧：对于同一帧的错误，发送一次NAK</p>
<p>NAK帧的序号就是出错帧的序号。</p>
<p>帧接受之后校验出错和序号不对都算是出错。</p>
</li>
</ul>
<p>协议6的示例实现：</p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-49-16-image.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-55-14-image.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-55-37-Screenshot_20230324_105446.png" alt="" /></p>
<p><img src="computer-networks/./data-link-layer/2023-03-24-10-55-55-image.png" alt="" /></p>
<h4 id="协议效率的分析"><a class="header" href="#协议效率的分析">协议效率的分析</a></h4>
<p>为了比较不同的协议效率的不同，一般采用<strong>最大信道利用率</strong>来描述一个协议的效率。</p>
<h5 id="停等协议的效率"><a class="header" href="#停等协议的效率">停等协议的效率</a></h5>
<p>在发送过程中没有遇到错误，需要确认帧的情况下，发送数据帧的总时间：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">roc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">roc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>一般来说认为处理时间和发送确认帧的时间是可以忽略不计的，所以总的时间就是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>计算出信道利用率：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>因此当传播延迟<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>越小，信道的利用率越高。</p>
<p>再考虑传输中遇到错误的问题。假设每一帧遇到错误的概率为<code>p</code>，可以首先计算出传输出错的数量为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>不难发现测试的信道利用率就是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3991em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>引入一个概念——带宽时延积<code>BD</code>：在单程传播时延的时间内，信道可以容纳多少为的数据。带宽时延积还可以用传输时延<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>和发送时延来计算<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>上述协议的效率还可以写成：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>现在再研究具有滑动窗口的停等协议：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中<code>W</code>是发送窗口的大小，而且效率的最大值是1。</p>
<p>在考虑上捎带确认的功能，不用发送单独的确认帧，信道的效率还可以提高为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="示例协议"><a class="header" href="#示例协议">示例协议</a></h2>
<h3 id="hdlc"><a class="header" href="#hdlc">HDLC</a></h3>
<h4 id="hdlc-帧结构"><a class="header" href="#hdlc-帧结构">HDLC 帧结构</a></h4>
<ul>
<li>
<p>同步传输</p>
</li>
<li>
<p>以位为单位</p>
</li>
<li>
<p>可以点对点之间通信，也可以按照主从模型进行通信</p>
</li>
</ul>
<p><img src="computer-networks/./data-link-layer/2023-03-28-15-20-27-image.png" alt="" /></p>
<p>其中HDLC的帧还有三种类型：</p>
<ul>
<li>
<p>信息：需要传输给上一层的数据。</p>
<p>流量控制，错误纠正等的确认帧也在这部分</p>
</li>
<li>
<p>监督帧：当没有使用</p>
</li>
</ul>
<h3 id="ppp"><a class="header" href="#ppp">PPP</a></h3>
<ul>
<li>
<p>无连接的协议，没有确认帧</p>
</li>
<li>
<p>以字节为单元进行传输</p>
</li>
<li>
<p>只能进行点对点直接通信</p>
</li>
</ul>
<h4 id="ppp和hdlc之间的对比"><a class="header" href="#ppp和hdlc之间的对比">PPP和HDLC之间的对比</a></h4>
<p>总的来说就是更加简单。</p>
<p>PPP增加了：</p>
<ul>
<li>
<p>可以和多种网络协议共同工作</p>
</li>
<li>
<p>连接和数据压缩的协商</p>
</li>
<li>
<p>用户的身份认证</p>
</li>
<li>
<p>物理层可以使同步或者异步的</p>
</li>
</ul>
<p>同时PPP移除了：</p>
<ul>
<li>
<p>错误纠正，但是保留了错误发现</p>
</li>
<li>
<p>流量控制</p>
</li>
<li>
<p>序列号</p>
</li>
</ul>
<h4 id="pppoe"><a class="header" href="#pppoe">PPPoE</a></h4>
<blockquote>
<p>就是PPP over Ethernet，广泛用于家庭网络中</p>
</blockquote>
<p><img src="computer-networks/./data-link-layer/2023-03-28-15-50-11-image.png" alt="" /></p>
<ul>
<li>
<p>没有序号的帧结构</p>
</li>
<li>
<p>使用字节填充</p>
<p><code>0x7D</code>作为转义字符</p>
<p>在所有的ASCII控制字符（也就是<code>0x20</code>及其以下）之前都需要添加转义字符</p>
</li>
<li>
<p>地址<code>0xFF</code>表示所有用户都可以接受，但是由于是点对点通信，故实际意义不大</p>
</li>
<li>
<p>控制<code>0x03</code>表示使用无序号的模式</p>
</li>
<li>
<p>协议字段指明负载中使用的协议，比如IP</p>
</li>
<li>
<p>校验和，使用CRC校验，可以是16位或者是32位</p>
</li>
</ul>
<p>然后介绍一下PPP的状态转移图：</p>
<p><img src="computer-networks/./data-link-layer/2023-03-28-15-55-01-image.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="介质访问控制子层"><a class="header" href="#介质访问控制子层">介质访问控制子层</a></h1>
<h2 id="信道分配问题"><a class="header" href="#信道分配问题">信道分配问题</a></h2>
<p>一般来说，共享信道有着下面几种方式：</p>
<p><img src="computer-networks/./mac/2023-03-31-10-00-20-image.png" alt="" /></p>
<p>在图中：</p>
<ul>
<li>
<p><code>SDTM</code>表示<strong>同步</strong>时分复用</p>
<p>将时间分成不同的时间片，不同的设备轮流使用介质发送或者接受数据。每个设备都会得到固定长度的时间片供其使用，如果没有使用这个时间片就浪费了。</p>
</li>
<li>
<p><code>ADTM</code>表示<strong>异步</strong>时分复用，也被称作统计复用。</p>
</li>
</ul>
<p>对于局域网来说，静态信道分配（<code>FDM</code>、<code>STDM</code>）工作的并不良好。</p>
<p>为了说明为什么工作的不好，我们首先引入一个公式：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>在公式中：</p>
<ul>
<li>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>表示平均服务速度</p>
</li>
<li>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span>表示平均到达时间</p>
</li>
<li>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>表示平均等待时间</p>
</li>
</ul>
<p>如果信道被平均分配到<code>N</code>个静态的子信道：</p>
<p>通过公式可以计算出平均等待时间变成了原来的<code>N</code>倍。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4365em;vertical-align:-1.1151em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2299em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1151em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NT</span></span></span></span></span></p>
<p>而信道的平均服务速率和平均到达速率均变成了原来的<code>N</code>分之一。</p>
<p>因此静态信道分配表现并不好：</p>
<ul>
<li>
<p>如果信道被分配为多个子信道：</p>
<ul>
<li>
<p>FDM：延迟相对于原来大大增加</p>
</li>
<li>
<p>TDM：存在一些问题</p>
</li>
</ul>
</li>
<li>
<p>在面对互联网上常见的突发请求处理均不好</p>
</li>
</ul>
<p>因此我们常用动态信道分配。</p>
<h3 id="动态信道分配的分类"><a class="header" href="#动态信道分配的分类">动态信道分配的分类</a></h3>
<ul>
<li>
<p>随机访问</p>
<ul>
<li>
<p><code>ALOHA</code></p>
</li>
<li>
<p><code>CSMA</code>，<code>CSMA/CD</code>，<code>CSMA/CA</code></p>
</li>
</ul>
</li>
<li>
<p>控制访问</p>
<ul>
<li>
<p>中心化的控制：轮询</p>
</li>
<li>
<p>去中心化的控制：令牌</p>
</li>
</ul>
</li>
</ul>
<h3 id="动态信道分配中涉及的假设"><a class="header" href="#动态信道分配中涉及的假设">动态信道分配中涉及的假设</a></h3>
<ul>
<li>
<p>每个站点之间都是相互独立的，且是单用户系统</p>
</li>
<li>
<p>只用一个可用的信道</p>
</li>
<li>
<p>如果发送冲突则数据就废弃了</p>
</li>
<li>
<p>时间分配：</p>
<ul>
<li>
<p>连续时间分配：随时均可以占用信道时间</p>
</li>
<li>
<p>分时隙：必须等待一个周期（称作<strong>时隙</strong>）开始才能占用</p>
</li>
</ul>
</li>
<li>
<p>载波监听：发送之前能否判断信道是否被占用</p>
<ul>
<li>
<p>提供载波监听</p>
</li>
<li>
<p>没有载波监听</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>时间分配和载波监听都是设计协议时需要二选一的选项</p>
</blockquote>
<h2 id="介质访问协议"><a class="header" href="#介质访问协议">介质访问协议</a></h2>
<p>主要注意协议中是如何侦测冲突和从冲突中恢复的。</p>
<h3 id="aloha"><a class="header" href="#aloha">ALOHA</a></h3>
<h4 id="纯aloha-pure-aloha"><a class="header" href="#纯aloha-pure-aloha">纯ALOHA Pure ALOHA</a></h4>
<p>第一个提供介质访问控制功能的协议，简单但是富有研究价值。</p>
<p>不使用时隙机制和载波监听。</p>
<p>协议的基本设计就是依赖确认帧来判断是否发生冲突：</p>
<ul>
<li>
<p>每个站点不考虑是否冲突，在需要传输的时候直接发送数据帧</p>
</li>
<li>
<p>如果没收到确认帧就重复发送</p>
</li>
</ul>
<p><img src="computer-networks/./mac/2023-03-31-10-31-49-image.png" alt="" /></p>
<p>注意在流程图中，为了避免总是发生冲突，协议中设计了一个随机的等待时间<code>k</code>。</p>
<p>为了衡量不同协议的性能，首先引入一系列参数：</p>
<p>首先用<strong>帧时</strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示发送一个标准的、固定长度的帧需要的时间，同时假定站点产生的新帧符合一个帧时上产生<code>N</code>个帧的泊松分布，可以定义以下两个量表示协议的性能：</p>
<ul>
<li>
<p>吞吐量<code>S</code>，在一个帧时中成功传输的帧数</p>
</li>
<li>
<p>网络负载<code>P</code>，在一个帧时中到达的帧</p>
</li>
</ul>
<p>不难发现存在下面这个关系：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">成功传输</span><span class="mclose">)</span></span></span></span></span></p>
<p>一个帧被成功发送需要的条件是：在帧发送和传输的工程中没有帧到达。这段时间被称作<strong>脆弱期</strong>，这段时间的长度是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，利用这个值可以得出：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">18.4%</span></span></span></span></span></p>
<h4 id="含有时隙的aloha-slotted-aloha"><a class="header" href="#含有时隙的aloha-slotted-aloha">含有时隙的ALOHA Slotted ALOHA</a></h4>
<ul>
<li>
<p>将时间分成帧时长度的时隙</p>
</li>
<li>
<p>需要一个中央时钟，或者某种同步机制</p>
</li>
<li>
<p>传输必须在时隙开始时才能开始</p>
<p><img src="computer-networks/./mac/2023-03-31-10-48-04-image.png" alt="" /></p>
</li>
<li>
<p>这是帧发送的脆弱期变为原来的一半：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
</li>
</ul>
<p>改进之后的协议吞吐量变成了原来的两倍：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">36.8%</span></span></span></span></span></p>
<h3 id="载波监听多点访问"><a class="header" href="#载波监听多点访问">载波监听多点访问</a></h3>
<p>Carrier Sense Multiple Access Protocols，简称<code>CSMA</code>。</p>
<p>这种协议的基本设计思想是：在发送信息之前监听信道。</p>
<p>监听信道有着两种方式：</p>
<ul>
<li>
<p>坚持听：一直监听信道，直到空闲</p>
</li>
<li>
<p>周期监听：周期性的监听信道，直到发现空闲</p>
</li>
</ul>
<p>坚持听到发现信道空闲之后是否发送也有着两种方式：</p>
<ul>
<li>
<p>1坚持：遇到空闲直接发送</p>
</li>
<li>
<p>P坚持：以概率P决定是否发送还是继续监听</p>
</li>
</ul>
<p>这种协议的脆弱期就是信号在介质传播的时延。</p>
<p><img src="computer-networks/./mac/2023-03-31-11-03-00-image.png" alt="" /></p>
<h4 id="不同csma协议的比较"><a class="header" href="#不同csma协议的比较">不同CSMA协议的比较</a></h4>
<ul>
<li>
<p>1坚持的CSMA</p>
<p>当负载比较低的时候，吞吐量比较大且时延比较低。</p>
<p>当负载比较高的时候，吞吐量比较低。</p>
</li>
<li>
<p>非坚持的CSMA</p>
<p>当负载比较高的时候，吞吐量高。</p>
</li>
</ul>
<h3 id="带冲突检测的载波监听多路访问"><a class="header" href="#带冲突检测的载波监听多路访问">带冲突检测的载波监听多路访问</a></h3>
<p>CSMA with Collision Detection，简称CSMA/CD。</p>
<p>协议的基本思想：在发送数据的同时监听信道，如果发现冲突就停止发送。</p>
<ul>
<li>
<p>如果冲突被发现了，停止发送数据，发送一系列的<strong>强化信号</strong>提醒所有的站点冲突发生了</p>
</li>
<li>
<p>发送强化信号之后，等待一段随机的时间</p>
</li>
<li>
<p>这就构成了一个半双工的系统。准确的说，是物理层为全双工的，但是数据链路层是半双工的，站点只能出在接收模式或者发送模型。</p>
</li>
<li>
<p>节约了时间和带宽</p>
</li>
<li>
<p>是以太网的基础</p>
</li>
<li>
<p>这个协议没有设计确认帧</p>
</li>
<li>
<p>这个协议的争用期也是信号在介质中传播时延的两倍</p>
</li>
</ul>
<p>CSMA/CD协议有着三个状态：</p>
<ul>
<li>
<p>发送期<code>transmission</code></p>
</li>
<li>
<p>争用期<code>contention</code></p>
</li>
<li>
<p>空闲期<code>idle</code></p>
</li>
</ul>
<p>争用期这个状态比较复杂：</p>
<p><img src="computer-networks/./mac/2023-03-31-12-19-23-image.png" alt="" /></p>
<p><strong>争用时隙</strong>：一个站点最多需要两个传播时延才能发现错误，或者说如果在两个传播时延之内没有发现冲突，那么这次传输就不会发生冲突。</p>
<blockquote>
<p>这也是以太网中一个重要的网络参数。</p>
</blockquote>
<p>1-坚持的CSMA/CD重传的等待时间：</p>
<p>选择一个介于0到d之间的随机数k，在等待k时间之后检查介质是否空闲。</p>
<ul>
<li>
<p>如果此时的介质空闲，发送数据</p>
</li>
<li>
<p>如果此时介质不空闲，等待到介质空闲。</p>
</li>
</ul>
<p>如果在重发的过程中冲突再次发生，那么在此重复上述的过程。但是在过程中会记录重试的次数，如果超过一个最大的重发次数，就放弃这次重发。在这个过程中，最大等待时间都会增大到原来的两倍，这被称作<strong>指数退避算法</strong>。同时最大的等待时间可以设置一个最大值，例如增大到1024就不再增大了。</p>
<p>例如第一次等待的时间介于[0,1]之间，第二次等待就介于[0,3]之间，第n次等待就介于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>之间。</p>
<p>下面是描述CSMA/CD的流程图：</p>
<p><img src="computer-networks/./mac/2023-04-04-15-44-58-image.png" alt="" /></p>
<h4 id="几种介质访问协议的比较"><a class="header" href="#几种介质访问协议的比较">几种介质访问协议的比较</a></h4>
<div class="table-wrapper"><table><thead><tr><th>协议</th><th>如何避免冲突</th><th>如果判断冲突</th><th>解决冲突</th><th>脆弱期</th></tr></thead><tbody>
<tr><td>Pure ALOHA</td><td>完全不避免</td><td>定时器没收到确认</td><td>重新发送</td><td>2<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr>
<tr><td>Slotted ALOHA</td><td>只能在时隙开始时发送</td><td>同上</td><td>同上</td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr>
<tr><td>CSMA</td><td>发送前监听信道</td><td>同上</td><td>同上</td><td>传播时延的两倍</td></tr>
<tr><td>CSMA/CD</td><td>发送前监听信息</td><td>发送时监听信息</td><td>同上</td><td>传播时延的两倍</td></tr>
</tbody></table>
</div>
<h3 id="无冲突协议"><a class="header" href="#无冲突协议">无冲突协议</a></h3>
<p>无冲突协议主要有以下几种实现方式：</p>
<p><strong>轮训</strong><code>Polling</code>：</p>
<ul>
<li>
<p>用在HDLC协议中，在Wi-Fi和蓝牙中也具有一定的应用</p>
</li>
<li>
<p>具有一个中心控制器</p>
</li>
<li>
<p>中心控制器会依次询问每个站点</p>
</li>
</ul>
<p><strong>令牌传送</strong><code>Token Passing</code>:</p>
<ul>
<li>
<p>分布式的模型</p>
</li>
<li>
<p>令牌就是一个大小比较小的帧，代表发送消息的权限</p>
</li>
<li>
<p>一般来说使用令牌传送的网络都是一个环网，令牌在相邻的站点之间传递，只有“持有”令牌的站点有权发送数据</p>
</li>
<li>
<p>没有冲突</p>
</li>
</ul>
<h3 id="无线网络wlan"><a class="header" href="#无线网络wlan">无线网络WLAN</a></h3>
<p>无线网络中一般具有以下几种要素：</p>
<ul>
<li>
<p>无线主机：运行应用程序的终端设备，例如笔记本电脑和手机</p>
</li>
<li>
<p>基站：一般同有线网链接，负责在有限主机和无线主机之间转发数据，在<code>802.11</code>协议中也被称为接入点<code>access point</code></p>
</li>
<li>
<p>无线链接</p>
</li>
</ul>
<p>无线网络具有以下的特点：</p>
<ul>
<li>
<p>随着距离增加信号强度下降，传输的距离有限</p>
</li>
<li>
<p>全方位的传播</p>
</li>
<li>
<p>误码率比较大</p>
</li>
</ul>
<p>而且我们已经设计的协议，比如CSMA/CD，不太适用于无线网络之中。下面给出两个直接使用已有协议可能遇到的问题：</p>
<ol>
<li>
<p>隐蔽站问题</p>
<p><img src="computer-networks/./mac/2023-04-04-16-07-47-image.png" alt="" /></p>
</li>
<li>
<p>暴露站问题</p>
<p><img src="computer-networks/./mac/2023-04-04-16-08-46-image.png" alt="" /></p>
</li>
</ol>
<p>可以用来解决上述问题的方法：</p>
<ul>
<li>
<p>采用轮询的方式可以解决</p>
</li>
<li>
<p>分布协调方法：站点之间握手确定谁能发送。这种方式称作CSMA/CA，CSMA with Collsion Avoidance</p>
</li>
</ul>
<p>握手的过程：</p>
<ul>
<li>
<p>站点发送<code>RTS</code>帧给接收方</p>
</li>
<li>
<p>如果接收方可以接受，就返回<code>CTS</code>帧给发送方，发送法就可以开始发送</p>
</li>
<li>
<p>如果发送方没有收到<code>CTS</code>帧，那么等待一段随机长度的时间，重新发送<code>RTS</code>帧</p>
</li>
</ul>
<h2 id="局域网参考模型-ieee-802-rm"><a class="header" href="#局域网参考模型-ieee-802-rm">局域网参考模型 IEEE 802 RM</a></h2>
<p>局域网的特点：</p>
<ul>
<li>
<p>设备的数量有限</p>
</li>
<li>
<p>传输的速度较快</p>
</li>
<li>
<p>误码率比较低</p>
</li>
<li>
<p>支持广播和多播</p>
</li>
<li>
<p>只有单个管理站点</p>
</li>
</ul>
<p>局域网的拓扑模型：</p>
<ul>
<li>
<p>总线型</p>
</li>
<li>
<p>星形</p>
</li>
<li>
<p>环形</p>
</li>
<li>
<p>树形</p>
</li>
</ul>
<p>局域网常见的传输介质：</p>
<ul>
<li>双绞线</li>
<li>射频</li>
</ul>
<p>IEEE 802参考模型和<code>OSI</code>模型的对比大致如图所示：</p>
<p><img src="computer-networks/./mac/image-20230407095441071.png" alt="image-20230407095441071" /></p>
<p>其中参考模型规定了三个层：</p>
<ul>
<li>
<p>物理层：</p>
<p>需要处理编码和解码</p>
<p>直接传输位</p>
<p>传输介质和传输拓扑</p>
</li>
<li>
<p>介质访问控制子层</p>
<p>成帧控制、错误纠正、物理地址（<code>mac</code>地址）</p>
<p>使用同样的传输媒介</p>
<p>本地网络交换，虚拟本地网络</p>
</li>
<li>
<p>逻辑链路控制子层</p>
<p>向网络层提供统一的接口，隐藏不同mac子层不同的实现</p>
<p>流量控制和错误控制</p>
<p>通过网桥连接不同的本地网络</p>
</li>
</ul>
<h3 id="逻辑链路控制子层llc"><a class="header" href="#逻辑链路控制子层llc">逻辑链路控制子层<code>LLC</code></a></h3>
<p><code>LLC</code>一般向上提供这些功能：</p>
<ul>
<li>不可靠的数据报服务。例如<code>Ethernet</code></li>
<li>可靠的数据报服务，例如<code>WiFi</code></li>
<li>可靠的面向连接的服务，例如<code>Token Ring</code></li>
</ul>
<p><code>LLC</code>协议：</p>
<ul>
<li>一般都是基于<code>HDLC</code>协议，但是并不唯一</li>
<li>使用<code>LSAPs</code>提供多播</li>
</ul>
<h3 id="mac子层概述"><a class="header" href="#mac子层概述"><code>mac</code>子层概述</a></h3>
<ul>
<li>
<p>在发送端将地址、错误纠正和数据封装成帧</p>
</li>
<li>
<p>在接收端解包帧：</p>
<p>提供地址识别</p>
<p>提供错误侦测</p>
</li>
<li>
<p>控制对于传输介质的访问</p>
</li>
<li>
<p>对于相同的<code>LLC</code>层，可以使用不同的<code>mac</code>子层</p>
</li>
</ul>
<h3 id="本地网络中的协议封装"><a class="header" href="#本地网络中的协议封装">本地网络中的协议封装</a></h3>
<p><img src="computer-networks/./mac/image-20230407100919359.png" alt="image-20230407100919359" /></p>
<h3 id="ieee-802-协议概览"><a class="header" href="#ieee-802-协议概览">IEEE 802 协议概览</a></h3>
<p><img src="computer-networks/./mac/image-20230407101132273.png" alt="image-20230407101132273" /></p>
<p>可以发现很多IEEE一些不仅规定了物理层的部分也规定了<code>mac</code>子层的功能。</p>
<h2 id="ethernet"><a class="header" href="#ethernet">Ethernet</a></h2>
<p>首先是以太网的发展历史：</p>
<p><img src="computer-networks/./mac/image-20230407102005615.png" alt="image-20230407102005615" /></p>
<h3 id="传统以太网-物理层"><a class="header" href="#传统以太网-物理层">传统以太网 物理层</a></h3>
<h4 id="网卡"><a class="header" href="#网卡">网卡</a></h4>
<p>网卡<code>Network Interface cards</code>的功能：</p>
<ul>
<li>实现数据链路层和物理层</li>
<li>连接到主机的总线上</li>
</ul>
<p>每块网卡都有着一个唯一的<code>mac</code>地址。</p>
<h4 id="传统以太网-10mbps"><a class="header" href="#传统以太网-10mbps">传统以太网 10Mbps</a></h4>
<div class="table-wrapper"><table><thead><tr><th>名称</th><th>传输介质</th><th>最大传输距离</th><th>节点</th><th>优点</th></tr></thead><tbody>
<tr><td>10Base5</td><td>粗同轴电缆</td><td>500m</td><td>100</td><td>比较原始的电缆，目前已经被弃用</td></tr>
<tr><td>10Base2</td><td>细同轴电缆</td><td>185m</td><td>30</td><td>不需要集线器</td></tr>
<tr><td>10BaseT</td><td>双绞线</td><td>100m</td><td>1024</td><td>最便宜的系统</td></tr>
<tr><td>10BaseF</td><td>光纤</td><td>2000m</td><td>1024</td><td>在建筑物之间最好的系统</td></tr>
</tbody></table>
</div>
<h4 id="10baset"><a class="header" href="#10baset">10BaseT</a></h4>
<blockquote>
<p>目前较为常用的协议</p>
</blockquote>
<p>没用共享的链路，使用集线器将双绞线连接在一起。</p>
<p>使用<code>RJ-45</code>和<code>UTP5</code>作为传输介质：</p>
<ul>
<li>使用双绞线中的两对线，收发各一对</li>
<li>差分传输：一对线中的一根线用正电平传输信号，另外一根线用负电平传输同一信号，减少电磁干扰</li>
<li>同一对线绞合，减少近端干扰</li>
</ul>
<p>还有就是连线的标准：</p>
<p><img src="computer-networks/./mac/image-20230407103819452.png" alt="image-20230407103819452" /></p>
<p><img src="computer-networks/./mac/image-20230407103839333.png" alt="image-20230407103839333" /></p>
<p>其中在连接设备时，双绞线有两种连接方式：</p>
<ul>
<li>
<p>直连线：</p>
<p>两端使用相同的标准，用于将不同的设备，例如电脑和集线器之间连接：</p>
<p><img src="computer-networks/./mac/image-20230407104350754.png" alt="image-20230407104350754" /></p>
</li>
<li>
<p>交叉线：</p>
<p>两端使用不同的标准，用于链接相同的设备，例如电脑和电脑之间</p>
<p><img src="computer-networks/./mac/image-20230407104521382.png" alt="image-20230407104521382" /></p>
</li>
</ul>
<p>在系统中可以添加中继器以扩大覆盖范围：</p>
<ul>
<li>中继器是物理层协议</li>
<li>中继器负责放大信号，让信号可以传播更远的距离</li>
<li>可以扩大局域网的网段</li>
<li>每个局域网可以最大使用4个中继器</li>
</ul>
<blockquote>
<p>然而中继器已经是过时的技术了</p>
</blockquote>
<p>在系统中还有集线器：</p>
<ul>
<li>是一个多端口的中继器</li>
<li>在物理上是星形的链路，但是在逻辑上实现了总线的拓扑结果</li>
<li>支持多种速度的链路</li>
</ul>
<blockquote>
<p>现在集线器已经完全取代了中继器</p>
</blockquote>
<h3 id="传统以太网-mac子层"><a class="header" href="#传统以太网-mac子层">传统以太网 <code>MAC</code>子层</a></h3>
<p>采用<strong>广播</strong>链路，所有网络中的设备都能收到其他设备发送的数据帧，先校验地址是否为自己的地址，如果是就接收反之丢弃。</p>
<p><strong>帧间间隔<code>IFG</code></strong>：协议中要求每个帧之间需要留出规定的时间，对于<code>10BaseT</code>协议，帧间间隔规定为9.6 us。</p>
<blockquote>
<p>在实践中，帧间间隔可能比协议中要求的小</p>
</blockquote>
<p>在添加帧间间隔之后，1-坚持的<code>CSMA/CD</code>步骤就变为：</p>
<ol>
<li>监听信道是否空闲</li>
<li>如果空闲时间超过<code>IFG</code>，则发送</li>
<li>如果信道忙，持续监听</li>
<li>边发送边检测冲突</li>
<li>如果发现冲突，发送强化信号</li>
<li>收到强化信号，所有站点退避一段时间后重新监听信道</li>
</ol>
<h4 id="帧结构"><a class="header" href="#帧结构">帧结构</a></h4>
<p><img src="computer-networks/./mac/image-20230407111106098.png" alt="image-20230407111106098" /></p>
<ul>
<li>
<p>前导码<code>Preamble</code>：用于时钟同步功能，有物理层负责处理，不计入数据链路层</p>
</li>
<li>
<p>地址：<code>MAC</code>地址</p>
<p>6个字节，常常使用十六进制表示</p>
<p>前3个字节表示网卡的生产厂家，后3个字节表示该网卡厂家生产网卡的序列号，每个网卡是唯一的</p>
<p>利用<code>mac</code>地址还可以区分单播地址和多播地址</p>
</li>
<li>
<p>种类：表示传输的上层数据的协议种类</p>
</li>
<li>
<p>长度：表示<code>Data</code>字段和<code>Pad</code>字段的总共长度</p>
<p>数据字段有着一个最大值：1500字节</p>
<p>同时数据字段也有着一个<strong>最小值</strong>：46字节，这也就是为什么需要一个<code>Pad</code>字段</p>
<blockquote>
<p>整个帧的最大长度是1518字节</p>
</blockquote>
</li>
<li>
<p>校验和：<code>CRC</code>校验和，如果校验失败，这个帧就被丢弃</p>
</li>
</ul>
<blockquote>
<p>为什么需要设置帧的最小值？</p>
<p>为了让主机有足够的时间侦测冲突。这个值可以利用<strong>争用时隙</strong>这个参数计算出来：</p>
<p>在最大长度为<code>2500m</code>和4个中继器的<code>10Mbps</code>网络中，传播时延<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 大概是<code>25.6us</code> ，而<code>CSMA/CD</code>的争用时隙长度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">51.2</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span></span></span></span>，可以计算出在争用时隙中可以发送的数据包长度就是<code>64B</code>，所以数据字段长度的最小值就是46字节。</p>
</blockquote>
<h3 id="以太网性能分析"><a class="header" href="#以太网性能分析">以太网性能分析</a></h3>
<p>为了进行i性能分析，首先假设信道上具有较重和稳定的负载，例如总有<code>k</code>个站点准备发送，而重传的概率为一个常数。</p>
<p>于是通过理论推导可以得到一个信道利用效率的表达式：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">cy</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4288em;vertical-align:-1.1073em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2377em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1073em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
在公式中，<code>L</code>表示信道的长度，<code>c</code>表示信道中信号的传输速度，<code>B</code>表示信道的带宽，<code>F</code>表示单个数据帧的长度。</p>
<p>总的来说，为了获得比较高的信道利用率，帧不能太长，电缆不能太长。</p>
<p><img src="computer-networks/./mac/image-20230411150217519.png" alt="image-20230411150217519" /></p>
<p>为了提高以太网的传输速度，我们可以采用这些错误：</p>
<ul>
<li>
<p>通过减少冲突：</p>
<ul>
<li>
<p>使用交换式局域网而不是共享式局域网</p>
</li>
<li>
<p>降低在同一个局域网中计算机设备的数量</p>
<p>使用网桥将不同的局域网链接</p>
</li>
</ul>
</li>
<li>
<p>提高数据传输速率</p>
<ul>
<li>使用吉比特以太网</li>
</ul>
</li>
</ul>
<h3 id="交换式以太网"><a class="header" href="#交换式以太网">交换式以太网</a></h3>
<ul>
<li>使用中心的交换机替代原有局域网中的集线器</li>
<li>交换机只将数据帧转发到确定的输出线路上</li>
<li>没有被使用的线路可以用来传送不同的信号，这就允许量同时的多方传输</li>
<li>大幅提高了局域网的带宽，如果局域网中接入了<code>2N</code>个端口，那么带宽将被提升为原来的<code>N</code>倍</li>
<li>这种方式也比传统的局域网更加安全</li>
</ul>
<blockquote>
<p>注意需要区分冲突域和广播域：广播域是发送广播包可以收到相关包的所有主机的结合，冲突域是会发送冲突的一系列计算机的集合。</p>
</blockquote>
<p>在交换机网络中，交换器没有使用<code>CSMA/CD</code>协议。但是如果交换机下面直接链接了集线器，那么仍然会发生冲突，<code>CSMA/CS</code>协议仍然被需要。</p>
<h3 id="快速以太网"><a class="header" href="#快速以太网">快速以太网</a></h3>
<ul>
<li>保持了传统以太网的帧结构，网卡和其他文本上规则。</li>
<li>将比特时间从之前的<code>100ns</code>调整到<code>10ns</code></li>
<li>最小帧大小没有变化</li>
<li>所有的快速以太网设备都需要使用集线器和交换机</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Code</th><th>Max-Segment</th><th>Advangages</th></tr></thead><tbody>
<tr><td>100BaseT4</td><td>Twisted Pair</td><td>100m</td><td>使用CAT3等级的双绞线</td></tr>
<tr><td>100Base-TX</td><td>Twisted Pair</td><td>100m</td><td>100<code>Mpbs</code>全双工</td></tr>
<tr><td>100Base-FX</td><td>光纤</td><td>2000m</td><td>1000<code>Mbps</code>全双工</td></tr>
</tbody></table>
</div>
<h4 id="100base-t4"><a class="header" href="#100base-t4">100Base-T4</a></h4>
<ul>
<li>
<p>使用25<code>MHz</code>的信号速率</p>
</li>
<li>
<p>需要双绞线中的四对线</p>
<p>其中有两对的传输方向固定，而另外两对的传输方向可以切换，总的来说是半双工的</p>
</li>
<li>
<p>不能使用曼彻斯特编码</p>
</li>
</ul>
<h4 id="100base-tx"><a class="header" href="#100base-tx">100Base-TX</a></h4>
<ul>
<li>
<p>使用125<code>MHz</code>的信号速率</p>
</li>
<li>
<p>需要双绞线中的两对线</p>
<p>传输方向固定，全双工</p>
</li>
</ul>
<p><img src="computer-networks/./mac/image-20230411153425783.png" alt="image-20230411153425783" /></p>
<p>快速以太网还提供了速率协商的功能，可以同网络中的设备协商传输速度和全/半双工，提供了向上的兼容性。</p>
<h3 id="吉比特以太网"><a class="header" href="#吉比特以太网">吉比特以太网</a></h3>
<ul>
<li>再次将以太网的传输速度提高了一倍</li>
<li>仍然保持了对以前以前以太网标准的支持</li>
<li>同时允许了点对点链接和共享广播链接</li>
</ul>
<h4 id="交换机"><a class="header" href="#交换机">交换机</a></h4>
<p>由于此时交换机的存在，以太网工作在全双工模式，<code>CSMA/CD</code>协议也不用了，最大的传输距离基本值取决于信号的强度。</p>
<h4 id="集线器"><a class="header" href="#集线器">集线器</a></h4>
<p>由于集线器仍然是构成总线型的网络，冲突可能会产生，于是<code>CSMA/CD</code>协议是需要的。</p>
<p>但是由于传输的速度过快，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>的时间十分短，冲突检测就变得比困难，目前有两种方式可以解决：</p>
<ul>
<li>
<p>载波扩展<code>Carrier extension</code></p>
<p>将不同长度的帧都扩展到512字节的长度</p>
</li>
<li>
<p>帧突发<code>Frame bursting</code></p>
<p>允许发送方在一次发送中发送连续的许多帧</p>
</li>
</ul>
<p><img src="computer-networks/./mac/image-20230411155604070.png" alt="image-20230411155604070" /></p>
<h4 id="流量控制-1"><a class="header" href="#流量控制-1">流量控制</a></h4>
<p>由于发送速度较快，使得即使是较短时间的暂停就很容易导致缓冲溢出。</p>
<p>因此在快速以太网和吉比特以太网中，引入了特殊的控制帧，发送这个帧可以让其他的终端暂停发送一段时间。</p>
<p><img src="computer-networks/./mac/image-20230411160049286.png" alt="image-20230411160049286" /></p>
<h2 id="无线局域网"><a class="header" href="#无线局域网">无线局域网</a></h2>
<h3 id="无线连接的相关标准"><a class="header" href="#无线连接的相关标准">无线连接的相关标准</a></h3>
<p><img src="computer-networks/./mac/image-20230411160305108.png" alt="image-20230411160305108" /></p>
<h3 id="无线局域网基础架构"><a class="header" href="#无线局域网基础架构">无线局域网：基础架构</a></h3>
<p><img src="computer-networks/./mac/image-20230411160424049.png" alt="image-20230411160424049" /></p>
<h3 id="无线网络自组织模式"><a class="header" href="#无线网络自组织模式">无线网络：自组织模式</a></h3>
<p><img src="computer-networks/./mac/image-20230411160510207.png" alt="image-20230411160510207" /></p>
<p>即没有独立的基站，利用不同的节点本身的信号发送能力将信号发送到附近的节点。</p>
<p>节点们自行组成一个独立的网络。</p>
<h3 id="ieee-80211-wi-fi"><a class="header" href="#ieee-80211-wi-fi">IEEE 802.11 Wi-Fi</a></h3>
<h4 id="物理层协议"><a class="header" href="#物理层协议">物理层协议</a></h4>
<p><img src="computer-networks/./mac/image-20230411160720360.png" alt="image-20230411160720360" /></p>
<h4 id="mac子层"><a class="header" href="#mac子层">MAC子层</a></h4>
<p>如何避免数据冲突：</p>
<ul>
<li>
<p>此时冲突侦测机制已经失效</p>
<p>当信号比较微弱时，难以收到冲突信号</p>
<p>”隐藏基站“问题</p>
</li>
<li>
<p>使用中心化的解决方案：<code>PCF</code>点协调功能</p>
</li>
<li>
<p>使用去中心化的解决方案：<code>DCF</code>分布协调功能</p>
<p>也就是<code>CSMA/CA</code></p>
</li>
</ul>
<p><code>CSMA/CA</code>协议的具体设计如下：</p>
<p>核心思想：不同正在信道上传输的信号发生冲突。</p>
<ul>
<li>单独的确认帧</li>
<li>指数退避算法</li>
<li>可选的冲突避免：<code>RTS</code>和<code>CTS</code></li>
</ul>
<p><img src="computer-networks/./mac/image-20230411161524813.png" alt="image-20230411161524813" /></p>
<p>首先引入两个时间：</p>
<ul>
<li><code>DIFS</code>：<code>DCF</code>帧间间隔</li>
<li><code>SIFS</code>：短帧间间隔</li>
</ul>
<p>首先对于发送方：</p>
<ul>
<li>当发现信道空闲的时间超过<code>DIFS</code>时，发送方发送数据</li>
<li>当信道忙时，启动随机的退避定时器（但是此时定时器不走）。如果检测到信道空闲，开始减小定时器，在定时器到时间时发送。如果没有收到确认帧，还需要延长退避的时间。</li>
</ul>
<p>对于接收方：</p>
<p>如果一个帧接受没有问题，在等待一个<code>SIFS</code>之后发送确认帧。</p>
<p><img src="computer-networks/./mac/image-20230411162147984.png" alt="image-20230411162147984" /></p>
<p>但是上述的设计还没有解决”隐蔽站“和”暴露站“的问题。802.11使用<code>RTS/CTS</code>和<code>NAV</code>来解决这种，其中<code>RTS/CTS</code>是可选的。</p>
<p>网络分配向量<code>NAV</code>是一种<strong>虚拟监听</strong>机制。每个帧都会包括一个<code>NAV</code>字段，告知其他的站点这个帧的序列会占用信道多长的时间。所有的站点都会跟踪这个<code>NAV</code>字段来确定信道是否处于忙碌状态。</p>
<blockquote>
<p>由于这不是通过直接监听信道完成的，所以被称为虚拟监听。</p>
</blockquote>
<p><img src="computer-networks/./mac/image-20230414100027730.png" alt="image-20230414100027730" /></p>
<p>802.11还设计了一种分段突发机制。由于随着帧的长度变长，帧在传输的过程中遇到错误的概率就越大。这个分段突发的机制允许发送方在发送数据的时候将比较长的帧划分为较短的帧，每个短帧都会被当作独立的帧进行处理。</p>
<p>在802.11e中还引入了一种优先级控制系统，可以让优先级较高的帧得到优先发送。这个系统是通过设置不同的帧间间隔来实现的。</p>
<p><img src="computer-networks/./mac/image-20230414101300948.png" alt="image-20230414101300948" /></p>
<p>下面这张流程图表示了<code>CSMA/CA</code>的大致工作流程。</p>
<p><img src="computer-networks/./mac/image-20230414101025015.png" alt="image-20230414101025015" /></p>
<p>当Wi-Fi网络中同时存在高速设备和低速设备时，如果每个站点每次只能发送一个帧，那么快速站点的速度就会被慢速站点的速度严重拖慢，所以Wi-Fi协议引入了一个<code>TXOP</code>发送机会的概念，每个站点都能得到平均的时间，而不是平均的帧发送个数。</p>
<p>下面介绍Wi-Fi协议中帧的结构：</p>
<p><img src="computer-networks/./mac/image-20230414101952484.png" alt="image-20230414101952484" /></p>
<p>这里帧同以太网中帧的不同有：</p>
<ul>
<li>帧的长度更长</li>
<li>数据字段没有了最小的限制</li>
</ul>
<p>帧中有着三个地址字段，其中第一个地址是接受帧的主机地址，第二个地址是发送方的地址，第三个地址是路由的地址。</p>
<h3 id="80215-蓝牙"><a class="header" href="#80215-蓝牙">802.15 蓝牙</a></h3>
<p>主要在个域网中使用的短距离通信协议，一般都在10米范围内使用。蓝牙都是工作在<code>Ad Hoc</code>模式，没有其他的基础设施。</p>
<p>蓝牙也可以通过<code>Master/Slave</code>模式构成一个局域网。</p>
<h2 id="数据链路层交换"><a class="header" href="#数据链路层交换">数据链路层交换</a></h2>
<p>为什么需要将多个局域网连接起来：</p>
<ul>
<li>局域网之间相互交流的需求</li>
<li>不同局域网之间物理距离比较大，不能构成同一个局域网</li>
<li>将多个局域网划分为多个冲突域，减少冲突</li>
<li>隔离设备故障</li>
</ul>
<p><img src="computer-networks/./mac/image-20230414104544146.png" alt="image-20230414104544146" /></p>
<h3 id="网桥"><a class="header" href="#网桥">网桥</a></h3>
<p><strong>网桥</strong>是在数据链路层将多个局域网相互连接的设备。</p>
<p>帧从一个局域网发送到另一个局域网时，网桥将根据<code>mac</code>地址在不更改帧的情况下直接转发。</p>
<p>在两个局域网使用的协议不同时，例如Wi-Fi和以太网中，在转发的过程中网桥还会负责协议的转换，数据的重新封装。</p>
<p>在网桥设计的过程中，还有下面这些问题：</p>
<ul>
<li>不同的局域网具有不同的帧格式</li>
<li>不同的局域网工作在不同的速率</li>
<li>不同的局域网具有不同的最大帧大小</li>
<li>安全原因：Wi-Fi网络支持通信加密但是以太网不支持</li>
<li>在使用网桥之后延迟会增加</li>
<li>没有流量控制功能</li>
<li>广播风暴问题没法解决，难以保证服务质量</li>
</ul>
<p>那么在转发的过程中，网桥如何知道网络地址在那个局域网？网桥是通过自我学习来构建这张查找表的，这种网桥也被称为<strong>透明网桥</strong>。这个网桥即插即用，在混杂模式之下工作。</p>
<p>转发的过程大致如下：</p>
<p>网桥收到一个帧，查表得到目的端口：</p>
<ul>
<li>如果目的端口和接收到的端口相同，直接忽略</li>
<li>如果目的端口和接收到的端口不同，转发</li>
<li>如果没找到目的端口或者是广播地址，转发到全部的端口<code>flooding</code>（当然接受到的端口就不转发了）。</li>
</ul>
<p>网桥自我学习的过程是一个<strong>逆向学习</strong>的过程：</p>
<ul>
<li>当设备启动的时候，查找表中没有内容</li>
<li>当网桥收到帧时，网桥就能够通过帧中的发送方地址和接受到这个帧的端口号确定发送方就是在这个端口对应的网络上，把记录写入查找表中</li>
</ul>
<p>在<code>MAC</code>查找表中还有这些值得注意的地方：</p>
<ul>
<li>和<code>ip</code>地址不同，<code>mac</code>地址是本地的</li>
<li>查找表也是本地的，只在一个子网的内部使用</li>
<li>构建查找表在构建到路由之后就不再向外部构建了</li>
</ul>
<h3 id="生成树网桥"><a class="header" href="#生成树网桥">生成树网桥</a></h3>
<p>生成树网桥是不同于学习网桥的一种网桥。</p>
<p>生成树网桥的出现主要是为了解决以下两个问题：</p>
<ul>
<li>为了提高可靠性，两个局域网之间可能使用多个网桥相连</li>
<li>当局域网比较复杂的时候，在网络拓扑图中可能会存在环形结构</li>
</ul>
<p><code>IEEE 802.1d</code>规定了一种构建生成树的分布式算法：</p>
<ul>
<li>每个网桥会周期性的广播自己的识别码（通常基于网桥自己的<code>mac</code>地址）</li>
<li>拥有最小识别码的网桥将自动成为生成树的根</li>
<li>算法将自动构建一个从根到每个网桥和设备的最短路径树</li>
<li>算法会在网络拓扑结构改变时自动重新生成树</li>
</ul>
<h3 id="互联设备的总结"><a class="header" href="#互联设备的总结">互联设备的总结</a></h3>
<p>不同互联设备的冲突域有着非常大的不同：</p>
<p><img src="computer-networks/./mac/image-20230418145812642.png" alt="image-20230418145812642" /></p>
<h4 id="网桥和交换机的对比"><a class="header" href="#网桥和交换机的对比">网桥和交换机的对比</a></h4>
<p>网桥的帧转发是通过软件实现的，而交换机常常通过硬件实现。</p>
<p>网桥通常同时只能分析和转发一个帧，交换机可以同时在多个端口上处理多个帧</p>
<p>网桥使用”存储-转发“策略而交换机使用直通策略。</p>
<p>网桥在商业上失败了。</p>
<h4 id="广播域"><a class="header" href="#广播域">广播域</a></h4>
<p>能够收到<code>FF-FF-FF-FF-FF-FF</code>广播地址包的设备构成一个广播域。</p>
<p>所有连接在同一个局域网上的设备都处在同一广播域。</p>
<blockquote>
<p>注意广播域和冲突域的区别。</p>
</blockquote>
<h2 id="虚拟局域网"><a class="header" href="#虚拟局域网">虚拟局域网</a></h2>
<p>在物理局域网中构建出虚拟的逻辑局域网，用于自己的广播域。</p>
<p>使用虚拟局域网主要解决以下几个问题：</p>
<ul>
<li>安全</li>
<li>避免广播风暴。</li>
<li>利用软件即可搭建新的逻辑局域网，减少了直接连接线路的成本开支。</li>
</ul>
<p>物理网桥/交换机使用<code>VLAN ID</code>来区别不同虚拟交换机。</p>
<p>物理网桥和交换机通过<code>VLAN ID</code>知道下面三种信息中的一种：</p>
<ul>
<li>同这个ID相连接的端口</li>
<li>同这个ID相连接的<code>mac</code>地址</li>
<li>同这个ID相连接的网络层协议和地址</li>
</ul>
<p><code>IEEE 802.1Q</code>协议规定了支持虚拟局域网的帧类型：</p>
<p><img src="computer-networks/./mac/image-20230418152058824.png" alt="image-20230418152058824" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="网络层-1"><a class="header" href="#网络层-1">网络层</a></h1>
<h2 id="网络层的位置和功能"><a class="header" href="#网络层的位置和功能">网络层的位置和功能</a></h2>
<p><img src="computer-networks/./network-layer/image-20230418155555180.png" alt="image-20230418155555180" /></p>
<p>网络层是处理端到端传输的最底层。</p>
<blockquote>
<p>"跳"的概念：</p>
<p>相邻的主机和路由器之间，相邻的路由器之间的一次传输就是一跳。</p>
<p>在一跳内的传输石油数据链路层来实现的。</p>
</blockquote>
<p>一般来说，网络层具有以下这些功能：</p>
<ol>
<li>
<p>网络互联<code>Internetworking</code>。</p>
<p>不同的网络可能具有不同的网络地址、实现技术，包格式。网络层需要处理这个不同并向上提供统一的接口。</p>
</li>
<li>
<p>编址<code>Addressing</code></p>
<p>不同的网络主机之间需要统一的地址进行通信。</p>
</li>
<li>
<p>路由<code>Routing</code></p>
<p>为了将包发送到目的的，需要决定这个数据包的下一跳，工作在第三层的路由器实现了这个功能。</p>
</li>
<li>
<p>封包<code>Packetizing</code></p>
<p>将上一层需要传输的数据封装成统一的包。</p>
</li>
<li>
<p>分片/分段<code>Fragmenting</code></p>
<p>不同的数据链路层网络支持的最大数据长度不同。</p>
<p>网络层需要将上层传输过长的包切分成合乎长度的分片，并在传输结束之后再次拼接起来。</p>
</li>
</ol>
<h3 id="在不同位置的网络层功能"><a class="header" href="#在不同位置的网络层功能">在不同位置的网络层功能</a></h3>
<ol>
<li>
<p>发送方：</p>
<p>在发送者处，网络层创建一个包含发送地址，目的地址，数据的包。</p>
<p>网络层还会检查路由表确定这个网络包下一跳需要前往的地址。</p>
</li>
<li>
<p>路由：</p>
<p>在路由处的网络层负责决定数据包下一跳前往的位置：</p>
<p>当一个数据包到达时，网络层会检查路由表确定这个数据包会前往哪个网络接口。</p>
</li>
<li>
<p>这里的网络层负责检查数据包的目的地址和当前主机的地址一致。</p>
</li>
</ol>
<p>网络层向上层提供的服务：</p>
<ul>
<li>同路由技术独立</li>
<li>传输层将对路由完全透明</li>
<li>传输层获得的地址是统一的，甚至是在局域网和广域网中</li>
</ul>
<h3 id="网络层提供的服务"><a class="header" href="#网络层提供的服务">网络层提供的服务</a></h3>
<p>网络层提供了面向连接和无连接两种服务。</p>
<p>网络层使用分组交换提供了：</p>
<ul>
<li>面向连接的网络：虚电路</li>
<li>无连接的网络：数据报</li>
</ul>
<h4 id="数据报网络"><a class="header" href="#数据报网络">数据报网络</a></h4>
<p><img src="computer-networks/./network-layer/image-20230421100815673.png" alt="image-20230421100815673" /></p>
<p>在数据包中需要携带目的地的完整地址，在到达每个路由时，路由通过路由表决定下一跳的位置。</p>
<p>每个包经过的路径可能是不一致的，因此包的到达可能是乱序的。</p>
<h4 id="虚电路网络"><a class="header" href="#虚电路网络">虚电路网络</a></h4>
<p><img src="computer-networks/./network-layer/image-20230421101209514.png" alt="image-20230421101209514" /></p>
<p>是链路交换网络和数据报网络之间的一种网络，提供了面向连接的服务。</p>
<p>在数据开始传输的时候，网络会建立一条端到端的虚拟电路。</p>
<p>在传输的过程中，网络使用虚拟电路地址<code>Virtual Circuit Identifier</code>用作地址的标示，但是比标准的地址短得多。</p>
<p>在传输的过程中，数据包将按顺序到达。</p>
<h2 id="路由算法"><a class="header" href="#路由算法">路由算法</a></h2>
<h3 id="路由的概念和路由表"><a class="header" href="#路由的概念和路由表">路由的概念和路由表</a></h3>
<p>互联网就是通过路由将数量庞大的局域网连接起来的网络，因此当互联网上一个包从发送方传输到接收方时，可能会经过相当数量的路由。</p>
<p>在数据包经过路由器时，路由器会通过<strong>路由表</strong>决定包应该被转发到哪个接口，因此路由表最好能够决定包转发的最佳路径。</p>
<p>在查询路由表时，我们还希望路由表的大小时可以控制的，否则难以管理。</p>
<p>路由表一般情况下可以分成两种：</p>
<ol>
<li>
<p>静态路由：不会经常改变的路由。</p>
<p>静态路由常常是手动管理的，往往保持不变。</p>
</li>
<li>
<p>动态路由：在网络中发生变化时会自动发生变化的路由表。</p>
<p>动态路由将通过动态路由协议<code>RIP</code>，<code>OSPF</code>，<code>BGP</code>定时或者在必要时自动更改。</p>
</li>
</ol>
<p>在路由表中有两个重要的概念：</p>
<ul>
<li>
<p>路由算法：用来构建和更新路由表的算法</p>
<p>常见的路由算法有：<code>DVR</code>，<code>LSR</code>，<code>PVR</code></p>
</li>
<li>
<p>路由协议：用于往路由之间相互通知的一组规则和流程。</p>
<p>常见的路由协议有：<code>RIP</code>，<code>OSPF</code>，<code>BGP</code></p>
</li>
</ul>
<h3 id="设计路由算法的原则"><a class="header" href="#设计路由算法的原则">设计路由算法的原则</a></h3>
<ul>
<li>
<p>正确性</p>
</li>
<li>
<p>简单型</p>
</li>
<li>
<p>鲁棒性</p>
</li>
<li>
<p>健壮性</p>
</li>
<li>
<p>公平性</p>
</li>
<li>
<p>高效性</p>
<p>转发延迟最小，网络吞吐量最大</p>
</li>
</ul>
<p>主要的路由策略有下面这几种：</p>
<ul>
<li>
<p>固定查表路由<code>Fixed Routing</code></p>
<p>从源到目的的简单固定映射</p>
</li>
<li>
<p>洪泛<code>Flooding</code></p>
<p>将包发送给所有邻近的设备</p>
</li>
<li>
<p>随机选路<code>Random Routing</code></p>
<p>随机选择一条发送的线路</p>
</li>
<li>
<p>自适应线路</p>
<p>当网络变化时自动改变路由表，但是需要网络的信息</p>
</li>
</ul>
<h3 id="洪泛"><a class="header" href="#洪泛">洪泛</a></h3>
<p>洪泛的设计思想：</p>
<ul>
<li>不需要路由表</li>
<li>不需要网络中的信息</li>
<li>收到的包将被发送到处理接受端口之外的所有端口</li>
<li>最终可能会一个包多个相同副本到达目的地</li>
</ul>
<p>但是，洪泛存在一种严重的问题：会产生巨大数量的重复数据包。</p>
<p>为了解决这个问题，人们提出了两种解决方案：</p>
<ol>
<li>
<p>每个数据包的包头中包括一个<strong>跳计数器</strong></p>
<p>每一跳，这个跳计数器都会被减一。</p>
<p>当这个跳计数器到达0时，这个包就会被丢弃。</p>
<p>发送方会利用从源地址到目的地址的长度或者子网的网络半径<code>subnet diameter</code>来初始化跳计数器。</p>
</li>
<li>
<p>发送方在数据包的包头中设置<strong>序列号</strong></p>
<p>每个路由都会记录每个发送方目前最大的序列表，表示这个序列号都已经通过该路由。</p>
</li>
</ol>
<p>洪泛具有以下这些特点：</p>
<ul>
<li>
<p>非常的可靠</p>
</li>
<li>
<p>至少有一个数据包会按照最短的路由达到目的地</p>
</li>
<li>
<p>网络中所有的节点都会被到达</p>
<p>这就表明洪泛虽然在实际中可能不使用，但是在建立路由表的过程中可能会非常有用。</p>
</li>
</ul>
<h3 id="最短路径选路"><a class="header" href="#最短路径选路">最短路径选路</a></h3>
<p>首先利用<strong>有向有权图</strong>来表示网络的结构。</p>
<p>其中网络拓扑图中的权可以具有多种含义：</p>
<ul>
<li>跳数</li>
<li>路由器之间的物理距离</li>
<li>平均传输时延</li>
<li>，，，，</li>
</ul>
<p>然后利用<code>Dijkstra</code>算法在这个有向有权图中构建两个路由之间的最短路径。</p>
<blockquote>
<p>上面介绍的两种路由算法，在严格意义上都属于路由思想，在实际中并不能工作。</p>
</blockquote>
<h3 id="距离矢量选路distance-vector-routing"><a class="header" href="#距离矢量选路distance-vector-routing">距离矢量选路<code>Distance Vector Routing</code></a></h3>
<p>每个路由都会维持一个路由表：</p>
<ul>
<li>到其他路由的最短距离</li>
<li>下一跳使用的接口</li>
</ul>
<p>这个路由表将会通过和响铃的路由器交换信号来更新数据。</p>
<ul>
<li>
<p>路由会按照<code>Destination, Distance</code>的格式周期性的发送自己的路由信息</p>
</li>
<li>
<p>当其他的路由器收到这一信息：</p>
<p>如果发现了更好的路由路径，路由器会更新自己的路由表</p>
<p>刷新已经存在的路由表</p>
</li>
<li>
<p>如果在一段时间之后都没有收到某一个路由器发送的信息，就把这个路由从路由表中删除</p>
</li>
</ul>
<p>下面是一个网络中路由表建立的过程：</p>
<p>首先是各个路由中路由表的初始状态：只有相邻路由的信息：</p>
<p><img src="computer-networks/./network-layer/image-20230421110829015.png" alt="image-20230421110829015" /></p>
<p>然后路由表进行第一次迭代：节点A收到了节点C发送的信息：</p>
<p><img src="computer-networks/./network-layer/image-20230421110917961.png" alt="image-20230421110917961" /></p>
<p>节点A收到了节点B发送的信息：</p>
<p><img src="computer-networks/./network-layer/image-20230421111028776.png" alt="image-20230421111028776" /></p>
<p>由此在第一次迭代结束之后，各个节点的路由表已经变成了这个样子：</p>
<p><img src="computer-networks/./network-layer/image-20230421111149359.png" alt="image-20230421111149359" /></p>
<p>然后路由表之间进行第二次迭代：</p>
<p><img src="computer-networks/./network-layer/image-20230421111439317.png" alt="image-20230421111439317" /></p>
<p>然后路由表之间进行第三次迭代：</p>
<p><img src="computer-networks/./network-layer/image-20230421111547025.png" alt="image-20230421111547025" /></p>
<p>当迭代之后，路由表不发生变化之后，算法就认为构建结束，算法退出。</p>
<p><code>DVR</code>算法有着这些特点和问题：</p>
<ul>
<li>基于邻近节点共享的信号构建/更新路由表</li>
<li>特点：
<ul>
<li>同邻近节点分享整个网络的信息（到所有节点的最短距离）</li>
<li>只同初始的邻近节点共享信息</li>
<li>在固定的间隔共享信息</li>
</ul>
</li>
<li>缺点：
<ul>
<li>构建路由表需要的迭代次数多</li>
<li>”好消息“迅速传遍整个网络，”坏消息“传得慢</li>
</ul>
</li>
</ul>
<p>在<code>DVR</code>算法中存在一个严重的问题——无穷计数问题。</p>
<blockquote>
<p>也被称为”无穷循环</p>
</blockquote>
<p><img src="computer-networks/./network-layer/image-20230421162218139.png" alt="image-20230421162218139" /></p>
<p>大致意思就是在节点A下线之后，但是链路上节点不能正确的获得这条消息。这是因为在路由之间相互传递消息的过程中，只传递了距离信息没有传递路径信息，就会在传递的过程中发生循环。在这里，第一次节点B认为通过节点C可以到达节点C，第二次节点C又认为通过节点B可以到达节点A，，，，如此循环下去，算法不会停止。</p>
<h3 id="链路状态选路link-state-routing"><a class="header" href="#链路状态选路link-state-routing">链路状态选路<code>Link State Routing</code></a></h3>
<p>路由器将同网络中的所有其他路由器分享自己得到的信息；在路由本地构建好已知的最好路由拓扑图之后，路由会发送一个链路状态包<code>Link State Packet</code>来通知网络中的所有路由。这种分享主要有三个重点：</p>
<ul>
<li>会分享整个网络的拓扑结果</li>
<li>会向网络中的所有路由分享</li>
<li>在发生改变的时候也进行分享</li>
</ul>
<h4 id="lsr操作"><a class="header" href="#lsr操作">LSR操作</a></h4>
<p>为了让每个节点建立起路由表，使用<code>LSR</code>协议的路由都需要执行这一系列的操作。</p>
<ol>
<li>
<p>从邻近的节点学习。</p>
<p>对于广播网络，广播一个特殊的<code>Hello</code>包，对于点对点的网络，多播这个<code>Hello</code>包。</p>
<p>邻近的节点在收到这个包之后需要发送一个包含自己的名称的回复包，其中名称（路由ID）应该是全局唯一的。</p>
<p>通过这种方式简化了网络的拓扑结构。</p>
</li>
<li>
<p>测量线路参数。</p>
<p>利用发送<code>echo</code>包得到线路的延迟，测量线路的带宽。</p>
</li>
<li>
<p>构建链路状态包。</p>
<p><img src="computer-networks/./network-layer/image-20230425150718105.png" alt="image-20230425150718105" /></p>
<p>可以定时重新构建链路状态包，也可以在监听在某些特定事件发生的时候重建。</p>
<p>包中的序列栈<code>Seq</code>是用来检验收到的链路状态包是否是最新的：</p>
<ul>
<li>收到一个新的<code>LSP</code>，洪泛这个包</li>
<li>收到一个重复的<code>LSP</code>，丢弃这个包</li>
<li>如果收到的<code>LSP</code>序列编号比已经收到的最大编号小，也丢弃这个包</li>
</ul>
<p>包中的年龄字段<code>Age</code>是用来删除循环的路由：</p>
<ul>
<li>当一个路由下线</li>
<li>当一个路由的名称（路由ID）改变</li>
<li>当一个路由需要删除一个<code>LSP</code></li>
</ul>
</li>
<li>
<p>发送<code>LSP</code></p>
<p>显而易见，我们需要可靠的方式将<code>LSP</code>包发送出去。因此利用洪泛的方式发送<code>LSP</code>包，并且在两端都设置了错误侦测，收到<code>LSP</code>包之后都要求发送确认包。</p>
<p><img src="computer-networks/./network-layer/image-20230425152051118.png" alt="image-20230425152051118" /></p>
</li>
<li>
<p>计算新的路由</p>
<p>当一个路由收到足够数量的<code>LSP</code>包之后，这个路由就可以将整个网络构建出来。</p>
<p>在本地运行<code>Dijkstra</code>算法，构建到每个目的地的最短路径，并且把最短的结果写在路由表中。</p>
</li>
</ol>
<p>在实际中，有<code>IS-IS</code>，Intermediate System-Intermediate System协议和<code>OSPF</code>，Open Shortest Path First协议使用这个算法。</p>
<h3 id="分级路由"><a class="header" href="#分级路由">分级路由</a></h3>
<p>首先出于效率原因，如果全球网络中所有的路由都需要建立一张共同的路由网络，那么这张网络中的路由数量将会非常庞大，导致整个网络的延迟很大。而且出于安全原因，单位内部的路由没有必要都暴露给互联网上的所有设备。基于这两个原因，分级路由出现了。</p>
<p>分级路由将网络按照<strong>域</strong>进行路由，在域间只选路到域，在进入单个域内之后，才选路到路由器。</p>
<h2 id="拥塞控制和互联"><a class="header" href="#拥塞控制和互联">拥塞控制和互联</a></h2>
<p>不严谨的说，拥塞就是网络不足以处理大量发送到网络中的数据包。</p>
<p><img src="computer-networks/./network-layer/image-20230425154409341.png" alt="image-20230425154409341" /></p>
<blockquote>
<p>拥塞会在任何含有等待/队列的系统当中。</p>
<p>如果数据包到达的数据大于数据包处理的速度，那么输入队列就会越来越长，直到队列溢出。</p>
<p>发送队列也是如此。</p>
<p>在发生拥塞的时候，会出现很长的延迟和较高的丢包率。</p>
</blockquote>
<h3 id="拥塞控制的方法"><a class="header" href="#拥塞控制的方法">拥塞控制的方法</a></h3>
<p>一般冲提升资源总量和降低负载两个角度上来考虑。</p>
<ul>
<li>提供资源总量：
<ul>
<li>规划调整网络</li>
<li>选路时考虑负载的影响</li>
</ul>
</li>
<li>降低负载：
<ul>
<li>接纳控制<code>Admission Control</code></li>
<li>业务量减速<code>Traffic Throttling</code></li>
<li>负载掉落<code>Load Shedding</code></li>
</ul>
</li>
</ul>
<h4 id="业务量减速"><a class="header" href="#业务量减速">业务量减速</a></h4>
<ol>
<li>
<p>路由检测是否发送拥塞</p>
<p>通过计算链路利用率，在路由内缓存的包数量，因为缓存不足而丢弃的包数量来检测。</p>
<blockquote>
<p>为了估计队列延迟，引入<code>EWMA</code> Exponentially Weighted Moving Average，指数甲醛移动均值算法。因为瞬时队列延迟是一个变化很大的值，利用这种算法得到一个较为合理的值。
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">))</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span></span>
在公式中：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示最近队列的长度</li>
<li><code>s</code>表示立即的队列长度</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>是一个平衡因子</li>
</ul>
</blockquote>
</li>
<li>
<p>传递发送拥塞的信息</p>
<p>发送一个<strong>抑制分组</strong>（Choke Packet）给源地址主机，告知源主机发送拥塞。</p>
<p>为了避免再次提高网络的负载，路由会以一个非常低的速率发送抑制分组。</p>
</li>
<li>
<p>调整系统</p>
<p>在源地址主机收到抑制分组之后，源地址主机降低发送的速度。</p>
</li>
</ol>
<p>除了这种方式，还有一个称作<code>ECN</code>的通知方式，<code>Explicit Congestion Notification</code>显式拥塞控制。</p>
<p>这种方式被TCP协议和IP协议使用。在IP包的字段中，设置了两个比特位来表示这个包在转发的过程中是否发送了拥塞。当路由发现拥塞的时候，就修改这个字段。当接受方接收到标识了经历丢包的数据包时，会在下一次发送包给发送方时标记上发生拥塞。</p>
<h4 id="负载掉落"><a class="header" href="#负载掉落">负载掉落</a></h4>
<blockquote>
<p>通俗的说，就是丢包。</p>
</blockquote>
<p>主要的问题就是，丢掉哪些包？</p>
<p>不同的应用可能可以接受丢失掉不同的包，还可以通过事先指定的优先级来丢包。</p>
<h4 id="随机早期检测"><a class="header" href="#随机早期检测">随机早期检测</a></h4>
<blockquote>
<p>在拥塞控制时，可以利用形如<code>CSMA/CA</code>的机制，提前侦测是否会发生拥塞。</p>
</blockquote>
<p>在路由完全失效之前就随机的丢弃掉一部分的包。</p>
<p>当发送方侦测到部分发送的包不能收到确认包时，就认为发送了拥塞并降速了。这种“通知”被称为<strong>隐式通知</strong>。</p>
<h3 id="服务质量"><a class="header" href="#服务质量">服务质量</a></h3>
<p>一般来说，在网络层有这些衡量服务质量的参数：</p>
<ol>
<li>
<p>可靠性：</p>
<p>错误率和丢包率</p>
</li>
<li>
<p>延迟：</p>
<p>第一个字节发送知道最后一个字节被接受的时间</p>
</li>
<li>
<p>抖动<code>Jitter</code>：</p>
<p>传输过程中延迟的变化量</p>
</li>
<li>
<p>带宽：</p>
<p>最大数据率</p>
</li>
</ol>
<p>不同的应用有着不同的服务质量要求特点：</p>
<p><img src="computer-networks/./network-layer/image-20230425161842307.png" alt="image-20230425161842307" /></p>
<p>下面是一些提高服务质量的方法。</p>
<h4 id="流量整形traffic-shaping"><a class="header" href="#流量整形traffic-shaping">流量整形<code>Traffic Shaping</code></a></h4>
<p>在实际的互联网上往往存在着很多的突发流量，虽然平均的流量不大，但是瞬时的流量可能很大。</p>
<p><img src="computer-networks/./network-layer/image-20230425162213476.png" alt="image-20230425162213476" /></p>
<p>流量整形就是一种去突发的技术，使得传输的速率接近平均速率。流量整形技术有着两个“桶”：漏桶和令牌桶。</p>
<p>首先介绍“漏桶”算法，这种算法可以将一个数据包的不平稳流变成一个稳定的流。使用这种算法有着两个作用：第一可以缓解流量突发情况，第二可以减少拥塞出现的可能性，同时可能出现桶满了数据丢失的可能。</p>
<p><img src="computer-networks/./network-layer/image-20230509145449418.png" alt="image-20230509145449418" /></p>
<p>其次再来介绍“令牌桶”算法。在主机空闲的时候，在令牌桶中会开始积累令牌，当需要发送数据时，就需要从令牌桶中取出令牌。在这种情况下，当出现突发数据时，可以允许部分的数据突发，但是当令牌桶中的令牌耗尽之后，令牌桶会限制发送数据的速率，这样就限制了突发。同时，如果令牌桶满了，不会像漏桶一样出现数据丢失的现象。</p>
<p><img src="computer-networks/./network-layer/image-20230509145825678.png" alt="image-20230509145825678" /></p>
<p>我们还可以计算在经过令牌桶之后突发持续的最大时间：首先假设突发时间为<code>s</code>秒，令牌桶的容积为<code>B</code>字节，令牌产生的速率为<code>R</code>字节每秒，最大的输出速率为<code>M</code>字节每秒。因此，经过令牌桶最大突发的数据量为<code>B+RS</code>字节，而通过数据的速率我们还可以计算出突发所传输的数据量为<code>MS</code>，利用等式<code>B+RS=MS</code>可以计算出突发可以持续的时间为：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h4 id="包调度packet-scheduling"><a class="header" href="#包调度packet-scheduling">包调度<code>Packet Scheduling</code></a></h4>
<p>当一系列包从一个特定的源发送到目标是，如果假设这一系列包都经过相同的路由，我们就称这一系列包为<strong>流</strong><code>Flow</code>。如何调度路由器资源来处理流就成为一个问题。</p>
<p>针对这个问题我们一般有四种算法：</p>
<ol>
<li>
<p>先进先出队列。</p>
<p>先到达的包就会优先被发送出去，但是这样后到达的包就可能因为资源不够而被丢弃掉。</p>
</li>
<li>
<p>优先级队列。</p>
<p>每个包都分配了一个优先级字段，每个优先级都有自己的队列，高优先级队列中的数据会先发送。但是这样可以会出现低优先级的队列始终是满的，难以发送的问题。</p>
</li>
<li>
<p>公平队列</p>
<p>设计多个队列，循环处理每个队列。</p>
</li>
<li>
<p>公平加权队列</p>
<p>仍然按照权值分成不同的队列，但是按照权值的不同分配不同队列发送的时间。</p>
</li>
</ol>
<h4 id="资源预留resource-reservation和接纳控制admission-control"><a class="header" href="#资源预留resource-reservation和接纳控制admission-control">资源预留<code>Resource Reservation</code>和接纳控制<code>Admission Control</code></a></h4>
<p>一般资源预留中的资源指：</p>
<ul>
<li>带宽</li>
<li>缓冲空间</li>
<li>CPU时间</li>
</ul>
<p>一般资源预留是按照<strong>流</strong>为单元进行的。</p>
<h3 id="网络互联"><a class="header" href="#网络互联">网络互联</a></h3>
<p>不同的网络有着不同的协议，为了能够在不同的网络之间传输信息，我们需要完成网络互联的功能。</p>
<p>在不同的层次上有着不同的互联方式：</p>
<ul>
<li>物理层：放大器，集线器（尽管他们几乎没有互联的功能）</li>
<li>数据链路层：网桥和交换机</li>
<li>网络层：路由器</li>
<li>传输层：传输网关</li>
<li>应用层：应用网关</li>
</ul>
<h2 id="internet中的网络层"><a class="header" href="#internet中的网络层">Internet中的网络层</a></h2>
<p>在设计Internet网络层的原则：</p>
<ul>
<li>确保可以工作</li>
<li>保持实现简单</li>
</ul>
<p>Internet网络层的核心协议就是<code>IP</code>协议，<code>Internet Protocol</code>。</p>
<ul>
<li>这是使用最广泛的互联协议</li>
<li>无连接的网络层协议</li>
<li>基于用户报路由</li>
<li>提供<strong>尽力</strong>服务，但是不保证可靠性</li>
<li>使用分级路由，距离矢量，链路状态的混合选路算法</li>
</ul>
<p><img src="computer-networks/./network-layer/image-20230509161238553.png" alt="image-20230509161238553" /></p>
<h3 id="ipv4-地址"><a class="header" href="#ipv4-地址"><code>IPv4</code> 地址</a></h3>
<p>为了在网络中区分不同的网络设备而设计的网络标识符就是<strong>IP地址</strong>。<code>IPv4</code>地址长度32位，一般使用点分十进制来表示。每一个网络接口都有一个<code>IPv4</code>地址。</p>
<h4 id="分类网络地址"><a class="header" href="#分类网络地址">分类网络地址</a></h4>
<p>在A，B，C类地址中，传统的<code>IPv4</code>地址有着一个两层的分级地址机制：网络ID加上主机ID</p>
<p><img src="computer-networks/./network-layer/image-20230509162138630.png" alt="image-20230509162138630" /></p>
<p>其中网络号部分保留，主机号部分为0的地址不能分配给计算机，被称为<strong>网络地址</strong>，用作路由。可以通过该网段中默认的<strong>网络掩码</strong>和网络中的IP地址计算得到网络地址。</p>
<p>在一个网络中有一些特殊的地址不能分配给计算机：</p>
<ul>
<li>网络地址：网络号部分保留，主机号留空的地址</li>
<li>广播地址：网络号部分保留，主机号为全1的地址</li>
</ul>
<p>因此，对于一个网络来说，实际上可以分配的地址需要在理论数量上减2。</p>
<p>除了上面两个特殊地址，还有几个其他的特殊地址：</p>
<ul>
<li><code>0.0.0.0</code>表示当前主机</li>
<li>网络号部分为0，主机号地址留空的地址，表示当前网络上的主机</li>
<li><code>255.255.255.255</code>表示当前网络的广播地址</li>
<li>网络号部分保留，主机号为全1的地址，表示指定网络的广播地址</li>
<li><code>127.x.y.z</code>本地环回地址</li>
</ul>
<h4 id="子网划分"><a class="header" href="#子网划分">子网划分</a></h4>
<p>为了更加方便的管理和路由，子网划分被发明。</p>
<p>一个网络可以被划分为数个不同的子网，但是对外就是一个网络，也就是说子网划分对于外部是不可见的。</p>
<p>使用<strong>子网掩码</strong>可以方便的得到一个子网的网络地址，将子网掩码和主机地址进行按位与操作即可得到网络地址。</p>
<h4 id="超网划分"><a class="header" href="#超网划分">超网划分</a></h4>
<p>由于C类地址的网络可以提供的地址数量较少，因此实际上一个组织需要分配多个C类地址才够用，为了用一个地址简单的表示这个组织，我们可以使用超网技术将几个C类地址合成一个更大的网络。</p>
<p>使用<strong>超网掩码</strong>，可以得到一个组织的网络地址。</p>
<h4 id="无类别地址"><a class="header" href="#无类别地址">无类别地址</a></h4>
<p>分类地址他妈的纯傻逼，屁用没有。</p>
<p>无类别地址都是用多少个主机就分配多长。可以使用无类别域间选路<code>CIDR</code>来表示一个子网，<code>a.b.c.d/x</code>，其中<code>x</code>表示地址中网络部分的长度。</p>
<p>使用<code>CIDR</code>既可以表示一个子网，也可以将多个子网聚合成一个超网。</p>
<h4 id="nat"><a class="header" href="#nat">NAT</a></h4>
<p>然而使用无类别地址还是不够用，于是网络地址翻译<code>NAT</code>技术被提出来。</p>
<p>首先<code>NAT</code>使用了私有网络地址：</p>
<ul>
<li><code>10.0.0.0/8</code></li>
<li><code>127.16.0.0/12</code></li>
<li><code>192.168.0.0/16</code></li>
</ul>
<p>负责<code>NAT</code>的路由器将把内部地址转换为公共的地址，为了保持私有主机和外部的网络联通，路由器还会维持一个私有地址和外部地址的转换表。同时，如果内网内部有多个主机访问同一个外部主机，为了识别不同的主机，在转换表表中还需要记录端口号。</p>
<p>所以，<code>NAT</code>路由器会进行如下操作：</p>
<ul>
<li>
<p>对于发送的包，将内部的源地址替换为共同地址。</p>
<p>同时将源地址，源端口号，目的地址，目的端口号记录在转发表中</p>
</li>
<li>
<p>对于接受到的包，从转发表中查找源地址</p>
<p>将目的地址替换为内部地址，发送给内部网络。</p>
</li>
</ul>
<h3 id="ip包格式"><a class="header" href="#ip包格式">IP包格式</a></h3>
<p><img src="computer-networks/./network-layer/20230516_14h57m00s_grim.png" alt="" /></p>
<h4 id="ip包包头"><a class="header" href="#ip包包头">IP包包头</a></h4>
<p><img src="computer-networks/./network-layer/20230516_15h01m32s_grim.png" alt="" /></p>
<ul>
<li>
<p><code>Version</code>：前四个字节<code>0~3</code>，表示IP协议的版本。</p>
</li>
<li>
<p><code>IHL</code>：表示IP包包头的长度，使用32位表示，实际上的取值范围为<code>5~15</code></p>
</li>
<li>
<p><code>Type of Service</code>：表示服务质量的目的</p>
</li>
<li>
<p><code>Total Length</code>：表示IP包的长度</p>
</li>
<li>
<p><code>Time to live</code>：包的生存时间，虽然是使用秒定义的，但是实际上都是按照跳来计数</p>
</li>
<li>
<p><code>Protocol</code>表示应该由何种协议来处理收到的数据，例如<code>tcp</code>、<code>udp</code>、<code>icmp</code></p>
</li>
<li>
<p><code>Header Chechsum</code>：校验和，只对包头进行校验，不对数据进行校验</p>
</li>
<li>
<p><code>Source IP Address</code>：发送IP包的主机地址</p>
</li>
<li>
<p><code>Destination IP address</code>： 接受该IP包的主机地址</p>
</li>
<li>
<p><code>Options</code>：选项部分</p>
<ul>
<li>安全选项</li>
<li>严格源选路：通过指定一系列的IP地址来指定发送过程中的路由过程</li>
<li>宽松源选路：只指定需要经过路径上的一系列IP地址</li>
<li>记录路由：记录下经过的路由地址</li>
<li>时间戳：除了记录一系列的路由地址，还加上经过这个路由的时间戳</li>
</ul>
</li>
</ul>
<p>分段和重装：也就是包头中的第二行。</p>
<p>由于不同的网络有着不同的最大允许传输大小，一个IP包在传输的过程中可能分成多个包来传输，在到达源主机之后再拼装在一起。这个最大传输的长度称为<code>MTU</code>，<code>maximum transmission unit</code>，最大传输单元。</p>
<p>几种典型的<code>MTU</code>大小如下：</p>
<ul>
<li>以太网中1500 字节</li>
<li>Wi-Fi中2312字节</li>
</ul>
<p>其中，分段操作在源主机和路径中的任何路由上都有可能发生，但是拼装操作只在目的主机进行。</p>
<p>下面介绍IP包中支持分段和拼装操作的字段。</p>
<ul>
<li>
<p><code>Identification</code>：源主机在发送IP包时为每一个包指定的唯一地址，在进行分段操作时复制到每个包头中。</p>
</li>
<li>
<p><code>DF</code>：将这个位设为1表示这个包不能进行分段操作了</p>
</li>
<li>
<p><code>MF</code>：将这个位设为1表示这是最后一个分段了</p>
</li>
<li>
<p><code>Offset</code>：为了表示不同分段的次序关系，使用该分段相对于原始数据包的偏移量来表示。同时因为这个字段的位数较少，这个偏移量的单位是8字节，在字面值的基础上乘上8字节才是郑珍的偏移量。</p>
</li>
<li>
<p><code>NU</code>：没有被使用的位，值为0</p>
</li>
</ul>
<p>当<code>MF</code>字段为0且<code>Offset</code>也为0 时，就表示这个IP包还没有被分段。</p>
<h3 id="ipv6"><a class="header" href="#ipv6">IPv6</a></h3>
<p>为了解决<code>IPv4</code>地址不够用的问题，人们提出了<code>IPv6</code>地址协议。</p>
<ul>
<li>为了提供更多的地址，<code>IPv6</code>地址使用128位长度的地址。</li>
<li>简化了包头的结构</li>
<li>提供了更好的路由选项</li>
<li>提供了更好的安全</li>
<li>提高的服务质量</li>
</ul>
<p><img src="computer-networks/./network-layer/20230516_15h49m45s_grim.png" alt="" /></p>
<h4 id="ipv6包结构"><a class="header" href="#ipv6包结构">IPv6包结构</a></h4>
<p><img src="computer-networks/./network-layer/20230516_15h52m45s_grim.png" alt="" /></p>
<ul>
<li><code>VER</code>：IP协议版本</li>
<li><code>PRI</code>：包的优先级</li>
<li><code>Flow label</code>：控制传输中占用的带宽和延迟，仍在试验中的属性</li>
<li><code>Payload length</code>：传输数据的长度</li>
<li><code>Next header</code>：在基础包头之后的子包头，一般就是指网络层协议的包头或者IP一些中其他控制协议</li>
<li><code>hop limit</code>：跳限制，同<code>ttl</code>一个用途</li>
<li><code>Extension Headers</code>：IPv4协议中可选的选项</li>
</ul>
<p>IPv6地址使用冒分十六进制来表示地址。如果在地址中连续的多个0，那么可以省略不写，但是需要注意的是在同一个地址中只能省略一次。</p>
<h3 id="icmparpdhcp"><a class="header" href="#icmparpdhcp">ICMP、ARP、DHCP</a></h3>
<h4 id="icmp"><a class="header" href="#icmp">ICMP</a></h4>
<p>Internet控制报文协议。</p>
<p>扩展了<code>IP</code>协议没有提供的功能。</p>
<ol>
<li>
<p>向源主机报告错误</p>
<p>例如路由无法确定前往目的地的路由，一个带有<code>DF=1</code>标志的包因此遇到了一个MTU较小的网络而被丢弃。这两种情况都是返回<code>Destination Unreachable</code>。</p>
<p>如果一个包因为<code>ttl</code>到达0被丢弃就返回<code>Time Exceed</code>。</p>
<p>因为流量控制或者阻塞的问题，需要源主机降速，返回<code>Source Quench</code>。</p>
<p>如果一个路由注意到一个包可能被错误的路由了，就返回<code>Redirect</code>。</p>
</li>
<li>
<p>测试网络是否联通</p>
<p><code>ping</code>实用程序。</p>
</li>
</ol>
<h4 id="arp"><a class="header" href="#arp">ARP</a></h4>
<p>地址解析协议。</p>
<p>解决如何从IP地址对应到数据链路层的<code>mac</code>地址的问题。</p>
<p>ARP协议为维持一个IP地址到<code>mac</code>地址的对应表，在发送数据时，如果在表中没有查到对于的mac地址，那么就广播一个<code>arp</code>包向网络中的主机询问。</p>
<p>除了ARP协议，还有<code>RARP</code>协议，逆向ARP协议，使用以太网地址获得对应的网络地址。</p>
<h4 id="dhcp"><a class="header" href="#dhcp">DHCP</a></h4>
<p>动态主机配置协议<code>Dynamic Host Configuration Protocol</code>。提供对于远程主机的自动配置，包括IP地址，路由器的地址，子网掩码，DNS服务器的地址，DHCP提供的信息都是有时间限制的，再到期之后会自动申请刷新。这是一个应用层的协议，使用客户端-服务器模式工作。</p>
<h3 id="路由协议"><a class="header" href="#路由协议">路由协议</a></h3>
<p>发送主机和路由器都需要考虑路由的问题。</p>
<p>发送主机首先使用子网掩码和目的地址计算出目的的网络地址，如果目的网络地址就是本地网络，直接发送到目的地，如果不是，就发送到本地网络的路由。</p>
<p>一般来说，路由表中至少需要以下四列：子网掩码，目的网络地址，下一跳地址，转发接口。到路由器收到一个包时，路由器首先使用子网掩码和包中的目标地址计算包发送目的地的网络地址，如果在路由表中发现了对应的记录，就通过指定的接口将包发送出去。也就是说，如果在路由表中存在多个匹配的网络地址，使用路由表中最上方的地址。</p>
<p>在路由表中，也可以使用<code>CIDR</code>格式代替子网掩码和目的网络地址来表示目的网络地址。如果在路由表中发现了多个匹配的目的网络地址，那么使用掩码最长的那项作为目的路由。</p>
<p>Internet的路由结构：Internet首先被分成多个有不同的组织自行管理的自治系统。每个组织在自治系统使用自己的路由选路协议<code>Interior Routing Protocol</code>，但是在不同的自治系统中交换信息使用一种特定的路由协议<code>Exterior Routing Protocol</code>。</p>
<p>现在的Internet上流行的三种路由协议为</p>
<ul>
<li><code>RIP</code>：基于距离向量路由</li>
<li><code>OSPF</code>：基于链路状态路由</li>
<li><code>BGP</code>：使用距离向量路由的升级版——路径向量路由</li>
</ul>
<p>其中前两种协议用于自治系统中，是<code>Interior</code>，后面一种用于自治系统之间，是<code>Exterior</code>。</p>
<h4 id="rip"><a class="header" href="#rip">RIP</a></h4>
<p>路由信息协议<code>Routing Information Protocol</code>，是距离向量路由算法的直接实现，使用网络的跳数来表示不同路径长度的不同，但是该协议限制最大的跳数为16，这就限制了协议的规模。该协议使用<code>UDP</code>作为通信协议。</p>
<h4 id="ospf"><a class="header" href="#ospf">OSPF</a></h4>
<p>开放的最短路径有限<code>Open Shortest Path First</code>，基于链路状态路由算法。该协议使得每个路由都知道整个网络的完整拓扑结构，每个路由都需要通知其的邻近路由在网络中所有路由的信息。</p>
<p>这个协议支持网络管理员手动指定一个网络的开销，还支持基于服务类型的路由、负载均衡和身份认证等功能。该协议直接使用<code>IP</code>进行通信。</p>
<h4 id="bgp"><a class="header" href="#bgp">BGP</a></h4>
<p>边界网关协议<code>Border Gateway Protocol</code>，在自治系统之间使用，基于距离矢量选路的升级版路径矢量选路算法。边界网关协议支持很多的路由策略。该协议使用<code>TCP</code>作为通信协议以提高可靠性。</p>
<h3 id="ip-组播"><a class="header" href="#ip-组播">IP 组播</a></h3>
<p>为了高效的将IP包发送给一系列地址的主机，IP组播使用<strong>组生成树</strong><code>Group Spanning Tree</code>，只发送组播信息一次，只在连接到多个网络之后才复制信息形成一个新的包。</p>
<p>使用Internet组管理协议<code>Internet Group Management Protocol</code>协议来支持组播/多播，可以在单个网络中建立不同的主机分组。</p>
<p>建立分组的过程大致如下：</p>
<ul>
<li>主机发送一个<code>IGMP</code>包给路由器声明其加入了一个组播组</li>
<li>本地路由定时广播<code>IGMP</code>查询包，询问本地主机那些加入了组播组，加入了的主机回复<code>IGMP</code>包</li>
</ul>
<p><code>IGMP</code>协议使用<code>IP</code>发送信息。</p>
<h3 id="移动ip"><a class="header" href="#移动ip">移动IP</a></h3>
<p>在主机移动到另外一个网络中时，仍然能够接受发给原来归属地IP地址的数据包。这是通过一个被称为<strong>隧道</strong>的技术来实现的。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="传输层-1"><a class="header" href="#传输层-1">传输层</a></h1>
<h2 id="传输层所在的功能和位置"><a class="header" href="#传输层所在的功能和位置">传输层所在的功能和位置</a></h2>
<p>传输层是网络网络分层模型中较为重要的一层，提供了端到端的可靠、高效、低开销的数据传输服务，而且同当前的物理设备和网络无关。</p>
<p>传输层提供了进程到进程级别的通信传输服务：</p>
<p><img src="computer-networks/./transport-layer/image-20230523152502659.png" alt="image-20230523152502659" /></p>
<h3 id="传输层提供的服务"><a class="header" href="#传输层提供的服务">传输层提供的服务</a></h3>
<ul>
<li>屏蔽了通信网络的复杂性并向上层提供了同一的通信接口</li>
<li>通过单一的网络接口提供了多个服务访问点<code>Service Access Points</code></li>
<li>提供了面向连接和无连接两种服务</li>
</ul>
<p>伯克利的套接字是目前在互联网上被广泛应用的传输层API：</p>
<p><img src="computer-networks/./transport-layer/image-20230523154634286.png" alt="image-20230523154634286" /></p>
<p><img src="computer-networks/./transport-layer/image-20230523154658014.png" alt="image-20230523154658014" /></p>
<h2 id="传输协议的重点"><a class="header" href="#传输协议的重点">传输协议的重点</a></h2>
<h3 id="传输层协议和数据链路层协议的比较"><a class="header" href="#传输层协议和数据链路层协议的比较">传输层协议和数据链路层协议的比较</a></h3>
<p>都需要处理差错控制、序列、流量控制等等问题。</p>
<p>但是数据链路层是节点到节点的传输，传输层是进程到进程。</p>
<p>两者所在的环境是也不太相同：</p>
<ul>
<li>不同的地址</li>
<li>连接建立的过程不同</li>
<li>不同子网的容纳量不同</li>
<li>缓冲的分配方式不同</li>
</ul>
<h3 id="地址编码方式端口号"><a class="header" href="#地址编码方式端口号">地址编码方式：端口号</a></h3>
<p>决定不同的进程应该如何发送和收到不同的信息，也就是应用层进程的服务提供点。</p>
<p>不同的端口号还提供了复用的功能：</p>
<ul>
<li>对于发送方：通过端口号区分从不同进程发送的数据包，实现对于传输层的复用</li>
<li>对于接收方：通过端口号区分从不同进程接受的数据包，实现对于传输层的复用</li>
</ul>
<h3 id="连接建立过程中的问题"><a class="header" href="#连接建立过程中的问题">连接建立过程中的问题</a></h3>
<p>基础的连接建立过程是通过两次握手：一方发送一个连接请求然后等待另一方发送一个接受连接的回复。</p>
<p>但是存在问题：网络传输过程中可能存在延迟，导致重复的连接：</p>
<p><img src="computer-networks/./transport-layer/image-20230523160209470.png" alt="image-20230523160209470" /></p>
<p>通过三次握手就可以结果建立连接重复的问题：</p>
<p><img src="computer-networks/./transport-layer/image-20230523160517039.png" alt="image-20230523160517039" /></p>
<p>在释放连接的过程中也存在着类似的问题：也可以通过类似的三次握手消息来解决。</p>
<p><img src="computer-networks/./transport-layer/image-20230523160757503.png" alt="image-20230523160757503" /></p>
<p><img src="computer-networks/./transport-layer/image-20230523160823428.png" alt="image-20230523160823428" /></p>
<h3 id="差错控制"><a class="header" href="#差错控制">差错控制</a></h3>
<p>差错控制使用了自动请求重传的机制，提供了进程到进程的差错控制。</p>
<p>在数据链路层和传输层都有差错控制，需要注意这两者的不同：</p>
<ul>
<li>功能上的不同</li>
<li>尺度上的不同</li>
</ul>
<h3 id="拥塞控制"><a class="header" href="#拥塞控制">拥塞控制</a></h3>
<p>如果发送了过多的包到一个网络中，就会发生拥塞的现象，会出现时延增加和丢包的情况。</p>
<p>需要注意对比拥塞控制和流量控制之间的区别：</p>
<p><img src="computer-networks/./transport-layer/image-20230526100015934.png" alt="image-20230526100015934" /></p>
<p>如何在多个发送方之间合理的分配带宽？<strong>最大最小公平性</strong>原则。</p>
<p>使得资源分配向量的最小分量的值最大，防止任何网络流被“饿死”，同时一定程度上尽可能增加每个流的速率。判断原则：在满足最小需求的前提下，各个流尽量均分带宽，如果增加任何一个参与者的带宽，将导致其他具有相同或者更少带宽的参与者的带宽下降，此时即满足了最大最下公平性。</p>
<p>在<code>Internet</code>中的拥塞控制步骤：</p>
<ul>
<li>
<p>发现拥塞：路由器更具队列长度或者线路利用率判断</p>
</li>
<li>
<p>将拥塞情况通知源主机：</p>
<p>显示拥塞通知：<code>TCP</code> with <code>ECN</code></p>
<p>隐式拥塞通知：源主机按照丢包的情况自行判断（更加常用）</p>
</li>
<li>
<p>源主机采取措施：</p>
<p>在没有拥塞的时候，增加发送速率</p>
<p>在存在拥塞的时候，降低发送速率</p>
</li>
</ul>
<p>为了达到效率和公平的平衡点，使用<strong>加法增乘法减</strong>的控制策略：</p>
<p><img src="computer-networks/./transport-layer/image-20230526102102387.png" alt="image-20230526102102387" /></p>
<h2 id="internet中的传输层"><a class="header" href="#internet中的传输层"><code>Internet</code>中的传输层</a></h2>
<h3 id="udp用户数据包协议"><a class="header" href="#udp用户数据包协议"><code>UDP</code>用户数据包协议</a></h3>
<p>无连接的，不可靠的协议，类似于<code>IP</code>的“尽力”协议。</p>
<ul>
<li>没有确认帧</li>
<li>没有丢包或者乱序的侦测机制</li>
<li>没有重传机制</li>
<li>没有流量控制机制</li>
</ul>
<p>相对于<code>IP</code>唯一多提供的功能就是基于端口号的复用功能。</p>
<p><code>UDP</code>的包格式如图所示：</p>
<p><img src="computer-networks/./transport-layer/image-20230526102756873.png" alt="image-20230526102756873" /></p>
<p>在<code>UDP</code>计算的校验和时，会带上<code>IP</code>部分的包头一同计算。发送方为了计算校验和而创建的<code>IP</code>包头因为不会被实际发送出去，而且被称为<strong>伪包头</strong>。</p>
<p><img src="computer-networks/./transport-layer/image-20230526104311483.png" alt="image-20230526104311483" /></p>
<h3 id="tcp传输控制协议"><a class="header" href="#tcp传输控制协议"><code>TCP</code>传输控制协议</a></h3>
<h4 id="tcp的特点"><a class="header" href="#tcp的特点"><code>TCP</code>的特点</a></h4>
<ul>
<li>
<p>面向连接的传输</p>
</li>
<li>
<p>可靠的传输（<code>ARQ</code>）</p>
<p>使用确认帧</p>
<p>使用校验和发现错误</p>
<p>重传传输错误的详细</p>
<p>使用序列号侦测丢失或者乱序的包</p>
<p>流量控制</p>
</li>
<li>
<p>基于字节的传输，不能保持消息的边界</p>
</li>
<li>
<p>有拥塞控制</p>
</li>
</ul>
<p>下面这种图说明了“不保留消息边界的含义”。</p>
<p><img src="computer-networks/./transport-layer/image-20230526105001795.png" alt="image-20230526105001795" /></p>
<h4 id="tcp报文段格式"><a class="header" href="#tcp报文段格式"><code>TCP</code>报文段格式</a></h4>
<p><img src="computer-networks/./transport-layer/image-20230526105640584.png" alt="image-20230526105640584" /></p>
<p>其中的部分控制字段含义如下：</p>
<ul>
<li><code>URG</code>指示紧急数据指针<code>urgent pointer</code>有效，该指针指向的数据需要提前处理</li>
<li><code>ACK</code>表示确认字段有效</li>
<li><code>PSH</code>指示数据需要尽快提交给应用层，但是优先级低于<code>URG</code></li>
<li><code>RST</code>表示连接需要重置</li>
<li><code>SYN</code>同步报文段序号</li>
<li><code>FIN</code>表示连接即将结束</li>
</ul>
<p>最前面的两位<code>ECE</code>和<code>CWR</code>是用于显示拥塞控制的，将同<code>IP</code>包头中的<code>ECN</code>字段协同工作。其中<code>ECN</code>字段有路由器设置，<code>ECE</code>由接收方设置，<code>CWR</code>由发送方设置。</p>
<p><img src="computer-networks/./transport-layer/image-20230526110641892.png" alt="image-20230526110641892" /></p>
<p><code>TCP</code>协议中还有支持一些扩展选项：</p>
<ul>
<li>
<p><code>MSS</code>最大报文段大小</p>
<p>允许主机指定<code>TCP</code>的最大大小</p>
</li>
<li>
<p><code>Window Scale</code></p>
<p>允许指定扩大滑动窗口大小的倍数，在一些信道延迟很大的情况下很有用</p>
</li>
<li>
<p><code>Timestamp</code></p>
<p>可以记载时间戳，计算时延</p>
</li>
<li>
<p><code>Selective ACK</code></p>
<p>允许接收方通知发送方一系列收到的序号。</p>
<p><img src="computer-networks/./transport-layer/image-20230526111609101.png" alt="image-20230526111609101" /></p>
</li>
</ul>
<h4 id="连接管理"><a class="header" href="#连接管理">连接管理</a></h4>
<p><code>TCP</code>首先需要三次握手同服务器建立连接。在这个过程中，客户端和服务端协商好开始序列号，同时解决重复连接的问题。</p>
<p><img src="computer-networks/./transport-layer/image-20230526112537773.png" alt="image-20230526112537773" /></p>
<p>在编号的方面需要注意：<code>SYN</code>和<code>ACK</code>报文段虽然不能携带数据，但是这两个哥们都需要算上一个序号。</p>
<p>下面的图表示了在建立连接之后的数据传输过程：</p>
<p><img src="computer-networks/./transport-layer/image-20230530145314113.png" alt="image-20230530145314113" /></p>
<p>数据传输完成之后的关闭连接过程，也是三次握手：</p>
<p><img src="computer-networks/./transport-layer/image-20230530145733336.png" alt="image-20230530145733336" /></p>
<p>和建立连接握手的过程中一样，虽然<code>FIN</code>和<code>ACK</code>报文段不能携带数据，但是仍然要占据一个序号。</p>
<p>但是在实际使用过程中，当一边的主机想要关闭链接的时候，另一边的主机不一定想要关闭连接，于是一种被称为<strong>半连接关闭</strong>的方式被广泛使用。在一边宣布关闭连接之后，另一边还可以继续传输数据，之后在宣布关闭连接。</p>
<p><img src="computer-networks/./transport-layer/image-20230530150032573.png" alt="image-20230530150032573" /></p>
<h4 id="流量控制和窗口大小管理"><a class="header" href="#流量控制和窗口大小管理">流量控制和窗口大小管理</a></h4>
<p><img src="computer-networks/./transport-layer/image-20230530150447893.png" alt="image-20230530150447893" /></p>
<p>在<code>TCP</code>协议中，主机之间可以使用协议中的<code>WIN</code>字段通知对方自己缓冲区中剩余的大小。</p>
<p>这里需要对比<code>TCP</code>同数据链路层之间的区别：</p>
<ul>
<li>在<code>TCP</code>中窗口大小按照字节为单位，但是在数据链路层中按照帧为大小</li>
<li>在<code>TCP</code>中窗口大小是可变的，但是在数据链路层中是固定的</li>
</ul>
<p>当收到对方的<code>WIN</code>字段为0时，主机的行为是：</p>
<ul>
<li>一般情况下不会再发送数据</li>
<li>但是一些标记为紧急的分段仍然可能发送</li>
<li>如果遇到死锁（更新窗口大小的帧在传输过程中丢失了），发送方可能会发送一个1字节大小的分段去确认缓存的大小是否仍然为0</li>
</ul>
<p>总的来说，<code>TCP</code>中的滑动窗口的大小具有如下的特点：</p>
<ul>
<li>
<p>发送方不用发送整个窗口大小的数据</p>
</li>
<li>
<p>动态的窗口大小：</p>
<p>发送方的大小可以由接收端的<code>WIN</code>字段来控制。</p>
<p>但是如果在网络中遇到拥塞，实际可以用到的窗口大小可能会更小。</p>
</li>
<li>
<p>接收方可能在任何时候发送确认帧</p>
</li>
</ul>
<p>在发送过程中还会遇到一系列有趣的问题：</p>
<ol>
<li>
<p><code>Nagle</code>问题</p>
<p>这个问题在初期的<code>TELNET</code>协议中遇到，这个协议以一次只发送一个字节的数据而闻名。但是为了发送这个字节的数据，可能会最多发送162字节的数据，这就造成了巨大的浪费。</p>
<p><img src="computer-networks/./transport-layer/image-20230530151807099.png" alt="image-20230530151807099" /></p>
<p>这个问题的解决办法就是尽量发送尽可能大的分段，提高利用率，具体的阈值为：</p>
<ul>
<li>已经接收到上一个分段的确认帧</li>
<li>缓存的数据已经填满了半个窗口或者最大分段<code>MSS</code>的一半</li>
</ul>
</li>
<li>
<p><code>Silly Window Syndrome</code>现象</p>
<p>大致就是接受方在窗口还在非常小的时候不要就通知发送方，较小的窗口大小会导致效率下降。</p>
<p>处理方式就是等待一段时间直到窗口较大的时候再发送。</p>
</li>
</ol>
<h4 id="错误控制-1"><a class="header" href="#错误控制-1">错误控制</a></h4>
<p><code>TCP</code>的错误控制包括侦测损坏的分段、丢失的分段、乱序的分段以及重复的分段。</p>
<p><code>TCP</code>仍然使用自动选择重传<code>ARQ</code>机制来进行错误控制。</p>
<p>在正常情况下，没有遇到任何的错误。接收方会等待一段时间<code>500ms</code>，来判断是否有更多的分段在传输过程中，以提供<code>ACK</code>的效率。</p>
<p><img src="computer-networks/./transport-layer/image-20230530152749365.png" alt="image-20230530152749365" /></p>
<p>如果在传输过程中，遇到丢失的帧，使用选择重传处理。</p>
<p><img src="computer-networks/./transport-layer/image-20230530152934847.png" alt="image-20230530152934847" /></p>
<p>需要注意的是，在传输过程中，<code>ACK</code>帧不重传。</p>
<p>在<code>TCP</code>中还存在一种特殊的机制称为<strong>快速重传</strong>，在收到三个重复的确认帧之后，发送方立刻发送这个丢失的帧。</p>
<h4 id="定时器管理"><a class="header" href="#定时器管理">定时器管理</a></h4>
<p>在<code>TCP</code>中一共存在四个定时器：</p>
<ul>
<li>
<p>重传定时器</p>
</li>
<li>
<p>持久定时器<code>Persistence</code>：当接收方发送0窗口大小的时候使用</p>
<p>主要就是防止上文提到过的死锁问题，防止新的窗口通知帧在传输过程中丢失。</p>
</li>
<li>
<p>保活定时器：当另一方长时间空闲的时候使用</p>
<p>当另一方长时间沉默的时候问一下对面还活着吗。</p>
</li>
<li>
<p>等待时间定时器<code>Time-waited</code>：在释放连接时等待</p>
<p>避免“两军问题”。</p>
</li>
</ul>
<p>在定时器管理中的主要问题就是重传定时器的时长怎么确定？如果太长会导致较低的吞吐量，太短又会导致大量的重复帧。</p>
<p><img src="computer-networks/./transport-layer/image-20230530160046437.png" alt="image-20230530160046437" /></p>
<p>在<code>TCP</code>中采用下列公式确定重传定时器的时长：
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></span>
其中的<code>Sample</code>是收到确认帧的时间减去发送帧的时间。</p>
<h4 id="拥塞控制-1"><a class="header" href="#拥塞控制-1">拥塞控制</a></h4>
<p>在没有端到端的带宽保证的情况下，拥塞控制是十分必要的。</p>
<p><code>TCP</code>中的发送方通过隐式的拥塞通知得知发生了拥塞，同时按照加法增乘法减<code>AIMD</code>的算法控制其的发送速度。其中，<code>TCP</code>使用被称为<strong>慢启动</strong>的技术去快速得知一个合理的拥塞窗口待行区啊，使用<strong>快速重传</strong>避免超时。</p>
<blockquote>
<p>拥塞窗口是一个由发送方控制的变量，表示在网络中最多能发送的数据量。</p>
<p><img src="computer-networks/./transport-layer/image-20230530161059980.png" alt="image-20230530161059980" /></p>
</blockquote>
<blockquote>
<p>重传定时器超时就标志着发生拥塞</p>
<p>收到确认帧就表示可发送数据</p>
</blockquote>
<p>为了简化描述，下面使用可发送的分段个数表示拥塞窗口。</p>
<p><strong>慢启动</strong>技术：初始的发送速率设置的很小（1），每收到一个确认帧将窗口扩大1，如果定时器超时，再次窗口设置为1。</p>
<p>虽然称为慢启动策略，但是启动过程中窗口的大小是指数级增长的。</p>
<p><img src="computer-networks/./transport-layer/image-20230530161714395.png" alt="image-20230530161714395" /></p>
<p>当当前窗口的大小达到发生重传的窗口大小的一半时，可以脱离慢启动的过程而进入<code>AIMD</code>。</p>
<p>在引入快速重传（三次重复的确认帧就认为是丢失）之后，拥塞控制也引入<strong>快速恢复</strong>。当遇到快速重传之后，发送的速度像慢启动一样直接回到1，而至减半，同时也继续<code>AIMD</code>控制而不是开始慢启动。</p>
<p><img src="computer-networks/./transport-layer/image-20230530162159523.png" alt="image-20230530162159523" /></p>
<p>图中的蓝线是原始版本，黑线是引入快速重传和快速恢复之后。</p>
<p><img src="computer-networks/./transport-layer/image-20230530162452378.png" alt="image-20230530162452378" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="期中复习"><a class="header" href="#期中复习">期中复习</a></h1>
<h2 id="概述-1"><a class="header" href="#概述-1">概述</a></h2>
<p><strong>未完成——仅根据往年题做了总结，未做其他细节/作业题</strong></p>
<h3 id="体系结构"><a class="header" href="#体系结构">体系结构</a></h3>
<p><img src="computer-networks/./assets/image-20230427151412250.png" alt="image-20230427151412250" /></p>
<ol>
<li>会话层：主机间通信</li>
<li>表示层：数据表示</li>
<li>应用层：网络应用进程</li>
</ol>
<p>层次从下往上编号，物理层是第一层</p>
<p><img src="computer-networks/./assets/image-20230426131936517.png" alt="image-20230426131936517" /></p>
<h2 id="物理层-1"><a class="header" href="#物理层-1">物理层</a></h2>
<ul>
<li>速度：双绞线&lt;细缆&lt;粗缆&lt;光纤</li>
</ul>
<h3 id="字节与编码"><a class="header" href="#字节与编码">字节与编码</a></h3>
<h4 id="比特填充法hdlc协议"><a class="header" href="#比特填充法hdlc协议">比特填充法：HDLC协议</a></h4>
<ul>
<li>0111 1110为<strong>首尾</strong>标志比特流</li>
<li>内容中出现连续5个1时，则在第五个1后插入一个0——无论不插入是否会构成0111 1110：比如0111 1100 ，倒数第二个0依然是填充进去的，需要被去除，虽然不填它也不会出现6个1</li>
</ul>
<h4 id="字节填充法ppp协议无连接"><a class="header" href="#字节填充法ppp协议无连接">字节填充法：PPP协议无连接</a></h4>
<ul>
<li>flag为0x**（某个数），转义为0x** (另外一个数)，这构造时在这两个前面都加一个转义，解码时反之</li>
<li><strong>首尾</strong>都有flag字节</li>
<li>0x7d：转义。0x7e：帧首尾。    0x7e变为0x7d5e。   0x7d变为0x7d5d。ascii控制字符（<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span>0x20）前，加0x7d</li>
<li>协议和校验和字段的长度可变</li>
</ul>
<h4 id="crc校验码"><a class="header" href="#crc校验码">CRC校验码</a></h4>
<ul>
<li>生成式：多项式，从n次幂到0次幂，系数非0的项为1。如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，则生成式为1001</li>
<li>计算方法：用待发送的比特流，左移生成式位数-1（最高阶），补0，除以生成式（竖式，除的每一步为异或操作），余数即为校验位</li>
<li>检验：收到的比特流除以生成式，不为0即有错。</li>
</ul>
<h4 id="海明码"><a class="header" href="#海明码">海明码</a></h4>
<ul>
<li>纠正单个错误的码字位数下界：m个消息位，r个校验位：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></li>
<li>构造：
<ul>
<li>计算r</li>
<li>写n=m+r个空，从1~n标下标，1、2、4、……为校验位，空着；其他位左到右依次填入待发送码字</li>
<li>将填入的比特中，为1的位的下标异或起来。如：_ _ 1_  010  则计算3^6=101，那么101填入上面的空格，变为1011 010就是结果。</li>
</ul>
</li>
<li>检验并纠错：
<ul>
<li>如上述正确是1011 010，错一位变成1010 010（错校验还是消息没区别），那么把所有为1的位的下标异或起来，如：1^3^6=100即第四位出错，翻转回来得到正确的。</li>
</ul>
</li>
</ul>
<h4 id="其他"><a class="header" href="#其他">其他</a></h4>
<ul>
<li>调制解调器使用字节传输，所以不适用比特填充法</li>
<li>调制解调器上行比下行慢：模拟变数字，信噪比影响，香农公式，受限</li>
<li>ADSL比普通电话线：扩展带宽，3400以上</li>
<li>单模光纤比多模快</li>
</ul>
<h3 id="adsldmt"><a class="header" href="#adsldmt">ADSL（DMT）</a></h3>
<ul>
<li>Modem（2.4kHZ）的升级，大大拓宽频率，分成多个信道，从kbps变到mbps</li>
<li>总共1.1MHZ，分到256信道，每个4312.5HZ。4000波特率，15bits/波特</li>
<li>保卫带400hz（不确定）</li>
<li>0信道（低频）是原有的电话线</li>
<li>1-5不使用，隔开数据和语音</li>
<li>2个信道上/下控制，248个信道数据传输</li>
</ul>
<h3 id="t1链路pcm"><a class="header" href="#t1链路pcm">T1链路（PCM）</a></h3>
<ul>
<li>采样时间为什么设置为 125μs？——话音信道的带宽为4KHz，按照奈奎斯特定理，采样频率应该为带宽的 2 倍，即每秒采样 8000 次，即每 125μs 采样一次。</li>
<li>时分复用TDM</li>
<li>每帧125us，所以8k帧率（波特率/采样率），每帧193bit</li>
<li>0bit为帧编码，然后分24个频道，每频道8bit，其中前7个是数据，8是信号——总之是每波特7bit数据，若指定带宽不是4k，那就是2H*7</li>
<li>速率：8k波特率，每波特24个频道，其中每频道7bit数据+1控制——因此，<strong>每频道的速率：8k*7=56k数据，及8k的控制信号。总速率：56k*24=1.536MHZ，加上0bit处的8k速率=1.544Mbps。</strong>     （T2为6Mbps，T3为45）</li>
</ul>
<h3 id="其他计算"><a class="header" href="#其他计算">其他计算</a></h3>
<ul>
<li>p2p信道，数据帧成功概率p，ack不会错，求成功发送的次数：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1488em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>因为相同设备的接口针脚功能相同,比如1号端口发送2号接受，需要1号对应2号，2号对应一号</li>
</ul>
<h4 id="存储-转发的分组交换网络"><a class="header" href="#存储-转发的分组交换网络">存储-转发的分组交换网络</a></h4>
<ul>
<li>计算包的个数n、计算发送一个包的耗时t，看路径有<strong>几跳</strong>k(k跳意味着有k段路径，不算首尾k-1个节点，算上首尾有k+1个节点)；</li>
<li>传输(Transmission )耗时：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>：就像cpu的流水线，第一个包发出、第一个包第二跳发出的同时第二个包的第一跳发出……因此可以看成nt+最后一个包再跑了k跳</li>
<li>传播（propagation）耗时：计算d=一段路径的长度L/传播速度V ，然后耗时为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">d</span></span></span></span></li>
</ul>
<h2 id="滑动窗口协议及其计算"><a class="header" href="#滑动窗口协议及其计算">滑动窗口协议及其计算</a></h2>
<p>效率：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">传输时延</span><span class="mord mathnormal">Tt</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">传播时延</span><span class="mord mathnormal">Tp</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，若采用piggy-back捎带确认，则为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>（因为加了发送一个返回数据包的时间）</p>
<h4 id="停等协议"><a class="header" href="#停等协议">停等协议</a></h4>
<p>效率：W=1</p>
<p>有错情况的效率：p为一帧的出错率，则W=1-p</p>
<p>1比特的序号位和没有序号是不同的，后者会有重复帧问题，不能取消</p>
<h4 id="gbn"><a class="header" href="#gbn">GBN</a></h4>
<p>1、效率：W=窗口长度，当P&gt;1时取1</p>
<p>2、发送0-7，首尾1、2、6的ACK，计时器超时后需要重传几帧？</p>
<ul>
<li>7号帧一个，因为会发出ACK6，一定意味着0-6全部无误收到</li>
</ul>
<p>3、窗口长度与序号的关系？</p>
<ul>
<li><strong>窗口长度&lt;最大序号，即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>。如序号是0~3，则窗口最大只能是0~2。</strong> 若窗口0~3，则发0~3然后ack全丢之后重传0，接收方会认为这是一个新的分组；若为0~2，则接收方期待3却收到0，就知道这个是重传的</li>
</ul>
<p>4、即RWS接收窗口=1的情况</p>
<h4 id="sr"><a class="header" href="#sr">SR</a></h4>
<p>1、效率：W=窗口长度，同上</p>
<p>2、发送0-3，收到ACK1，0、2超时：谁超时就重传谁，所以02两个</p>
<p>3、窗口长度与序号的关系？</p>
<ul>
<li><strong>窗口长度<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span>最大序号范围的一半，即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。如序号是0~7，则窗口最大只能是0~3,长度是8/2=4；若序号0~4，则窗口最大是0~1,长度是5/2=2。</strong> 如第一种情况，窗口0到4的话，发出01234，ack全部丢失，则接收方认为应该接受56701，此时重传01234，其中的01无法分辨是新的还是重传的（若后者情况，窗口012的话则序号0是重叠的）</li>
</ul>
<p>4、即RWS=SWS接受窗口=发送窗口的情况</p>
<p><img src="computer-networks/./assets/image-20230427145427527.png" alt="image-20230427145427527" /></p>
<h2 id="mac子层-1"><a class="header" href="#mac子层-1">MAC子层</a></h2>
<h3 id="随机接入"><a class="header" href="#随机接入">随机接入</a></h3>
<h4 id="aloha-1"><a class="header" href="#aloha-1">ALOHA</a></h4>
<ul>
<li>纯ALOHA：脆弱期2T（T为传输时间，为包大小d/带宽B），效率<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">18%</span></span></span></span>，完全分散</li>
<li>时隙ALOHA：脆弱期T，效率<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">37%</span></span></span></span>  ，需要统一时钟来定位时隙</li>
</ul>
<h4 id="csmacd"><a class="header" href="#csmacd">CSMA/CD</a></h4>
<ul>
<li>
<p>脆弱期2<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>（<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>为传播到该网段最远处的耗时，常为线缆长度L/传播速度V）</p>
</li>
<li>
<p>半双工。随机接入的主流</p>
</li>
</ul>
<h4 id="无线网"><a class="header" href="#无线网">无线网</a></h4>
<p>802.3：曼彻斯特编码，速率=赫兹=码率/2，一次调制10bit，</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="概述-2"><a class="header" href="#概述-2">概述</a></h2>
<p><del>算了，稍微写了一点，然后感觉好像也没啥用，主要去看题了，所以其实只是补充和调整了一下期中及之前的</del></p>
<h3 id="体系结构-1"><a class="header" href="#体系结构-1">体系结构</a></h3>
<p><img src="computer-networks/./assets/image-20230427151412250.png" alt="image-20230427151412250" /></p>
<ol>
<li>会话层：主机间通信</li>
<li>表示层：数据表示</li>
<li>应用层：网络应用进程</li>
</ol>
<p>层次从下往上编号，物理层是第一层</p>
<p><img src="computer-networks/./assets/image-20230426131936517.png" alt="image-20230426131936517" /></p>
<h2 id="物理层-2"><a class="header" href="#物理层-2">物理层</a></h2>
<ul>
<li>速度：双绞线&lt;细缆&lt;粗缆&lt;光纤</li>
</ul>
<h3 id="t1链路pcm-1"><a class="header" href="#t1链路pcm-1">T1链路（PCM）</a></h3>
<p><strong>最初级的复用</strong></p>
<p><strong>传统的模拟话音4KHz，因此使用8KHz频率采样，即8000Baud/s，然后每波特调制为7bit，再加1bit控制信号一起传输，所以每条信道56kbps。</strong></p>
<p><strong>这个带宽太低，所以把24条这样的信道塞在一根线上，因为每秒8000次采样，所以每条信道需要每125微秒传一次数据，因此每个125us内，先传输24*8=192bit数据，然后传输1bit的成帧信号（即，将24条信道同时传输的这一个波特封装成一个帧）</strong></p>
<p><strong>别管加的那几bit的控制信号算不算带宽，总之就是1.544Mbps</strong></p>
<ul>
<li>采样时间为什么设置为 125μs？——话音信道的带宽为4KHz，按照奈奎斯特定理，采样频率应该为带宽的 2 倍，即每秒采样 8000 次，即每 125μs 采样一次。</li>
<li><strong>时分复用TDM</strong></li>
<li>每帧125us，所以8k帧率（波特率/采样率），每帧193bit</li>
<li>0bit为帧编码，然后分24个频道，每频道8bit，其中前7个是数据，8是信号——总之是每波特7bit数据，<strong>若指定了</strong>带宽不是4k，那就是2H*7</li>
<li>速率：8k波特率，每波特24个频道，其中每频道7bit数据+1控制——因此，<strong>每频道的速率：8k*7=56k数据，及8k的控制信号。总速率：56k*24=1.536MHZ，加上0bit处的8k速率=1.544Mbps。</strong>     （T2为6Mbps，T3为45）</li>
</ul>
<h3 id="adsldmt-1"><a class="header" href="#adsldmt-1">ADSL（DMT）</a></h3>
<p>比T1更快，大约下载30M，上传12M</p>
<p><strong>T1是每125us传输一轮24条信道的数据，ADSL是把话音的4KHz大大拓宽成了1.1MHz，然后分出了256条信道，频分复用取了后面的248条拿来传输数据</strong></p>
<ul>
<li>Modem（2.4kHZ）的升级，大大拓宽频率，分成多个信道，从kbps变到mbps</li>
<li><strong>频分复用</strong></li>
<li>上下行非对称</li>
<li>总共1.1MHZ，分到256信道，每个4312.5HZ。4000波特率，15bits/波特</li>
<li>保卫带400hz（不确定）</li>
<li>0信道（低频）是原有的电话线</li>
<li>1-5不使用，隔开数据和语音</li>
<li>2个信道上/下控制，248个信道数据传输</li>
</ul>
<h3 id="其他-1"><a class="header" href="#其他-1">其他</a></h3>
<ul>
<li>怎么在物理链路上传输bit流是链路层的事（成帧、检错等），物理层只管发，它解决的是连接的建立、维持等；并尽量屏蔽物理链路的差异。并且物理链路两边的传输速率、链路层协议都要一样。</li>
<li>集线器是物理层设备</li>
<li>
<ul>
<li>不归零编码（NRZ）：1=正，0=负</li>
<li>曼彻斯特编码：bit在时钟信号的中间表示，上/下跳变表示一个0/1，并且一段较长的0/1之间是两个bit的区分点</li>
<li>差分曼彻斯特：类似，但是每个bit表示的是与前一个bit有无差别，有差别则记为1</li>
</ul>
</li>
</ul>
<h2 id="链路层-1"><a class="header" href="#链路层-1">链路层</a></h2>
<h3 id="字节与编码-1"><a class="header" href="#字节与编码-1">字节与编码</a></h3>
<h4 id="hdlc协议"><a class="header" href="#hdlc协议">HDLC协议</a></h4>
<ul>
<li>0111 1110为<strong>首尾</strong>标志比特流</li>
<li><strong>比特填充法</strong></li>
<li>有连接，有序号，有ack，可靠</li>
<li>内容中出现连续5个1时，则在第五个1后插入一个0——无论不插入是否会构成0111 1110：比如0111 1100 ，倒数第二个0依然是填充进去的，需要被去除，虽然不填它也不会出现6个1</li>
</ul>
<h4 id="ppp协议"><a class="header" href="#ppp协议">PPP协议</a></h4>
<ul>
<li>flag为0xaa（某个数），转义为0xbb (另外一个数)，这构造时在这两个前面都加一个转义，解码时反之</li>
<li><strong>字节填充法</strong></li>
<li>无连接，无序号，无ack，不可靠</li>
<li><strong>首尾</strong>都有flag字节</li>
<li>0x7d：转义。0x7e：帧首尾。    0x7e变为0x7d5e。   0x7d变为0x7d5d。ascii控制字符（<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span>0x20）前，加0x7d</li>
<li>协议和校验和字段的长度可变（最小5字节，最大10字节）</li>
</ul>
<h4 id="crc校验码-1"><a class="header" href="#crc校验码-1">CRC校验码</a></h4>
<ul>
<li>生成式：多项式，从n次幂到0次幂，系数非0的项为1。如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，则生成式为1001</li>
<li>计算方法：用待发送的比特流，左移生成式位数-1（最高阶），补0，除以生成式（竖式，除的每一步为异或操作），余数即为校验位</li>
<li>检验：收到的比特流除以生成式，不为0即有错。</li>
</ul>
<h4 id="海明码-1"><a class="header" href="#海明码-1">海明码</a></h4>
<ul>
<li>纠正单个错误的码字位数下界：m个消息位，r个校验位：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span>（或者说，表示<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>的比特可以管到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>之前的比特，即4号位那个比特可以检验第5-7位的bit有没有错）</li>
<li>构造：
<ul>
<li>计算r</li>
<li>写n=m+r个空，从1~n标下标，1、2、4、……为校验位，空着；其他位左到右依次填入待发送码字</li>
<li>将填入的比特中，为1的位的下标异或起来。如：_ _ 1_  010  则计算3^6=101，那么101填入上面的空格，变为1011 010就是结果。</li>
</ul>
</li>
<li>检验并纠错：
<ul>
<li>如上述正确是1011 010，错一位变成1010 010（错校验还是消息没区别），那么把<strong>所有为1的位的下标异或起来</strong>，如：1^3^6=100即第四位出错，翻转回来得到正确的。</li>
</ul>
</li>
</ul>
<h4 id="其他-2"><a class="header" href="#其他-2">其他</a></h4>
<ul>
<li>调制解调器使用字节传输，所以不适用比特填充法</li>
<li>ADSL比普通电话线：扩展带宽，3400以上</li>
<li>单模光纤比多模快</li>
</ul>
<h3 id="其他计算-1"><a class="header" href="#其他计算-1">其他计算</a></h3>
<ul>
<li>p2p信道，数据帧成功概率p，ack不会错，求成功发送的次数：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1488em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2019em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>因为相同设备的接口针脚功能相同,比如1号端口发送2号接受，需要1号对应2号，2号对应一号</li>
<li>因特网校验和：低到高计算，溢出的高位带回低位计算，算完取反</li>
</ul>
<h4 id="存储-转发的分组交换网络-1"><a class="header" href="#存储-转发的分组交换网络-1">存储-转发的分组交换网络</a></h4>
<ul>
<li>计算包的个数n、计算发送一个包的耗时t，看路径有<strong>几跳</strong>k(k跳意味着有k段路径，不算首尾k-1个节点，算上首尾有k+1个节点)；</li>
<li>传输(Transmission )耗时：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>：就像cpu的流水线，第一个包发出、第一个包第二跳发出的同时第二个包的第一跳发出……因此可以看成nt+最后一个包再跑了k跳</li>
<li>传播（propagation）耗时：计算d=一段路径的长度L/传播速度V ，然后耗时为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">d</span></span></span></span></li>
</ul>
<h3 id="滑动窗口协议及其计算-1"><a class="header" href="#滑动窗口协议及其计算-1">滑动窗口协议及其计算</a></h3>
<p>效率：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">传输时延</span><span class="mord mathnormal">Tt</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">传播时延</span><span class="mord mathnormal">Tp</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，若采用piggy-back捎带确认，则为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>（因为加了发送一个返回数据包的时间）</p>
<h4 id="停等协议-1"><a class="header" href="#停等协议-1">停等协议</a></h4>
<p>效率：W=1</p>
<p>有错情况的效率：p为一帧的出错率，则W=1-p</p>
<p>1比特的序号位和没有序号是不同的，后者会有重复帧问题，不能取消</p>
<h4 id="gbn-1"><a class="header" href="#gbn-1">GBN</a></h4>
<p>1、效率：W=窗口长度，当P&gt;1时取1</p>
<p>2、发送0-7，首尾1、2、6的ACK，计时器超时后需要重传几帧？</p>
<ul>
<li>7号帧一个，因为会发出ACK6，一定意味着0-6全部无误收到</li>
</ul>
<p>3、窗口长度与序号的关系？</p>
<ul>
<li>**窗口长度&lt;最大序号，即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>。如序号是0~3，则窗口最大只能是0~2。**若窗口0~3，则发0~3然后ack全丢之后重传0，接收方会认为这是一个新的分组；若为0~2，则接收方期待3却收到0，就知道这个是重传的</li>
</ul>
<p>4、即RWS接收窗口=1的情况</p>
<h4 id="sr-1"><a class="header" href="#sr-1">SR</a></h4>
<p>1、效率：W=窗口长度，同上</p>
<p>2、发送0-3，收到ACK1，0、2超时：谁超时就重传谁，所以02两个</p>
<p>3、窗口长度与序号的关系？</p>
<ul>
<li><strong>窗口长度<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span>最大序号范围的一半，即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。如序号是0~7，则窗口最大只能是0~3,长度是8/2=4；若序号0~4，则窗口最大是0~1,长度是5/2=2。</strong> 如第一种情况，窗口0到4的话，发出01234，ack全部丢失，则接收方认为应该接受56701，此时重传01234，其中的01无法分辨是新的还是重传的（若后者情况，窗口012的话则序号0是重叠的）</li>
</ul>
<p>4、即RWS=SWS接受窗口=发送窗口的情况</p>
<p><img src="computer-networks/./assets/image-20230427145427527.png" alt="image-20230427145427527" /></p>
<h2 id="mac子层-2"><a class="header" href="#mac子层-2">MAC子层</a></h2>
<h3 id="随机接入-1"><a class="header" href="#随机接入-1">随机接入</a></h3>
<h4 id="aloha-2"><a class="header" href="#aloha-2">ALOHA</a></h4>
<ul>
<li>纯ALOHA：脆弱期2T（T为传输时间，为包大小d/带宽B），效率<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">18%</span></span></span></span>，完全分散</li>
<li>时隙ALOHA：脆弱期T，效率<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">37%</span></span></span></span>  ，需要统一时钟来定位时隙</li>
</ul>
<h4 id="csmacd-1"><a class="header" href="#csmacd-1">CSMA/CD</a></h4>
<ul>
<li>
<p>脆弱期2t（t为传播到该网段最远处的耗时，常为线缆长度L/传播速度V）</p>
</li>
<li>
<p>半双工。随机接入的主流</p>
</li>
</ul>
<h4 id="csmaca"><a class="header" href="#csmaca">CSMA/CA</a></h4>
<h3 id="无线网-1"><a class="header" href="#无线网-1">无线网</a></h3>
<p>802.3：曼彻斯特编码，速率=赫兹=码率/2，一次调制10bit，</p>
<h3 id="vlan"><a class="header" href="#vlan">VLAN</a></h3>
<h2 id="网络层-2"><a class="header" href="#网络层-2">网络层</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="实验二-抓包"><a class="header" href="#实验二-抓包">实验二-抓包</a></h1>
<h2 id="实验内容和实验环境描述"><a class="header" href="#实验内容和实验环境描述">实验内容和实验环境描述</a></h2>
<h3 id="实验环境"><a class="header" href="#实验环境">实验环境</a></h3>
<p>系统环境：Windows 10、 Ubuntu 23.04（几个指令所访问的，自己的服务器）</p>
<p>所用软件：wireshark 4.0.3、浏览器、cmd</p>
<p>报告撰写：typora</p>
<h3 id="实验任务"><a class="header" href="#实验任务">实验任务</a></h3>
<ul>
<li>捕获 DHCP 报文并分析</li>
<li>发送 ICMP 报文，捕获并分析格式</li>
<li>分析 IP 数据报的分片传输过程</li>
<li>捕获建立连接和释放连接过程的 TCP 报文段并分析</li>
</ul>
<h3 id="实验内容"><a class="header" href="#实验内容">实验内容</a></h3>
<p>如下</p>
<p>##DHCP</p>
<h3 id="dhcp概述"><a class="header" href="#dhcp概述">DHCP概述</a></h3>
<p>DHCP（Dynamic Host Configuration Protocol，动态主机配置协议），使用UDP协议工作。端口为：67（服务器端），68（客户端）</p>
<p>简单来说，DHCP就是一个不需要账号密码登录的、自动给内网机器分配IP地址等信息的协议。</p>
<p>DHCP一共有8中报文，各种类型报文的基本功能如下：</p>
<div class="table-wrapper"><table><thead><tr><th>报文类型</th><th>说明</th><th></th></tr></thead><tbody>
<tr><td>Discover （0x01)</td><td>DHCP客户端在请求IP地址时并不知道DHCP服务器的位置，因此DHCP客户端会在本地网络内以广播方式发送Discover请求报文，以发现网络中的DHCP服务器。所有收到Discover报文的DHCP服务器都会发送应答报文，DHCP客户端据此可以知道网络中存在的DHCP服务器的位置。</td><td></td></tr>
<tr><td>Offer（0x02）</td><td>DHCP服务器收到Discover报文后，就会在所配置的地址池中查找一个合适的IP地址，加上相应的租约期限和其他配置信息（如网关、DNS服务器等），构造一个Offer报文，发送给DHCP客户端，告知用户本服务器可以为其提供IP地址。但这个报文只是告诉DHCP客户端可以提供IP地址，最终还需要客户端通过ARP来检测该IP地址是否重复。</td><td></td></tr>
<tr><td>Request（0x03）</td><td>DHCP客户端可能会收到很多Offer请求报文，所以必须在这些应答中选择一个。通常是选择第一个Offer应答报文的服务器作为自己的目标服务器，并向该服务器发送一个广播的Request请求报文，通告选择的服务器，希望获得所分配的IP地址。另外，DHCP客户端在成功获取IP地址后，在地址使用租期达到50%时，会向DHCP服务器发送单播Request请求报文请求续延租约，如果没有收到ACK报文，在租期达到87.5%时，会再次发送广播的Request请求报文以请求续延租约。</td><td></td></tr>
<tr><td>ACK（0x05）</td><td>DHCP服务器收到Request请求报文后，根据Request报文中携带的用户MAC来查找有没有相应的租约记录，如果有则发送ACK应答报文，通知用户可以使用分配的IP地址。</td><td></td></tr>
<tr><td>NAK（0x06）</td><td>如果DHCP服务器收到Request请求报文后，没有发现有相应的租约记录或者由于某些原因无法正常分配IP地址，则向DHCP客户端发送NAK应答报文，通知用户无法分配合适的IP地址。</td><td></td></tr>
<tr><td>Release（0x07）</td><td>当DHCP客户端不再需要使用分配IP地址时（一般出现在客户端关机、下线等状况）就会主动向DHCP服务器发送RELEASE请求报文，告知服务器用户不再需要分配IP地址，请求DHCP服务器释放对应的IP地址。</td><td></td></tr>
<tr><td>Decline（0x04）</td><td>DHCP客户端收到DHCP服务器ACK应答报文后，通过地址冲突检测发现服务器分配的地址冲突或者由于其他原因导致不能使用，则会向DHCP服务器发送Decline请求报文，通知服务器所分配的IP地址不可用，以期获得新的IP地址。</td><td></td></tr>
<tr><td>Inform（0x08）</td><td>DHCP客户端如果需要从DHCP服务器端获取更为详细的配置信息，则向DHCP服务器发送Inform请求报文；DHCP服务器在收到该报文后，将根据租约进行查找到相应的配置信息后，向DHCP客户端发送ACK应答报文。目前基本上不用了。</td><td></td></tr>
</tbody></table>
</div>
<h3 id="抓包操作"><a class="header" href="#抓包操作">抓包操作</a></h3>
<h4 id="release释放ip"><a class="header" href="#release释放ip">release：释放IP</a></h4>
<p><img src="computer-networks/./assets/image-20230604214351156.png" alt="image-20230604214351156" /></p>
<p><img src="computer-networks/./assets/image-20230604164031796.png" alt="image-20230604164031796" /></p>
<p>报文内容</p>
<pre><code class="language-hex">0000   10 4f 58 6c 0c 00 48 51 c5 5e 4e 71 08 00 45 00
0010   01 48 e1 bf 00 00 80 11 00 00 0a 1c a6 5b 0a 03
0020   09 02 00 44 00 43 01 34 c4 c1 01 01 06 00 15 ad
0030   10 b0 00 00 00 00 0a 1c a6 5b 00 00 00 00 00 00
0040   00 00 00 00 00 00 48 51 c5 5e 4e 71 00 00 00 00
0050   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0060   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0070   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0080   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0090   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00a0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00b0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00c0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00d0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00e0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00f0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0100   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0110   00 00 00 00 00 00 63 82 53 63 35 01 07 36 04 0a
0120   03 09 02 3d 07 01 48 51 c5 5e 4e 71 ff 00 00 00
0130   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0140   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0150   00 00 00 00 00 00
</code></pre>
<h5 id="其他包头"><a class="header" href="#其他包头">其他包头</a></h5>
<h6 id="udp头"><a class="header" href="#udp头">UDP头</a></h6>
<p>后面的DHCP包头中此字段类似，不再展示</p>
<p><img src="computer-networks/./assets/image-20230604164149385.png" alt="image-20230604164149385" /></p>
<p><img src="computer-networks/./assets/image-20230604164810923.png" alt="image-20230604164810923" /></p>
<pre><code>0020   			00 44 00 43 01 34 c4 c1
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Hex值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>00 44</td><td>源端口</td><td>端口68</td></tr>
<tr><td>00 43</td><td>目的端口</td><td>端口67</td></tr>
<tr><td>01 34</td><td>udp包长度</td><td>udp包长300</td></tr>
<tr><td>c4 c1</td><td>校验和</td><td>0xc4c1</td></tr>
</tbody></table>
</div>
<h6 id="ip头略"><a class="header" href="#ip头略">IP头（略）</a></h6>
<p>具体分析内容<strong>见后面分析IP数据包的部分</strong></p>
<p>（可以看到IP包长度328=UDP的308+20）</p>
<p><img src="computer-networks/./assets/image-20230604164157993.png" alt="image-20230604164157993" /></p>
<h6 id="以太网头"><a class="header" href="#以太网头">以太网头：</a></h6>
<p>后面的DHCP包头中此字段类似，不再展示</p>
<p><img src="computer-networks/./assets/image-20230604164211760.png" alt="image-20230604164211760" /></p>
<p><img src="computer-networks/./assets/image-20230604170337845.png" alt="image-20230604170337845" /></p>
<pre><code>0000   10 4f 58 6c 0c 00 48 51 c5 5e 4e 71 08 00 
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Hex值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>10 4f 58 6c 0c 00</td><td>源MAC地址</td><td>48位MAC地址</td></tr>
<tr><td>48 51 c5 5e 4e 71</td><td>目的源MAC地址</td><td>48位MAC地址</td></tr>
<tr><td>08 00</td><td>协议类型</td><td>上层使用IPv4协议</td></tr>
</tbody></table>
</div>
<p>注意长度为14字节，因此包总长度342=IP的328+14<img src="computer-networks/./assets/image-20230604170616771.png" alt="image-20230604170616771" /></p>
<h5 id="dhcp报文内容"><a class="header" href="#dhcp报文内容">DHCP报文内容</a></h5>
<p><img src="computer-networks/./assets/Center.png" alt="img" /></p>
<p><img src="computer-networks/./assets/image-20230604164225254.png" alt="image-20230604164225254" /></p>
<pre><code>0020								 01 01 06 00 15 ad
0030   10 b0 00 00 00 00 0a 1c a6 5b 00 00 00 00 00 00
0040   00 00 00 00 00 00 48 51 c5 5e 4e 71 00 00 00 00
0050   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0060   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0070   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0080   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0090   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00a0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00b0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00c0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00d0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00e0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00f0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0100   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0110   00 00 00 00 00 00 63 82 53 63 35 01 07 36 04 0a
0120   03 09 02 3d 07 01 48 51 c5 5e 4e 71 ff 00 00 00
0130   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0140   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0150   00 00 00 00 00 00
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Hex值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>01</td><td>OP:操作类型</td><td>01：发送给服务器的操作报文<br/>若为02，则是服务器发送的应答报文</td></tr>
<tr><td>01</td><td>Htype:客户端的MAC地址类型</td><td>01：以太网地址</td></tr>
<tr><td>06</td><td>Hlen:MAC地址长度</td><td>以太网地址长度为6</td></tr>
<tr><td>00</td><td>Hops:经过DHCP中继的数目</td><td>未经过中继</td></tr>
<tr><td>15 ad 10 b0</td><td>Xid:用来标识请求的随机数</td><td>无意义</td></tr>
<tr><td>00 00</td><td>Secs：DHCP客户端开始请求后的时间，以秒为单位</td><td>此字段未使用，固定为0</td></tr>
<tr><td>00 00</td><td>Flags：是否广播标志位，只使用最高一个比特</td><td>80：广播发送（申请ip时）<br />00，单播发送（释放/续约ip时）</td></tr>
<tr><td>0a 1c a6 5b</td><td>Ciaddr：DHCP客户端的IP地址</td><td>仅在释放、续约中有值，此处为我电脑的IP:10.28.166.91</td></tr>
<tr><td>00 00 00 00</td><td>Yiaddr：DHCP服务器分配给客户端的IP地址</td><td>仅在DHCP服务器发送的Offer和ACK报文中显示，其他报文中显示为0</td></tr>
<tr><td>00 00 00 00</td><td>Siaddr：下一个为DHCP客户端分配IP地址等信息的DHCP服务器IP地址</td><td>仅在DHCP Offer、DHCP ACK报文中显示，其他报文中显示为0</td></tr>
<tr><td>00 00 00 00</td><td>Giaddr：DHCP客户端发出请求报文后经过的第一个DHCP中继的IP地址。</td><td>如果没有经过DHCP中继， 则显示为0</td></tr>
<tr><td>48 51 c5 5e 4e 71</td><td>Chaddr：DHCP客户端的MAC地址</td><td>由于服务器唯一标识客户端</td></tr>
<tr><td>00 00 00 00   00 00 00 00 00 00</td><td>Chaddr padding：硬件地址最长可达16字节，以太网地址只使用了6字节，所以这里扩展到16</td><td>无意义，且不一定存在，为填充长度的内容</td></tr>
<tr><td>00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00</td><td>Sname：为DHCP客户端分配IP地址的DHCP服务器名称</td><td>DNS域名格式，在Offer和ACK报文中显示发送报文的DHCP服务器名称（如有域名，比如学校这个内网服务器只有ip，的这个字段就一直是空的）</td></tr>
<tr><td>00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 <br />00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</td><td>File：DHCP服务器为DHCP客户端指定的启动配置文件名称及路径信息</td><td>仅在DHCP Offer报文中显示（不一定有）</td></tr>
<tr><td>………………</td><td>Options： 可选项字段</td><td>，长度可变，格式为"代码+长度+数据"。</td></tr>
</tbody></table>
</div>
<h4 id="renew获取ip"><a class="header" href="#renew获取ip">renew：获取IP</a></h4>
<p>DHCP的工作流程</p>
<p><img src="computer-networks/./assets/image-20230604164504749.png" alt="image-20230604164504749" /></p>
<p>DHCP具体的报文格式在上面已经分析展示过了，下面就只例举工作流程中变化的几个关键字段</p>
<h5 id="dhcp-discover"><a class="header" href="#dhcp-discover">DHCP Discover</a></h5>
<ul>
<li>首先，此时我的电脑是没有获取IP地址的，也不知道该向谁请求IP分配，因此设置以太网的目的为全f，即广播地址</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604174649223.png" alt="image-20230604174649223" /></p>
<p>同样的原因，这整个流程中，客户端发出的DHCP包的source IP都是0.0.0.0。</p>
<p><img src="computer-networks/./assets/image-20230604174843064.png" alt="image-20230604174843064" /></p>
<ul>
<li>DHCP字段中，设置发送方式为广播</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604175033979.png" alt="image-20230604175033979" /></p>
<ul>
<li>并说明自己的MAC地址</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604175107868.png" alt="image-20230604175107868" /></p>
<p>即，向所在网络上的所有主机发出一个请求获取IP的DHCP包</p>
<h5 id="dhcp-offer"><a class="header" href="#dhcp-offer">DHCP Offer</a></h5>
<ul>
<li>以太网字段中，源是DHCP服务器的地址（说明学校这个服务器还是阿鲁巴的）。目的是之前Discover中填写的本机MAC</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604175215321.png" alt="image-20230604175215321" /></p>
<ul>
<li>此时由于客户端没有ip，服务器必须也以广播方式发送给所有的主机，因此目的ip是广播的255</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604175436874.png" alt="image-20230604175436874" /></p>
<ul>
<li>此时，服务器其实已经从它的空闲ip中取出了对应的信息，拟定分配给这个客户端（使用MAC地址标识），在Yiaddr字段填上了打算分配的ip（由于我是释放之后立即申请，所以其实不是分配新的，而是从已分配的表里取到了这个ip然后发给我，不过流程是一样的）</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604175634675.png" alt="image-20230604175634675" /></p>
<ul>
<li>同时说明这个操作经过了局域网（总DHCP服务器10.3.9.2，到10.28.128.0/17这个局域网主机）的中转<img src="computer-networks/./assets/image-20230604175759265.png" alt="image-20230604175759265" /></li>
<li>同时，还携带了多个有用的optional字段</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604180007828.png" alt="image-20230604180007828" /></p>
<p>如这里：</p>
<ul>
<li>DHCP服务器IP：10.3.9.2</li>
<li>分配到的这个ip的有效时长：7200s，两小时</li>
<li>所在子网的掩码：17位</li>
<li>子网的路由器地址：10.28.128.1</li>
<li>所在网络的域名服务器：.44和.45（也就是学校的俩总ns服务器）</li>
</ul>
<h5 id="dhcp-request"><a class="header" href="#dhcp-request">DHCP Request</a></h5>
<p>此时客户端已经收到了一个或多个DHCP服务器打算分配给自己的地址，并从中选择一个，发送request包，表示自己打算使用这个ip（学校的环境可能是只有一个服务器，所以没有体现出这个选择？），其他的ip仍然属于服务器</p>
<ul>
<li>由于这个报文需要告知可能的多个服务器说自己选择了哪个ip，因此目的地全部是广播</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604180736301.png" alt="image-20230604180736301" /></p>
<ul>
<li>仍然以客户端ip作为标识</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604180817529.png" alt="image-20230604180817529" /></p>
<ul>
<li>最重要的，通过option的这个字段说明自己选中的是哪个ip</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604180900859.png" alt="image-20230604180900859" /></p>
<ul>
<li>顺带表示自己的主机名</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604180949819.png" alt="image-20230604180949819" /></p>
<h5 id="dhcp-ack"><a class="header" href="#dhcp-ack">DHCP ACK</a></h5>
<p>现在，提供的ip被客户端选中的那个服务器收到request之后，确定将这个ip分配出去，在自己表里记录；而其他的服务器将之前拟分配的ip放回去。</p>
<ul>
<li>以太网地址确定是给那一个客户端，但是这个ACK报文还是需要给整个网络发送，以防万一</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181500423.png" alt="image-20230604181500423" /></p>
<ul>
<li>最后一次确认，告知客户端它的ip</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181249358.png" alt="image-20230604181249358" /></p>
<ul>
<li>消息类型为ACK，客户端收到这一条之后就可以放心使用分配到的ip了（如果没人静态ip撞了的话）</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181357072.png" alt="image-20230604181357072" /></p>
<h4 id="租期续约"><a class="header" href="#租期续约">租期续约</a></h4>
<p>由于写上面的内容耗时比较长，刚好等到了一次续约租期的请求，虽然不是要求的内容，但是这里也展示一下</p>
<ul>
<li>
<p>Transaction ID改变了（最下面两个）</p>
</li>
<li>
<p><img src="computer-networks/./assets/image-20230604181638498.png" alt="image-20230604181638498" /></p>
</li>
<li>
<p>消息类型仍然是request</p>
</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181835441.png" alt="image-20230604181835441" /></p>
<ul>
<li>发送类型变成了单播，只给分配的ip的那个服务器发送</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181759838.png" alt="image-20230604181759838" /></p>
<ul>
<li>Ciaddr字段有值了</li>
</ul>
<p><img src="computer-networks/./assets/image-20230604181826038.png" alt="image-20230604181826038" /></p>
<ul>
<li>ACK包与之前获取ip时的ACK内容一模一样，只有ip地址从广播变成了单播</li>
</ul>
<p>对比之前分配ip过程中的情况，，可以发现除了上面这几点基本没啥变化。</p>
<p>所以我觉得，可以认为租期续约的请求基本和获取IP时request+ACK这个两个包类似，只不过是从广播变成了单播</p>
<h2 id="icmp-1"><a class="header" href="#icmp-1">ICMP</a></h2>
<h3 id="icmp概述"><a class="header" href="#icmp概述">ICMP概述</a></h3>
<p>ICMP是 Internet Control Message Protocol 的缩写，即互联网控制消息协议。</p>
<p>ICMP属于网络层的一部分，分为两大类，查询报文和差错报文</p>
<h3 id="抓包操作-1"><a class="header" href="#抓包操作-1">抓包操作</a></h3>
<p>指令：ping www.baidu.com</p>
<p><img src="computer-networks/./assets/image-20230604183547173.png" alt="image-20230604183547173" /></p>
<p>可以观察到，两条消息一组，共4组</p>
<p>这里以第一组为例：<img src="computer-networks/./assets/image-20230604183645108.png" alt="image-20230604183645108" /></p>
<h4 id="ip包头"><a class="header" href="#ip包头">ip包头</a></h4>
<p>以太网头和UDP头在前面分析过了，这里再具体看一下IP包头</p>
<p><img src="computer-networks/./assets/image-20230604184112632.png" alt="image-20230604184112632" /></p>
<p><img src="computer-networks/./assets/image-20230604183826924.png" alt="image-20230604183826924" /></p>
<pre><code>0000   											45 00 
0010  00 3c 07 f4 00 00 40 01 00 00 0a 1c a6 5b 27 9c
0020  42 0e
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Hex值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>4</td><td>版本号</td><td>半个byte，4即ipv4，如果是6就是ipv6</td></tr>
<tr><td>5</td><td>首部长度</td><td>5，但不是5byte。<br />这里的单位是32bit，也就是有5*4=20byte</td></tr>
<tr><td>00</td><td>ToS：服务类型</td><td>不做详细说明，这里全为0</td></tr>
<tr><td>00 3c</td><td>总长度</td><td>ip数据报的总长度，这里为0x3c=60byte</td></tr>
<tr><td>07 f4</td><td>标识符</td><td>随机选择的数值，无意义。在分段时需相同</td></tr>
<tr><td>000[B]</td><td>标志位（由于它以bit为单位，因此这一栏和下一栏均是bit描述）</td><td>用于分段时表示，依次为：首个bit不适用，第二个是DF，第三个是MF</td></tr>
<tr><td>0 0000 0000 0000[B]</td><td>片偏倚</td><td>分段的片的偏移量。具体说明见后面ip分段的部分</td></tr>
<tr><td>40</td><td>TTL</td><td>可生存的路由跳数，减为0时路由器丢弃</td></tr>
<tr><td>01</td><td>协议</td><td>01即ICMP协议</td></tr>
<tr><td>00 00</td><td>校验和</td><td>这里为0，是因为交给了网卡进行硬件层面的校验，提高速度</td></tr>
<tr><td>0a 1c a6 5b</td><td>源IP</td><td>这里为我电脑的ip 10.28.166.91</td></tr>
<tr><td>27 9c 42 0e</td><td>目的IP</td><td>这里为ping的目的ip，百度的39.156.66.14</td></tr>
<tr><td>……</td><td>optional</td><td>可选项，icmp这里没有</td></tr>
<tr><td>……</td><td>padding</td><td>如果有可选项，需要填充包头至32位的倍数</td></tr>
</tbody></table>
</div>
<h4 id="icmp报文"><a class="header" href="#icmp报文">ICMP报文</a></h4>
<p><img src="computer-networks/./assets/SouthEast.jpeg" alt="ICMP报头格式" /></p>
<p>这里讲跟在ip包头20字节后的内容</p>
<pre><code>0020         08 00 4d 5a 00 01 00 01 
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Hex值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>08</td><td>类型</td><td>表示ICMP报文的类型，08表示Echo (ping) request</td></tr>
<tr><td>00</td><td>代码</td><td>对应ICMP报文的代码，与上一字节共同确定ICMP报文的类型</td></tr>
<tr><td>4d 5a</td><td>校验和</td><td>整个ICMP报文的校验和，包含IP包头</td></tr>
<tr><td>00 01</td><td>标识</td><td>仅适用于回显请求和应答ICMP报文，用于标识本ICMP进程。<br />在一次请求与回显中一致，在一次ping中一共有四个不同的值</td></tr>
<tr><td>00 01</td><td>序列号</td><td>标识一的ping中的多次请求。每发送一次就加一，用来确定是否有丢包</td></tr>
</tbody></table>
</div>
<p>ICMP的data部分，这里是abcdefg……</p>
<pre><code>0020   								 61 62 63 64 65 66
0030   67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76
0040   77 61 62 63 64 65 66 67 68 69

</code></pre>
<p><img src="computer-networks/./assets/image-20230604190853719.png" alt="image-20230604190853719" /></p>
<p>响应的数据报：type变成0，其余的icmp字段无变化</p>
<h5 id="ipv6-ping"><a class="header" href="#ipv6-ping">IPv6 ping</a></h5>
<p>指令：ping nginx.show  （[2001:da8:215:3c02:8e1d:96ff:fef1:f2e3]）</p>
<p><img src="computer-networks/./assets/image-20230604202548890.png" alt="image-20230604202548890" /></p>
<p>和v4的基本相同，icmp报文部分只有类型字段从08变成了80，响应的类型变成了81</p>
<h2 id="ip数据报的分段传输"><a class="header" href="#ip数据报的分段传输">ip数据报的分段传输</a></h2>
<h4 id="抓包操作-2"><a class="header" href="#抓包操作-2">抓包操作</a></h4>
<p>制定8000字节数据，ping一次：<code>ping 10.3.9.2 -l 8000 -n 1</code></p>
<p><img src="computer-networks/./assets/image-20230604234507134.png" alt="image-20230604234507134" /></p>
<p>设置wireshark过滤条件**：<code>ip.src eq 10.3.9.2 or ip.dst eq 10.3.9.2</code>**</p>
<p>ip包头前面分析过了，这里主要看ip包头中，与分段-重组相关的几个地方</p>
<div class="table-wrapper"><table><thead><tr><th>二进制值</th><th>字段类型</th><th>含义</th></tr></thead><tbody>
<tr><td>0</td><td>未使用</td><td>无意义</td></tr>
<tr><td>0</td><td>DF</td><td><strong>这个数据报不分段，如果超出了某一跳链路的MTU，就直接发送失败</strong></td></tr>
<tr><td>1</td><td>MF</td><td><strong>这一个包不是最后一个时设置，表示还有更多的包</strong></td></tr>
<tr><td>0 0000 0000 0000</td><td>片偏倚</td><td>分段的片的偏移量</td></tr>
<tr><td>99 c6</td><td>标识符</td><td>同一个包的多个分段中，此值相同</td></tr>
</tbody></table>
</div>
<h5 id="第一个包"><a class="header" href="#第一个包">第一个包：</a></h5>
<p><img src="computer-networks/./assets/image-20230604215014953.png" alt="image-20230604215014953" /></p>
<p>如图，MF设置为1，表示后续还有分段的片</p>
<p><img src="computer-networks/./assets/image-20230604215041601.png" alt="image-20230604215041601" /></p>
<p>偏移量为0，表示是第一个片</p>
<h5 id="第二个包"><a class="header" href="#第二个包">第二个包</a></h5>
<p><img src="computer-networks/./assets/image-20230604215112140.png" alt="image-20230604215112140" /></p>
<p>flag同上</p>
<p><img src="computer-networks/./assets/image-20230604215126263.png" alt="image-20230604215126263" /></p>
<p><strong>注意偏移量</strong></p>
<p><strong>这里偏移量实际值是1011 1001，为185，而不是这里wireshark给出的1480（以太网MTU=1500，减去IP包头20字节，因此ip的数据MTU为1480）</strong></p>
<p><strong>实际上这里的偏移量单位是8个byte，也就是这个片在整个数据报中，开始的位置是185*8=1480。</strong></p>
<p><strong>那么为什么有这个8byte的倍率呢——ip包头中，总长度字段是16字节的</strong><img src="computer-networks/./assets/image-20230604215417021.png" alt="image-20230604215417021" /></p>
<p>而这里片偏移只有13字节，如果表示分片的精确起始位置的话是不够用的，于是就选择用偏倚的一个bit映射了包总长度的最低3个bit，也就是这个8倍的关系</p>
<p><strong>也因此，当包分段时，要满足网络层数据+包头小于链路MTU，而且数据的长度得是8的整数倍</strong></p>
<p>其余的包都和第二个类似。</p>
<div class="table-wrapper"><table><thead><tr><th>第几个包</th><th>包长度</th><th>DF</th><th>MF</th><th>Offest</th><th>段标识符</th></tr></thead><tbody>
<tr><td>1</td><td>1500</td><td>0</td><td>1</td><td>0</td><td>99 c6</td></tr>
<tr><td>2</td><td>1500</td><td>0</td><td>1</td><td>185</td><td>99 c6</td></tr>
<tr><td>3</td><td>1500</td><td>0</td><td>1</td><td>370</td><td>99 c6</td></tr>
<tr><td>4</td><td>1500</td><td>0</td><td>1</td><td>555</td><td>99 c6</td></tr>
<tr><td>5</td><td>1500</td><td>0</td><td>1</td><td>740</td><td>99 c6</td></tr>
<tr><td>6</td><td>628</td><td>0</td><td>0</td><td>925</td><td>99 c6</td></tr>
</tbody></table>
</div>
<p>（Offset写的是原始二进制值，换算成bit偏移量需要再乘8）</p>
<h5 id="最后一个包"><a class="header" href="#最后一个包">最后一个包</a></h5>
<p><img src="computer-networks/./assets/image-20230604215752228.png" alt="image-20230604215752228" /></p>
<p>可以看到，flag中，MF字段变为0，表示它就是这个identification（0x99c6）所对应的最后一个包，主机收到之后就可以将它组装起来了，每个包放在偏移量*8的位置上即可，比如这个放在925*8=7400bit的位置上</p>
<h2 id="tcp建立连接和释放连接"><a class="header" href="#tcp建立连接和释放连接">TCP建立连接和释放连接</a></h2>
<p>通过浏览器访问网址 nginx.show，并捕获、分析TCP协议过程</p>
<h3 id="三次握手"><a class="header" href="#三次握手">三次握手</a></h3>
<p>如图，本机端口12971和服务器端口80之间的三次握手</p>
<p><img src="computer-networks/./assets/image-20230604221147627.png" alt="image-20230604221147627" /></p>
<h4 id="第一次握手syn-n"><a class="header" href="#第一次握手syn-n">第一次握手：SYN n</a></h4>
<p><img src="computer-networks/./assets/image-20230604221245800.png" alt="image-20230604221245800" /></p>
<p>客户端给服务器发送一个SYN段(在 TCP 标头中 SYN 位字段为 <strong>1</strong> 的 TCP/IP 数据包),</p>
<p>该段中也包含客户端的初始序列号(Sequence number = J)，此例中客户端初始序列号为0，因此是SYN 0。</p>
<h4 id="第二次握手ack-n1syn-m"><a class="header" href="#第二次握手ack-n1syn-m">第二次握手：ACK n+1,SYN m</a></h4>
<p><img src="computer-networks/./assets/image-20230604221647179.png" alt="image-20230604221647179" /></p>
<p>服务器返回客户端 SYN +ACK 段(在 TCP 标头中SYN和ACK位字段都为 1 的 TCP/IP 数据包)， 该段中包含服务器的初始序列号(Sequence number = K)。</p>
<p>同时使 Acknowledgment number = J + 1来表示确认已收到客户端的 SYN段(Sequence number = J)。</p>
<p>此例中，ACK 1，服务器序列号也恰为0，因此SYN 0</p>
<h4 id="第三次握手ack-m1"><a class="header" href="#第三次握手ack-m1">第三次握手：ACK M+1</a></h4>
<p><img src="computer-networks/./assets/image-20230604221701950.png" alt="image-20230604221701950" /></p>
<p>客户端给服务器响应一个ACK段(在 TCP 标头中 ACK 位字段为 <strong>1</strong> 的 TCP/IP 数据包), 该段中使 Acknowledgment number = K + 1来表示确认已收到服务器的 SYN段(Sequence number = K)。</p>
<p>此例中，为ACK 1</p>
<h4 id="后续请求"><a class="header" href="#后续请求">后续请求</a></h4>
<p>之后，双方就使用seq=1来开始通信</p>
<p>比如这里握手之后，客户端第一次请求GET</p>
<p><img src="computer-networks/./assets/image-20230604222034133.png" alt="image-20230604222034133" /></p>
<p>seq为握手之后的1，负载的http请求长度为470</p>
<p><img src="computer-networks/./assets/image-20230604222109056.png" alt="image-20230604222109056" /></p>
<p>服务器的响应，seq=1，ack=471（get请求的tcp长度+1）</p>
<p>客户端再次请求</p>
<p><img src="computer-networks/./assets/image-20230604222326038.png" alt="image-20230604222326038" /></p>
<p>seq变为上次ack的471，同时捎带确认上面一个http 301的374序号</p>
<h4 id="时空图"><a class="header" href="#时空图">时空图</a></h4>
<p><img src="computer-networks/./assets/image-20230604223246179.png" alt="image-20230604223246179" /></p>
<h3 id="四次挥手"><a class="header" href="#四次挥手">四次挥手</a></h3>
<p><img src="computer-networks/./assets/image-20230604224655336.png" alt="image-20230604224655336" /></p>
<p>如图，本机端口1388和服务器端口80，执行四次挥手（第一条理论上是FIN，但是这里多带了ACK，应该是捎带确认了之前发的包，seq号是符合的）</p>
<h4 id="第一次挥手"><a class="header" href="#第一次挥手">第一次挥手</a></h4>
<p><img src="computer-networks/./assets/image-20230604230225259.png" alt="image-20230604230225259" /></p>
<p>（不知道为啥，我这里是由服务器主动发起的fin，也就是那个80，1388是本机端口。不过不影响，分析的流程是一样的，只是调换学的客户端与服务器角色）</p>
<p>服务器发起终止，设置<strong>FIN，seq=1</strong>。（ACK 2与挥手无关，是对之前的捎带确认）</p>
<p>服务器等待来自客户端的确认</p>
<h4 id="第二次挥手"><a class="header" href="#第二次挥手">第二次挥手</a></h4>
<p><img src="computer-networks/./assets/image-20230604230414518.png" alt="image-20230604230414518" /></p>
<p>本机返回ACK包，设置<strong>ACK 2</strong>，<strong>即上一个FIN的seq+1</strong></p>
<p>等待1388这个socket的链接处理完了其他事情后，发送FIN</p>
<p>在此期间内是<strong>仍然可以单方面的向对方发送数据</strong>的，直到要发的发完了，主动的给出一个FIN表示这边同意终止。</p>
<h4 id="第三次挥手"><a class="header" href="#第三次挥手">第三次挥手</a></h4>
<p><img src="computer-networks/./assets/image-20230604230543063.png" alt="image-20230604230543063" /></p>
<p>本机向服务器发送<strong>ACK+FIN</strong>包，设置<strong>ACK 2，FIN 2</strong>，这里的<strong>ack与上一个相同，seq号自己指定</strong></p>
<p>表示本机做好准备终止TCP链接了，发送出最后一个FIN包。此后如果收到了对面的ACK，就不再使用此连接发送，否则的话认为是这个FIN丢包，就不断重发</p>
<h4 id="第四次挥手"><a class="header" href="#第四次挥手">第四次挥手</a></h4>
<p><img src="computer-networks/./assets/image-20230604230941234.png" alt="image-20230604230941234" /></p>
<p>服务器发出ACK包，为<strong>ACK 3</strong>，即本机发往服务器FIN 2的序号+1，进入最后的TIME_WAIT状态</p>
<p>此状态持续两个MSL（Maximum Segment LifeTime 报文最大生存时间  2MSL即数据报来回的最大时间），如果此期间内没有收到重传的FIN，就认为成功终止了TCP连接；如果再次收到，就说明ACK丢包了，重新做出响应。</p>
<h4 id="时空图-1"><a class="header" href="#时空图-1">时空图</a></h4>
<p><img src="computer-networks/./assets/image-20230604232624375.png" alt="image-20230604232624375" /></p>
<h2 id="实验结论和实验心得"><a class="header" href="#实验结论和实验心得">实验结论和实验心得</a></h2>
<p>用时大约5小时</p>
<p>在做实验之外，重新理解了一下各个协议的实现、字段，以及一些需要注意的点，起到了一些复习的作用，对网络层协议的理解更深入了。</p>
<p>不过像拥塞控制、路由等，与实际发包/抓包无关的内容还需要专门复习</p>
<p>另外发现对于TCP的握手和挥手的过程还是不太熟悉，需要再加强一下</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机系统基础课程笔记"><a class="header" href="#计算机系统基础课程笔记">计算机系统基础课程笔记</a></h1>
<p>大二上学期专业基础课——计算机系统基础，课程笔记。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据的位级表示"><a class="header" href="#数据的位级表示">数据的位级表示</a></h1>
<h2 id="数据的表示"><a class="header" href="#数据的表示">数据的表示</a></h2>
<h3 id="bits"><a class="header" href="#bits">Bits</a></h3>
<ul>
<li>Bits的取值可以为0或者1</li>
<li>计算机可以通过Bits判断做什么，Bits还可以代表计算机中的数据</li>
<li>在电路中，Bits是通过电压的高低来代表的</li>
</ul>
<h3 id="字节的编码"><a class="header" href="#字节的编码">字节的编码</a></h3>
<p>1 Byte = 8 bits</p>
<ul>
<li>二进制 00000000~11111111</li>
<li>十进制0~255</li>
<li>十六进制 00~FF</li>
</ul>
<blockquote>
<p>在数据的前面加上0x即表示十六进制</p>
</blockquote>
<h3 id="其他数据类型"><a class="header" href="#其他数据类型">其他数据类型</a></h3>
<p>在32位和64位构架的计算机上，数据类型的表达可能不一样。</p>
<h2 id="位级运算"><a class="header" href="#位级运算">位级运算</a></h2>
<h3 id="布尔代数"><a class="header" href="#布尔代数">布尔代数</a></h3>
<ul>
<li>And 和</li>
<li>Or 或</li>
<li>Not 非</li>
<li>Exclusive Or 异或</li>
</ul>
<p>可以直接将布尔代数的运算方法运用在bit向量上，也就是一个比特串上的运算。所有布尔代数中的运算特性都可以运用在比特向量上。</p>
<blockquote>
<p>布尔代数和集合运算上的相似性：</p>
<ul>
<li>与——集合的交集</li>
<li>或——集合的并集</li>
<li>非——集合的补集</li>
<li>异或——对称差（Symmetric difference）</li>
</ul>
</blockquote>
<h3 id="c语言中的位级运算"><a class="header" href="#c语言中的位级运算">C语言中的位级运算</a></h3>
<p>&amp;，|，~，^运算符都可以在C语言中使用。</p>
<h4 id="同c语言中逻辑操作的比较"><a class="header" href="#同c语言中逻辑操作的比较">同C语言中逻辑操作的比较</a></h4>
<p>C语言中还提供了一系列的逻辑运算符：&amp;&amp;, ||, !，应注意逻辑运算符和位级运算符之间的区别。</p>
<p>在逻辑运算中，具有以下的特征：</p>
<ul>
<li>将0视为假</li>
<li>任何不为0的数据都是真</li>
<li>总是返回0或者1</li>
<li>在逻辑表达式中，如果前半段的语句即可判断整个语句的真假，则直接返回而不继续执行（Early termination）</li>
</ul>
<h3 id="移位运算"><a class="header" href="#移位运算">移位运算</a></h3>
<h4 id="左移"><a class="header" href="#左移">左移</a></h4>
<p>将比特向量向左移位，多余的位直接丢弃，空余的位采用0填充。</p>
<h4 id="右移"><a class="header" href="#右移">右移</a></h4>
<p>将比特向量向右移位，如果是逻辑右移，就在向量的左边填上0，如果是算术移位，就在向量的左边填上符号位，也就是填上最高位。</p>
<blockquote>
<p>如果移动一个负值或者移动的长度超过了比特向量的长度（字长），那么就是未定义的操作，在不同机器中会表现出不同的行为。</p>
</blockquote>
<h2 id="整数"><a class="header" href="#整数">整数</a></h2>
<h3 id="有符号整数和无符号整数的表示"><a class="header" href="#有符号整数和无符号整数的表示">有符号整数和无符号整数的表示</a></h3>
<p>将一个比特串转换为无符号的整数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8747em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>将一个比特串转换为有符号的整数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8747em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="表示范围"><a class="header" href="#表示范围">表示范围</a></h3>
<p>对于一个无符号的整数，其最小值是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>， 其的最大值是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p>
<p>对于一个有符号的整数，其最小值是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，其的最大值是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p>
<p>对于一个短整型类型的整数，其的字长是16位：</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>16</th></tr></thead><tbody>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>65535</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td>32767</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">in</span></span></span></span></td><td>-32768</td></tr>
</tbody></table>
</div>
<p>我们不难发现，其中存在着：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li>无符号整数和有符号整数中非负数的位级表示是一致的</li>
<li>每一个比特串都只代表着一个唯一的整数，即唯一性，也就是我们可以建立起一对函数将整数转换为比特串</li>
</ul>
<h3 id="类型转换和强制类型转换"><a class="header" href="#类型转换和强制类型转换">类型转换和强制类型转换</a></h3>
<p>在有符号和无符号整数相互转换的过程中，先转换为一个比特串，再重新表示，也就是说再转换的过程中，位级的表示是不会变换的。</p>
<p>在C语言中：</p>
<ul>
<li>在默认情况下，常量均是作为有符号的整数看待的</li>
<li>在有符号数和无符号数之间的强制类型转化将按照位级表示不变的方式执行</li>
<li>在赋值的过程中发生的隐式类型转换也按照位级表示不变的方式执行</li>
<li>在一个有符号和无符号混杂的表达式中，有符号的整数会被先转换为无符号的整数</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>常数</th><th>常数2</th><th>结果</th><th>运算时的类型</th></tr></thead><tbody>
<tr><td>0</td><td>0U</td><td>==</td><td>unsigned</td></tr>
<tr><td>-1</td><td>0</td><td>&lt;</td><td>signed</td></tr>
<tr><td>-1</td><td>0U</td><td>&gt;</td><td>unsigned</td></tr>
<tr><td>214748647</td><td>-214748647-1</td><td>&gt;</td><td>signed</td></tr>
<tr><td>214748647U</td><td>-214748647-1</td><td>&lt;</td><td>unsigned</td></tr>
<tr><td>-1</td><td>-2</td><td>&gt;</td><td>signed</td></tr>
<tr><td>(unsigned)-1</td><td>-2</td><td>&gt;</td><td>unsigned</td></tr>
<tr><td>214748647</td><td>214748648U</td><td>&lt;</td><td>unsigned</td></tr>
<tr><td>214748647</td><td>(int)214748648U</td><td>&gt;</td><td>signed</td></tr>
</tbody></table>
</div>
<p>总结：类型转换都是保持位级表示不变而重新解释。</p>
<h3 id="扩展和截断"><a class="header" href="#扩展和截断">扩展和截断</a></h3>
<p>将低字长的整数转换为高字长的整数称为扩展，无符号数在前面填0，而有符号数在前面填1。</p>
<p>将高字长的整数转换为低字长的整数称为截断，直接抛弃前面的位就可以了，再对结果进行重新解释。</p>
<h3 id="加减乘除"><a class="header" href="#加减乘除">加减乘除</a></h3>
<h4 id="无符号整数的相加"><a class="header" href="#无符号整数的相加">无符号整数的相加</a></h4>
<p>按位相加，将溢出的数位直接忽略。或者用更加数学化的语言：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="有符号整数的相加"><a class="header" href="#有符号整数的相加">有符号整数的相加</a></h4>
<p>与无符号整数的加法在位级表现上是一致的，仍然是按位相加，并且忽略溢出的部分。也就是说，运行下面给一段C代码：</p>
<pre><code class="language-c">int s, t, u, v;
s = (int) ((unsigned)u + (unsigned)v);
t = u + v;
</code></pre>
<p>在运行之后的结果是<code>s == t</code>。</p>
<p>在有符号整数相加的溢出中，如果结果大于等于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，那么发生负溢出，结果是一个负数，如果结果小于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，那么发生正溢出，结果是一个负数。</p>
<h4 id="整数的乘法"><a class="header" href="#整数的乘法">整数的乘法</a></h4>
<p>存储w位的整数的乘法需要<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span></span></span></span>位的空间。在实际的计算过程中，仍然是忽略掉所有溢出的数位，在数学上就是：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>有符号数和无符号上乘法在细节上可能存在一定的差异，但是最后计算结果的低位是一致的。</p>
<p>在实现乘以2的幂时，我们可以通过移位操作来实现，也就是说<code>u &lt;&lt; k</code>得出的结果就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>，这个结论对于无符号整数和有符号整数都是成立的。而且对于现代的处理器来说，移位和加法操作远快于乘法操作，因此在计算乘法时，编译器会尽量优化为移位和加法操作来完成。</p>
<p>在无符号整数除以2的幂时，我们可以采用逻辑右移来实现，也就是说<code>x &gt;&gt; k</code>就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">u</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">⌋</span></span></span></span>。在有符号整数除以2的幂时，我们可以采用算术右移来实现，也即<code>x &gt;&gt; k</code>就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal">u</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">⌋</span></span></span></span>，但是当结果是负数时，我们希望计算机能向靠近0的方向舍入，也就是向上舍入。于是我们可以进行修正：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>，通过加上一个整数来使结果”看上去“像是向上取整的。</p>
<h4 id="求负数"><a class="header" href="#求负数">求负数</a></h4>
<p>对整数求负数，可以通过<code>-x = ~x + 1</code>来实现。但是这个运算存在两个特例，<code>0</code>和<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，这两个数求负数的结果都是它自己。</p>
<h2 id="位与内存指针和字符串"><a class="header" href="#位与内存指针和字符串">位与内存，指针和字符串</a></h2>
<h3 id="面向字节的内存组织"><a class="header" href="#面向字节的内存组织">面向字节的内存组织</a></h3>
<p>程序通过<strong>地址</strong>来访问内存，我们可以将内存视为一个超级大的字节数组。同时，对于每一个不同的进程，操作系统都提供了一个独立的内存空间供程序使用。</p>
<p>任何计算机都有一个指定的<strong>字长</strong>，通常这个数值指定了<code>int</code>类型和地址的字节长度。现在的大部分计算机都是<code>64</code>位的，也就是说这些计算机采用8字节作为字长。现在的计算机大多都是同时支持32位和64位的，这样在32位时代时编写的程序在64位的计算机上也可以正常的运行。</p>
<p>下面的这张表给出在在不同字长的计算机和<code>x86-64</code>架构计算机上不同数据类型的典型字长。</p>
<div class="table-wrapper"><table><thead><tr><th>C语言中的类型名称</th><th>32位典型值</th><th>64位典型值</th><th>x86-64架构下的大小</th></tr></thead><tbody>
<tr><td>char</td><td>1</td><td>1</td><td>1</td></tr>
<tr><td>short</td><td>2</td><td>2</td><td>2</td></tr>
<tr><td>int</td><td>4</td><td>4</td><td>4</td></tr>
<tr><td>long</td><td>4</td><td>8</td><td>8</td></tr>
<tr><td>float</td><td>4</td><td>4</td><td>4</td></tr>
<tr><td>double</td><td>8</td><td>8</td><td>8</td></tr>
<tr><td>pointer</td><td>4</td><td>8</td><td>8</td></tr>
</tbody></table>
</div>
<h3 id="字节顺序"><a class="header" href="#字节顺序">字节顺序</a></h3>
<p>在内存中储存数据时，显然不可能所有的数据都只占据一个字长的空间。当数据占用了多个字长的空间时，字节的顺序就显得尤为重要。</p>
<p>字节的顺序存在着下面两种情况：</p>
<ul>
<li>大端法</li>
<li>小端法</li>
</ul>
<p>需要指出的是，大端法和小端法并没有任何性能或者其他方面的差异，仅是计算机设计者在设计时的偏好。</p>
<blockquote>
<p>就像是从大头打破鸡蛋还是从小头打破鸡蛋，这是《格列佛游记》中的一个故事，大端法和小端法的英文名称也是来自于这个典故。</p>
</blockquote>
<p>我们可以编写一个C函数来打印一个数据的每个字节：</p>
<pre><code class="language-C">typedef unsigned char* pointer;
void show_bytes(pointer start, size_tlen)
{
    size_t i;
    for (i= 0; i&lt; len; i++)
        printf(”%p\t0x%.2x\n",start+i, start[i]);
    printf("\n");
}

</code></pre>
<h3 id="字符串的表示"><a class="header" href="#字符串的表示">字符串的表示</a></h3>
<p>在C语言中，字符串的表示都是一个字符的数组，每个字符都通过<code>ASCII</code>的方式进行编码。通过每一个字符串都需要是空终止的，也就是说最后一个字符是0。</p>
<blockquote>
<p>这里的0不是字符'0'，而是数值0</p>
</blockquote>
<h2 id="浮点数的表示"><a class="header" href="#浮点数的表示">浮点数的表示</a></h2>
<h3 id="分数的位级表示"><a class="header" href="#分数的位级表示">分数的位级表示</a></h3>
<p>仍然采用一种加权的思想，给每一个二进制位赋予一个权重，对于小数点右边的位数，我们将它们赋给2的负数次方幂的权值。在这种表示方法下，我们可以表示这样的有理数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.2499em;vertical-align:-1.4382em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8117em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>给出一个例子：</p>
<div class="table-wrapper"><table><thead><tr><th>值</th><th>表示</th><th></th></tr></thead><tbody>
<tr><td>5.75</td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">101.1</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr>
<tr><td>2.875</td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">10.11</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></td></tr>
</tbody></table>
</div>
<p>但是这种表示方式具有一定的缺陷：</p>
<ul>
<li>只有符合<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0528em;vertical-align:-0.3574em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.6426em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3574em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>公式的数值可以被精准的表示，其他的分数会被表示为无限循环小数。</li>
<li>小数点的位置时固定的，在表示特别大和特别小的数上时十分困难</li>
</ul>
<h3 id="ieee浮点数标准"><a class="header" href="#ieee浮点数标准">IEEE浮点数标准</a></h3>
<h4 id="ieee-754标准"><a class="header" href="#ieee-754标准">IEEE 754标准</a></h4>
<p>这个标准具有许多的优点：</p>
<ul>
<li>这个1985年确定的标准几乎被大多数的CPU所支持</li>
<li>在处理涉入、上溢和下溢上十分的巧妙</li>
</ul>
<h4 id="浮点数的表示-1"><a class="header" href="#浮点数的表示-1">浮点数的表示</a></h4>
<p>这个标准通过这样一个数学公式表示小数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>符号位<code>s</code>确定这个浮点数是正数还是负数</li>
<li>位数<code>M</code>表示一个位于<code>[1.0,2.0)</code>之间的小数</li>
<li>阶码<code>E</code>表示一个2的一个幂</li>
</ul>
<p>在计算机中，使用<code>MSB</code>准确编码符号位，使用<code>frac</code>近似编码位数，使用<code>exp</code>近似编码阶码。一般有着两种不同的字长来编码浮点数，长度分别为32位和64位，分别被称为单精度浮点数和双精度浮点数。</p>
<p><img src="csapp/./assets/float-encoding-20221120150651-q4i1hm0.png" alt="float-encoding" /></p>
<p>在编码的长度指定之后，通过<code>exp</code>值的不同，被编码的值可以被分为三种不同的情况：</p>
<ul>
<li>
<p><code>exp</code>每一位上都是0，称为非规格化的编码。此时上述数学公式中的<code>E</code>为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">bia</span><span class="mord mathnormal">s</span></span></span></span>，这个<code>bias</code>是一个偏置值，这个偏置值和<code>exp</code>的位数有关，如果<code>exp</code>有着<code>k</code>位，那么<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">bia</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>。</p>
<ul>
<li>如果<code>frac</code>全为0，通过符号位的不同，我们就可以得到两个<code>0</code>，<code>+0</code>和<code>-0</code></li>
<li>如果<code>frac</code>不全为0，我们可以表示那些十分接近于<code>0</code>的值</li>
</ul>
</li>
<li>
<p><code>exp</code>中既有1又有0，称为规格化的编码。此时<code>exp</code>的值等于上述数学公式中的阶码加上偏置值<code>E+bias</code>。</p>
<p>例如现在有一个小数<code>15213.0</code>，则有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">1521</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">1110110110110</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">1.110110110110</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span></span></span></span></span></span></span></span>，于是表示这个数的浮点数的<code>frac</code>部分是<code>11011011011010000000000</code>，<code>exp</code>部分就是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">13</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">13</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">127</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">140</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">1000110</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，于是这个数的浮点形式就是：</p>
<p><img src="csapp/./assets/float-example-20221120150651-ik1na2g.png" alt="float-example" /></p>
</li>
<li>
<p><code>exp</code>中全部都是1，称为特殊编码。这种编码方式下还有这两种不同形式：</p>
<ul>
<li>当<code>frac</code>全为0时，表示无穷大或者无穷下</li>
<li>当<code>frac</code>不全为0时，表示<code>NaN</code>，即不是一个数，这个值常出现在一些非法操作的结果中。</li>
</ul>
</li>
</ul>
<blockquote>
<p>在设计时，将规格化和非规格化分开的目的是从非规格化的数转化为规格化数时，位级表示是平滑的（抽象拉满）。具体如何平滑见下图：</p>
<p><img src="csapp/./assets/normalized-20221120150651-thrnali.png" alt="normal" /></p>
</blockquote>
<h3 id="c语言中的浮点数"><a class="header" href="#c语言中的浮点数">C语言中的浮点数</a></h3>
<p>C语言中实现了两种字长的浮点数，4字节的<code>float</code>和8字节的<code>double</code>。</p>
<p>C语言中<code>float</code>，<code>double</code>和<code>int</code>之间的类型转换比较复杂，介绍如下：</p>
<ul>
<li>
<p>在这三个类型之间相互转换回改变位级表示</p>
</li>
<li>
<p><code>double/float ​</code>转换为<code>int</code>：</p>
<ul>
<li>分数的部分会被直接忽略</li>
<li>会向趋近于0的方向圆整</li>
<li>如果是发生了溢出或者<code>NaN</code>，一般是转换为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
<li>
<p><code>int</code>转换为<code>double</code></p>
<ul>
<li>准确的转换</li>
</ul>
</li>
<li>
<p><code>int</code>转换为<code>float</code></p>
<ul>
<li>将按照指定的舍入模式舍入</li>
</ul>
<blockquote>
<p>具体是个啥模式没说</p>
</blockquote>
</li>
</ul>
<p>为了帮助理解，给出下列例子：</p>
<div class="table-wrapper"><table><thead><tr><th>布尔表达式</th><th>正误</th></tr></thead><tbody>
<tr><td><code>x == (int)(float)x</code></td><td>错误</td></tr>
<tr><td><code>x == (int)(double)x</code></td><td>正确</td></tr>
<tr><td><code>f == (float)(double)f</code></td><td>正确</td></tr>
<tr><td><code>d==(double)(float)d</code></td><td>错误</td></tr>
<tr><td><code>f == -(-f)</code></td><td>正确</td></tr>
<tr><td><code>2/3==2/3.0</code></td><td>错误</td></tr>
<tr><td><code>d &lt; 0.0 -&gt; (d*2) &lt; 0.0</code></td><td>正确</td></tr>
<tr><td><code>d &gt; f -&gt; -f &gt; -d</code></td><td>正确</td></tr>
<tr><td><code>d * d &gt;= 0.0</code></td><td>正确</td></tr>
<tr><td><code>(d + f)-d==f</code></td><td>错误</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="程序的机器级表示"><a class="header" href="#程序的机器级表示">程序的机器级表示</a></h1>
<p>也就是汇编语言。不过根据<code>CSAPP</code>，我们并不需要完全掌握汇编语言，只需要学会阅读汇编语言，并通过对汇编语言的理解写出执行效率更高的<code>C</code>语言代码，毕竟在产生汇编语言这件事上，编译器比我们做得更好也更有耐心。</p>
<h2 id="intel处理器和架构的历史"><a class="header" href="#intel处理器和架构的历史">Intel处理器和架构的历史</a></h2>
<h3 id="intel-x86-处理器"><a class="header" href="#intel-x86-处理器">Intel x86 处理器</a></h3>
<p>在桌面，笔记本和服务器市场都占据很大的市场份额。这主要是因为Intel长期坚持的向前兼容策略，现在生产的处理器仍然可以兼容到1978年出现的8086处理器。</p>
<p>这类的处理器都是复杂指令计算机<code>CISC</code>，这类架构的特点就是提供极为复杂繁多的硬件指令供开发者使用，但是其中只有很小的一个子集是被<code>Linux</code>操作系统所使用的。</p>
<h3 id="intel-64位处理器历史"><a class="header" href="#intel-64位处理器历史">Intel 64位处理器历史</a></h3>
<p>2001年，Intel首次推出64位的计算机处理器，但是这款处理器几乎不兼容32位的应用程序，运行的效率极低，在推出之后的不久就被市场所拒绝。同时，AMD公司采用逐步演进的方式推进64位架构的普及，同时完全兼容之前的32为，在市场中获得了极大的成功，因此现在的64位架构也被称为<code>amd64</code>。</p>
<p><code>IA32</code>就是Intel公司的32位指令集，<code>x86-64</code>就是64位的指令集了。</p>
<h2 id="汇编语言基础"><a class="header" href="#汇编语言基础">汇编语言基础</a></h2>
<h3 id="定义"><a class="header" href="#定义">定义</a></h3>
<ul>
<li>架构<code>Architecture</code>：也被称为<code>ISA</code>，为了编写汇编语言我们需要知道的处理器知识。比如具体的指令集和寄存器。</li>
<li>微架构<code>Microarchitecture</code>：架构的具体实现。比如缓存的大小和处理器运行的频率。</li>
<li>代码格式：
<ul>
<li>机器码：字节级别的程序代码，处理器可以直接执行</li>
<li>汇编代码：机器码的文本表示方式。</li>
</ul>
</li>
<li>ISAs举例：
<ul>
<li>Intel: IA32, x86-64</li>
<li>Arm</li>
<li>RSIC V</li>
</ul>
</li>
</ul>
<h3 id="汇编语言代码的运行环境"><a class="header" href="#汇编语言代码的运行环境">汇编语言代码的运行环境</a></h3>
<p><img src="csapp/./assets/arth-20221120150652-e38vatd.png" alt="架构图" /></p>
<p>在汇编语言运行时，处理器的下列信息是可以访问的：</p>
<ul>
<li><code>PC</code>: Program counter 程序计数器，也就是下一条需要执行的指令的地址</li>
<li>寄存器文件：程序中大量使用的变量存储在这里</li>
<li>条件码：存储各种操作的结果类型，比如运算中是否溢出，是否为0</li>
</ul>
<p>汇编语言支持多种不同的数据类型，在实际运行的过程中，针对不同的数据类型有着不同的指令，这些指令往往只有后缀上的区别。下面是支持的数据类型：</p>
<ul>
<li>1，2，3，8字节的整数</li>
<li>4，8，10字节的浮点数</li>
<li>8，16，32，64字节或者更多的向量数据，由<code>SIMD</code>指令集使用，通过被用在媒体数据中</li>
<li>字节编码的指令</li>
<li>在运行中没有任何聚合的数据类型，例如结构体或者联合</li>
</ul>
<p>在汇编语言运行的过程中还可以访问一系列的寄存器文件，有一些寄存器的具有着约定的含义，例如<code>%rsp</code>寄存器就储存着栈指针的地址。同时使用寄存器还得遵循一系列的规则。每个寄存器都是8个字节大小，但是我们可以通过一些其他的名称来访问这些寄存器的低字节空间。</p>
<p>条件码在执行条件跳转指令，类似于C语言中的<code>if</code>时，有着很大的作用。不过我们通常不需要访问这些数据，而是通过一系列的指令来实现条件跳转操作。</p>
<h3 id="汇编语言指令"><a class="header" href="#汇编语言指令">汇编语言指令</a></h3>
<p>汇编语言中的可执行的操作：在内存和寄存器之前传送数据，对寄存器或者内存中存储的数据进行算术操作，在执行指令的过程中进行控制转移。</p>
<h4 id="传送数据指令"><a class="header" href="#传送数据指令">传送数据指令</a></h4>
<pre><code class="language-nasm">movq Source, Dest
</code></pre>
<p>指令的操作数：</p>
<ul>
<li>立即数：直接编写在代码中的整数，不可变。例如<code>$0x400$</code></li>
<li>寄存器：十六个可以访问的寄存器中的一个</li>
<li>内存：在内存中通过地址访问的一系列的连续的字符，这个地址一般通过一个寄存器指定。这串字符的长度通过指令操作的类型来确定，例如指令的后缀是<code>q</code>，就说明这是一个8字节的操作指令，这串字符的长度就是8个字节。指令操作的数据类型不仅在访问内存时有用，在访问寄存器时也有用，我们已经知道使用寄存器也可以访问寄存器低位的空间了。</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>数据类型</th><th>汇编代码后缀</th><th>大小</th></tr></thead><tbody>
<tr><td>字节</td><td>b</td><td>1</td></tr>
<tr><td>字</td><td>w</td><td>2</td></tr>
<tr><td>双字</td><td>l</td><td>4</td></tr>
<tr><td>四字</td><td>q</td><td>8</td></tr>
<tr><td>单精度浮点数</td><td>s</td><td>4</td></tr>
<tr><td>双精度浮点数</td><td>l</td><td>8</td></tr>
</tbody></table>
</div>
<blockquote>
<p>双精度浮点数和双字的后缀一样不会引起指令的歧义，操作整数和浮点数采用的两套不同的指令</p>
</blockquote>
<p>传送指令举例：</p>
<p><code>movq $0x4 %ras</code>：将立即数4复制到寄存器<code>ras</code>。</p>
<p>在汇编语言中，我们有以下的几种方式来访问内存：</p>
<ul>
<li><code>(R)</code>其中<code>R</code>是一个特定的寄存器，这句指令就是访问寄存器<code>R</code>存储地址的内存空间。例如：<code>movq $-0x134 (%rax)</code>：将一个立即数复制到内存中，目标内存地址由寄存器<code>%rax</code>指定。</li>
<li><code>D(R)</code>其中<code>D</code>是一个立即数，<code>R</code>就是寄存器。这句指令就是在上一句指令的基础上添加了一个常数的偏移量<code>D</code>，所访问的内存地址就是<code>R</code>储存的值加上<code>D</code>，例如<code>movq $0x123 0x8(%rsp)</code>，将一个立即数复制到寄存器<code>%rsp</code>存储值加上8对应的内存空间中</li>
<li><code>D(Rb,Ri,S)</code>，最为通用的内存访问方式。其中<code>D</code>是一个立即数，称作“偏移量”，<code>Rb,Ri</code>是两个寄存器，<code>s</code>也是一个立即数，称作“比例因子”，这个语句访问地址的计算公式是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>所对应的值</li>
</ul>
<blockquote>
<p>其实访问内存的方式有且仅有一种，就是最通用的那种访问方式，前两种方式就是第三种方式的简化形式。同时需要说明的，简化的方式并不只有上述的两种。</p>
</blockquote>
<h4 id="地址计算指令"><a class="header" href="#地址计算指令">地址计算指令</a></h4>
<p><code>leaq Src, Dest</code>：<code>Src</code>是一个地址表达式，<code>Dest</code>存放前述的表达式计算的值。地址表达式的格式和上面内存中寻址的方式是一致的。</p>
<p>在实际中，地址计算指令并不全部是用于地址计算的。因为人们发现这个指令在进行一些运算是十分的方便，例如：为了计算<code>x+4 * y</code>，其中<code>x</code>储存在<code>%rdi</code>寄存器中，<code>y</code>存储在<code>%rsi</code>寄存器中，我们可以用这条指令来计算这个表达式的值<code>leaq (%rdi, %rsi, 4), %rdi</code>，并且把结果存储在<code>%rdi</code>寄存器中。</p>
<h4 id="算术运算指令"><a class="header" href="#算术运算指令">算术运算指令</a></h4>
<p><img src="csapp/./assets/arithmetic-20221120150652-d0dcuvh.png" alt="算数运算指令" /></p>
<p>下面给出一段C语言程序编译为汇编代码的例子，辅助理解。首先，C语言代码如下：</p>
<pre><code class="language-C">long arith(long x, long y, long z)
{
    long t1 = x+y;long t2 = z+t1;
    long t3 = x+4;long t4 = y * 48;
    long t5 = t3 + t4;long rval= t2 * t5;
    return rval;
}
</code></pre>
<p>这个函数编译为汇编代码是：</p>
<pre><code class="language-nasm">arith:
	leaq (%rdi,%rsi), %rax# t1
	addq %rdx, %rax# t2
	leaq (%rsi,%rsi,2), %rdx
	salq $4, %rdx# t4
	leaq 4(%rdi,%rdx), %rcx# t5
	imulq %rcx, %rax# rval
	ret
</code></pre>
<p>同时，在这段汇编代码中，寄存器和C语言中变量的对应关系为：</p>
<div class="table-wrapper"><table><thead><tr><th>寄存器</th><th>C语言中的变量</th></tr></thead><tbody>
<tr><td><code>%rdi</code></td><td><code>x</code></td></tr>
<tr><td><code>%rsi</code></td><td><code>y</code></td></tr>
<tr><td><code>%rdx</code></td><td><code>z</code>, <code>t4</code></td></tr>
<tr><td><code>%rax</code></td><td><code>t1</code>, <code>t2</code>,<code>​ rval</code></td></tr>
<tr><td><code>%rcx</code></td><td><code>t5</code></td></tr>
</tbody></table>
</div>
<p><del>结合着下面给出的寄存器使用列表，这段汇编代码还是很好理解的。</del> 我们可以看见在汇编代码中，编译器使用的大量的<code>leaq</code>来实现算术运算。</p>
<h3 id="从c语言到可执行程序"><a class="header" href="#从c语言到可执行程序">从C语言到可执行程序</a></h3>
<p><img src="csapp/./assets/c-obj-20221120150652-l2vulyk.png" alt="过程" /></p>
<h4 id="编译为汇编代码"><a class="header" href="#编译为汇编代码">编译为汇编代码</a></h4>
<p>采用<code>gcc -Og -S</code>指令可以将C语言源文件编译为汇编语言文件，在指令中<code>-Og</code>表示让<code>gcc</code>采用比较低的优化等级，避免产生的汇编代码的结构和C语言相差过大，方便我们学习。</p>
<blockquote>
<p>需要注明的是，汇编语言和平台强相关，在不同平台上产生的汇编代码可能差异巨大</p>
</blockquote>
<p>我们用一个<code>hello.c</code>的C语言代码来作为示例：</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main()
{
    printf("world, hello!\n");
    return 0;
}
</code></pre>
<p>使用<code>gcc -Og -S hello.c</code>来产生汇编语言：</p>
<pre><code class="language-nasm">        .file   "001.c"
        .text
        .section        .rodata.str1.1,"aMS",@progbits,1
.LC0:
        .string "world, hello!"
        .text
        .globl  main
        .type   main, @function
main:
.LFB23:
        .cfi_startproc
        endbr64
        subq    $8, %rsp
        .cfi_def_cfa_offset 16
        leaq    .LC0(%rip), %rdi
        call    puts@PLT
        movl    $0, %eax
        addq    $8, %rsp
        .cfi_def_cfa_offset 8
        ret
        .cfi_endproc
.LFE23:
        .size   main, .-main
        .ident  "GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0"
        .section        .note.GNU-stack,"",@progbits
        .section        .note.gnu.property,"a"
        .align 8
        .long    1f - 0f
        .long    4f - 1f
        .long    5
0:
        .string  "GNU"
1:
        .align 8
        .long    0xc0000002
        .long    3f - 2f
2:
        .long    0x3
3:
        .align 8
4:
</code></pre>
<h4 id="从汇编代码到可执行文件"><a class="header" href="#从汇编代码到可执行文件">从汇编代码到可执行文件</a></h4>
<p>在这个过程中，涉及到两个程序——<code>assembler</code>汇编器和<code>linker</code>链接器。汇编器将上面产生的汇编代码翻译为二进制代码，链接器负责链接一些运行时库，比如在上面<code>hello.c</code>中使用到的<code>printf</code>函数。</p>
<blockquote>
<p>链接分为静态链接和动态链接，这个不过多叙述</p>
</blockquote>
<h4 id="可执行文件反编译为汇编文件"><a class="header" href="#可执行文件反编译为汇编文件">可执行文件反编译为汇编文件</a></h4>
<p>有些时候，我们想查看手里的二进制文件的汇编代码，我们可以使用反汇编器和调试器。</p>
<p>使用反汇编器：<code>objdump -d exec</code>其中<code>exec</code>是可执行文件的名称</p>
<p>使用调试器：<code>gdb exec</code>其中<code>gdb</code>是一款功能强大的调试器，具体的使用不做叙述。</p>
<blockquote>
<p>注意：对不少商业软件进行反编译是违反用户协议的</p>
</blockquote>
<h2 id="华为鲲鹏处理器简介"><a class="header" href="#华为鲲鹏处理器简介">华为鲲鹏处理器简介</a></h2>
<h3 id="arm处理器简介"><a class="header" href="#arm处理器简介">Arm处理器简介</a></h3>
<p>Arm处理器是一种不同于<code>Intel</code>系列的处理器，采用一套完全不同的指令集架构。Arm处理器采用<strong>授权</strong>的方式在全球范围内进行生产和研发。华为购买了Arm处理器的<strong>架构授权</strong>，其的产品就是鲲鹏处理器。</p>
<h3 id="鲲鹏处理器简介"><a class="header" href="#鲲鹏处理器简介">鲲鹏处理器简介</a></h3>
<blockquote>
<p>不搞硬件 略</p>
</blockquote>
<h3 id="arm寻址方式"><a class="header" href="#arm寻址方式">Arm寻址方式</a></h3>
<p>在Arm中有这些重要的寄存器：</p>
<p><img src="csapp/./assets/arm-register-20221120150652-ktylrqa.png" alt="Arm" /></p>
<blockquote>
<p>可以发现这寄存器的命名比<code>x86-64</code>那座屎山好多了</p>
</blockquote>
<p>下面这张图给出了<code>AArch64</code>和<code>x86</code>中寄存器的不少对比</p>
<p><img src="csapp/./assets/register-difference-20221120150652-9h8tdk0.png" alt="register-difference" /></p>
<p>和<code>x86</code>一样，在<code>AArch64</code>中也存在着状态寄存器，下表给出</p>
<p><img src="csapp/./assets/flag-20221120150652-7xef85t.png" alt="flags" /></p>
<p>在<code>AArch64</code>下有着下列的寻址方式：</p>
<ul>
<li>立即数寻址</li>
<li>寄存器寻址</li>
<li>寄存器间接寻址</li>
<li>基址寻址</li>
<li>相对寻址</li>
</ul>
<blockquote>
<p>还有多寄存器寻址、堆栈寻址和寄存器移位寻址等方式，这里不做叙述</p>
</blockquote>
<h4 id="立即数寻址"><a class="header" href="#立即数寻址">立即数寻址</a></h4>
<p>在立即数寻址指令中地址码就是操作数本身，可以直接使用。在<code>AArch64</code>中，立即数采用<code>#</code>开头。</p>
<p>例如：<code>MOV R0, #0xFF000</code>，将立即数中的值存入<code>R0</code>寄存器中</p>
<h4 id="寄存器寻址-1"><a class="header" href="#寄存器寻址-1">寄存器寻址</a></h4>
<p>操作数的值存储在寄存器，在指令执行时直接去除寄存器中的值进行计算。</p>
<p>例如：<code>MOV R1,R2</code>将<code>R2</code>寄存器的值复制到<code>R1</code>中。</p>
<h4 id="寄存器间接寻址-1"><a class="header" href="#寄存器间接寻址-1">寄存器间接寻址</a></h4>
<p>将操作时从寄存器中所指向的内存中取出，寄存器内存储的是内存地址。</p>
<p>同时，在<code>AArch64</code>中，不能直接对内存中的数据进行运算，需要先用指令将数据从内存中取出，一般常用的指令是<code>LDR</code>读取内存数据，<code>STR</code>写入内存数据。</p>
<p>例如：<code>LDR R1, [R2]</code>将<code>R2</code>地址中指向的数据写入<code>R1</code>。<code>STR R1,[R2]</code>将<code>R1</code>的值写入<code>R2</code>地址对应的内存空间</p>
<h3 id="基址变址寻址"><a class="header" href="#基址变址寻址">基址变址寻址</a></h3>
<p>将基址寄存器的内容和指令中给出的偏移量相加，在得到有效操作数的地址。基址变址寻址存在三种不同的寻址方式：</p>
<ul>
<li>前索引<code>LDR R0, [R1,#4]</code>，访问的地址是<code>R1</code>中的地址加上4。</li>
<li>自动索引<code>LDR R0, [R1, #4]!</code>，访问的地址同上，但是会将新的地址再写入<code>R1</code>。</li>
<li>后索引<code>LDR R0, [R1], #4</code>，访问的地址就是<code>R1</code>中存储的指令，但是在访问之后将相加的值写入<code>R1</code></li>
</ul>
<blockquote>
<p><code>AArch64</code>不再做过多的介绍，如有兴趣自行学习</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="程序的机器级表示数据"><a class="header" href="#程序的机器级表示数据">程序的机器级表示——数据</a></h1>
<h2 id="数组"><a class="header" href="#数组">数组</a></h2>
<h3 id="数组空间的分配"><a class="header" href="#数组空间的分配">数组空间的分配</a></h3>
<p>对于一个类型为<code>T</code>，长度为<code>L</code>的数组来说，C语言编译器会在内存中分配一片连续的内存区域来储存这个数组，这段内存空间的长度是<code>L * sizeof(T)</code>。</p>
<h3 id="数组中值的访问"><a class="header" href="#数组中值的访问">数组中值的访问</a></h3>
<p>在C语言中，这个数组的标识符可以被用作一个访问这个数组中首个元素的指针，而实际上，C语言也通过计算数组中每个元素的地址来直接访问。比如C语言代码<code>z[digit]</code>对应的汇编代码为<code>movl (%rdi,%rsi,4),%eax</code>，其中<code>%rdi</code>寄存器是数组的首地址，<code>%rsi</code>中的值是<code>digit</code>。</p>
<blockquote>
<p>但是C语言编译器在编译的过程中不会检查数组的访问是否越界，它只会傻傻的给出这个内存访问式子。</p>
</blockquote>
<p>可以通过下面这个例子来理解数组和指针之间的联系和区别。</p>
<p>我们通过下面的语句声明两个变量</p>
<pre><code class="language-c">int A1[3];
int *A2;
</code></pre>
<p>这两个语句都可以通过编译。<code>A1</code>和<code>A2</code>都可以访问而不引发空指针异常，他们的字长分别为12和8。<code>*A1</code>和<code>*A2</code>则是字长均为4，而对于<code>A2</code>的取值会引发空指针异常。</p>
<h3 id="多维数组"><a class="header" href="#多维数组">多维数组</a></h3>
<p>对于一个类型为<code>T</code>，<code>M</code>行<code>N</code>列的二维数组，C语言编译器会在内存中分配一片连续的内存空间来储存这个数组，直接将这个二维数组一行行的放在这篇内存区域中。</p>
<p>对于多维数组的数据访问也是类似于普通数组。直接计算需要访问元素的地址，比如对于一个二维的<code>int</code>类型的数组<code>A[i][j]</code>，汇编代码中的地址计算为<code>A+(i * size + j) * 4</code>。</p>
<h2 id="结构体"><a class="header" href="#结构体">结构体</a></h2>
<ul>
<li>一个结构体代表了内存中的一块内存</li>
<li>在这块内存中按照声明的顺序安排每个元素的内存空间</li>
<li>编译器在编译的时候会确定整个结构体的大小和其中每个元素的位置，机器级代码中对于结构体这些内容一无所知。</li>
</ul>
<h3 id="结构体的例子链表"><a class="header" href="#结构体的例子链表">结构体的例子——链表</a></h3>
<p>我们先给出这样一段C语言代码：</p>
<pre><code class="language-c">struct rec {
    int a[4];
    int i;
    struct rec* next;
}

void set_val(struct rec* r, int val)
{
	while(r)
    {
        int i = r-&gt;i;
        r-&gt;a[i] = val;
       r = r-&gt;next; 
    }
}
</code></pre>
<p>其中核心的循环代码为</p>
<pre><code class="language-nasm">.L11:
	movsalq 16(%rdi), %rax
    movl %esi, (%rdi, %rax, 4)
    movq 24(%rdi), %rdi
    testq %rdi, %rdi
    jne .L11
</code></pre>
<p>我们不难从汇编代码中发现，无论是对数组的访问还是对于结构体中元素的访问，都是利用地址的运算来实现的。</p>
<h3 id="结构体和对齐"><a class="header" href="#结构体和对齐">结构体和对齐</a></h3>
<p>为了提高内存访问的效率，内存中指针的地址应该被对齐至4或者8的倍数。而在结构体中，元素的大小又是任意的，因此，在编译含有结构体的代码时，编译器可能在结构体的中间或者前后安排一些“多余的”空间，使结构体和结构体中元素的地址都是4或者8的倍数。</p>
<p>对于每一种数据结构：</p>
<ul>
<li>仅有1位的<code>byte</code>之类的数据类型，没有特别的对齐要求</li>
<li>2位的数据结构，比如<code>short</code>，我们希望他们的地址是2的倍数</li>
<li>对于4位的数据结构，比如<code>int</code>，那最好是4的倍数</li>
<li>对于8位的数据结构，比如<code>double</code>，那么地址最好是8的倍数</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="程序的机器级表示控制"><a class="header" href="#程序的机器级表示控制">程序的机器级表示——控制</a></h1>
<p>在实际的程序执行过程中，代码并不总是从上到下依次执行的，需要根据数据的不同执行不同的语句。这里C语言中表现为流程控制语句，同样的，汇编代码也支持流程控制。我们通过学习C语言的流程控制语句如何在汇编语言中实现来学习汇编语言中的流程控制。</p>
<h2 id="条件码"><a class="header" href="#条件码">条件码</a></h2>
<p>在汇编语言中，我们通过一系列的条件寄存器来判断程序当前执行的状态，还约定一些特定的寄存器来存储程序运行的状态。例如，<code>%rsp</code>寄存器标记了当前内存中栈顶的位置，<code>%rip</code>指明了当前运行指令的位置。条件寄存器是一系列一位寄存器，这些条件寄存器会被隐式或者显式的设置。</p>
<p>条件寄存器有以下的4个，同时注明了他们被隐式设置的条件：</p>
<ul>
<li><code>CF</code>在算术运算的结果使最高位产生了溢出</li>
<li><code>ZF</code>算术运算的结果为0</li>
<li><code>SF</code>算术运算的结果为负数</li>
<li><code>OF</code>符号位产生了溢出</li>
</ul>
<p>可以通过<code>CMP</code>指令和<code>TEST</code>指令进行显式的设置。</p>
<ul>
<li><code>CMP S1, S2</code>基于<code>S2 - S1</code>的值设置条件寄存器</li>
<li><code>TEST S1, S2</code>基于<code>S1&amp;S2</code>的值设置条件寄存器</li>
</ul>
<p>在实践中，我们往往不会直接去访问这些条件条件寄存器，而是通过一系列的条件执行指令来使用。例如，根据条件码的某种组合，将一个字节设置为0或者1；根据条件码跳转到程序的某个其他部分继续执行；或者有条件的传送数据。</p>
<h3 id="条件设置指令"><a class="header" href="#条件设置指令">条件设置指令</a></h3>
<p>在条件寄存器满足一定条件的基础上，将目的寄存器的最低位为设置为0或者1，下图给出了条件寄存器的使用条件。</p>
<p><img src="csapp/./assets/flag-set-20221120150651-2c3d9wc.png" alt="flag-set" /></p>
<p>例如下面一段C语言程序和其对应的汇编语言程序：</p>
<pre><code class="language-c">int gt(long x, long y)
{
	return x &gt; y;
}
</code></pre>
<pre><code class="language-nasm">cmpq %rsi, %rdi # x in %rdi y in %rsi
setg %al;
movzbl %al, %eax
ret
</code></pre>
<blockquote>
<p>在使用<code>cmp</code>指令时，需要尤为注意操作数的顺序。</p>
</blockquote>
<h3 id="条件跳转指令"><a class="header" href="#条件跳转指令">条件跳转指令</a></h3>
<p>在条件寄存器满足一定条件时，跳转到程序的其他部分执行。</p>
<p><img src="csapp/./assets/flag-jump-20221120150651-wwww6fr.png" alt="flag-jump" /></p>
<p>在汇编代码中，<code>jump</code>指令产生的效果类似于C语言中的<code>goto</code>语句，具体的使用在下面的流程控制的实现中具体介绍。</p>
<h3 id="条件传送指令"><a class="header" href="#条件传送指令">条件传送指令</a></h3>
<p>在条件寄存器满足某一条件时，将值复制到目的地。条件指令在1996年之后的处理器中添加，现代的C语言编译器会尝试使用这种指令去优化流程控制语句。因为采用条件传送指令可以让现代处理器流水线执行方式的效率更高。而且使用条件传送指令可以避免控制跳转。下面是一个使用条件传送指令的例子：</p>
<pre><code class="language-c">long absdiff(long x, long y)
{
	long result;
	if (x &gt; y)
		result = x-y;
	else
		result = y-x;
	return result;
}
</code></pre>
<p>其对应的汇编代码是：</p>
<pre><code class="language-nasm">absdiff:
    movq %rdi, %rax# x
    subq rsi, %rax# result= x-y
    movq %rsi, %rdx
    subq %rdi, %rdx# eval= y-x
    cmpq %rsi, %rdi# x:y
    cmovle %rdx, %rax# if&lt;=, result= eval
    ret
</code></pre>
<p>不过使用条件传送指令会存在一些问题。在控制流程比较复杂的时候，条件传送指令会导致多余的运算，因为条件传送指令需要计算每一个分支的运算结果。同时也是由于条件传送指令需要计算每一个分支的运算结果，如果分支中存在一些不安全（例如，访问空指针）或者破坏性的操作（例如：<code>x++</code>）就会导致程序出错。</p>
<h3 id="分支控制"><a class="header" href="#分支控制">分支控制</a></h3>
<blockquote>
<p>就是C语言中的<code>if</code>语句</p>
</blockquote>
<blockquote>
<p>在较新版本的<code>gcc</code>编译器中，<code>if</code>语句可能已经被条件传送指令优化了，因此我们需要使用<code>-fno-if-conversion</code>来告诉<code>gcc</code>不进行优化</p>
</blockquote>
<p>我们先给出一个例子：</p>
<pre><code class="language-c">long absdiff(long x, long y)
{
	long result;
	if (x &gt; y)
		result = x-y;
	else
		result = y-x;
	return result;
}
</code></pre>
<pre><code class="language-nasm">absdiff:
	cmpx0, x1# x:y
	bgt .L4
	sub    x0, x1,x0#x0=x1-x0
.L1:
	ret
.L4:       # x &lt;= y
	subx0,x0, x1
	b .L1
</code></pre>
<p>我们可以用C语言中<code>goto</code>语句来“仿写”这段汇编代码：</p>
<pre><code class="language-c">long absdiff_j(long x, long y)
{
	long result;
	intntest= x &lt;= y;
	if (ntest) 
		gotoElse;
	result = x-y;
	gotoDone;
Else:
	result = y-x;
Done:
	return result;
}
</code></pre>
<p>三元运算符也可以通过上述的方式实现。</p>
<blockquote>
<p><code>goto</code>重写大法在流程控制这里真的很有用</p>
</blockquote>
<h2 id="循环控制"><a class="header" href="#循环控制">循环控制</a></h2>
<h3 id="do-while循环"><a class="header" href="#do-while循环">Do-While循环</a></h3>
<p>我们先给出一个例子：</p>
<pre><code class="language-c">long pcount_do(unsigned long x) 
{
    long result = 0;
    do 
    {
    	result += x &amp; 0x1;
    	x &gt;&gt;= 1;
    } while (x);
    return result;
}
</code></pre>
<p>使用<code>goto</code>重写这段代码：</p>
<pre><code class="language-c">long pcount_goto(unsigned long x) 
{
	long result = 0;
loop:
	result += x &amp; 0x1;
	x &gt;&gt;= 1;
	if(x) gotoloop;
	return result;
}
</code></pre>
<p>在写成<code>goto</code>的版本之后，我们可以容易的写出对应的汇编语言代码。</p>
<pre><code class="language-nasm">	movl    $0, %eax#  result = 0
.L2:# loop:
	movq %rdi, %rdx
    andl    $1, %edx#  t = x &amp; 0x1
    addq    %rdx, %rax#  result += t
    shrq    %rdi#  x &gt;&gt;= 1
    jne     .L2#  if(x) goto loop
    rep; ret#seebookp141
</code></pre>
<p><code>Do-While</code>翻译可以总结为以下的过程：</p>
<p><img src="csapp/./assets/do-while-20221120150651-ws26ilv.png" alt="do-while" /></p>
<h3 id="while循环"><a class="header" href="#while循环">While循环</a></h3>
<p>有了上面学习<code>Do-while</code>的基础，我们直接给出一个<code>While</code>的翻译过程：</p>
<p><img src="csapp/./assets/while-20221120150651-894tbs6.png" alt="while" /></p>
<p>上面给出的翻译只是<code>while</code>语句的一种翻译方式，我们还可以将<code>while</code>循环先改写为<code>do-while</code>再翻译为汇编代码。</p>
<p><img src="csapp/./assets/while-2-20221120150651-pai3a1h.png" alt="while-2" /></p>
<p>对于<code>gcc</code>而言，在使用<code>-Og</code>时会使用第一种翻译方式，在使用<code>-O1</code>时会使用第二种翻译方式。</p>
<h3 id="for循环"><a class="header" href="#for循环">For循环</a></h3>
<p>先将For循环翻译为While循环，再翻译为汇编语言。</p>
<p><img src="csapp/./assets/for-20221120150651-3ro0n7q.png" alt="for" /></p>
<h2 id="switch语句"><a class="header" href="#switch语句">Switch语句</a></h2>
<p>由于switch语句中含有大量的跳转，为了提高跳转的效率，我们引入一个被称为<strong>跳转表</strong>的玩意儿。在跳转表中存储着每一个分支的语句地址，可以将switch的变量当作是这张表的索引，在执行时直接跳转到对应的地址进行执行。</p>
<p>首先给出一段C语言的switch语句如下：</p>
<pre><code class="language-c">long my_switch(long x, long y, long z)
{
    long w = 1;
    switch(x) 
    {
    case 1:
        w = y*z;
        break;
    case 2:
        w = y/z;
        /* Fall Through */
    case 3:
        w += z;
        break;
    case 5:
    case 6:
        w -= z;
        break;
    default:
    	w = 2;
    }
    return w;
}
</code></pre>
<p>汇编代码的跳转部分：</p>
<pre><code class="language-nasm">my_switch:
    movq %rdx, %rcx
    cmpq $6, %rdi   # x:6
    ja .L8
    jmp *.L4(,%rdi,8)
</code></pre>
<p>在这段汇编代码中，首先通过<code>cmpq $6, %rdi</code>处理了<code>default</code>的情况，然后通过一个跳转表完成了具体的分支跳转。</p>
<blockquote>
<p>这种跳转表的使用也被称为间接跳转</p>
</blockquote>
<p>以下是跳转表的设计：</p>
<pre><code class="language-nasm">.section.rodata
	.align 8
.L4:
    .quad.L8# x = 0
    .quad.L3# x = 1
    .quad.L5# x = 2
    .quad.L9# x = 3
    .quad.L8# x = 4
    .quad.L7# x = 5
    .quad.L7# x = 6 
</code></pre>
<p>跳转表的设计也非常的考究，巧妙的实现了对于<code>Fall through</code>和相同分支的处理。</p>
<p><img src="csapp/./assets/jump-table-20221120150651-k7yol83.png" alt="jump-table" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="程序的机器级表示过程"><a class="header" href="#程序的机器级表示过程">程序的机器级表示——过程</a></h1>
<p>我们主要介绍在C语言中函数调用的实现，包括：</p>
<ul>
<li>控制的传送</li>
<li>数据的传送</li>
<li>内存的管理</li>
</ul>
<blockquote>
<p>这些机制的机器级实现完全取决于设计者，这又被称为<strong>ABI</strong>，Application Binary Interface。</p>
</blockquote>
<h2 id="内存中栈的结构"><a class="header" href="#内存中栈的结构">内存中栈的结构</a></h2>
<p>在内存中存这各种各样的区域，每个区域的管理方式和用途都是不同的。内存中栈：就是内存中按照栈的方式管理的区域。</p>
<p>一般来说，在内存中地址小的一端存放程序的代码，而栈的栈底是内存中地址大的另一端。在程序运行的过程中，栈底按照程序的需求在栈底和代码之间的区域移动。栈顶的地址存储在寄存器<code>%rsp</code>中。</p>
<p>在汇编语言中，有着两条专门操作栈的指令：</p>
<ul>
<li><code>pushq Src</code>将<code>Src</code>的值或者其代表值压入栈中储存</li>
<li><code>popq Dest</code>将栈顶中的值弹出，存入<code>Dest</code>中</li>
</ul>
<h2 id="调用规则"><a class="header" href="#调用规则">调用规则</a></h2>
<h3 id="控制转移"><a class="header" href="#控制转移">控制转移</a></h3>
<p>首先给出一个控制转移的例子：</p>
<pre><code class="language-c">void multstore(long x, long y, long *dest)
{
	long t = mult2(x, y);
	*dest= t;
}

long mult2(long a, long b)
{
    long s = a * b;
    return s;
}
</code></pre>
<p>下面是这个函数的汇编代码：</p>
<pre><code class="language-nasm">0000000000400540 &lt;multstore&gt;:
	400540: push   %rbx# Save %rbx
	400541: mov    %rdx,%rbx# Save dest
	400544: callq  400550 &lt;mult2&gt;# mult2(x,y)
	400549: mov    %rax,(%rbx)# Save at dest
	40054c: pop    %rbx# Restore %rbx
	40054d: retq# Return

0000000000400550 &lt;mult2&gt;:
	400550:  mov    %rdi,%rax# a 
	400553:  imul   %rsi,%rax# a * b
	00557:  retq# Return
</code></pre>
<p>在开始函数时，使用机器指令<code>callq Addr</code>来调用对应函数，同时需要将返回的地址，也就是<code>PC</code>所存储的值压入栈中存储，在跳转到对应的地址执行。在执行完毕遇到<code>ret</code>之后，从栈中取出返回地址，跳转执行。保持当前栈顶所储存的值仍是返回地址是被调用函数的工作，因此如果被调用函数使用了栈，需要将栈还原。</p>
<h3 id="数据的传递"><a class="header" href="#数据的传递">数据的传递</a></h3>
<p>对于两条位于不同位置的机器指令来说，他们共享的资源就是那些寄存器，因此在函数调用的过程中，使用寄存器在两个函数之前传递参数。</p>
<p>对于函数的前六个参数，我们约定了六个寄存器来存储他们：</p>
<div class="table-wrapper"><table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr></thead><tbody>
<tr><td>%rdi</td><td>%rsi</td><td>%rdx</td><td>%rcx</td><td>%r8</td><td>%r9</td></tr>
</tbody></table>
</div>
<p>对于函数的返回值，我们将存放在寄存器<code>%rax</code>中。</p>
<p>如果函数有多于六个参数的函数，我们可以通过将参数压入栈中的方式来进行参数的传递。</p>
<h3 id="状态管理"><a class="header" href="#状态管理">状态管理</a></h3>
<p>对于基于栈的语言来说，比如C语言，每个函数的每个调用过程都应该是<strong>可重入的</strong>。</p>
<blockquote>
<p>这里有点太抽象了，我的理解来说，就是每个函数的每次调用都会用到一些寄存器和局部变量，为了确保再调用结束之后这些值不变，我们需要在栈上开辟一点空间来存储这些值。</p>
</blockquote>
<p>这一段被分配的栈空间就被称作栈帧。在一些情况下，还存在着一个栈帧寄存器<code>%rbp</code>，它指向当前栈帧开始的内存地址，这段内存地址中存储的内容是上一段栈帧的起始地址。</p>
<p><img src="csapp/./assets/stack-frame-20221120150651-1glbdr7.png" alt="stack-frame" /></p>
<p>在这段栈帧中保存着这些信息：</p>
<ul>
<li>多余6个的函数调用参数</li>
<li>在寄存器中的无法存储的局部变量</li>
<li>那些值可能被破坏的寄存器值，比如需要使用寄存器<code>r11</code>，但是上一个函数也使用了这个寄存器，为了避免寄存器中的值被破环，先把其中的值保存在栈中再使用这个寄存器。</li>
</ul>
<p>下面给出一个例子：</p>
<pre><code class="language-c">long call_incr() 
{
    long v1 = 15213;
    long v2 = incr(&amp;v1, 3000);
    return v1+v2;
}
</code></pre>
<pre><code class="language-nasm">call_incr:
	subq $16, %rsp
	movq $15213, 8(%rsp)
	movl $3000, %esi
	leaq 8(%rsp), %rdi
	call    incr
	addq 8(%rsp), %rax
	addq $16, %rsp
	ret
</code></pre>
<p>在函数<code>call_incr</code>调用<code>incr</code>的过程中，先在栈上开辟了一段空间储存局部变量<code>v1</code>的值，再调用函数<code>incr</code>。在调用结束之后，将这个值从栈上取出，函数继续。</p>
<h4 id="寄存器保存约定"><a class="header" href="#寄存器保存约定">寄存器保存约定</a></h4>
<p>在函数的调用的过程中，为了保证每个函数使用的寄存器不会被其他的函数改变，将寄存器分为两类：</p>
<ul>
<li>调用者保存寄存器：这些寄存器中的内容应该在调用之前由调用者保存在它自己的栈帧上</li>
<li>被调用者保存寄存器：这些寄存器中的内容应该在调用之后由被调用者保存在它自己的栈帧上，当然如果这个寄存器被调用者不用，自然不用保存。</li>
</ul>
<p>通过这条简单的规则，我们就能确保每个函数使用的寄存器中的值都真是自己的。</p>
<p>用作返回值和调用参数的寄存器是调用者保存的寄存器，毕竟在数据传递的过程中，这些寄存器几乎必然被破坏。其他的寄存器基本都是被调用者保存的寄存器。当然存在几个特殊的寄存器：<code>%r10</code>和<code>%r11</code>就是调用者保存的寄存器，<code>%rbp</code>和<code>%rsp</code>是两个特殊的寄存器。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="程序的机器级表达高级话题"><a class="header" href="#程序的机器级表达高级话题">程序的机器级表达——高级话题</a></h1>
<h2 id="linux内存分配"><a class="header" href="#linux内存分配">Linux内存分配</a></h2>
<p><img src="csapp/./assets/memory-layout-20221120150651-wgcsiv5.png" alt="image-layout" /></p>
<p>内存中一般被分配为下列积几个部分：</p>
<ul>
<li>
<p>栈</p>
<ul>
<li>程序运行时的栈大小，一般最大的栈为8MB</li>
<li>程序中的本地变量一般就放在这个地方</li>
</ul>
</li>
<li>
<p>堆</p>
<p>程序中按照需要分配的动态内存空间，比如<code>malloc</code>和<code>new</code>分配的空间。</p>
</li>
<li>
<p>数据</p>
<p>静态数据存放的空间，比如程序中的全局变量，静态变量，还有程序中的字符串常量。</p>
</li>
<li>
<p>共享库</p>
<p>程序共享的运行时库的存储位置，只读的可执行代码。</p>
<p>一些比较大块的内存分配也会在这里进行。</p>
</li>
</ul>
<h3 id="栈溢出例子"><a class="header" href="#栈溢出例子">栈溢出例子</a></h3>
<pre><code class="language-c">int recurse(int x)
{
    int a[1&lt;&lt;15];
    printf("x = %d. a at %p\n", x, a);
    a[0] = (1&lt;&lt;14)-1;
    a[a[0]] = x-1;
    if (a[a[0]] == 0)
    {
        return -1;
    }
    return recurse(a[a[0]] - 1);
}
</code></pre>
<p>这个递归函数每次在运行的时候都会在栈上分配128KB的空间，当递归次数太多的时候，这个程序就会崩溃推出，报出<code>Segmentation fault</code>。</p>
<h2 id="缓存溢出"><a class="header" href="#缓存溢出">缓存溢出</a></h2>
<h3 id="漏洞"><a class="header" href="#漏洞">漏洞</a></h3>
<p>在访问数组的时候，访问的地址超过数组分配的空间，就被称为缓存溢出漏洞。</p>
<p>在一般情况下，输入字符串的程序十分容易出现这个问题，输出的字符串长度很容易超过程序中分配空间的大小。尤其是如果输入的字符串中包含一些可执行的二进制代码，就会让程序执行一些意外的代码，而往往这些代码不会是善良的。</p>
<h4 id="木马蠕虫和病毒"><a class="header" href="#木马蠕虫和病毒">木马、蠕虫和病毒</a></h4>
<p>这是三种不同种类的恶意软件，在最开始是按照他们的传播方式分类的，但是随着时间的流逝，三者之间的界限正在变得模糊。</p>
<ul>
<li>木马：通过引诱人们进行点击进行传播的软件，往往在电子邮件附件和网络中下载的文件中发现</li>
<li>蠕虫：可以自行进行复制和传播，这个过程是完全自动的</li>
<li>病毒：夺取已安装软件的控制权</li>
</ul>
<h4 id="库函数"><a class="header" href="#库函数">库函数</a></h4>
<p>在C语言中存在不少关于字符串和输入的库函数都是不安全的。比如下面的这个例子<code>gets</code>函数</p>
<pre><code class="language-C">char* gets(char* dest)
{
	int c = getchar();
    char *p = dest;
    while(c != EOF &amp;&amp; c != '\n')
    {
        *p++ = c;
        c = getchar();
    }
    *p = '\0';
    return dest;
}
</code></pre>
<p>仔细分析这个函数，没有任何对于输入字符数量的限制，如果输入的字符数量大于了传入函数的数组大小，输入的字符就会开始破坏栈上的数据。</p>
<p><code>scanf</code>和类似的<code>sscanf</code>、<code>fscanf</code>函数在处理<code>%s</code>的时候也存在类似的问题。</p>
<p><code>strcpy</code>、<code>strcat</code>两个字符串操作函数也存在着相同的问题。</p>
<h4 id="溢出攻击的原理"><a class="header" href="#溢出攻击的原理">溢出攻击的原理</a></h4>
<p>我们先给出一个存在溢出攻击可能的函数：</p>
<pre><code class="language-c">void echo()
{
	char buf[4];
    gets(buf);
    puts(buf);
}
</code></pre>
<p>我们在下面这个函数中调用<code>echo</code>函数：</p>
<pre><code class="language-c">void call_echo()
{
	echo()
}
</code></pre>
<p>为了方便分析，先给出这两个函数的汇编代码：</p>
<pre><code class="language-nasm">00000000004006cf &lt;echo&gt;:
4006cf:48 83 ec18           sub    $0x18,%rsp
4006d3:48 89 e7             mov%rsp,%rdi
4006d6:e8 a5 ffffff         callq400680 &lt;gets&gt;
4006db:48 89 e7             mov%rsp,%rdi
4006de:e8 3d feffff         callq400520 &lt;puts@plt&gt;
4006e3:48 83 c4 18          add    $0x18,%rsp
4006e7:c3                   retq
</code></pre>
<pre><code class="language-nasm">4006e8:48 83 ec08           sub    $0x8,%rsp
4006ec:b8 00 00 00 00       mov$0x0,%eax
4006f1:e8 d9 ffffff         callq4006cf &lt;echo&gt;
4006f6:48 83 c4 08          add    $0x8,%rsp
4006fa:c3                   retq
</code></pre>
<p>然后画出内存中空间分配的示意图：</p>
<p><img src="csapp/./assets/overflow-example-20221120150651-brs5aut.png" alt="overflow-example" /></p>
<p>虽然在程序中的字符数组只有4个字符的大小，但是汇编代码中给这个函数分配了0x18个字节的空间，但是这并不影响这段代码仍然是危险的，如果输入的字符串当长于24个字符的时候，栈上的数据就开始被破坏。而攻击的关键就在这里，这里的数据是函数的返回地址，如果我们输入的字符串中这里的数据”恰好“是一段可执行代码的地址，那在这个函数结束之后，程序就会开始执行意料之外的程序。</p>
<h3 id="补丁"><a class="header" href="#补丁">补丁</a></h3>
<h4 id="不使用具有漏洞的函数"><a class="header" href="#不使用具有漏洞的函数">不使用具有漏洞的函数</a></h4>
<p>解决问题的最好办法就是消除问题，在程序中不要编写这样的代码就可以避免所有的问题。比如，在使用运行时库的时候，使用含有长度限制的函数，比如</p>
<ul>
<li>使用<code>fgets</code>而不是<code>gets</code></li>
<li>使用<code>strncpy</code>而不是<code>strcpy</code></li>
</ul>
<h4 id="系统级的措施"><a class="header" href="#系统级的措施">系统级的措施</a></h4>
<p>虽然不写错误的代码是最完美的解决方案，但是人总是要犯错的。不过我们可以在操作系统上添加一些限制。</p>
<ul>
<li>随机的栈地址</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="异常控制流"><a class="header" href="#异常控制流">异常控制流</a></h1>
<h2 id="控制流"><a class="header" href="#控制流">控制流</a></h2>
<p>在计算机运行的过程中，处理器做一件事，取指令执行，取指令执行……</p>
<p>但是在实际运行过程中，我们总需要改变程序的控制流来实现不同的功能，我们已经介绍了两种：</p>
<ul>
<li><code>jump</code>指令</li>
<li><code>call</code>和<code>ret</code>指令</li>
</ul>
<p>我们把这两种改变都称为<strong>程序状态</strong>的改变。但是在实际中，我们需要对<strong>系统状态</strong>也做出反应，比如网络端口收到了数据包，键盘有了输入，计算机执行了错误的指令。为了解决这个问题，异常控制流就出现了。</p>
<h2 id="异常控制流-1"><a class="header" href="#异常控制流-1">异常控制流</a></h2>
<blockquote>
<p>异常控制流几乎存在于计算机的所有抽象层次上</p>
</blockquote>
<p>低级机制：</p>
<ul>
<li>对系统事件的响应：通过硬件和操作系统结合来实现</li>
</ul>
<p>高级机制：</p>
<ul>
<li>进程上下文的切换：通过操作系统和硬件计时器实现</li>
<li>信号：操作系统实现</li>
<li>非逻辑跳转：<code>setjump</code>和<code>longjump</code>，C语言运行时库实现。</li>
</ul>
<h2 id="异常"><a class="header" href="#异常">异常</a></h2>
<p>异常就是将控制流传送给操作系统内核来处理一系列的事件。操作系统内核是常驻于内存中的程序，事件可能是除数为0，算数指令溢出，<code>I/O</code>请求完成，键盘输入。</p>
<p><img src="csapp/./assets/exception-handler-20221120150651-q4hfwnk.png" alt="" /></p>
<p>由于系统中出现的异常可能是多种多样的，处理这些异常也就需要多段代码。为了根据异常找到指定的处理程序，我们就需要一张类。似于<code>switch</code>跳转表的<strong>异常表</strong>。每一种类型的错误都有一种独特的编号<code>k</code>，这就是跳转表中的索引编号，这个<code>k</code>有时也被称作<strong>终端向量</strong>。</p>
<p>异常有着分类。</p>
<p><img src="csapp/./assets/exception-taxonomy-20221120150652-rukcxad.png" alt="异常分类" /></p>
<h3 id="异步异常"><a class="header" href="#异步异常">异步异常</a></h3>
<p>在CPU的中断引脚上引发的异常，在处理完之后，控制流“原路”返回。</p>
<p>例如：</p>
<ul>
<li>计时器中断</li>
<li>外围<code>I/O</code>设备引发的终端</li>
</ul>
<h3 id="同步异常"><a class="header" href="#同步异常">同步异常</a></h3>
<p>通过执行一个指令而引发的异常。</p>
<ul>
<li>陷阱(Traps)：
<ul>
<li>内部引发的异常</li>
<li>例如：系统调用，断点，特殊指令</li>
<li>控制原路返回</li>
</ul>
</li>
<li>错误(faults)：
<ul>
<li>不是内部引发但是多半是可恢复的</li>
<li>例如：页错误，保护错误，空指针错误</li>
<li>要么重新执行以尝试修正或者终止运行</li>
</ul>
</li>
<li>终止(abort)：
<ul>
<li>非内部引发且不可恢复</li>
<li>例如：非法指令，</li>
<li>终止当前程序</li>
</ul>
</li>
</ul>
<h3 id="系统调用"><a class="header" href="#系统调用">系统调用</a></h3>
<p>对于一个<code>x86-64</code>的系统来说，每一种系统调用都有一个特定的编号：</p>
<div class="table-wrapper"><table><thead><tr><th>编号</th><th>名称</th><th>描述</th></tr></thead><tbody>
<tr><td>0</td><td>read</td><td>Read file</td></tr>
<tr><td>1</td><td>write</td><td>Write file</td></tr>
<tr><td>2</td><td>open</td><td>Open file</td></tr>
<tr><td>3</td><td>close</td><td>Close file</td></tr>
<tr><td>4</td><td>stat</td><td>Get info about file</td></tr>
<tr><td>57</td><td>fork</td><td>Create Process</td></tr>
<tr><td>59</td><td>execve</td><td>Execute a program</td></tr>
<tr><td>60</td><td>_exit</td><td>Terminate process</td></tr>
<tr><td>62</td><td>kill</td><td>Send signal to process</td></tr>
</tbody></table>
</div>
<p>我们描述一种系统调用的例子——打开文件：</p>
<p>现有如下的汇编代码，实现打开文件的操作：<code>open(filename, options)</code></p>
<pre><code class="language-nasm">00000000000e5d70&lt;_open&gt;:
...
e5d79:   b8 02 00 00 00     mov  $0x2,%eax # open is syscall #2
e5d7e:   0f 05                     syscall# Return value in %rax
e5d80:   48 3d 01 f0 ff ff   cmp  $0xfffffffffffff001,%rax
</code></pre>
<p>在这段代码中就使用了<code>syscall</code>这个玩意儿。</p>
<ul>
<li><code>%rax</code>寄存器中存储着系统调用的编号</li>
<li><code>%rdi</code>, <code>%rsi</code>等寄存器存储着参数</li>
<li><code>%rax</code>存储返回值，负返回值往往意味着异常</li>
</ul>
<p>我们不难发现，系统调用和函数调用几乎是一致的，都有着控制的改变，使用相同的寄存器来存储参数和返回值。不过和一般的函数调用还是有着以下几个区别：</p>
<ul>
<li>系统调用是由系统内核执行的，代码执行的特权是不相同的</li>
<li>系统的编号，我们不妨认为就是函数的地址，储存在<code>%rax</code>中</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="链接"><a class="header" href="#链接">链接</a></h1>
<p>将编译出来的多个二进制文件合成一个可执行文件。</p>
<h2 id="为什么使用链接"><a class="header" href="#为什么使用链接">为什么使用链接？</a></h2>
<ul>
<li>
<p>原因一：模块化。</p>
<p>在编写代码时，我们不能把所有的代码都写在同一个源文件中，这样只会写出屎山。</p>
</li>
<li>
<p>原因二：效率。</p>
<ul>
<li>我们可以分别编译。如果我们只是修改了某一个源文件中的一句代码，我们只需要重新编译这一个文件再链接就可以，而不必重新编译整个工程。</li>
<li>我们可以实现库。将一些常用的函数的写成了二进制文件，在后期需要使用的时候，只需要将这个二进制文件和我们的程序链接就可以。</li>
<li>库的链接有着两种方式：静态链接和动态链接。静态链接会将需要用到的库二进制数据复制到可执行文件中。动态链接会将库二进制数据加载到内存中，其他的程序就可以利用内存地址使用库了。</li>
</ul>
</li>
</ul>
<h2 id="链接做了什么"><a class="header" href="#链接做了什么">链接做了什么？</a></h2>
<ul>
<li>
<p>符号解析</p>
<p>程序中会定义或者引用需要使用的函数和全局变量，这些符号变量会储存在目标文件的符号表中。</p>
<p>链接器会重新解析这张符号表，将每个符号和函数的定义同唯一的符号和函数实现对应在一起。</p>
</li>
<li>
<p>重定位</p>
<ul>
<li>将分散的代码和数据合并在一起</li>
<li>将<code>.o</code>​​文件中代码的相对位置重定向到在可执行文件中的最终内存地址</li>
<li>更新文件中对上面这些内容的所有引用</li>
</ul>
</li>
</ul>
<blockquote>
<p>下面我们更详细的介绍这两个步骤。</p>
</blockquote>
<h4 id="对象文件的三种种类"><a class="header" href="#对象文件的三种种类">对象文件的三种种类</a></h4>
<ul>
<li>
<p>可重定向对象文件<code>.o</code>​​</p>
<ul>
<li>包含可以同其他<code>.o</code>​​文件合并为一个可执行文件的代码和数据</li>
<li>每个<code>.o</code>​​是由单个<code>.c</code>​​文件产生的</li>
</ul>
</li>
<li>
<p>可执行文件<code>.out</code>​​​</p>
<p>包含可以直接复制到内存中运行的代码和数据</p>
</li>
<li>
<p>共享库文件</p>
<ul>
<li>一种特殊类型的课重定向对象文件，可以直接加载在内存中然后动态链接，加载时链接或者运行时链接均可。</li>
<li>在Windows操作系统中后缀为<code>.dll</code>​​</li>
</ul>
</li>
</ul>
<h2 id="可执行文件格式"><a class="header" href="#可执行文件格式">可执行文件格式</a></h2>
<p>在不同的系统上采用的可执行文件格式是不相同的，这里主要考虑在现代Unix系统上使用的可执行可链接目标文件(ELF)格式，这是目标文件的标准二进制格式，不论是可重定向文件<code>.o</code>​、可执行文件<code>.out</code>​还是共享库文件<code>.so</code>​都需要遵循这个格式的要求。</p>
<h3 id="elf目标文件格式"><a class="header" href="#elf目标文件格式">ELF目标文件格式</a></h3>
<p>一个典型的ELF文件由三部分组成：ELF文件头、数量不定的节和节头部表。位于文件开头的ELF文件头一般包括这些信息：字长、字节顺序、文件类型（可执行文件、可重定向文件、共享库文件）、机器类型；而位于文件末尾的节头部表描述了文件中不同节的大小和位置。位于文件头和节头部表之间的就是节，节一般有：</p>
<ul>
<li>​<code>.text</code>​：已编译程序的机器代码</li>
<li>​<code>.rodata</code>​：只读数据</li>
<li>​<code>.data</code>​：已初始化的全局和静态C变量</li>
<li>​<code>.bss</code>​：未初始化的全局和静态C变量</li>
<li>​<code>.symtab</code>​：一个符号表，存放程序中定义和引用的函数的全局变量的信息，同编译器中的符号表不同，这里的符号表不会包含局部变量的信息。</li>
<li>​<code>.rel.text</code>​：一个<code>.text</code>​节中位置的列表，当链接器将这个目标文件同其他文件组合时，需要修改这些位置。</li>
<li>​<code>.rel.data</code>​：一个<code>.data</code>​节中位置的列表，也就是模块引用或者定义的所有全局变量的重定位信息。</li>
<li>​<code>.debug</code>​：调试符号表。在<code>gcc</code>​编译中采用<code>-g</code>​选项时，才会生成这张表。</li>
</ul>
<h3 id="符号和符号表"><a class="header" href="#符号和符号表">符号和符号表</a></h3>
<p>在链接器的上下文中存在着三种符号：</p>
<ul>
<li>全局符号：由当前模块定义且可以被其他模块所引用的符号，比如C语言中的非静态的函数和变量</li>
<li>外部符号：由其他模块定义且被当前模块引用的符号</li>
<li>本地符号：由当前模块定义且只能由当前模块引用的符号，比如C语言中静态的函数和全局变量</li>
</ul>
<blockquote>
<p>注意：链接器中符号和本地程序中的符号不能说是一模一样，只能说是毫不相干。</p>
</blockquote>
<p>每个符号都会被分配到目标文件的某个节中。在文件中有三个特殊的伪节，在节头部表中没有条目：<code>ABS</code>​表示不该被重定位的符号，<code>UNDEF</code>​表示未定义的符号，<code>COMMON</code>​表示还未被分配位置的未初始化的数据目标。<code>COMMON</code>​和<code>.bss</code>​节之间的区别很细微，一般的链接器遵循如下的规则来将可重定位目标文件中的符号分配到这两个节中：</p>
<ul>
<li>​<code>COMMON</code>​：未初始化的全局变量</li>
<li>​<code>.bss</code>​：未初始化的静态变量，以及初始化为0的全局或者静态变量</li>
</ul>
<h2 id="符号解析"><a class="header" href="#符号解析">符号解析</a></h2>
<p>链接器解析符号引用的方式是将每个引用都和它输入的可重定位目标文件的符号表中的一个确定的符号定义关联起来。对全局符号的符号解析很棘手。</p>
<h3 id="链接器如何处理多重定义的全局符号"><a class="header" href="#链接器如何处理多重定义的全局符号">链接器如何处理多重定义的全局符号</a></h3>
<p>在编译时，编译器想链接器输出每个全局符号，或者是强的或者是弱的。函数和已初始化的全局变量是强的，未初始化的全局变量是弱的。然后，链接器将按照如下的强弱规则来处理多重定义的符号名：</p>
<ul>
<li>不允许有多个同名的强符号</li>
<li>如果有一个强符号和多个弱符号重名，那么选择强符号</li>
<li>如果有多个弱符号重名，那么选择这其中任意一个</li>
</ul>
<h3 id="关于全局变量"><a class="header" href="#关于全局变量">关于全局变量</a></h3>
<p>如果能避免使用全局变量，一定要避免。</p>
<p>如果必须要使用全局变量：</p>
<ul>
<li>使用<code>static</code>​标记，限制其只能在模块内使用</li>
<li>在申明全局变量时初始化变量</li>
<li>使用<code>extern</code>​标记引用的外部全局变量</li>
</ul>
<h2 id="打包常用的函数"><a class="header" href="#打包常用的函数">打包常用的函数</a></h2>
<p>一些像数学、输入输出、内存管理和字符串操作之内的函数是在大多数程序中都会涉及，为了避免重复的实现这些函数，应该将这些函数打包成一个“库”。</p>
<h3 id="过时的解决方式静态库"><a class="header" href="#过时的解决方式静态库">过时的解决方式——静态库</a></h3>
<p>将数个可重定位文件连接成一个存档文件（archive files），让链接器遇到没有解决的外部符号时就在多个存档文件中寻找定义，如果存档文件中含有这个符号的定义，就把这个文件链接进可执行文件中。</p>
<p>在C语言编程中通常使用的静态库有：</p>
<ul>
<li>​<code>libc.a</code>​C语言标准库，大约4.6M大小，包含1496个对象，含有输入输出、内存管理、信号处理、字符串处理、时间和日期等方面的函数。</li>
<li>​<code>libm.a</code>​C语言数学库，大约2M大小，含有444个对象，主要是一些浮点运算函数。</li>
</ul>
<p>在链接器处理的时候，链接器会按照命令行上给出的顺序依次扫描可重定位文件和存档文件，链接器会维护一张当前未找到定义符号的列表，每扫描到一个文件，就会尝试在这个文件中寻找定义，如果在扫描完成之后仍然没有找到定义就给出错误。因此，命令行中指定文件的顺序就变得重要起来，一个常见的技巧是在命令行的最后指定存档文件。</p>
<h3 id="现代的解决方式动态链接库"><a class="header" href="#现代的解决方式动态链接库">现代的解决方式——动态链接库</a></h3>
<p>将可重定向文件动态的加载和链接进入一个可执行程序中，可以是加载时链接，也可是运行时链接。</p>
<ul>
<li>动态链接可以发生在可执行文件第一次被加载和执行的时候，也就是加载时链接。这种情况在Linux上常见，C标准库<code>libc.so</code>​就常常是加载时链接的。</li>
<li>动态链接也可以发生在可执行文件开始运行之后，也就是运行时链接。</li>
</ul>
<h2 id="位置无关代码"><a class="header" href="#位置无关代码">位置无关代码</a></h2>
<p>为了使多个正在运行的进程共享内存中相同的库代码，从而节约宝贵的内存资源，需要库代码可以不经过链接的任意加载到内存中的任意位置。这种可以加载而无需重定位的代码被称为位置无关代码，共享库都是这种类型的代码。</p>
<h3 id="pic数据引用"><a class="header" href="#pic数据引用">PIC数据引用</a></h3>
<p>为了实现对全局变量的PIC引用，编译器利用了这样一个规律：无论我们在内存中的何处加载一个目标模块，数据段和代码段之间的距离总是保持不变的，因此应带段中任何指令和数据段中任何变量之间的距离都是一个运行时常量，与代码段和数据段的绝对内存位置是无关的。于是编译器在数据段开始的地方创建了一个，称作全局偏移量表<code>GOT</code>​，在这张表中，每个被这个目标模块引用的全局数据目标都有一个8字节的条目。编译器还为<code>GOT</code>​中每个条目生成一个重定位记录，在加载时，动态链接器会重定位<code>GOT</code>​中每个条目，使得它包含目标的正确的绝对地址。</p>
<h3 id="pic函数调用"><a class="header" href="#pic函数调用">PIC函数调用</a></h3>
<p>假设程序调用一个由共享库定义的函数，编译器没有办法预测这个函数的运行时地址，因为定义它的共享库模块可以在运行时加载到任意的地址。编译器采用一种称作“延迟绑定”的技术来处理这种情况，将过程地址的绑定推迟到第一次调用这个过程时。</p>
<p>使用延迟绑定的动机是对于像<code>libc.so</code>​这样的共享库输出的上千个函数中，一个实际的应用程序只会用到其中的少数，让动态链接器在加载的时候进行上千个其实并不需要的重定位相当的浪费资源。市容延迟绑定之后，虽然在第一次调用的过程中开销比较大，在之后的调用都只会花费一条指令和一个间接的内存引用。</p>
<p>延迟绑定是通过两个数据结构之间的交互实现的，这两个数据结构是上文中提到的<code>GOT</code>​和过程链接表<code>PLT</code>​。<code>GOT</code>​是数据段的一部分，<code>PLT</code>​是代码段的一部分。<code>PLT</code>​是一个数组，其中每个条目是16字节的代码。<code>PLT[0]</code>​是一个特殊条目，跳转到动态链接器中，<code>PLT[1]</code>​调用系统启动函数，初始化执行环境，调用<code>main</code>​函数并处理其的返回值，从<code>PLT[2]</code>​开始的条目调用用户代码调用的函数。<code>GOT</code>​是一个数组，其中每个条目是8字节的地址。在和<code>PLT</code>​联合使用的时候，<code>GOT[0]</code>​和<code>GOT[1]</code>​包含动态链接器在解析函数地址会使用的信息，<code>GOT[2]</code>​是动态链接器在<code>ld-linux.so</code>​模块中的入口点，其余的每个条目对应于一个被调用的函数，其地址需要在运行时被解析。<code>GOT</code>​中的每个条目都有一个相匹配的<code>PLT</code>​条目。</p>
<p>下面两张图展示了第一次调用全局函数和后续调用该函数时的控制流：</p>
<p>在第一次调用时，控制流会给到动态链接器以获取函数的实际地址，这里不同的程序之间通过栈来传递信息。</p>
<p>​![Screenshot from 2022-12-23 10-33-41](./assets/Screenshot from 2022-12-23 10-33-41-20221223103401-lmr5a5m.png)​</p>
<p>在后续的调用时，已经获得了函数的实际地址了。</p>
<p>​<img src="csapp/./assets/image-20221223103553-tncu9zw.png" alt="image" />​</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="io"><a class="header" href="#io">IO</a></h1>
<h2 id="io系统"><a class="header" href="#io系统">IO系统</a></h2>
<p>计算机的主要任务就是处理数据，因此如果让大量的数据快速有序的进出计算机就成为了一个考题，在计算机中这个部分就被称作<code>I/O</code>。设计一个计算机的<code>I/O</code>部分主要存在这样几个挑战：</p>
<ul>
<li>可能和计算机交互的<code>I/O</code>设备种类繁多，而且各有各的特点：存储设备、网络、键盘、屏幕</li>
<li>计算机需要支持大量的设备</li>
<li><code>I/O</code>设备的驱动程序都以内核模式在系统中工作，如果出现错误就可能引发系统崩溃</li>
</ul>
<p>因此，现在<code>I/O</code>部分已经成为了操作系统的一个重要组成部分：</p>
<ul>
<li>不同的端口、总线、设备控制器连接了各式各样的外接设备</li>
<li>驱动程序隐藏了调用设备的详细细节，将操作系统提供了一套统一的调用接口。</li>
</ul>
<h3 id="io-硬件"><a class="header" href="#io-硬件">I/O 硬件</a></h3>
<p>硬件的种类总是十分多样的：</p>
<ul>
<li>存储设备</li>
<li>数据传输</li>
<li>人机接口部分</li>
</ul>
<p>在硬件中有着一些共同的概念：</p>
<ul>
<li>端口<code>port</code>：硬件和计算机连接的位置</li>
<li>总线<code>bus</code>：将设备连接向计算机的菊花链或者是公用的直连线</li>
<li>设备控制器<code>controller</code>：控制端口，总线和硬件的电子设备
<ul>
<li>可能是计算机内部集成的，或者是一块独立的电路</li>
<li>可能包含处理器，微码，私有的内存空间，总线控制器等等</li>
<li>对于操作系统来说，控制器也隐藏了自己硬件中的细节，给系统提供了一种统一的设备接口</li>
</ul>
</li>
</ul>
<p><img src="csapp/./assets/hw-organization-20221120150652-dg8u9ss.png" alt="" /></p>
<p>I/O在控制过程中是类似于计算机的：</p>
<ul>
<li>I/O指令用来控制设备，类似于汇编代码</li>
<li>I/O设备也有着寄存器存储输入输出设备的数据，指令和设备当前的状态</li>
<li>I/O设备也有着地址：
<ul>
<li>被直接I/O指令使用</li>
<li>或者有的设备会将输入输出的指令和当前状态直接映射在设备的内存中，这种方式在数据量比较大的设备中比较常用，比如显卡。</li>
</ul>
</li>
</ul>
<p>设备驱动程序在I/O控制过程中：</p>
<ul>
<li>驱动程序向提供了一套统一的设备调用方法，隐藏了调用不同设备之间的细节</li>
<li>驱动程序设计者需要对设备的设计细节十分的了解</li>
<li>驱动程序需要运行在内存模式才有特权去调用I/O指令</li>
</ul>
<p>I/O设备的调用一般有着下面三种方式：</p>
<ul>
<li>
<p>轮询调用</p>
<p>系统将反复读取设备的状态，通过寄存器之类的方法来确定设备的当前运行状态。当设备出现问题时，系统将耗费大量的资源。</p>
</li>
<li>
<p>中断调用</p>
<p>设备通过一个硬件中断引脚通知CPU，CPU在每条指令处理完毕之后都会检测这个引脚的状态，如果中断到达就会调用对应的中断处理程序来处理</p>
</li>
<li>
<p>DMA直接内存读取</p>
<p>设备可以绕过CPU，直接从其他的设备或者内存中读取数据进行处理。</p>
</li>
</ul>
<p>下面这张图详细给出了计算机系统中从应用程序到底层硬件中的复杂关系</p>
<p><img src="csapp/./assets/kernel-io-stack-20221120150652-xu9gnd8.png" alt="" /></p>
<blockquote>
<p>需要注意的是，不同的操作系统可能有着不同的I/O架构设计</p>
</blockquote>
<h2 id="unix-io--c-standard-io"><a class="header" href="#unix-io--c-standard-io">Unix I/O &amp; C Standard I/O</a></h2>
<p>Unix I/O和C标准库中的I/O操作是两个不同层级的I/O，一个是系统级别的I/O，一个是C语言的运行时库，是对前者的一个封装。</p>
<h3 id="unix-io"><a class="header" href="#unix-io">Unix I/O</a></h3>
<ul>
<li>在Unix系统之下，一个文件就是一个字节序列</li>
<li>在Unix系统中，系统将每一个I/O设备都映射成系统中的一个文件</li>
</ul>
<blockquote>
<p>这就是Unix系统设计哲学之一：文件即系统</p>
</blockquote>
<p>再将所有的设备映射为一个文件之后，Unix系统就通过几个简单的操作实现了Unix I/O：</p>
<ul>
<li>打开和关闭文件：<code>open</code>和<code>close</code>函数</li>
<li>读取和写入文件：<code>write</code>和<code>read</code>函数</li>
<li>改变当前读取文件的位置：<code>lseek</code>函数</li>
</ul>
<h3 id="文件的类型"><a class="header" href="#文件的类型">文件的类型</a></h3>
<p>每个文件都有一个特定的类型来标识他在系统中的类型：</p>
<ul>
<li>文件</li>
<li>目录</li>
<li>套接字（Socket）</li>
</ul>
<p>在系统还有一些其他的文件类型，不过在本文中我们不做讨论：</p>
<ul>
<li>Named Pipelines</li>
<li>Symbolic links</li>
<li>Character and block devices</li>
</ul>
<h4 id="文件"><a class="header" href="#文件">文件</a></h4>
<p>一个不同的文件中可以包含任意的数据。</p>
<p>应用程序会区分文本文件和二进制文件：</p>
<ul>
<li>文本文件往往只包含ASCII字符或者是Unicode字符</li>
<li>二进制文件是除了文本文件之外的所有文件</li>
<li>注意：系统是不会在这两者之间做区分的</li>
</ul>
<p>文本文件往往是由一系列的文本行组成的，每一个文本行都是用一个EOL去终结的。在不同的系统上可能有着不同的行终止符：</p>
<ul>
<li>Unix:LF</li>
<li>Windows: CRLF</li>
</ul>
<h4 id="目录"><a class="header" href="#目录">目录</a></h4>
<p>目录中包含一系列的连接，将一个文件名指向一个文件。</p>
<p>每个目录中都至少包含两个连接：</p>
<ul>
<li><code>.</code>指向其本身的连接</li>
<li><code>..</code>指向一个父目录的连接</li>
</ul>
<p>Unix系统提供了一系列的命令来控制目录</p>
<ul>
<li><code>mkdir</code>创建一个目录</li>
<li><code>ls</code>查看目录中的内容</li>
<li><code>rmdir</code>删除一个目录</li>
</ul>
<p>可以通过<code>/</code>将一系列目录名连接在一起，标识一个绝对或者相对的路径。</p>
<ul>
<li>在Unix系统中<code>/</code>标识根文件系统，从<code>/</code>开始的文件路径为绝对路径</li>
<li>从<code>.</code>开始的文件路径为相对路径</li>
</ul>
<blockquote>
<p>操作系统会为每个程序维持一个当前的运行目录（CWD）</p>
</blockquote>
<h3 id="文件操作"><a class="header" href="#文件操作">文件操作</a></h3>
<h4 id="打开文件"><a class="header" href="#打开文件">打开文件</a></h4>
<p>打开文件就是通知系统你已经准备好获取这个文件中的内容了。</p>
<pre><code class="language-c">int fd;

if (fd = open("/etc/hosts", O_RDONLY) &lt; 0 )
{
	perror("open");
	exit(1)
}
</code></pre>
<p><code>open</code>函数的返回值是一个被称为文件描述符的整数，我们就通过这个整数来访问我们想要访问的文件。如果文件描述符小于0，往往意味着发生了错误。</p>
<p>每个通过Linux Shell创建的进程都会有三个文件文件描述符和这个Shell联系起来：</p>
<ul>
<li>0: standard input</li>
<li>1: standard output</li>
<li>2: standard error</li>
</ul>
<h4 id="关闭文件"><a class="header" href="#关闭文件">关闭文件</a></h4>
<p>关闭文件就是通知操作系统你已经完成了对这个文件的操作。</p>
<pre><code class="language-c">int fd; // 之前通过open拿到的文件描述符
int returnVal;

if ((returnVal = close(fd)) &lt; 0)
{
	perror("close");
	exit(1)
}
</code></pre>
<p>注意在关闭文件的时候，也需要检查关闭函数的返回是否是正常的。重复的关闭一个文件可能会导致灾难性的后果。</p>
<blockquote>
<p>即使是如同<code>close</code>一样看上去人畜无害的函数也需要检查返回值。</p>
</blockquote>
<h4 id="读取文件"><a class="header" href="#读取文件">读取文件</a></h4>
<p>读取一个文件从当前文件的位置复制一系列的字节到内存中，然后更新文件的位置。</p>
<pre><code class="language-c">char buf[512];
int fd; // 前文中通过open获得的文件描述符
int nbytes;

if ((nbytes = read(fd, buf, sizeof(buf))) &lt; 0 )
{
    perror("read");
    exit(1);
}
</code></pre>
<p>读取文件函数的返回值是从文件中读取字符的数量。</p>
<ul>
<li>返回值是一个有符号的整数</li>
<li>这个返回值小于0说明在读取过程中发生了错误</li>
<li>不足值<code>nbytes &lt; sizeof(buf)</code>并不意味着错误，只是文件中的内容不足以填满空间而已</li>
</ul>
<h4 id="写入文件"><a class="header" href="#写入文件">写入文件</a></h4>
<p>写入文件意味着从内存中复制一系列的字符到当前的文件位置中，然后在更新文件的位置。</p>
<pre><code class="language-c">x char buf[512];
int fd; // 前文中通过open获得的文件描述符
int nbytes;
if ((nbytes = write(fd, buf, sizeof(buf))) &lt; 0 )
{    
	perror("write");    
	exit(1);
}
</code></pre>
<p>和<code>read</code>函数一样，小于0的返回值意味着错误，不足值不表示错误。</p>
<blockquote>
<p>虽然这里的不足值不表示错误显得有点反直觉，下文中有解释。</p>
</blockquote>
<h4 id="不足值"><a class="header" href="#不足值">不足值</a></h4>
<p>不足值可能在下面这些场景中出现：</p>
<ul>
<li>在读取的过程中遇到了EOF</li>
<li>从终端中读取文件</li>
<li>在读取和写入网络套接字</li>
</ul>
<p>不足值不可能在下面这些情形中出现：</p>
<ul>
<li>从磁盘中的文件读取（除非遇到了EOF）</li>
<li>向磁盘中的文件写入</li>
</ul>
<blockquote>
<p>在一般情况下，我们都是允许不足值的出现。</p>
</blockquote>
<h2 id="元数据--文件共享--重定向"><a class="header" href="#元数据--文件共享--重定向">元数据 &amp; 文件共享 &amp; 重定向</a></h2>
<h3 id="元数据"><a class="header" href="#元数据">元数据</a></h3>
<p>元数据就是关于数据的数据。</p>
<p>操作系统维护者每个文件的元数据，可以利用<code>stat</code>和<code>fstat</code>这两个函数来访问文件的元数据。在内核中，元数据的定义是下面这个结构体：</p>
<pre><code class="language-c">/* Metadata returned by the stat and fstat functions */
struct stat 
{
	dev_t	st_dev;      /* Device */
    ino_t 	st_ino;      /* inode */
    mode_t	st_mode;     /* Protection and file type */
    nlink_t	st_nlink;    /* Number of hard links */
    uid_t	st_uid;      /* User ID of owner */
    gid_t	st_gid;      /* Group ID of owner */
    dev_t	st_rdev;     /* Device type (if inodedevice) */
    off_t	st_size;     /* Total size, in bytes */
    unsigned long st_blksize;  /* Block size for filesystemI/O */
    unsigned long st_blocks;   /* Number of blocks allocated */
    time_t	st_atime;    /* Time of last access */
    time_t	st_mtime;    /* Time of last modification */
    time_t	st_ctime;    /* Time of last change */
};
</code></pre>
<h3 id="linux如何打开文件"><a class="header" href="#linux如何打开文件">Linux如何打开文件</a></h3>
<p>两个不同的文件描述符将指向两个不同的文件。</p>
<p><img src="csapp/./assets/open-file-20221120150652-wwdt6a7.png" alt="" /></p>
<h4 id="文件共享"><a class="header" href="#文件共享">文件共享</a></h4>
<p>两个不同的文件描述符可以通过两个独立的文件打开表实例共享相同的磁盘文件。</p>
<p><img src="csapp/./assets/file-sharing-20221120150652-hj819mr.png" alt="" /></p>
<h4 id="创建进程"><a class="header" href="#创建进程">创建进程</a></h4>
<p>父进程可以通过调用<code>fork</code>函数创建一个新的子进程。</p>
<ul>
<li><code>fork</code>函数将给子进程返回0，给父进程返回子进程的<code>PID</code></li>
<li>子进程几乎和父进程一模一样：
<ul>
<li>子进程将得到一份父进程虚拟内存空间的拷贝，虽然完全独立</li>
<li>子进程也会得到父进程文件描述符的拷贝</li>
<li>子进程将有着和父进程不同的PID</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：<code>fork</code>函数常常令我们困惑，因为这个函数会返回两次，分别在子进程的父进程。</p>
</blockquote>
<h3 id="io-重定向"><a class="header" href="#io-重定向">I/O 重定向</a></h3>
<blockquote>
<p>Shell 中实现管道和重定向的原理</p>
</blockquote>
<p>通过调用<code>dup2(oldFd, newFd)</code>函数就可以改变文件描述符指向的文件。</p>
<h2 id="标准io-函数"><a class="header" href="#标准io-函数">标准I/O 函数</a></h2>
<p>在C语言的标准库中包含着一系列高级的标准I/O函数。</p>
<h3 id="标准io流"><a class="header" href="#标准io流">标准I/O流</a></h3>
<p>C语言库会通过一种<strong>流</strong>的方式打开文件，这是C语言标准库对于内核中文件描述符和内存中缓存的一个抽象。</p>
<p>在每个C语言程序开始运行的时候，C都会自动初始化三个打开的流：</p>
<ul>
<li><code>stdio</code>标准输入流</li>
<li><code>stdout</code>标准输出流</li>
<li><code>stderr</code>标准错误流</li>
</ul>
<p>这三个流通过全局变量的方式定义在<code>stdio.h</code>这个头文件中。</p>
<p>C语言中实现流这种抽象的主要结构体是<code>FILE</code>：</p>
<pre><code class="language-c">typedef struct __iobuf {
	int cnt;       /* characters left */
    char *ptr;      /* next characters position */
    char *base;     /* location of buffers */
    int flag;      /* mode of file access */
    int fd;        /* file descripter*/
} FILE;
</code></pre>
<blockquote>
<p>C语言这样抽象文件描述符的原因是：</p>
<ul>
<li>程序中常常只会一个字一个字的读取文件</li>
<li>然而每次系统调用都是较为耗时的，因为涉及到内核态和用户态的切换</li>
</ul>
<p>所以采用这样一种缓存的方式提高文件读写的效率</p>
</blockquote>
<p>既然我们已经拥有了两个不同层面的I/O访问方法，那我们应该如何选择使用哪种API呢？</p>
<p>首先来看看两种方式的优缺点：</p>
<p>Unix I/O:</p>
<ul>
<li>优点 ：
<ul>
<li>是最通用、最底层的API，所有的其他I/O都是这个API的一个高层抽象</li>
<li>提供了获得文件元信息的方法</li>
<li>异步安全，可以用于信号处理程序中</li>
</ul>
</li>
<li>缺点：
<ul>
<li>不足值的处理比较困难的</li>
<li>读取大量的文本需要使用缓冲来提高效率</li>
</ul>
</li>
</ul>
<p>C标准库I/O:</p>
<ul>
<li>优点：
<ul>
<li>使用缓冲降低了使用系统调用的数量，提高了效率</li>
<li>不足值会被自动的处理</li>
</ul>
</li>
<li>缺点：
<ul>
<li>没有提高访问元数据的函数</li>
<li>不是异步安全的，不适合在信号处理程序中使用</li>
<li>不适合读写网络套接字</li>
</ul>
</li>
</ul>
<p>在了解两种API的差异之后，我们就可以大体上给出一些原则：</p>
<ul>
<li>第一，永远使用你能使用的最高级API</li>
<li>第二，在信号处理程序和需要极端性能时，再使用底层API</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据结构课程笔记"><a class="header" href="#数据结构课程笔记">数据结构课程笔记</a></h1>
<p>大二上学期专业基础课——数据结构，课程笔记。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="算法基础"><a class="header" href="#算法基础">算法基础</a></h1>
<h2 id="算法设计的要求"><a class="header" href="#算法设计的要求">算法设计的要求</a></h2>
<ul>
<li>正确性</li>
<li>可读性</li>
<li>健壮性</li>
<li>效率和低存储量要求</li>
</ul>
<h2 id="算法的复杂度"><a class="header" href="#算法的复杂度">算法的复杂度</a></h2>
<p>我们再考虑算法的好坏时，可以认为一个特定算法“运行工作量”的大小，只依赖与问题的规模（通常用n表示）和算法本身，也就是说，这是一个问题规模的函数。</p>
<h3 id="时间复杂度"><a class="header" href="#时间复杂度">时间复杂度</a></h3>
<ul>
<li>时间频度：一个算法中的原操作执行次数称为语句频度或者时间频度，用c表示。</li>
<li>时间复杂度：一个算法执行所耗费的时间。</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord cjk_fallback mtight">语句集合</span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.566em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord cjk_fallback mtight">语句集合</span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<blockquote>
<p>由于考虑所有原操作的时间不太现实且没有太多的用处，在这里直接将原操作的时间视为单位时间。</p>
<p>同时统计算法中所有原操作的数量也不太现实，我们直接把语句的数量视为原操作的数量</p>
</blockquote>
<p>例如:</p>
<pre><code class="language-C">int i, sum = 0, n = 100; // 执行1次
for(i = 1; i &lt;= n; i++) // 执行n + 1次
{
	sum = sum + i; // 执行n次
}
</code></pre>
<p>总共执行了<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>次。</p>
<p>多重循环中执行次数的判断时复杂度分析中的难点。</p>
<p>又例如：</p>
<pre><code class="language-C">int i, j, sum = 0, n = 100; // 执行1次
for(i = 1; i &lt;= n; i++)// 执行n + 1次
{
	for(j = 1; j &lt;= n; j++) // 执行n(n + 1)次
	{
		sum = sum + j;// 执行n * n次
	}
}
</code></pre>
<p>总共执行了<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>次。</p>
<p>时间复杂度<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>还可用下面这种方式来表示</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span></p>
<p>将<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span>称为算法的渐进时间复杂度，简称为时间复杂度。</p>
<blockquote>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span> 的定义详见离散数学，这里懒得打数学符号了。</p>
</blockquote>
<p>例如：</p>
<pre><code class="language-C">for(int i = 1; i &lt; n ; i++)
{
	y = y + 1;
	for(int j = 1; j &lt;= (2 * n); j++)
	{
		x++; // 2n * n - n - 1
	}
}
</code></pre>
<p>时间复杂度为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>时间复杂度的比较：在一般情况下，指数时间复杂度都大于多项式时间复杂度</p>
<p>多项式时间复杂度：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>指数时间复杂度：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">!)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>当n的取值很大的时候，指数时间算法和多项式时间算z在所需时间上的非常悬殊。因此，在设计算法的过程中，我们希望将指数时间算法化简为多项式时间的算法。</p>
<p>在一些情况下，算法中基本操作重复执行的次数还随着问题的输入数据集不同而不同，例如排序算法中的冒泡排序。</p>
<p>在冒泡排序的实际执行中，如果输入的数据本身就是有序的，那么算法的时间复杂度可以认为是0，但是在最坏的情况下，冒泡算法的时间复杂度可以达到平方阶。</p>
<h3 id="空间复杂度"><a class="header" href="#空间复杂度">空间复杂度</a></h3>
<p>空间复杂度：算法运行需要占据的存储空间大小。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">))</span></span></span></span></span></p>
<p>算法的存储空间：</p>
<ul>
<li>输入数据本身占据的空间</li>
<li>程序本身占据的空间</li>
<li>辅助变量所占的空间</li>
</ul>
<p>将上面的三部分可以分为：</p>
<ul>
<li>固定部分：程序本体，常量，简单的变量，定长的数据结构</li>
<li>可变部分：和问题规模有关的存储空间，主要由输入数据和辅助变量组成，由于输入数据的规模我们无法控制，我们主要考虑辅助变量的影响。</li>
</ul>
<p>如果一个算法的辅助变量和输入数据的规模无关，我们把这类算法称为<strong>就地算法</strong>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="内部排序"><a class="header" href="#内部排序">内部排序</a></h1>
<h2 id="排序"><a class="header" href="#排序">排序</a></h2>
<h3 id="评价排序算法的主要标准"><a class="header" href="#评价排序算法的主要标准">评价排序算法的主要标准</a></h3>
<p>首先是算法的时间开销：</p>
<ul>
<li>比较关键字的次数</li>
<li>移动记录的次数</li>
</ul>
<p>算法运行的时间还和输入实例的初始状态有关，分情况：</p>
<ul>
<li>最好</li>
<li>最坏</li>
<li>平均</li>
</ul>
<p>然后是算法的空间开销，这上面的比较相对比较简单，主要就是考虑算法中所需的辅助变量占据的空间。</p>
<blockquote>
<p>在讨论中我们先做一些约定：</p>
<ul>
<li>采用顺序存储</li>
<li>按记录关键字非递减排序，关键字为整数</li>
</ul>
</blockquote>
<h2 id="插入排序"><a class="header" href="#插入排序">插入排序</a></h2>
<p>将序列分为两部分，前一部分为有序序列，后一部分为无序序列，通过遍历将无序序列中的元素插入有序序列中合适的位置上，直到无序序列为空。</p>
<h3 id="直接插入排序"><a class="header" href="#直接插入排序">直接插入排序</a></h3>
<p>利用顺序查找找到元素的插入位置。</p>
<pre><code class="language-cpp">void InsertSort(std::vector&lt;int&gt;&amp; list)
{
    int length = list.size();

    for (int i = 1; i &lt; length; i++)
    {
        if (list[i] &lt; list[i - 1])
        {
            // 只有当前值小于目前有序序列的最大值时才处理
            int temp = list[i];
            int j;
            // 依次比较有序序列和当前元素
            // 如果大于就将有序序列的元素向后面移动一位
            // 当找到第一个不大于的元素时
            // 在它的后面插入元素
            for (j = i - 1; j &gt;= 0; j--)
            {
                if (list[j] &gt; temp)
                {
                    list[j + 1] = list[j];
                }
                else
                {
                    break;
                }
            }
            list[j + 1] = temp;
        }
    }
}
</code></pre>
<h4 id="性能分析"><a class="header" href="#性能分析">性能分析</a></h4>
<ul>
<li>
<p>在最好的情况下，也就是原始的数据就是按照正序来排列的：</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>​</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>​</p>
</li>
<li>
<p>在最坏的情况下，原始的数据按照逆序来排列：</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>​</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">4</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>​</p>
</li>
</ul>
<p>总的来说，算法的时间复杂度在<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>这个级别，辅助空间复杂度是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p>
<h4 id="改进措施"><a class="header" href="#改进措施">改进措施</a></h4>
<p>直接插入排序算法还存在不少的优化空间。</p>
<ul>
<li>
<p>折半插入排序</p>
<p>将循环中每一次在有序序列上的查找从顺序查找改为折半查找，有效的减少了关键字之间的比较次数</p>
</li>
<li>
<p>2路插入排序</p>
<p>设置一个个原始序列相同大小的辅助空间，首先将原始序列中的第一个元素复制到辅助序列中，遍历序列中的元素，同辅助空间的第一个元素比较大小，如果大于就插入在第一个元素之后的序列中，如果小于就插入到第一个元素之前的序列之中。通过辅助变量空间的变大可以有效的减少记录移动的次数。</p>
<blockquote>
<p>说实话，我没看懂</p>
</blockquote>
</li>
<li>
<p>表插入排序</p>
<p>构造静态链表，通过改变指针来代替移动记录的操作，效果同上面一个优化的方法一样，都是减少记录移动的次数。</p>
</li>
</ul>
<h3 id="希尔排序"><a class="header" href="#希尔排序">希尔排序</a></h3>
<p>对待整体的序列先做“宏观”的调整，再进行“微观”的调整。</p>
<p>先选定一个记录下标的增量，将整个记录序列按增量从第一个记录划分为若干组，对每组使用直接插入排序的方法；然后减小增量的值，不断的重复上述的过程，直到增量的大小等于1。</p>
<pre><code class="language-cpp">void ShellSort(std::vector&lt;int&gt;&amp; list)
{
    int length = list.size();
    for (int delta = length &gt;&gt; 1; delta &gt; 0; delta = delta &gt;&gt; 1)
    {
        for (int i = delta; i &lt; length; i++)
        {
            int temp = list[i];
            int j = 0;
            for (j = i - delta; j &gt;= 0 and list[j] &gt; temp; j = j - delta)
            {
                list[j + delta] = list[j];
            }
            list[j + delta] = temp;
        }
    }
}
</code></pre>
<h4 id="性能分析-1"><a class="header" href="#性能分析-1">性能分析</a></h4>
<p>希尔排序的性能主要取决于增量序列的选择，在上面的实现中我是直接使用的折半序列，目前还没有关于最佳序列选择的定论，但是一般的决定原则是：</p>
<ul>
<li>最后一个增量是1</li>
<li>避免增量序列中的值，尤其是相邻的值，有公因子</li>
</ul>
<p>经过在现实世界中的实验结果，在<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>比较大的时候，比较和移动的次数约在<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.25</span></span></span></span></span></span></span></span></span></span></span></span>到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1.6</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1.25</span></span></span></span></span></span></span></span></span></span></span></span>之间。</p>
<p>希尔排序不算是稳定的排序算法。</p>
<h2 id="交换排序"><a class="header" href="#交换排序">交换排序</a></h2>
<h3 id="冒泡排序"><a class="header" href="#冒泡排序">冒泡排序</a></h3>
<p>将两个相邻记录的关键词进行比较，若为逆序则交换两者的位置，小者往上浮，大者往下沉。</p>
<pre><code class="language-cpp">void BubbleSort(std::vector&lt;int&gt;&amp; list)
{
    int length = list.size();
    // 设置sort可以避免一些不必要的循环
    bool sorted = false;

    for (int i = 1; i &lt; length and !sorted; i++)
    {
        sorted = true;

        for (int j = 0; j &lt; length - i; j++)
        {
            if (list[j] &gt; list[j + 1])
            {
                int swap = list[j];
                list[j] = list[j + 1];
                list[j + 1] = swap;
                sorted = false; 
            }
        }
    }
}
</code></pre>
<h4 id="性能分析-2"><a class="header" href="#性能分析-2">性能分析</a></h4>
<p>在最好情况下，即原始数据就按照正序排序：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>​</p>
<p>在最坏的情况下，原始数据按照逆序排序，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2537em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2537em;vertical-align:-0.2997em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<p>总的来说，冒泡排序的时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，辅助空间的复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p>
<h3 id="快速排序"><a class="header" href="#快速排序">快速排序</a></h3>
<p>指定枢轴（或者称为支点、基准记录），通过一次排序将其放在正确的位置上，而且这个元素将待排的记录分为独立的两个部分，使得在枢轴左侧的记录都小于等于枢轴，在枢轴右侧的记录都大于等于枢轴。对枢轴左右两侧的元素重复这个过程，直到形成的子序列中只剩下一个记录或者是没有记录。</p>
<h4 id="分治的算法原理"><a class="header" href="#分治的算法原理">分治的算法原理</a></h4>
<ul>
<li>分解：将原问题分解为若干个子问题</li>
<li>求解：递归的求解子问题，如果子问题的规模足够小，则直接求解</li>
<li>组合：将各子问题的解组合成原问题的解</li>
</ul>
<pre><code class="language-cpp">void QuickSortR(std::vector&lt;int&gt;&amp; list, int begin, int end)
{
    if (begin &lt; end)
    {
        int key = list[begin];
        int low = begin;
        int high = end;

        while (low &lt; high)
        {
            while(low &lt; high and list[high] &gt;= key)
            {
                high--;
            }
            list[low] = list[high];
            while (low &lt; high and list[low] &lt;= key)
            {
                low++;
            }
            list[high] = list[low];
        }

        list[low] = key;

        QuickSortR(list, begin, low - 1);
        QuickSortR(list, low + 1, end);
    }
}

void QuickSort(std::vector&lt;int&gt;&amp; list)
{
    QuickSortR(list, 0, list.size() - 1);
}
</code></pre>
<h4 id="性能分析-3"><a class="header" href="#性能分析-3">性能分析</a></h4>
<p>对于快速排序而言，有序的情况反而是最坏的情况，在当输入的数据就是正序或者逆序时，排序的时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。而快速排序最好的情况是每次划分的结果是枢轴的左右两个子序列的长度基本相同，在这种情况下时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</p>
<p>在平均情况下，算法的时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">kn</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。如果仅就平均时间复杂度而言，快速排序被认为是较好的一种内部排序算法。</p>
<p>关于辅助空间的复杂度：在最好情况下为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，在最坏的情况下为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</p>
<h2 id="选择排序"><a class="header" href="#选择排序">选择排序</a></h2>
<h3 id="简单选择排序"><a class="header" href="#简单选择排序">简单选择排序</a></h3>
<p>每次从待排序列中选出关键字最小的记录作为有序序列中最后的一个记录，直到最后一个记录为止。</p>
<pre><code class="language-cpp">void SelectSort(std::vector&lt;int&gt;&amp; list)
{
    int length = list.size();

    for (int i = 0; i &lt; length; i++)
    {
        int j = i;
        for (int k = i + 1; k &lt; length; k++)
        {
            if (list[j] &gt; list[k])
            {
                j = k;
            }
        }

        if (i != j)
        {
            int swap = list[i];
            list[i] = list[j];
            list[j] = swap;
        }
    }
}
</code></pre>
<h4 id="性能分析-4"><a class="header" href="#性能分析-4">性能分析</a></h4>
<p>总的比较册次数和记录初始的排列状态没有关系，都是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，不过移动的次数就和初始状态有关系，在最好的条件下，也就是初始记录就是正序时，移动的次数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，在最坏的条件下，也就是初始记录就是完全逆序的情况下：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p>
<p>总的来说，平均的时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 而辅助空间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p>
<h3 id="树形选择排序"><a class="header" href="#树形选择排序">树形选择排序</a></h3>
<p>​<img src="data-structure/./assets/image-20221128142909-itq554s.png" alt="image" />​</p>
<h3 id="堆排序"><a class="header" href="#堆排序">堆排序</a></h3>
<ul>
<li>较直接选择排序减少重复排序</li>
<li>较树形选择排序减少辅助存储空间（仅需一个）</li>
</ul>
<h4 id="二叉堆的定义"><a class="header" href="#二叉堆的定义">二叉堆的定义</a></h4>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个关键字的序列当且仅当满足下列条件之一：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 且 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，称为小根堆</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 且 <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>，称为大根堆</li>
</ul>
<p>堆的定义和完全二叉树的顺序存储结构比较相似。</p>
<h4 id="基本思想"><a class="header" href="#基本思想">基本思想</a></h4>
<ul>
<li>将初始文件建成一个大根堆</li>
<li>将大根堆的堆顶，也就是最大的元素，同最末尾的元素交换</li>
<li>将新形成的无序部分调整为大根堆</li>
<li>重复2~3步，直到所有元素都排序完成</li>
</ul>
<p>在基本思想中就存在两个问题需要我们解决：</p>
<ul>
<li>如何从一个无序的序列建成一个堆</li>
<li>如何在输出堆顶元素之后，调整剩余元素，使之成为一个新的堆</li>
</ul>
<p>我们可以通过筛选的方法，在将堆顶元素输出之后的堆调整为新的大顶堆：</p>
<p>​<img src="data-structure/./assets/image-20221201103503-2x31sg1.png" alt="image" />​</p>
<p>在从一群无序的元素建立一个大顶堆的时候，就从低到高依次筛选建立大顶堆：</p>
<p>​<img src="data-structure/./assets/image-20221201103600-3vsu6r8.png" alt="image" />​</p>
<h4 id="算法实现"><a class="header" href="#算法实现">算法实现</a></h4>
<p>首先我们需要实现从一个无序的堆建立大根堆的函数：</p>
<pre><code class="language-cpp">void HeapAdjust(std::vector&lt;int&gt;&amp; heap, int begin, int end)
{
    // 初始化父节点 子节点的位置
    int dad = begin;
    int son = dad * 2 + 1;

    while (son &lt;= end)
    {
        if (son + 1 &lt;= end and heap[son] &lt; heap[son + 1])
        {
            // 选择左右节点中较大者
            son++;
        }
        if (heap[dad] &gt; heap[son])
        {
            break;
        }
        else
        {
            // 交换父子节点
            int temp = heap[dad];
            heap[dad] = heap[son];
            heap[son] = temp;

            // 继续下一个父节点
            dad = son;
            son = dad * 2 + 1;
        }
    }
}
</code></pre>
<p>在拥有上面这个调整函数之后，我们就可以写出堆排序：</p>
<pre><code class="language-cpp">void HeapSort(std::vector&lt;int&gt;&amp; heap)
{
    int length = heap.size();
    // 将无序堆初始化为大根堆
    // 从最后一个父节点开始调整
    for (int i = length / 2 - 1; i &gt;= 0; i--)
    {
        HeapAdjust(heap, i, length - 1);
    }
    for (int i = length - 1; i &gt; 0; i--)
    {
        // 交换最大的元素和末尾的元素
        int temp = heap[i];
        heap[i] = heap[0];
        heap[0] = temp;
        // 重新将前面的无序堆调整为大根堆
        HeapAdjust(heap, 0, i - 1);
    }
}
</code></pre>
<h4 id="性能分析-5"><a class="header" href="#性能分析-5">性能分析</a></h4>
<p>在最坏的情况下，算法的时间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>​</p>
<ul>
<li>在建立初始堆时，比较的次数不超过<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mord mathnormal">n</span></span></span></span>​</li>
<li>在反复调整堆时，比较的次数不会超过<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mopen">⌊</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">⌋</span></span></span></span>​</li>
</ul>
<p>通过在实际环境中的反复实验，平均性能比较接近于算法的最坏时间复杂度。</p>
<p>算法的辅助空间复杂度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>​</p>
<p>这是一种不稳定的排序算法，在对于数据较大的序列进行排序时用处比较大。</p>
<h2 id="归并排序"><a class="header" href="#归并排序">归并排序</a></h2>
<p>将两个或者两个以上同序的序列归并为一个序列的操作成为归并。</p>
<h3 id="两路归并排序"><a class="header" href="#两路归并排序">两路归并排序</a></h3>
<p>首先将待排序列看作是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个长度为1的有序子序列，两两归并成为长度为2的有序子序列；将上一步得到的子序列两两归并；……；直到合并成为一个序列为止。</p>
<h4 id="性能分析-6"><a class="header" href="#性能分析-6">性能分析</a></h4>
<p>在任何情况下算法的时间复杂度都是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，空间的复杂度都是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，很少用于内部排序。</p>
<h3 id="自然两路归并排序"><a class="header" href="#自然两路归并排序">自然两路归并排序</a></h3>
<p>以游程（自然的有序段）作为子序列进行归并，可以比直接两路归并更加有效。</p>
<p>​<img src="data-structure/./assets/image-20221201152549-4mk6086.png" alt="image" />​</p>
<h2 id="基数排序"><a class="header" href="#基数排序">基数排序</a></h2>
<p>通过“分配”和“收集”过程来实现排序，时间复杂度可以突破基于关键字比较一类方法的下界<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，达到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</p>
<blockquote>
<p>基数排序的算法思想来自于多关键字排序中的思想。在多关键字排序中存在两个排序思想：最高位优先法(MSD)和最低位优先法(LSD)</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="外部排序"><a class="header" href="#外部排序">外部排序</a></h1>
<p>‍</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数组和广义表"><a class="header" href="#数组和广义表">数组和广义表</a></h1>
<p>虽然是非线性的数据结构，但是其实质上就是扩展的线性表，表中的数据元素本身也是一个数据结构。</p>
<h2 id="数组和线性表的关系以及数组的运算"><a class="header" href="#数组和线性表的关系以及数组的运算">数组和线性表的关系以及数组的运算</a></h2>
<p>任何数组都可以看作是一个线性表，不过其中存储的元素类型不同，例如，对于二位数组来说，其中的元素就是一个一维数组。</p>
<p>在存储多维数组的时候，也是一行行的存储这些元素，这就是所谓的<strong>行优先</strong>存储方式。</p>
<blockquote>
<p>至于计算多维数组中一个指定元素地址，计算公式难以用一个简易的公式给出。</p>
</blockquote>
<p>数组是一种随机存取结构，对于数组中任何一个元素定位的时间是相等的。</p>
<h2 id="数组的顺序表示"><a class="header" href="#数组的顺序表示">数组的顺序表示</a></h2>
<p>略</p>
<h2 id="矩阵的压缩存储"><a class="header" href="#矩阵的压缩存储">矩阵的压缩存储</a></h2>
<p>由于矩阵是一种占用空间极大的储存结构，其在程序中的运用又十分广泛，因此研究如何压缩存储矩阵具有十分重要的意义。</p>
<h3 id="对称矩阵"><a class="header" href="#对称矩阵">对称矩阵</a></h3>
<p>对于一个<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>的方阵，如果满足<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ji</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，则称这个矩阵是一个对称矩阵。</p>
<p>在存储对称矩阵时，我们只用存储矩阵中上三角或者下三角中的元素，包括主对角线中的元素即可，只需要<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的空间；将这些元素储存在一个数组中，我们可以通过如下的公式访问这个矩阵的元素：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.826em;vertical-align:-2.163em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.892em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.616em' style='width:0.8889em' viewBox='0 0 888.89 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.616em' style='width:0.8889em' viewBox='0 0 888.89 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style="top:-4.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.663em;"><span style="top:-4.663em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.163em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="三角矩阵"><a class="header" href="#三角矩阵">三角矩阵</a></h3>
<p>对角线以上或者一下的元素全部为常数的矩阵被称为三角矩阵。</p>
<p>存储的方式和对称矩阵的存储方式大致近似，都是存储上三角或者下三角中的元素。不过在访问这些元素时操作比较复杂：</p>
<p>对于上三角矩阵：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.913em;vertical-align:-1.7065em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.8889em' height='0.016em' style='width:0.8889em' viewBox='0 0 888.89 16' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V16 H384z M384 0 H504 V16 H384z'/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.2065em;"><span style="top:-4.2065em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span><span style="top:-2.3805em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7065em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="带状矩阵对角矩阵"><a class="header" href="#带状矩阵对角矩阵">带状矩阵（对角矩阵）</a></h3>
<p>在方阵中，非零的元素主要集中在主对角线机器两侧的奇数条对角线中，我们便可以只存储这个区域中的元素，而且按照对角线的顺序存储。</p>
<h3 id="稀疏矩阵"><a class="header" href="#稀疏矩阵">稀疏矩阵</a></h3>
<p>没啥特别规律的矩阵就被称为稀疏矩阵。</p>
<p>我们可以采用<strong>三元组表</strong>的方式来存储一个普通的矩阵，一个三元组包括矩阵中一个元素所在的位置和元素的值，对于为0的元素，我们直接不存储来节省空间。使用三元组表来存储矩阵中的元素可以在一定程度上节约空间，但是使用这个方法存储矩阵在矩阵相关操作的实现上就十分的困难了。</p>
<p>为了优化三元组表在矩阵运算时的表现，我们可以添加一个新的数组，储存矩阵每一行开始的位置。</p>
<h2 id="广义表"><a class="header" href="#广义表">广义表</a></h2>
<p>广义表是由零个或者多个原子或者子表组成的有限序列。其中原子是指在逻辑上不能再分解的火元素，子表是作为广义表中元素的广义表。</p>
<p>当广义表中的元素全部为原子时就是线性表，线性表就是广义表的特例，广义表就是线性表的推广。</p>
<h3 id="广义表的相关概念"><a class="header" href="#广义表的相关概念">广义表的相关概念</a></h3>
<ul>
<li>表的长度：表中的元素（第一层） 的个数</li>
<li>表的深度：表中元素的最深嵌套层数</li>
<li>表头：表中的第一个元素</li>
<li>表尾：除第一个元素之外，剩余元素构成的广义表，不是一个元素而是一张表。非空广义表的表尾一定是一个广义表</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>例子</th><th>表长</th><th>表深</th><th>表头</th><th>表尾</th></tr></thead><tbody>
<tr><td>A=()</td><td>0</td><td>1</td><td>-</td><td>-</td></tr>
<tr><td>B=(a,A)</td><td>2</td><td>2</td><td>a</td><td>(())</td></tr>
<tr><td>C=((a,b),c,d)</td><td>3</td><td>2</td><td>(a,b)</td><td>(c,d)</td></tr>
<tr><td>D=(a,D)</td><td>2</td><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></td><td>a</td><td>(D)</td></tr>
</tbody></table>
</div>
<h3 id="广义表结构的分类"><a class="header" href="#广义表结构的分类">广义表结构的分类</a></h3>
<ul>
<li>纯表：与树形结构类似的表</li>
<li>再入表：允许元素共享的表</li>
<li>递归表：允许元素递归的表</li>
</ul>
<h3 id="广义表的用途"><a class="header" href="#广义表的用途">广义表的用途</a></h3>
<ul>
<li>程序的语句结构</li>
<li>m元多项式的表示</li>
</ul>
<h3 id="广义表的存储结构"><a class="header" href="#广义表的存储结构">广义表的存储结构</a></h3>
<h4 id="头尾链表形式"><a class="header" href="#头尾链表形式">头尾链表形式</a></h4>
<p>为了区分原子节点和子表节点，我们先定义一个枚举：</p>
<pre><code class="language-c">typedef enum {
    Atom, // 原子类型
    List, // 子表类型
} ElementType;
</code></pre>
<p>然后再定义每个节点的数据类型：</p>
<pre><code class="language-C">struct gl_node {
    ElementType type;
    union {
        int value;
        struct {
            struct gl_node* head;
            struct gl_node* tail;
        } ptr;
    };
};

typedef struct gl_node gl_node_t;
</code></pre>
<blockquote>
<p>这里涉及到C语言中一种特殊的类型：联合</p>
</blockquote>
<h4 id="扩展的线性链表形式"><a class="header" href="#扩展的线性链表形式">扩展的线性链表形式</a></h4>
<p>为了区分原子节点和子表节点，同上文中一样定义一个<code>ElementType</code>枚举。</p>
<p>定义每个节点的数据类型：</p>
<pre><code class="language-C">struct gl_node {
    ElementType type;
    union {
        int value;
        struct gl_node* head;
    };
    struct gl_node* tail;
};

typedef struct gl_node gl_node_t;
</code></pre>
<blockquote>
<p>在课程PPT中，联合中的<code>head</code>节点还用<code>struct</code>包了一下。但是我感觉貌似没有用的样子</p>
</blockquote>
<h3 id="广义表的递归算法"><a class="header" href="#广义表的递归算法">广义表的递归算法</a></h3>
<p>广义表的相关操作较为复杂，且几乎都采用递归实现。</p>
<p>为了简化相关算法的表达，我们规定例子中的广义表定义都不是递归的，且没有共享子表。</p>
<h4 id="计算广义表的深度"><a class="header" href="#计算广义表的深度">计算广义表的深度</a></h4>
<p>方法一：分析表中各节点的深度，取其深度的最大值</p>
<pre><code class="language-cpp">int gl_depth(gl_node_t* g)
{
    if (g == nullptr)
    {
        // 空表
        return 1;
    }

    if (g-&gt;type == Atom)
    {
        // 单原子表
        return 0;
    }

    int max = 0;
    for(gl_node_t* node = g; node != nullptr; node = node-&gt;ptr.tail)
    {
        int dep = gl_depth(node-&gt;ptr.head);
        if (dep &gt; max)
        {
            max = dep;
        }
    }

    return max + 1;
}
</code></pre>
<p>方法二：分析表头和表尾</p>
<pre><code class="language-cpp">int gl_depth_1(gl_node_t* g)
{
    if (g == nullptr)
    {
        // 空表
        return 0;
    }

    if (g-&gt;type == Atom)
    {
        // 单原子表
        return 0;
    }

    int depth1 = gl_depth_1(g-&gt;ptr.head) + 1;
    int depth2 = gl_depth_1(g-&gt;ptr.tail);

    if (depth1 &gt; depth2)
    {
        return depth1;
    }
    else 
    {
        return depth2;
    }
}
</code></pre>
<h4 id="广义表的复制算法"><a class="header" href="#广义表的复制算法">广义表的复制算法</a></h4>
<pre><code>bool gl_copy(gl_node_t*&amp; target, gl_node_t* g)
{
    if (g == nullptr)
    {
        // 被复制的广义表为空
        return false;
    }

    target = (gl_node_t* )malloc(sizeof(gl_node_t));
    if (target == nullptr)
    {
        // 空间分配失败
        return false;
    }
    
    target-&gt;type = g-&gt;type;
    if (g-&gt;type == Atom)
    {
        // 原子节点
        target-&gt;value = g-&gt;value;
    }
    else
    {
        gl_copy(target-&gt;ptr.head, g-&gt;ptr.head);
        gl_copy(target-&gt;ptr.tail, g-&gt;ptr.tail);
    }

    return true;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="线性表"><a class="header" href="#线性表">线性表</a></h1>
<blockquote>
<p>观前提醒：本文中的代码未经严格测试，如存在缺陷还请指出。</p>
<p>再次提醒：本文中的代码和PPT上的实现不完全相同。</p>
</blockquote>
<h2 id="线性结构"><a class="header" href="#线性结构">线性结构</a></h2>
<p>线性结构是一个数据元素的<strong>有序（次序）</strong> 集合。一个线性表一般具有以下的特征：</p>
<ul>
<li>集合中必存在唯一的一个”第一元素“</li>
<li>集合中必存在唯一的一个”最后元素“</li>
<li>除最后元素之外，其他数据元素均有唯一的”后继“</li>
<li>除第一元素之外，其他数据元素均有唯一的”前驱“</li>
</ul>
<p>线性表是具有相同数据类型的n(n&gt;=0)个元素的有限序列，当<code>n=0</code>是被称为空表。</p>
<h2 id="线性表的类型定义"><a class="header" href="#线性表的类型定义">线性表的类型定义</a></h2>
<h3 id="抽象数据类型线性表的定义"><a class="header" href="#抽象数据类型线性表的定义">抽象数据类型线性表的定义</a></h3>
<p><strong>ADT</strong> List {</p>
<p>数据对象：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">El</span><span class="mord mathnormal">e</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.05764em;">tS</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span></span></p>
<p>数据关系：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7474em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">}</span></span></span></span></span></p>
<blockquote>
<p>序偶：即有序对，可以看作是具有两个元素的集合。但它与一般集合不同的是序偶具有确定的次序。</p>
</blockquote>
<p>基本操作：</p>
<blockquote>
<p>基本操作可以被分为四类：结构的初始化，结构的销毁，引用型的操作和加工型的操作</p>
</blockquote>
<ul>
<li>结构的初始化：<code>InitList(*L)</code> 构造一个空的线性表L</li>
<li>结构的销毁：<code>DestroyList(*L)</code></li>
<li>引用型操作：<code>ListEmtpy(L)</code>判空操作，<code>ListLength(L)</code>求长度操作，<code>PriorElement(L, cur_e, *pre_e)</code>获得指定元素的前驱操作，<code>NexteElement(L, cur_e, *next_e)</code>获得指定元素的后继，<code>GetElement(L, i, *e)</code>获得指定索引的元素，<code>LocateElement(L, e)</code>判断指定的元素是否在表中</li>
<li>加工型操作：<code>ClearList(*L)</code>清空表中的元素，<code>ListInsert(*L,i,e)</code>在表指定的位置插入元素，<code>ListDelete(*L,i,*e)</code>在线性表中删除一个指定的元素，</li>
</ul>
<p>} <strong>ADT</strong> List</p>
<h2 id="线性表的顺序存储表示和实现"><a class="header" href="#线性表的顺序存储表示和实现">线性表的顺序存储表示和实现</a></h2>
<p>顺序表：用一组<strong>地址连续</strong>的存储单元依次存放线性表中的数据元素。并且用表中第一个元素的存储位置作为线性表的起始地址，称为线性表的<strong>基地址</strong>。</p>
<p>在顺序存储中：</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li>
</ul>
<p>结构体的定义：</p>
<pre><code class="language-cpp">const int MAX_LIST_SIZE = 80;// 预设存储的最大空间

typedef struct
{
	int *element;
	int length;
	int listSize;
} SqList;
</code></pre>
<blockquote>
<p>目前数据结构课程使用的语言说起来比较复杂，不是纯粹的<code>C</code>也不是完全体的<code>C++</code>。目前已知会用到的<code>C++</code>语法有引用语法和<code>bool</code>型变量。</p>
</blockquote>
<h3 id="初始化操作"><a class="header" href="#初始化操作">初始化操作</a></h3>
<p>在初始化操作中，有两个需要注意的地方。</p>
<ul>
<li>传入的线性表参数。这里采用了引用的方式来解决，还可以使用指针的方式</li>
<li>在使用<code>malloc</code>分配了空间之后，需要判断空间是否分配成功</li>
</ul>
<pre><code class="language-cpp">/**
 * @brief 初始化顺序线性表
 * 
 * @param l 线性表引用
 * @param max_size 线性表的最大大小
 * @return int 线性表是否创建成功 0为成功 1为失败
 */
int InitList(SqList&amp; l, int max_size)
{
    if (max_size == 0)
    {
        max_size = MAX_LIST_SIZE;
    }
    l.element = (int *) malloc(max_size * sizeof(int));

    if (l.element == nullptr)
    {
        return 1;
    }
    

    l.length = 0;
    l.listSize = MAX_LIST_SIZE;
    return 0;
}
</code></pre>
<p>在实际初始化该线性表时，需要先为结构体<code>SqList</code>分配内存空间。</p>
<p>该操作的时间复杂度是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p>
<h3 id="元素定位操作"><a class="header" href="#元素定位操作">元素定位操作</a></h3>
<pre><code class="language-cpp">/**
 * @brief 定位线性表中的一个元素
 * 
 * @param l 线性表引用
 * @param target 需要寻找的目标值
 * @return int 目标元素在线性表中的索引 -1表示线性表中不存在该元素
 */
int LocateElement(const SqList&amp; l, int target)
{
    int *p = l.element;
    for(int i = 0; i &lt; l.length; i++)
    {
        if (*p == target)
        {
            return i;
        }
        p++;
    }
    return -1;
}
</code></pre>
<p>该操作的时间复杂度平均是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>。</p>
<h3 id="元素插入操作"><a class="header" href="#元素插入操作">元素插入操作</a></h3>
<p>在向数组的<code>pos</code>位置插入元素之前，需将这个位置及其之后的元素向后移动一位，为这个元素腾出插入空间。</p>
<pre><code class="language-cpp">/**
 * @brief 在线性表中插入值
 * 
 * @param l 线性表引用
 * @param pos 需要插入的位置
 * @param element 目标位置
 * @return true 插入成功
 * @return false 插入失败
 */
bool InsertList(SqList&amp; l, int pos, int element)
{
    if (pos &lt; 0 || pos &gt; l.listSize)
    {
        return false;
    }

    if (l.length &gt;= l.listSize)
    {
        return false;
    }

    for (int i = l.length - 1; i &gt;= pos; i--)
    {
        l.element[i + 1] = l.element[i];
    }
    l.element[pos] = element;
    l.length++;
    return true;
}
</code></pre>
<p>该操作的次数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>为插入的位置，操作的时间复杂度可以可以表达为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="元素删除操作"><a class="header" href="#元素删除操作">元素删除操作</a></h3>
<p>将一个元素从数组中删除，将这个元素之后的所有元素向前移动一位即可。</p>
<pre><code class="language-cpp">/**
 * @brief 从线性表中删除一个元素
 * 
 * @param l 线性表引用
 * @param pos 需要删除的位置
 * @param result 被删除元素的值
 * @return true 删除成功
 * @return false 删除失败
 */
bool DeleteList(SqList&amp; l, int pos, int&amp; result)
{
    if (pos &lt; 0 || pos &gt;= l.length)
    {
        return false;
    }

    result = l.element[pos];

    for (int i = pos; i &lt; l.length - 1; i++)
    {
        l.element[i] = l.element[i + 1];
    }
    l.length--;
    return true;
}
</code></pre>
<p>删除的操作的时间复杂度分析类似为插入的分析：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>也就是说插入和删除操作在平均上都需要移动线性表中一半的元素，在时间复杂度上顺序表示不是很优秀。</p>
<h3 id="销毁结构操作"><a class="header" href="#销毁结构操作">销毁结构操作</a></h3>
<p>将数组占据的空间之间释放就可以了，同时还记得释放结构体所占据的空间。</p>
<pre><code class="language-cpp">/**
 * @brief 删除线性表
 * 
 * @param l 线性表引用
 */
void DestoryList(SqList&amp; l)
{
    free(l.element);
    l.element = nullptr;
    l.listSize = 0;
    l.length = 0;
}
</code></pre>
<h3 id="顺序存储的特点"><a class="header" href="#顺序存储的特点">顺序存储的特点</a></h3>
<ul>
<li>逻辑上相邻的元素，在物理上也相邻</li>
<li>可随机存取线性表的任一元素</li>
<li>顺序存储是一种静态的存储结构，空间的利用率在大部分时间中都比较低。</li>
<li>顺序存储在数组的中段插入和删除数据时，需要的操作较多。</li>
</ul>
<h2 id="线性表的链式存储表示和实现"><a class="header" href="#线性表的链式存储表示和实现">线性表的链式存储表示和实现</a></h2>
<p>链式存储：用一组任意的存储单元存储线性表的数据元素，这组存储单元不一定是物理相邻的。同时这个单元为了表示单元之间在逻辑上的相邻性，还需要留出一部分的空间来存储相邻单元的地址，这部分的空间被称为<strong>指针域</strong>，而存储数据的空间被称为<strong>数据域</strong>。</p>
<p>单链表：每个节点中只包含一个指针域</p>
<p>头指针：第一个节点的存储地址，也就是链表的基地址。</p>
<p>头节点：在第一个节点前面在添加一个节点，称作头节点。这个节点的指针指向第一个节点，这个节点的数据域不储存数据。虽然添加头节点会占据更多的内存空间，但是添加这个节点可以避免在操作链表时需要对头节点进行大量的判空操作。</p>
<h3 id="单向链表"><a class="header" href="#单向链表">单向链表</a></h3>
<h4 id="节点结构体定义"><a class="header" href="#节点结构体定义">节点结构体定义</a></h4>
<pre><code class="language-cpp">struct node {
    int element;
    struct node* next;
};

typedef struct node node_t;
typedef struct node* node_p;
</code></pre>
<h4 id="初始化操作-1"><a class="header" href="#初始化操作-1">初始化操作</a></h4>
<pre><code class="language-cpp">/**
 * @brief 初始化链表
 * 
 * @param node 链表头节点的引用
 * @return int 0表示创建成功，-1表示创建失败
 */
int InitList(node_p&amp; node)
{
    node = (node_p) malloc(sizeof(node_t));
    if (node == nullptr)
    {
        return -1;
    }
    node-&gt;next = nullptr;
    return 0;
}
</code></pre>
<h4 id="销毁操作"><a class="header" href="#销毁操作">销毁操作</a></h4>
<pre><code class="language-cpp">/**
 * @brief 销毁链表 清理占用的空间
 * 
 * @param head 链表头节点的引用
 */
void DestroyList(node_p&amp; head)
{
    node_p node = head;

    while (node != nullptr)
    {
        node_p temp = node;
        node = node-&gt;next;
        free(temp);
    }
    head = nullptr;
}
</code></pre>
<h4 id="定位元素"><a class="header" href="#定位元素">定位元素</a></h4>
<pre><code class="language-cpp">/**
 * @brief 在链表中定位元素
 * 
 * @param head 链表中的头节点引用
 * @param target 需要寻找的目标
 * @return node_p 存储目标的节点
 */
node_p LocateElement(const node_p&amp; head, int target)
{
    // 链表含有头节点
    node_p node = head-&gt;next;

    while (node != nullptr)
    {
        if (node-&gt;element == target)
        {
            break;
        }
        node = node-&gt;next;
        // 这里如果没有找到目标，返回的值就是一个空指针
    }

    return node;
}
</code></pre>
<h4 id="获得指定索引的元素"><a class="header" href="#获得指定索引的元素">获得指定索引的元素</a></h4>
<pre><code class="language-cpp">/**
 * @brief 获得链表中的指定元素
 * 
 * @param head 头节点的引用
 * @param pos 目标元素的索引
 * @param result 存储结构的指针
 * @return true 获取目标元素成功
 * @return false 获取目标元素失败
 */
bool GetElement(const node_p&amp; head, int pos, int* result)
{
    // 链表含有头节点
    node_p node = head-&gt;next;
    // 存储修改的结果
    bool flag = false;

    for(int i = 0; i &lt; pos; i++)
    {
        if(node == nullptr)
        {
            break;
        }

        if(i == pos)
        {
            *result = node-&gt;element;
            flag = true;
            break;
        }

        node = node-&gt;next;
    }

    return flag;
}
</code></pre>
<h4 id="插入元素"><a class="header" href="#插入元素">插入元素</a></h4>
<pre><code class="language-cpp">/**
 * @brief 在链表中插入一个元素
 * 
 * @param head 头节点的引用
 * @param pos 需要插入的位置
 * @param element 需要插入的元素
 * @return true 插入成功
 * @return false 插入失败
 */
bool AppendList(const node_p&amp; head, int pos, int element)
{
    // 链表含有头节点
    node_p node = head-&gt;next;

    for(int i = 0; i &lt; pos - 1; i++)
    {
        if(node == nullptr)
        {
            break;
        }
        node++;
    }

    // 指定位置无法到达
    if (node == nullptr)
    {
        return false;
    }

    node_p newNode = (node_p)malloc(sizeof(node_t));
    if (newNode == nullptr)
    {
        // 空间分配失败
        return false;
    }

    newNode-&gt;element = element;
    newNode-&gt;next = node-&gt;next;
    node-&gt;next = newNode;

    return true;
}
</code></pre>
<h4 id="删除元素"><a class="header" href="#删除元素">删除元素</a></h4>
<pre><code class="language-cpp">/**
 * @brief 从链表中删除元素
 * 
 * @param head 头节点的引用
 * @param pos 位置
 * @param result 结果指针
 * @return true 删除成功
 * @return false 删除失败
 */
bool DeleteList(const node_p&amp; head, int pos, int* result)
{
    // 链表中存在头节点
    node_p node = head-&gt;next;
    bool flag = false;

    for(int i = 0; i &lt; pos - 1; i++)
    {
        if(node-&gt;next == nullptr)
        {
            break;
        }

        node = node-&gt;next;
    }

    if(node-&gt;next == nullptr)
    {
        // 无法到达指定位置
        return false;
    }

    node_p oldNode = node-&gt;next;
    node-&gt;next = oldNode-&gt;next;
    *result = oldNode-&gt;element;
    free(oldNode);

    return true;
}
</code></pre>
<h3 id="双向链表"><a class="header" href="#双向链表">双向链表</a></h3>
<p>每一个节点具有两个指针域，一个指向前驱，一个指向后继。在插入和修改的时候必须同时修改两个指针域。</p>
<blockquote>
<p>代码省略</p>
</blockquote>
<h3 id="循环列表"><a class="header" href="#循环列表">循环列表</a></h3>
<p>将单向链表或者双向列表的末尾节点和头节点连接起来，就构成了一种新的链表——循环列表。循环列表在遍历上使用起来很方便，但是容易引发死循环。</p>
<blockquote>
<p>代码省略</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="栈与队列"><a class="header" href="#栈与队列">栈与队列</a></h1>
<h2 id="线性表栈队列的比较"><a class="header" href="#线性表栈队列的比较">线性表、栈、队列的比较</a></h2>
<p>栈和队列是两种广泛使用的线性数据结构，他们的主要不同在于操作方式上。栈必须按照“后进先出”的规则进行操作，队列必须按照“先进先出”的规则进行操作。同线性表相比，这两种数据结构受到的约束比一般的线性表更多，是受到约束的线性表。</p>
<blockquote>
<p>栈和队列操作并不复杂，关键在于能够用这些数据结构来完成什么样的任务。</p>
</blockquote>
<h2 id="栈"><a class="header" href="#栈">栈</a></h2>
<p>栈是一种特殊的线性表，插入和删除的操作之恶能在表尾进行，具有<strong>后进先出</strong>的特点。栈相关的术语有：</p>
<ul>
<li>栈顶：实际是线性表的表尾</li>
<li>栈底：实际是线性表的表头</li>
<li>入栈：将元素加入线性表</li>
<li>出栈：将元素从线性表中删除</li>
</ul>
<p>栈相关的操作有：</p>
<ul>
<li>生成空栈操作</li>
<li>栈判空操作</li>
<li>数据元素入栈操作</li>
<li>数据元素出栈操作</li>
<li>取栈顶元素操作</li>
<li>栈清空操作</li>
<li>计算栈中元素个数操作</li>
</ul>
<p>栈按照实现方式可以分为顺序栈和链式栈，分别由顺序表和链式表实现，在实践中顺序栈使用更频繁。</p>
<h3 id="顺序栈"><a class="header" href="#顺序栈">顺序栈</a></h3>
<p>栈中的数据元素采用一组连续的存储空间来存放。栈底的位置可以设置在存储空间的一个端点，栈顶的位置可以有两种方式：当前末尾元素所在的位置和当前末尾元素所在的下一个位置。一般常用第二种方式，在栈为空时，栈底和栈顶的位置相同。</p>
<p>顺序栈结构体定义</p>
<pre><code class="language-cpp">struct {
	int* base;
	int* top;
	int stack_size;
} sq_stack;
</code></pre>
<ul>
<li>栈空的条件：<code>top = base</code>，此时出栈会引发下溢问题</li>
<li>栈满的条件：<code>top = base + array_max</code>其中<code>array_max</code>是数组的大小，此时入栈引发上溢问题</li>
</ul>
<blockquote>
<p>懒得写代码捏，等需要用到栈的时候再说</p>
</blockquote>
<h4 id="生成空栈"><a class="header" href="#生成空栈">生成空栈</a></h4>
<pre><code class="language-cpp">bool init_stack(stack&amp; s)
{
    if (s.stack_size == 0) 
    {
        // 如果未正确设置栈的长度
        // 设置为默认长度
        s.stack_size = MAX_STACKS_SIZE; 
    }

    int* address = (int*)malloc(s.stack_size * sizeof(int));
    if (address == nullptr)
    {
        // 分配空间失败
        return false;
    }

    // 默认均设置为栈底地址
    s.top = address;
    s.base = address;
    return true;
}
</code></pre>
<h4 id="栈判空"><a class="header" href="#栈判空">栈判空</a></h4>
<pre><code class="language-cpp">bool is_empty(stack&amp; s)
{
    return s.base == s.top;
}
</code></pre>
<h4 id="栈判满"><a class="header" href="#栈判满">栈判满</a></h4>
<pre><code class="language-cpp">bool is_full(stack&amp; s)
{
    return s.base + s.stack_size == s.top;
}
</code></pre>
<h4 id="入栈"><a class="header" href="#入栈">入栈</a></h4>
<pre><code class="language-cpp">bool stack_push(stack&amp; s, int value)
{
    if(is_full(s))
    {
        // 栈已满
        return false;
    }

    *s.top = value;
    s.top++;
    return true;
}
</code></pre>
<h4 id="出栈"><a class="header" href="#出栈">出栈</a></h4>
<pre><code class="language-cpp">bool stack_pop(stack&amp; s, int* result)
{
    if(is_empty(s))
    {
        // 栈空
        return false;
    }

    *s.top--;
    *result = *s.top;
    return true;
}
</code></pre>
<h3 id="链式栈"><a class="header" href="#链式栈">链式栈</a></h3>
<p>链式栈在编写上比顺序栈更加复杂。比如在出栈的时候，我们需要找到上一个节点的地址，这对于一个单向链表来说是十分复杂的操作。因此，我们将<code>top</code>指针置为链表的头节点，而把<code>base</code>指向链表的尾节点。不过使用链表的好处就是让空间的利用率大大提升，而且链式栈没有栈满的情况，在不考虑内存大小的情况下，链式栈可以认为是无限大的，同时也就没有了判空的方法。</p>
<h4 id="结构体定义"><a class="header" href="#结构体定义">结构体定义</a></h4>
<p>使用链式栈需要定义两个结构体：链表的节点和栈。</p>
<p>链表相关的类型定义：</p>
<pre><code class="language-cpp">typedef struct node {
    int value;
    struct node* next;
} node_t;

typedef node_t* node_p;
</code></pre>
<p>栈相关的结构体定义：</p>
<pre><code class="language-cpp">typedef struct {
    node_p top;
    node_p base;
} stack;
</code></pre>
<h4 id="初始化栈"><a class="header" href="#初始化栈">初始化栈</a></h4>
<pre><code class="language-cpp">bool init_stack(stack&amp; s)
{
    node_p address = (node_p)malloc(sizeof(node_t));

    if (address == nullptr)
    {
        // 空间分配失败
        return false;
    }

    s.top = address;
    s.base = address;
    return true;
}
</code></pre>
<p>在设计链式栈时，仍使用顺序栈时的假设，即当前栈顶的位置为末尾元素的下一个位置。</p>
<h4 id="判空"><a class="header" href="#判空">判空</a></h4>
<pre><code class="language-cpp">bool is_empty(stack&amp; s)
{
    return s.top == s.base;
}
</code></pre>
<h4 id="入栈-1"><a class="header" href="#入栈-1">入栈</a></h4>
<pre><code class="language-cpp">bool stack_push(stack&amp; s, int value)
{
    node_p node = (node_p)malloc(sizeof(node_t));

    if (node == nullptr)
    {
        // 创建空间失败
        return false;
    }

    s.top-&gt;value = value;
    node-&gt;next = s.top;
    s.top = node;
    return true;
}
</code></pre>
<h4 id="出栈-1"><a class="header" href="#出栈-1">出栈</a></h4>
<pre><code class="language-cpp">bool stack_pop(stack&amp; s, int* result)
{
    if(is_empty(s))
    {
        // 栈为空
        return false;
    }

    node_p node = s.top;
    s.top = s.top-&gt;next;
    *result = s.top-&gt;value;
    free(node);
    return true;
}
</code></pre>
<p>入栈和出栈的操作记住栈顶时链表的头节点就行。</p>
<h3 id="栈的应用"><a class="header" href="#栈的应用">栈的应用</a></h3>
<h4 id="数制的转换"><a class="header" href="#数制的转换">数制的转换</a></h4>
<p>我们常常使用除k取余法来实现数制的转换，在除法完成了之后，需要将得到的余数逆序写出。这个逆序写出的过程可以通过栈来实现，在计算的时候，将计算的结构压入栈中，在输出的时候将值依次弹出就得到了转换的结果。</p>
<h4 id="括号匹配"><a class="header" href="#括号匹配">括号匹配</a></h4>
<p>在编译的过程中，括号的匹配是一个十分重要的课题。由于后出现的括号序号先进行匹配，我们可以利用栈来完成这个过程。遍历整个文本，将遇到的左括号压入栈中，遇到右括号就检测它与栈顶的括号是否匹配，如果匹配就出栈继续检测，反之程序退出。</p>
<h4 id="整型数简单表达式求解"><a class="header" href="#整型数简单表达式求解">整型数简单表达式求解</a></h4>
<p>算术表达式的求解需要遵循先乘除后加减，先左后右，括号内的先计算这三条规则。为了在运算的过程中满足这些规则，我们利用栈的特性，设计两个栈，一个栈存储操作数，一个栈存储操作符。在处理的过程中，依次读取表达式中的元素，如果是操作数就压入操作数栈中，如果是操作符就和操作符栈顶端的元素比较优先级，如果优先级低就执行运算，如果优先级高就将其压入操作符栈，如果优先级低，就执行栈顶的操作符，再将其压入操作符栈中，如此循环直到运算结束。</p>
<p>表达式有着三种形式，前缀式，中缀式，后缀式。在这当中，中缀式符合人类的书写习惯。而后缀式书写的顺序符合表达式运算的方式，在计算机有着更为广泛的使用。例如表达式:<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">11</span><span class="mclose">)</span></span></span></span></p>
<ul>
<li>前缀式：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">435</span></span></span></span></li>
</ul>
<blockquote>
<p>按照我的理解，前缀式就是后缀式逆过来</p>
</blockquote>
<ul>
<li>中缀式：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">11</span><span class="mclose">)</span></span></span></span></li>
<li>后缀式：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">534</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">11</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">+</span></span></span></span></li>
</ul>
<h4 id="递归"><a class="header" href="#递归">递归</a></h4>
<p>虽然递归很牛逼，但是最好不用递归。</p>
<blockquote>
<p>所以没有笔记</p>
</blockquote>
<h2 id="队列"><a class="header" href="#队列">队列</a></h2>
<p>队列式一种特殊的线性表，限定插入和删除操作分别在表的两端机型，具有先进先出的特点。表头的元素被称为<strong>队头</strong>​**<code>f</code><strong>，在这里进行出队的操作，表末尾的元素被称为</strong>队尾<strong>​</strong><code>r</code>**，在这里进行入队的操作。队列支持的操作和栈支持的操作近似。</p>
<p>队列有链式实现和顺序实现两种实现方式，但是链式实现更加的方便。</p>
<h3 id="队列的链式存储实现"><a class="header" href="#队列的链式存储实现">队列的链式存储实现</a></h3>
<p>队列中节点结构体定义：</p>
<pre><code class="language-cpp">struct node {
    int data;
    struct node* next;
};

typedef struct node node_t;
typedef struct node* node_p;
</code></pre>
<p>在实现队列的时候，我们需要两个指针：</p>
<ul>
<li><code>front</code>队头指针</li>
<li><code>rear</code>队尾指针</li>
</ul>
<p>为了使用这两个指针方便，我们可以再定义一个新的结构体：</p>
<pre><code class="language-cpp">typedef struct {
    // 队头指针
    node_p front;
    // 队尾指针
    node_p rear;
} linked_quene;
</code></pre>
<h4 id="队列的初始化"><a class="header" href="#队列的初始化">队列的初始化</a></h4>
<pre><code class="language-cpp">bool init_quene(linked_quene&amp; q)
{
    q.front = nullptr;
    q.rear = nullptr;
    return true;
}
</code></pre>
<p>在初始化的时候，我们没有添加头节点。</p>
<h4 id="入队操作"><a class="header" href="#入队操作">入队操作</a></h4>
<pre><code class="language-cpp">bool in_quene(linked_quene&amp; q, int data)
{
    node_p node = (node_p) malloc(sizeof(node_t));

    if (node == nullptr)
    {
        // 分配空间失败
        return false;
    }

    node-&gt;data = data;
    node-&gt;next = nullptr;

    // 处理第一次插入，头指针为空的情况
    if (q.front == nullptr)
    {
        q.front = node;
    }

    // 如果不是第一次插入
    if (q.rear != nullptr)
    {
        q.rear-&gt;next = node;
    }
    q.rear = node;

    return true;
}
</code></pre>
<p>在进行入队操作时，需要注意插入第一个元素需要同时修改队头的指针和队尾的指针。</p>
<h4 id="出队操作"><a class="header" href="#出队操作">出队操作</a></h4>
<pre><code class="language-cpp">bool out_quene(linked_quene&amp; q, int* target)
{
    if (q.front == nullptr)
    {
        // 木有元素力
        return false;
    }

    *target = q.front-&gt;data;

    node_p node = q.front;
    q.front = q.front-&gt;next;
    if (q.front == nullptr)
    {
        // 表中没有元素了
        q.rear = nullptr;
    }

    free(node);
    return true;
}
</code></pre>
<p>在进行出队操作的时候，也是注意在删除最后一个元素的时候，需要同时修改队头指着和队尾指针。</p>
<h4 id="队列的判空操作"><a class="header" href="#队列的判空操作">队列的判空操作</a></h4>
<p>只用判断队头指针或者队尾指针是否为空就可以了</p>
<pre><code class="language-cpp">bool quene_empty(const linked_quene&amp; q)
{
    return q.front == nullptr;
}
</code></pre>
<p>还有一些操作这里没有给出实现：</p>
<ul>
<li>队列的清空操作</li>
<li>获取队列的长度操作</li>
</ul>
<h3 id="队列的顺序存储实现"><a class="header" href="#队列的顺序存储实现">队列的顺序存储实现</a></h3>
<p>队列的顺序存储实现非常的复杂，需要考虑非常多的因素。</p>
<h4 id="基本实现原理"><a class="header" href="#基本实现原理">基本实现原理</a></h4>
<p>将队头和队尾在初始化时置为顺序表的第一个位置<code>0</code>，在需要入队的时候，在目前队尾索引的位置插入新的元素，将队尾索引加1；在需要出队的时候，取出目前队头索引位置的元素，将队尾索引加1。在操作中注意判空。</p>
<h4 id="假溢出的问题"><a class="header" href="#假溢出的问题">假溢出的问题</a></h4>
<p>这样的顺序存储实现存在一个非常严重的假溢出问题：当我们不断的入队和出队之后，我们的队头索引和队尾索引都在不断的变大，很快索引的值就大于数组的尺寸了，但是目前存储值的数量并没有超出数组的大小。</p>
<p>为了解决这个问题，我们可以采用<strong>循环数组</strong>来解决，通过对索引取数组长度的模来实现这个“逻辑上”的循环。</p>
<ul>
<li>队列的初始化：<code>front =0, end = 0</code></li>
<li>入队操作：<code>end mod length + 1</code></li>
<li>出队操作：<code>front mod length + 1 ​</code></li>
<li>判满操作：<code>(r mod length) + 1 = f</code></li>
<li>判空操作：<code>f == r</code></li>
</ul>
<blockquote>
<p>由于数组的实现比较复杂，这里就不放实现了。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="树"><a class="header" href="#树">树</a></h1>
<h2 id="树的结构定义和基本操作"><a class="header" href="#树的结构定义和基本操作">树的结构定义和基本操作</a></h2>
<h3 id="树的定义"><a class="header" href="#树的定义">树的定义</a></h3>
<p>树是一类重要的非线性数据结构，是以分支关系定义的层次结构。</p>
<p>树是由若干个节点组成的有限集合。</p>
<h3 id="树的基本术语"><a class="header" href="#树的基本术语">树的基本术语</a></h3>
<ul>
<li>节点的度：节点拥有的子树数目</li>
<li>叶子（终端）节点：度为0的节点</li>
<li>分支节点：度不为0的节点</li>
<li>树的度：树的各节点度的最大值</li>
<li>内部节点：除根节点以外的节点</li>
<li>子节点和父节点：节点的子树的根是该节点的孩子，该节点为父节点</li>
<li>兄弟：具有同一父节点的子节点互为兄弟</li>
<li>节点的祖先：从根到该节点所经分支上的所有节点</li>
<li>节点的子孙：该节点为根的子树中的任一节点</li>
<li>节点的层次：表示该节点在树中的相对位置</li>
<li>堂兄弟：父节点在同一层的节点互为堂兄弟</li>
<li>树的深度：树中节点的最大层次</li>
<li>有序树：树中各节点的子树从左至右是有次序的，不能互换。如果反之则为无序树</li>
<li>路径长度：从树中的某节点出发，能够”自上而下的“通过树中节点到达另外一个节点，就称这两个节点之间存在一条路径，路径经过的分支数称为路径长度</li>
<li>树的路径长度：从根到每个节点的路径长度之和</li>
<li>森林：许多互不相交的树的集合</li>
</ul>
<h3 id="树的基本操作"><a class="header" href="#树的基本操作">树的基本操作</a></h3>
<ul>
<li>初始化操作</li>
<li>求根操作</li>
<li>求父节点操作</li>
<li>求子节点操作</li>
<li>求兄弟操作</li>
<li>建树操作</li>
<li>插入子树操作</li>
<li>删除子树操作</li>
<li>遍历操作</li>
<li>清除结构操作</li>
</ul>
<h2 id="二叉树"><a class="header" href="#二叉树">二叉树</a></h2>
<h3 id="二叉树的定义"><a class="header" href="#二叉树的定义">二叉树的定义</a></h3>
<p>二叉树是n个结点的有限集合，或者为空树，或由一个根节点和两颗互不相交的左子树和右子树的二叉树组成。</p>
<p>二叉树的特点：</p>
<ul>
<li>定义是一个递归的定义</li>
<li>结点的度总是大于等于0小于等于2的</li>
<li>是有序树</li>
</ul>
<p>二叉树作为一种有序树，在使用中需要区别左子树和右子树；即使只有一颗子树也需要指明这是左子树还是右子树。总的来说，二叉树总共有着五种基本的形态：空表</p>
<p>根和空的左右子树</p>
<pre><code class="language-mermaid">graph TB
root(根)
</code></pre>
<p>根和左子树或者右子树，这是两种不同的树</p>
<pre><code class="language-mermaid">graph TB
root(根)
left(左子树/右子树)
root--&gt;left
</code></pre>
<p>根和左右子树</p>
<pre><code class="language-mermaid">graph TB
root(根)
left(左子树)
right(右子树)
root--&gt;left
root--&gt;right
</code></pre>
<p>二叉树还存在一些其他的概念：</p>
<ul>
<li>满二叉树：一颗深度为<code>k</code>且有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个结点的二叉树称为满二叉树</li>
<li>完全二叉树：若一颗二叉树至多只有最下面的两层上结点的度数可以小于2，并且最下面一层上的结点都集中在该层最左边的若干位置上，则此二叉树可以被称为完全二叉树</li>
</ul>
<h3 id="二叉树的性质"><a class="header" href="#二叉树的性质">二叉树的性质</a></h3>
<ul>
<li>
<p>二叉树的第<code>i</code>层上至多有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>个节点</p>
</li>
<li>
<p>深度为<code>k</code>的二叉树至多有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个节点</p>
</li>
<li>
<p>对于任何一棵二叉树T，如果其终端节点数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，度为2的节点数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p>证明：除了树中的根节点，每一个结点都有一个进入的分支，所以进入结点的分支数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，而离开结点的分支数为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，由于分支数是守恒的，所以可以得到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
</li>
<li>
<p>具有n个结点的完全二叉树的深度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p>证明：假设树的深度为k，则有节点数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，进行适度的放缩<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9851em;vertical-align:-0.136em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>，然后在对左边的不等式两边取对数，再由n必然是整数，可以得到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
</li>
<li>
<p>对于一颗具有n个结点的完全二叉树从上到下从左至右进行1至n的编号，则对于任何一个结点i(<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>)，有如下的三条结论：</p>
<ul>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>,则结点的父节点是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2007em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8557em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span></li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord">2</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>,则i的左子节点是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord">2</span><span class="mord mathnormal">i</span></span></span></span></li>
<li>如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>，则i的右子节点是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
</ul>
</li>
</ul>
<h3 id="二叉树的基本操作"><a class="header" href="#二叉树的基本操作">二叉树的基本操作</a></h3>
<ul>
<li>初始化操作</li>
<li>求根函数</li>
<li>求父节点函数</li>
<li>求子节点函数</li>
<li>求兄弟结点函数</li>
<li>建树操作</li>
<li>插入子树操作</li>
<li>删除子树操作</li>
<li>遍历操作</li>
<li>清楚结构操作</li>
</ul>
<h3 id="二叉树的储存结构"><a class="header" href="#二叉树的储存结构">二叉树的储存结构</a></h3>
<h4 id="顺序存储"><a class="header" href="#顺序存储">顺序存储</a></h4>
<p>利用二叉树的第五个性质，将树从上到下从左至右地将树存储到一个数组当中，如果一个结点并不存在，也要在数组中占据一个位置。但是这样存储不算是很好的，如果树中空余的元素比较多，那么空间的利用率就会很低，而且如果树发生变化，修改这个数组是比较复杂的，也就是灵活性不咋样。</p>
<blockquote>
<p>所以在实际中很少用到顺序存储来存二叉树</p>
</blockquote>
<h4 id="链式存储"><a class="header" href="#链式存储">链式存储</a></h4>
<p>在链式存储的设计上有着两种方式：</p>
<ul>
<li>二叉链表：含有左子节点、数据部分和右子节点</li>
<li>三叉链表/带父节点的二叉链表：在二叉链表的基础上增加了指向父节点的指针</li>
</ul>
<p>在具体使用需要按照实际情况下选择合适的结构体定义，在一般情况下我们都使用二叉链表。</p>
<h3 id="二叉树的基本操作-1"><a class="header" href="#二叉树的基本操作-1">二叉树的基本操作</a></h3>
<p>结构体定义如下：</p>
<pre><code class="language-cpp">struct tree {
    int data;
    struct tree* l_child;
    struct tree* r_child;
};

typedef struct tree tree_t;
typedef struct tree* tree_p;
</code></pre>
<h4 id="二叉树的创建"><a class="header" href="#二叉树的创建">二叉树的创建</a></h4>
<h4 id="二叉树的遍历"><a class="header" href="#二叉树的遍历">二叉树的遍历</a></h4>
<p>在二叉树的应用中，遍历操作是十分普遍的，但是二叉树是一个非线性的结构，想要设计一个线性的队列将整个树每一个结点不重不漏的都遍历一遍是比较困难的，于是我们采用递归的方法。</p>
<p>由于树的递归定义，一棵树又左节点，根节点和右节点组成，因此在遍历时就存在三种遍历的顺序，我们按照遍历根的顺序吧他们称为前序、中序和后序。我们以下面这棵树给出三种遍历的顺序：</p>
<pre><code class="language-mermaid">graph TB
A
A--&gt;B
A--&gt;C
B--&gt;D
B--&gt;E
</code></pre>
<p>前序遍历：ABDEC</p>
<p>中序遍历：DBEAC</p>
<p>后序遍历：DEBCA</p>
<p>看完上面一个比较简单的例子，我们给出一个比较复杂的例子：</p>
<pre><code class="language-mermaid">graph TB
R
R--&gt;D
R--&gt;A
D--&gt;F
D--&gt;B
F--&gt;C
F--&gt;S
B--&gt;M-Left
A--&gt;H
H--&gt;Y-Right
A--&gt;K
</code></pre>
<p>前序遍历：RDFCSBMAHYK</p>
<p>中序遍历：CFSDMBRHYAK</p>
<p>后序遍历：CSFMBDYHKAR</p>
<p>利用前序+中序或者中序+后序我们可以从遍历的顺序中回复出原有的二叉树结构。</p>
<h5 id="前序遍历的实现"><a class="header" href="#前序遍历的实现">前序遍历的实现</a></h5>
<pre><code class="language-cpp">void preorder_iter(tree_p t)
{
    if (t != nullptr)
    {
        // do something
        Preorder(t-&gt;l_child);
        Preorder(t-&gt;r_child);
    }
}
</code></pre>
<p>不过由于在树中叶子结点占大多数，采用如上的递归算法会存在许多的无效递归调用，我们可以如下优化：</p>
<pre><code class="language-cpp">void preorder_iter_2(tree_p t)
{
    // do something
    if (t-&gt;l_child == nullptr)
    {
        preorder_iter_2(t-&gt;l_child);
    }
    if (t-&gt;r_child == nullptr)
    {
        preorder_iter_2(t-&gt;r_child);
    }
}
</code></pre>
<p>或者，由于对于右节点的递归实质上是一个伪递归，我们可以用一个循环来替代这个递归</p>
<pre><code class="language-cpp">void preorder_iter_3(tree_p t)
{
    while (t != nullptr)
    {
        // do something
        preorder_iter_3(t-&gt;l_child);
        t = t-&gt;r_child;
    }
}
</code></pre>
<p>当然，我们可以用栈来模拟递归，将递归的调用完全消除</p>
<pre><code class="language-cpp">void preorder_iter_4(tree_p t)
{
	stack_t s;
    init_stack(s);
    tree_p node = t;
    while(node != nullptr)
    {
        // do something
       	if (node-&gt;r_child != nullptr)
        {
            stack_push(s,node-&gt;r_child);
        }
        if (node-&gt;l_child != nullptr)
        {
            node = node-&gt;l_child;
        }
        else
        {
            node = stack_pop(s);
        }
    }
}
</code></pre>
<h5 id="中序遍历的实现"><a class="header" href="#中序遍历的实现">中序遍历的实现</a></h5>
<pre><code class="language-cpp">void inorder_iter(tree_p t)
{
	if(t != nullptr)
	{
		inoder_iter(t-&gt;l_child);
		// do something
		inorder_iter(t-&gt;r_child);
	}
}
</code></pre>
<h5 id="后序遍历算法"><a class="header" href="#后序遍历算法">后序遍历算法</a></h5>
<pre><code class="language-cpp">void postorder_iter(tree_p t)
{
    if(t != nullptr)
    {
        postorder_iter(t);
        postorder_iter(t);
        // do something
    }
}
</code></pre>
<p>在实现遍历算法之后，我们可以利用遍历操作来实现查找指定节点值的节点、求节点所在层次、求二叉树的深度，二叉树的复制等等一系列操作。</p>
<h2 id="线索二叉树"><a class="header" href="#线索二叉树">线索二叉树</a></h2>
<p>上面已经说明了，遍历二叉树实际上就是将二叉树中的节点排成一个线性的队列。在有些时候，我们不希望对二叉树完全进行遍历就能找到指定节点的前驱和后继，在这种情况下，我们就需要记录每个节点的前驱和后继，这样的二叉树就是线索二叉树。</p>
<p>线索二叉树最简单的实现方式就是按照定义，在节点的定义中添加一个前驱指针和一个后继指针，但是这样会使空间的利用率大大降低。</p>
<p>为了提高一下空间的利用率，我们可以注意到在原有的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个节点的二叉树中，还有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个指针域的内容是空指针，我们不妨利用一下这些空指针来储存我们的前驱和后继。</p>
<h3 id="线索二叉树的存储结构"><a class="header" href="#线索二叉树的存储结构">线索二叉树的存储结构</a></h3>
<pre><code class="language-cpp">typedef enum
{
    child;
    node;
} pointer_type_t;

struct clue_tree 
{
	pointer_type_t l_tag;
    int* l_child;
    int data;
    int* r_child;
    pointer_type_t r_tag;
}
</code></pre>
<p>在实际的操作过程中，前序和后序线索二叉树在寻找后继或者前驱时仍然存在麻烦，我们一般只使用中序线索二叉树。</p>
<p>对于中序线索二叉树：</p>
<ul>
<li>在寻找前驱时，如果<code>l_tag</code>是<code>child</code>，那么从其左子沿着右链走到<code>r_tag</code>是<code>node</code>的节点即为前驱，如果<code>l_tag</code>是<code>node</code>，那么就是前驱。</li>
<li>在寻找后继时，如果<code>r_tag</code>是<code>child</code>，那么从其右子沿着左链走到<code>l_tag</code>是<code>node</code>的节点即为后继，如果<code>r_tag</code>是<code>node</code>，那么就是后继。</li>
</ul>
<h3 id="二叉树的线索化"><a class="header" href="#二叉树的线索化">二叉树的线索化</a></h3>
<p>利用中序遍历算法：</p>
<ul>
<li>遍历左子树</li>
<li>访问当前节点
<ul>
<li>首先判断<code>l_tag</code>和<code>r_tag</code>的值</li>
<li>建立前驱的后继线索</li>
<li>建立前驱</li>
<li>将当前节点作为下一个节点的前驱</li>
</ul>
</li>
<li>遍历右子树</li>
</ul>
<h2 id="哈夫曼树"><a class="header" href="#哈夫曼树">哈夫曼树</a></h2>
<h3 id="哈夫曼树的概念"><a class="header" href="#哈夫曼树的概念">哈夫曼树的概念</a></h3>
<p>在正式介绍哈夫曼树之前，我们先介绍一组术语：</p>
<ul>
<li>
<p>节点权值：有某种意义的实际数字</p>
</li>
<li>
<p>节点的路径长度：从根节点到每一个节点的路径上的分支数</p>
</li>
<li>
<p>带权路径长度：节点的路径长度与该节点的权之积</p>
</li>
<li>
<p>树的带权路径长度：树中所有叶子节点的带权路径长度之和</p>
<p>这个值记为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">wpl</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>在公式中，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为节点的权值，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为节点到根的路径长度。</p>
</li>
<li>
<p>最优二叉树：带权路径长度最小的二叉树。这种树也被称为哈夫曼树。</p>
</li>
</ul>
<p>我们在给出一个例子：现在有着4个节点，节点的权值分别为7，5，2，4，请构造一个具有四个叶子节点的二叉树。</p>
<p>我们先给出一个“均匀”的例子：</p>
<pre><code class="language-mermaid">graph TB
root--&gt;left
root--&gt;right
left--&gt;7
left--&gt;5
right--&gt;2
right--&gt;4
</code></pre>
<p>这颗二叉树的WPL值为36</p>
<p>我们在给出一个比较优化的二叉树：</p>
<pre><code class="language-mermaid">graph TB
root--&gt;7
root--&gt;right1
right1--&gt;5
right1--&gt;right2
right2--&gt;2
right2--&gt;4
</code></pre>
<h3 id="哈夫曼树的建立方法"><a class="header" href="#哈夫曼树的建立方法">哈夫曼树的建立方法</a></h3>
<p>建立哈夫曼树的基本思想就是使权值大的节点靠近根。</p>
<ul>
<li>将给定的权值从小到大排序为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，生成一个森林<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，其中每一颗树的根节点的带着对应的权值，左右子树均为空。</li>
<li>将F中根的权值最小的两颗二叉树合并成一颗新的二叉树，将新的二叉树加入森林中，同时删除已经合并了两颗二叉树。</li>
<li>重复上一步，指导在森林中只剩下一颗树，这棵树就是哈夫曼树。</li>
</ul>
<h3 id="哈夫曼树的存储结构"><a class="header" href="#哈夫曼树的存储结构">哈夫曼树的存储结构</a></h3>
<p>由于在哈夫曼树中没有度为1的节点，属于是严格二叉树，对于一个有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个叶子节点的哈夫曼树来说，这棵树有着<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个节点。我们可以直接使用一个大小为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>的向量来储存哈夫曼树。</p>
<pre><code class="language-cpp">typedef struct {
    // 节点的权值
    unsigned int weight;
    // 节点的父节点和左右子节点在数组中的索引
    unsigned int parent, lChild, rChild;
} HuffmanNode;

typedef HuffmanNode HuffmanNodeP;
</code></pre>
<h3 id="哈夫曼树的应用"><a class="header" href="#哈夫曼树的应用">哈夫曼树的应用</a></h3>
<h4 id="哈夫曼编码"><a class="header" href="#哈夫曼编码">哈夫曼编码</a></h4>
<p>为了在通信和数据传送中使总传输的数据量最小，在将信息编码为二进制代码的时候可以使用不等长的编码，对于使用频率比较高的字符使用比较短的编码，对于使用频率比较低的字符使用比较长的编码，这样可以有效压缩编码之后数据的长度。</p>
<p>例如现在有字符集<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mclose">}</span></span></span></span>，我们要编码的信息为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">im</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span></span>。</p>
<p>首先写出节点的权值，也就是这里字符出现的频率：</p>
<div class="table-wrapper"><table><thead><tr><th>t</th><th>i</th><th>m</th><th>e</th><th>r</th><th>s</th><th>u</th><th>h</th></tr></thead><tbody>
<tr><td>4</td><td>2</td><td>1</td><td>2</td><td>2</td><td>1</td><td>1</td><td>1</td></tr>
</tbody></table>
</div>
<p>建立哈夫曼树，在左子树视作0，右子树视作1，从叶子节点到根节点就可以写出一种不等长的编码。</p>
<div class="table-wrapper"><table><thead><tr><th>字符</th><th>二进制编码</th></tr></thead><tbody>
<tr><td>t</td><td>01</td></tr>
<tr><td>i</td><td>100</td></tr>
<tr><td>m</td><td>1110</td></tr>
<tr><td>e</td><td>101</td></tr>
<tr><td>r</td><td>110</td></tr>
<tr><td>s</td><td>1111</td></tr>
<tr><td>u</td><td>000</td></tr>
<tr><td>h</td><td>001</td></tr>
</tbody></table>
</div>
<p>而且在哈夫曼编码中我们不难发现，没有编码是其他编码的前缀，我们不用担心编码之后的结果会引起歧义的问题，所以哈夫曼编码是一种十分不错的编码。</p>
<h2 id="树-1"><a class="header" href="#树-1">树</a></h2>
<h3 id="树和二叉树"><a class="header" href="#树和二叉树">树和二叉树</a></h3>
<blockquote>
<p>树与二叉树之间的转换：</p>
<p>在树或者森林同二叉树之间存在一个一一对应的关系。任何一棵树或者森林都能唯一的对应到一颗二叉树，任何一颗二叉树也是唯一对应到一个树或者森林。</p>
</blockquote>
<p>在树同二叉树之间的转换方法：</p>
<ul>
<li>
<p>树到二叉树：</p>
<ul>
<li>在所有的兄弟节点之间加一条连线</li>
<li>对于每个节点，除了保留同父节点之间的连线之外，去掉该节点同其他所有节点的连线</li>
<li>所得的树就是一颗二叉树。</li>
</ul>
<p><img src="data-structure/./assets/tree-to-2-20221120150358-bfg7z8z.png" alt="" /></p>
</li>
<li>
<p>二叉树到树：</p>
<ul>
<li>将左子节点的右子节点、右子节点的右子节点，……同父节点连接在一起</li>
<li>最后去掉父节点同右子节点的所有连线。</li>
</ul>
</li>
</ul>
<h3 id="树的遍历"><a class="header" href="#树的遍历">树的遍历</a></h3>
<p>我们可以直接对转换生成的二叉树进行遍历，对于二叉树的先序遍历就是树的先序遍历，对于二叉树的中序遍历就是对树的后序遍历，树没有中序遍历。</p>
<p>如果是森林生成的二叉树，我们先定义对于森立的遍历方法。森林的先序遍历就是：访问第一颗树的根节点，先序遍历第一颗树的根的子树森林，先序遍历除第一颗树之外的森林。森林的中序遍历就是：中序遍历第一棵树的根的子树森林，访问第一棵树的根节点，中序遍历除第一颗树外剩余的树构成的森林。对于二叉树的先序遍历对应树的先序遍历，对于二叉树的中序遍历对于树的中序遍历。</p>
<h3 id="树的存储结构"><a class="header" href="#树的存储结构">树的存储结构</a></h3>
<p>我们可以利用二叉树和树之间的关系，采用二叉链表来存储一颗树。</p>
<p>不过采用这种方式保存的树查找指定节点的子节点比较困难，左子节点就是左子节点，而右子节点需要遍历到右子节点链的末尾。</p>
<h2 id="树的二叉树的应用举例"><a class="header" href="#树的二叉树的应用举例">树的二叉树的应用举例</a></h2>
<h3 id="四皇后问题"><a class="header" href="#四皇后问题">四皇后问题</a></h3>
<h4 id="问题描述"><a class="header" href="#问题描述">问题描述</a></h4>
<p>在4x4的棋盘上放置4个棋子，使得任何两个棋子都不在同一行/列/对角线上，请列出所有合法的布局。</p>
<h4 id="算法-1"><a class="header" href="#算法-1">算法</a></h4>
<blockquote>
<p>采用回溯的算法，在约束的条件下进行先序遍历，并在遍历的过程中剪去那些不满足条件的分支。</p>
</blockquote>
<p><img src="data-structure/./assets/four-queen-20221120150358-gpk2rs2.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="图"><a class="header" href="#图">图</a></h1>
<h2 id="概述-3"><a class="header" href="#概述-3">概述</a></h2>
<p>图是非线性的数据结构，数据元素之间呈现多对多的关系。</p>
<p>图在数学上的定义为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>在公式中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>是顶点的有穷非空集合，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是弧的有穷集合。</p>
<h3 id="图的相关术语"><a class="header" href="#图的相关术语">图的相关术语</a></h3>
<ul>
<li>顶点：数据元素所构成的节点</li>
<li>有向图：弧的顶点偶对是有序的。</li>
<li>无向图：弧的顶点偶对是无序的。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="字符串"><a class="header" href="#字符串">字符串</a></h1>
<h2 id="串的概念和基本操作"><a class="header" href="#串的概念和基本操作">串的概念和基本操作</a></h2>
<h3 id="基本概念"><a class="header" href="#基本概念">基本概念</a></h3>
<p>字符串：是由零个或者多个字符组成的有限序列。串是特殊的线性表，数据元素是单个字符。</p>
<ul>
<li>子串和主串：串中任意个连续的字符组成的子序列称为该串的子串。包含子串的串称为主串</li>
<li>串相等：两个串的长度相等，且对应位置的字符都相等</li>
<li>空串和空白串：空串不包含任意的字符，用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span>表示，空白串由一个或者多个空格组成</li>
<li>子串的位置：子串中第一个字符在主串中的序号称为子串的位置</li>
</ul>
<p>串需要支持一系列的基本操作：</p>
<ul>
<li>求串长</li>
<li>串赋值</li>
<li>串连接</li>
<li>串比较</li>
<li>求子串</li>
<li>子串定位</li>
</ul>
<h3 id="串的定长存储"><a class="header" href="#串的定长存储">串的定长存储</a></h3>
<p>方法一：顺序存储空间的第一个位置存放串中字符的个数</p>
<p>方法二：串后边再存放一个特殊字符<code>\0</code>表示结尾，<code>\0</code>不算做串中的元素</p>
<p>使用链式存储存储字符串的方式称作链串。使用链串有助于进行插入和删除的操作，但是空间的利用率比较低。</p>
<h2 id="模式匹配"><a class="header" href="#模式匹配">模式匹配</a></h2>
<p>子串定位操作称为串的模式匹配。</p>
<p>模式匹配在计算机中的应用是非常广泛的，比如搜索引擎和在文档中搜索特定的单词。</p>
<h3 id="简单模式匹配算法"><a class="header" href="#简单模式匹配算法">简单模式匹配算法</a></h3>
<p>方法：穷举法。</p>
<p>在主串中每次取出长度和子串相等的子串，将这两个子串相互比较，直到找到相同的子串或者比对结束。</p>
<pre><code class="language-cpp">int simpleIndex(string source, string target)
{
    int i = 0;
    int j = 0;

    while (i &lt; source.length() and j &lt; target.length())
    {
        if (source[i] == source[j])
        {
            // 匹配成功
            i++;
            j++;
        }
        else
        {
            i = i - j + 1;
            j = 0;

        }
    }

    if (j &gt; target.length())
    {
        return i - target.length();
    }
    else
    {
        return -1;
    }
}
</code></pre>
<p>在设计这个算法中需要注意：</p>
<ul>
<li>匹配失败后再次开始的位置</li>
<li>匹配成功的判断条件</li>
</ul>
<p>但是在子串和主串的相似程度比较高的时候，这种匹配算法的复杂度就会比较高。在主串中可能存在大量和子串部分匹配的内容，算法中回溯的次数就会比较多。</p>
<h3 id="模式匹配改进算法kmp"><a class="header" href="#模式匹配改进算法kmp">模式匹配改进算法——KMP</a></h3>
<p>算法主要改进在遍历时主串回溯这一问题，使在比对时指向主串中比对位置的指针不必回退。实现这一点的关键就是，在完成一个部分匹配之后，先对子串部分匹配的部分进行一个自匹配，因为此时子串部分匹配的部分和主串时相同的。</p>
<p><img src="data-structure/./assets/kmp-20221120150358-i5ftw3k.png" alt="" /></p>
<p>在设计实现KMP算法中主要的难点就是：如何确定已经部分匹配的子串应该向前滑动的长度？</p>
<p>由于确定这个长度和主串没有关系而只和子串有关系，我们可以先针对子串生成一个数组来存储当部分匹配到某一个位置之后，子串可以向后面滑动的长度。而且由于子串向后滑动等效于向前移动子串的开始匹配位置，我们可以先根据子串建立起一个当前匹配位置和下一次匹配位置的对应数组。</p>
<h4 id="next数组"><a class="header" href="#next数组">next数组</a></h4>
<p>在<code>kmp</code>​算法中比较重要的部分就是next数组的获得。next数组从定义来说是当前字符串的前缀和后缀最多匹配的位数。</p>
<div class="table-wrapper"><table><thead><tr><th>字符串</th><th>next</th></tr></thead><tbody>
<tr><td>a</td><td>0</td></tr>
<tr><td>ab</td><td>0</td></tr>
<tr><td>abb</td><td>0</td></tr>
<tr><td>abbc</td><td>0</td></tr>
<tr><td>abbca</td><td>1</td></tr>
<tr><td>abbcad</td><td>0</td></tr>
<tr><td>abbcada</td><td>1</td></tr>
<tr><td>abbcadab</td><td>2</td></tr>
<tr><td>abbcadabb</td><td>3</td></tr>
</tbody></table>
</div>
<p>下面是通过通过模式串求得next数组的算法。</p>
<pre><code class="language-c">int getNext(int nextArray[], char str[], int length)
{
    int j = 0;
    int k = -1;

    nextArray[0] = -1;

    while(j &lt; length)
    {
        if (k == -1 || str[j] == str[k])
        {
            j++;
            k++;
            nextArray[j] = k;
        }
        else
        {
            k = nextArray[k];
        }
    }
}
</code></pre>
<p>在获得了next数组之后，我们就可以简单的写出<code>kmp</code>​算法的匹配部分。</p>
<pre><code class="language-c">int kmpMatch(char pattern[], char str[], int patternLength, int strLength)
{
    int nextArray[patternLength];

    getNext(nextArray, pattern, patternLength);

    int patternPos = 0;
    for(int pos = 0; pos &lt; strLength; pos++)
    {
        if (pattern[patternPos] == str[pos])
        {
            patternPos++;
            pos++;

            if (patternPos == patternLength)
            {
                return pos;
            }
        }
        else
        {
            patternPos = nextArray[patternPos - 1];
        }
    }
}
</code></pre>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="查找表"><a class="header" href="#查找表">查找表</a></h1>
<h2 id="查找中涉及的概念和术语"><a class="header" href="#查找中涉及的概念和术语">查找中涉及的概念和术语</a></h2>
<h3 id="术语"><a class="header" href="#术语">术语：</a></h3>
<ul>
<li>
<p>查找表：同一类型的记录（数据元素）的集合</p>
<blockquote>
<p>数据元素之间存在着比较松散的关系，为了提高查找的效率，可以在元素之间人为的附加某种特定的关系。</p>
</blockquote>
</li>
<li>
<p>关键字：记录数据元素中的某个数据项的值</p>
<ul>
<li>主关键字：该关键字可以唯一的标识一个记录</li>
<li>次关键字：该关键字不能唯一标识一个记录</li>
</ul>
</li>
<li>
<p>查找：指定某个值，在查找表中确定是否存在一个记录，该记录的关键字等于给定值</p>
</li>
<li>
<p>静态查找：对查找表的查找仅是为了查找，不改动查找表中的数据</p>
</li>
<li>
<p>动态查找：在查找的过程中同时插入不存在的记录，或者删除某个已存在的记录</p>
</li>
<li>
<p>查找成功：查找表中存在满足查找条件的记录</p>
</li>
<li>
<p>查找失败：查找表中不存在满足查找要求的记录</p>
</li>
<li>
<p>内查找：整个查找过程都在内存中进行</p>
</li>
<li>
<p>外查找：在查找过程中需要访问外存</p>
</li>
<li>
<p>平均查找长度ASL：查找方法时效的度量。或者更数学的，为确定记录在查找表中的位置，需将关键字和给定值比较次数的期望值。</p>
<p>查找成功时ASL的计算公式：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>在公式中：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>是记录的个数，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是查找指定记录的概率，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>查找指定记录所需的比较次数。</p>
</li>
</ul>
<h2 id="静态查找表"><a class="header" href="#静态查找表">静态查找表</a></h2>
<p>静态表这里是指在查找过程中表基本不会发生变化。</p>
<h3 id="顺序表的查找"><a class="header" href="#顺序表的查找">顺序表的查找</a></h3>
<h4 id="算法描述"><a class="header" href="#算法描述">算法描述</a></h4>
<p>遍历表进行查找。为了提高查找的效率，可以设置一个监视哨，查找是就不必检测位置是否越界。</p>
<pre><code class="language-cpp">int sequenceSearch(vector&lt;int&gt;&amp; x, int target)
{
    x.push_back(target);

    int i = 0;
    while (x[i] != target)
    {
        i++;
    }
    return i;
}
</code></pre>
<h4 id="性能分析-7"><a class="header" href="#性能分析-7">性能分析</a></h4>
<ul>
<li>当查找成功时，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mbin mtight">+</span><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="minner mtight">⋯</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>当查找失败时，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
</ul>
<h3 id="有序表的查找"><a class="header" href="#有序表的查找">有序表的查找</a></h3>
<h4 id="算法描述-1"><a class="header" href="#算法描述-1">算法描述</a></h4>
<p>采用二分查找。</p>
<pre><code class="language-cpp">int binarySearch(vector&lt;int&gt;&amp; x, int target)
{
    int low = 0;
    int high = x.size();

    while (low &lt;= high)
    {
        int mid = (low + high) / 2;
        
        if (target == x[mid])
        {
            return mid;
        }
        else
        {
            if (target &lt; x[mid])
            {
                high = mid - 1;
            }
            else
            {
                low = mid + 1;
            }
        }
    }

    return -1;
}
</code></pre>
<h4 id="性能分析-8"><a class="header" href="#性能分析-8">性能分析</a></h4>
<p>为了编译分析查找的过程，我们可以引入一颗二叉树来描述这个过程，这棵树也被称为判定树。</p>
<p><img src="data-structure/./assets/find-tree-20221120150358-awrhdkv.png" alt="" /></p>
<p>这颗二叉树的深度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">⌋</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p>则成功查找时的平均查找长度为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<h3 id="静态树表的查找"><a class="header" href="#静态树表的查找">静态树表的查找</a></h3>
<p>当有序表中各个记录查找的概率不同时，为了降低查找的平均查找长度，我们可以对判定树进行适当的调整。</p>
<h4 id="静态最优查找树"><a class="header" href="#静态最优查找树">静态最优查找树</a></h4>
<p>查找性能最优的判定树。</p>
<p>对于最优查找树：其的带权内路径长度之和<code>PH</code>为最小值：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>在公式中值得指出参量时<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，这个数的定义为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<code>c</code>是一个常数，<code>p_i</code>是这个节点被查找的概率。</p>
<p>构造最优查找树的原则是：</p>
<ul>
<li>最先访问的节点是访问概率最大的节点</li>
<li>每次访问应使节点两边尚未访问的节点的被访概率之和尽可能的相等</li>
</ul>
<h4 id="静态次优查找树"><a class="header" href="#静态次优查找树">静态次优查找树</a></h4>
<p>但是在实际工作中，构造一颗最优的查找树往往是困难的。但是我们有一种方法可以构造一棵次优的查找树。这棵树的特点是其的<code>PH</code>值近似为最小，但是比静态查找树更加的易于查找，构造所需要的时间很短，而且查找的性能同最优树之间只存在1%~2%之间的差距。</p>
<p>下面给出构造次优静态查找树的方法：</p>
<p>现在已经有了有序排列的记录序列<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:</p>
<ol>
<li>
<p>对序列中所有的节点<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>计算其的</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2499em;vertical-align:-1.4138em;"></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.2254em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8117em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>在序列中找到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>最小的节点作为根节点。</p>
<p>显然，这里主要的困难就是计算<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，我们这里介绍一种可以简化计算的方式：</p>
<p>首先计算每个节点的累计权值和：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2254em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8117em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>将每个节点的累计全权值和用一张表存起来，而且</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
</li>
<li>
<p>对根节点左右两边的列表递归操作</p>
</li>
</ol>
<h3 id="索引顺序表的查找"><a class="header" href="#索引顺序表的查找">索引顺序表的查找</a></h3>
<p>当有序表中的元素是分块有序的时候，我们可以建立索引表。首先在索引表中利用顺序或者二分查找知道找到对应的分块，再在对应的分块中寻找对应的记录。</p>
<h4 id="性能分析-9"><a class="header" href="#性能分析-9">性能分析</a></h4>
<blockquote>
<p>需要注意的是，计算索引查找的平均查找长度需要计算两部分的平均查找长度。首先是在索引表的平均查找长度，然后是在分块中的平均查找长度。</p>
</blockquote>
<p>由于对于索引表和分块中的查找都有着两种不同的查找方式——顺序查找和折半查找，这让索引顺序表的平均查找长度的计算变得比较复杂，不过大致的结论是索引查找的性能大致介于顺序查找和折半查找之间。</p>
<p>在索引查找中还有一些值得注意的点：</p>
<ul>
<li>在实际使用中，不同分块的大小不一定相同</li>
<li>分块查找的代价是附加索引表的空间和建立索引表的时间开销</li>
<li>在每次主表发生变化之后的索引都得重新建立。为此，我们可以在主表的每个分块之后预留一部分的空间，以便在改变主表之后能够只修改对应分块的索引</li>
</ul>
<h2 id="动态查找表"><a class="header" href="#动态查找表">动态查找表</a></h2>
<p>就是在查找的过程中，表可能频繁的进行插入和删除操作。</p>
<h3 id="二叉排序树"><a class="header" href="#二叉排序树">二叉排序树</a></h3>
<p>二叉排序树的定义是一个递归的定义。一颗二叉排序树或者是空树，或者是满足以下性质的二叉树：</p>
<ul>
<li>如果其左子树非空，那么左子树上所有结点的值均小于根节点的值</li>
<li>如果其右子树非空，那么右子树上所有节点的值都大于根节点的值</li>
<li>其左右子树如果存在都是一颗二叉排序树</li>
</ul>
<p>按照如上定义设计出来的二叉排序树将具有一个非常不错的性质：按照中序遍历之后得到的序列就是一个递增的序列。</p>
<h4 id="二叉排序树上的操作"><a class="header" href="#二叉排序树上的操作">二叉排序树上的操作</a></h4>
<p>通常，我们和二叉树一样利用二叉链表来储存二叉排序树。</p>
<pre><code class="language-cpp">typedef struct tree {
    int data;
    struct tree* lChild;
    struct tree* rChild;
} BinarySearchTree;

typedef BinarySearchTree* BinarySearchTreeP;
</code></pre>
<p>首先介绍搜索操作：</p>
<pre><code class="language-cpp">BinarySearchTreeP search(BinarySearchTreeP tree, int target)
{
    if (tree = nullptr)
    {
        return nullptr;
    }

    if (tree-&gt;data == target)
    {
        return tree;
    }
    else if (target &lt; tree-&gt;data)
    {
        return search(tree-&gt;lChild, target);
    }
    else
    {
        return search(tree-&gt;rChild, target);
    }
}
</code></pre>
<p>然后是在二叉树中插入一个元素的操作，在插入元素操作中会用到搜索操作的一个变型版：</p>
<pre><code class="language-cpp">/**
 * 在二叉树中查找元素
 * 
 * @param tree 当前查询的二叉树节点
 * @param target 查找的目标
 * @param father 当前节点的父节点，初始时为空
 * @param result 查找的结果 当查找成功时指向该节点，当查找失败时指向查找路径上的最后一个节点
 * 
 * @return 查找的结果状态
*/
bool search(BinarySearchTreeP tree, int target, BinarySearchTreeP father, BinarySearchTreeP&amp; result)
{
    if (tree == nullptr)
    {
        result = father;
        return false;
    }

    if (target == tree-&gt;data)
    {
        result = tree;
        return true;
    }
    else if (target &lt; tree-&gt;data)
    {
        return search(tree-&gt;lChild, target, tree, result);
    }
    else
    {
        return search(tree-&gt;rChild, target, tree, result);
    }
}

bool insert(BinarySearchTreeP&amp; tree, int value)
{
    BinarySearchTreeP result;
    if (!search(tree, value, nullptr, result))
    {
        BinarySearchTreeP node = (BinarySearchTreeP)malloc(sizeof(BinarySearchTree));
        if (node == nullptr)
        {
            // 空间分配失败
            return false;
        }
        node-&gt;data = value;
        node-&gt;lChild = nullptr;
        node-&gt;rChild = nullptr;
        
        if (tree == nullptr)
        {
            tree = node;
        }
        else if (value &lt; result-&gt;data)
        {
            result-&gt;lChild = node;
        }
        else
        {
            result-&gt;rChild = node;
        }
    }
    else
    {
        return false;
    }
}
</code></pre>
<p>当需要生成一颗新的二叉搜索树的时候，反复调用<code>insert</code>函数就可以了。</p>
<p>如果需要在搜索二叉树中删去一个节点，需要按照被删去节点的类型分类讨论：</p>
<ul>
<li>叶子节点：修改父节点的指针就可以</li>
<li>只有左子节点：用左子树代替被删除的节点</li>
<li>只有右子节点：使用右子树代替被删除的节点</li>
<li>左右子节点都有：找到被删除节点的中序的后继或者是前驱节点，将该节点的值赋值给被删除的节点。如果该节点只有左子节点或者右子节点或者没有子节点，则删除该节点。</li>
</ul>
<h4 id="性能分析-10"><a class="header" href="#性能分析-10">性能分析</a></h4>
<p>在构造的二叉排序树的形态确定的时候，等概率查找，查找成功时：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>最差的情况下：也就是构造为单支树：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>​</li>
<li>在最好的情况下：构造为折半查找的判定树：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>​</li>
<li>在随机的情况下：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>​</li>
</ul>
<h3 id="平衡二叉树"><a class="header" href="#平衡二叉树">平衡二叉树</a></h3>
<p>或者是空树，或者是满足如下性质的二叉排序树：</p>
<ul>
<li>左右子树的高度之差的绝对值不超过1</li>
<li>左右子树本身也是平衡二叉树</li>
</ul>
<p>对于一棵有着<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个节点的二叉查找树的高度我们有如下的定理：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2061em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2702em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5842em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">5</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>由公式不难发现，在最坏的情况下平衡二叉树的高度为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1.44</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，而完全平衡的二叉树的高度约为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，因此平衡二叉树是一种十分接近于最优的平衡二叉树，平均查找长度和<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>同数量级。</p>
<h4 id="平衡二叉树的存储结构"><a class="header" href="#平衡二叉树的存储结构">平衡二叉树的存储结构</a></h4>
<p>我们首先定义平衡二叉树上的每个节点的平衡因子：该节点左子树的高度减去右子树的高度。</p>
<pre><code class="language-cpp">struct BSTNode
{
    // 存储的数据
    int data;
    // 该节点的平衡因子
    int bf;
    // 左子树指针
    struct BSTNode* lChild;
    // 右子树指针
    struct BSTNode* rChild;
};

typedef BSTNode BSTNodeT;
typedef BSTNodeP BSTNodeP;
</code></pre>
<h4 id="平衡二叉树上的操作"><a class="header" href="#平衡二叉树上的操作">平衡二叉树上的操作</a></h4>
<p>查找操作和二叉排序上的一致。</p>
<p>下面是比较困难的插入操作：我们需要通过一个旋转的操作维持子树的平衡。</p>
<p>首先确定旋转的范围：在插入节点之后，找到离插入节点最近且平衡因子绝对值超过1的祖先节点，则以该节点为根的子树将是可能不平衡的最小子树，可将重新平衡的范围局限于这颗子树。</p>
<p>调整的规律为：</p>
<ul>
<li>
<p>LL型平衡旋转——单向右旋：</p>
<p>​<img src="data-structure/./assets/image-20221120155220-dgcnic5.png" alt="image" />​</p>
</li>
<li>
<p>RR型平衡旋转——单项左旋：</p>
<p>​<img src="data-structure/./assets/image-20221120155259-246ap7z.png" alt="image" />​</p>
</li>
<li>
<p>LR型平衡旋转——一次逆时针旋转和一次顺时针旋转</p>
<p>​<img src="data-structure/./assets/image-20221120155339-n4fiqh8.png" alt="image" />​</p>
</li>
<li>
<p>RL型平衡旋转——一次顺时针旋转和一次逆时针旋转</p>
<p>​<img src="data-structure/./assets/image-20221120155603-4r0g8ev.png" alt="image" />​</p>
</li>
</ul>
<p>删除平衡二叉树的思路：</p>
<p>将删除节点转化为删除的节点最多有一个子节点的情形，即：如果有两个子节点，用其的中序前驱或者后继节点取代它，然后再删除这个节点。</p>
<p>如果在删除的过程中树的平衡性被破坏，利用上面提高的旋转方法回复树的平衡性。</p>
<h3 id="b树balanced-tree"><a class="header" href="#b树balanced-tree">B树（Balanced Tree）</a></h3>
<p>B树就是一种平衡的多路查找。</p>
<p>一颗m阶B树，或者是空树，或为满足下列特性的m叉树：</p>
<ul>
<li>树中每个节点最多有m课子树</li>
<li>如果根节点不是叶子节点，则最少有两颗子树</li>
<li>除根之外的所有非叶子节点最少有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌊</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌋</span></span></span></span>课子树</li>
<li>所有非叶子节点包含<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的信息数据。其中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>为节点中关键字的个数，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为指向子树的指针，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为关键字</li>
<li>所有叶子节点在同一层中，且不带信息</li>
</ul>
<h4 id="b树的用途"><a class="header" href="#b树的用途">B树的用途</a></h4>
<p>当内存中不可能容纳下所有的数据记录时，在磁盘等直接存取设备上组织动态的查找表。</p>
<ul>
<li>B树的根节点可以始终放在内存中</li>
<li>其余非叶子的节点放置在外存中，每一个节点可作为一个读取单位</li>
<li>选择阶次比较大的B树，降低树的高度，减少外存的访问次数</li>
</ul>
<h2 id="哈希表"><a class="header" href="#哈希表">哈希表</a></h2>
<p>在记录的存储地址和它的关键字之间建立一个确定的对应关系。在理想的情况下，不需要进行比较，直接存取就能得到所查的元素。</p>
<ul>
<li>哈希表：一个有限的连续的地址空间，用以容纳按哈希地址存储的记录</li>
<li>哈希函数：记录的存储位置和它的关键字之间存在的对应关系</li>
<li>哈希冲突：对于不同的关键字，哈希函数得出的值相同</li>
<li>同义词：在同一地址出现冲突的各关键字</li>
<li>哈希地址：根据哈希函数和处理冲突的方法确定的记录的存储位置</li>
<li>装填因子：表中填入的记录同哈希表表长之间的比值，一般记作<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></li>
</ul>
<h4 id="哈希函数的基本构造方法"><a class="header" href="#哈希函数的基本构造方法">哈希函数的基本构造方法</a></h4>
<p>构造函数的原则：</p>
<ul>
<li>算法简单、运算量小</li>
<li>均匀分布、减少冲突</li>
</ul>
<ol>
<li>
<p>直接定址法</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span></p>
<p>这个方法计算简单，冲突最少。但是只有地址集合的大小等于关键字集合的大小时才可以使用</p>
</li>
<li>
<p>数字分析法</p>
<p>去关键字的若干数位作为哈希地址。</p>
<p>假设关键字集合中的每个关键字的数位都是由s位数字组成的，分析关键字集中的全体，并从中提取分布均匀的若干位或者他们的组合作为地址。</p>
<p>这个方法适用于能预先估计全体关键字的每一位上各种数字出现的频率。</p>
</li>
<li>
<p>平方取中法</p>
<p>取关键字平方后的中间几位作为哈希地址。“关键字的平方值”的目的是“扩大差别”，同时平方值的中间各位又能受到整个关键字各位的影响。</p>
<p>当关键字中的每一位都有某些数字重复出现频度很高的现象。</p>
</li>
<li>
<p>折叠法</p>
<p>将关键字分割为位数相同的几部分（最后一部分的位数可以不同），去这几部分的叠加和作为哈希地址</p>
<p>这个方法适用于关键字的数字位数特别多</p>
</li>
<li>
<p>除留余数法</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mord mathnormal" style="margin-right:0.02778em;">MO</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span></p>
<p>m时哈希表的表长</p>
<p>p最好为素数，更有利于“散列”</p>
</li>
<li>
<p>随机数法</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span></span></span></span></p>
<p>这个方法适用于关键字的长度不相等的时候</p>
</li>
</ol>
<h3 id="处理冲突的常用方法"><a class="header" href="#处理冲突的常用方法">处理冲突的常用方法</a></h3>
<h4 id="开放定址法"><a class="header" href="#开放定址法">开放定址法</a></h4>
<p>这种方法又叫做空缺编址法。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">MO</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace"> </span><span class="mord mathnormal">m</span></span></span></span></span></p>
<p>在公式中，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>是哈希表的表长，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是增量序列。当增量序列的设计不相同的时候，我们有着不同的开放定址法：</p>
<ol>
<li>
<p>线性探测再散列：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>​</p>
<p>这种方法的缺陷在于容易造成聚集现象——非同义词的地址也发生冲突。</p>
</li>
<li>
<p>二次探测再散列：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0585em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>这种方法的缺陷是不容易探测到整个散列空间。</p>
</li>
<li>
<p>伪随机数探测再散列：</p>
<p>增量序列就是一个伪随机数序列。</p>
</li>
<li>
<p>双重散列函数探查法：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>对于第二个散列函数<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span></span></span>的要求是：结果和<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>互素。</p>
<ul>
<li>当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>为素数时，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span></span></span>可以取1到m-1之间的任何数，比如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li>当<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>为2的幂时，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span></span></span>可以去1到m-1之间的任何奇数。</li>
</ul>
</li>
</ol>
<blockquote>
<p>开放定址法不适合执行删除操作。</p>
</blockquote>
<h4 id="再哈希法"><a class="header" href="#再哈希法">再哈希法</a></h4>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">ey</span><span class="mclose">)</span></span></span></span></span></p>
<p>在公式中<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为不同的哈希函数。</p>
<h4 id="链地址法"><a class="header" href="#链地址法">链地址法</a></h4>
<p>为每个哈希地址建立一个单链表，存储所有具有同义词的记录。</p>
<ul>
<li>冲突处理简单，无堆积现象，平均查找长度较短</li>
<li>适合于事先无法确定表长的情况</li>
<li>装填因子可以大于1，空间的利用率高</li>
<li>删除节点的操作易于实现</li>
</ul>
<h4 id="建立公共的溢出区"><a class="header" href="#建立公共的溢出区">建立公共的溢出区</a></h4>
<p>在主哈希表外，再分配一块区域储存同义词。</p>
<h3 id="哈希表的asl分析"><a class="header" href="#哈希表的asl分析">哈希表的ASL分析</a></h3>
<p>在一般情况下，装填因子越小，哈希表中发生冲突的可能性越小，ASL就会越小，但是空间的利用率就会越低。利用装填因子我们可以得到如下的ASL计算公式：</p>
<ul>
<li>
<p>线性探测再散列：</p>
<ul>
<li>成功： <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></li>
<li>失败：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.3651em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li>
<p>伪随机探测再散列：</p>
<ul>
<li>成功：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>​</li>
<li>失败：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
</ul>
</li>
<li>
<p>链地址法：</p>
<ul>
<li>成功：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li>
<li>失败：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
</ul>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="实验相关注意事项"><a class="header" href="#实验相关注意事项">实验相关注意事项</a></h1>
<h2 id="c输入输出"><a class="header" href="#c输入输出"><code>C++</code>输入输出</a></h2>
<p><code>cin</code>和<code>cout</code>两个输入输出对象的使用。</p>
<p>在使用<code>cout</code>的过程中， 不必考虑各种格式字符串。直接使用<code>&lt;&lt;</code>连接需要输出的数据就可以了。</p>
<pre><code class="language-cpp">for (int i = 0; i &lt; 3; i++)
{
	cout &lt;&lt; "count = " &lt;&lt; i &lt;&lt; endl;
}
</code></pre>
<p>在使用<code>cin</code>的过程中也是同样。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据库系统原理"><a class="header" href="#数据库系统原理">数据库系统原理</a></h1>
<p>大三上学期专业必修课——数据库系统原理。</p>
<p>授课教师：邓芳。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<h2 id="history-of-database-system"><a class="header" href="#history-of-database-system">History of Database System</a></h2>
<ol>
<li>
<p>Manual Model</p>
</li>
<li>
<p>File System</p>
<p>Drawbacks of using file systems to store data:</p>
<ul>
<li>Data redundancy and inconsistency</li>
<li>Difficulty in accessing data</li>
<li>Data isolation</li>
<li>Integrity problems</li>
<li>Atomicity of updates</li>
<li>Concurrent access by multiple users</li>
<li>Security problems</li>
</ul>
</li>
<li>
<p>Databse</p>
<p><img src="database/./intro/image-20230912141148285.png" alt="image-20230912141148285" /></p>
<p>Benefits of database approach:</p>
<ul>
<li>Data can be shared</li>
<li>Redundancy can be reduced</li>
<li>Inconsistency can be avoided</li>
<li>Transaction support can be provided</li>
<li>Integrity can be maintained</li>
<li>Security can be enforced</li>
<li>...</li>
</ul>
</li>
</ol>
<h2 id="what-is-database-systems"><a class="header" href="#what-is-database-systems">What is Database Systems</a></h2>
<p><strong>DB</strong>: database, a collection of interrelated data</p>
<p><strong>DBMS</strong>: Database Management System</p>
<p><strong>Application</strong>: Set of programs to access the data</p>
<p>DBMS contains information about:</p>
<ul>
<li>Collection of interrelated data</li>
<li>Set of programs to access the data</li>
<li>An environment that is both convenient and efficient to use</li>
</ul>
<h2 id="three-levels-and-data-abstraction"><a class="header" href="#three-levels-and-data-abstraction">Three Levels and Data Abstraction</a></h2>
<ol>
<li>
<p>Physical level:</p>
<p>Describes how a record is physically stored.</p>
</li>
<li>
<p>Logical level:</p>
<p>Describes logical data stored in database and relationships among the data.</p>
</li>
<li>
<p>View level</p>
<p>Part of the entire database. Application programs hide details of data types. Views can also hide information for security purpose.</p>
</li>
</ol>
<p><img src="database/./intro/image-20230912145408962.png" alt="image-20230912145408962" /></p>
<p>There are two mappings between three levels:</p>
<ul>
<li>The physical (internal) / logical (conceptual) mapping</li>
<li>The view (external) /logical (conceptual) mapping</li>
</ul>
<p>And database has two kinds of data independence:</p>
<ul>
<li>
<p>Physical data independence</p>
<p>The ability to modify the physical schema without changing the logical schema or the views. So the application programs need not to be rewritten if the physical schema changes.</p>
</li>
<li>
<p>Logical data independence</p>
<p>The ability to modify the logical schema without changing the logical views.</p>
</li>
</ul>
<blockquote>
<p>Schema: the description of the structure of the data in a database.</p>
<p>Instance: the actual content of the database at a particular point in time.</p>
</blockquote>
<p><strong>Data Models</strong>: A collection of conceptual tools for describing data, data relationships, data semantics and consistency constrains.</p>
<ul>
<li>Data structure</li>
<li>Data operations</li>
<li>Constraint rules.</li>
</ul>
<h2 id="database-languages"><a class="header" href="#database-languages">Database Languages</a></h2>
<p><strong>DDL</strong>: Data definition language, specification notation for definition the database schema.</p>
<p><strong>DML</strong>: Data manipulation language: language for accessing the manipulating the data organized by the appropriate data model. For example: query, insert, delete and update. <code>SQL</code> is the most widely used query language.</p>
<h2 id="database-users"><a class="header" href="#database-users">Database Users</a></h2>
<p>Users are differentiated by the way they expect to interact with the system.</p>
<ul>
<li>End users</li>
<li>Application programmers</li>
<li>Database analyzer and designer</li>
<li>Database administrators(<code>DBA</code>)</li>
<li>Database management system designer and implementer</li>
</ul>
<h2 id="database-system-structure"><a class="header" href="#database-system-structure">Database System Structure</a></h2>
<p><img src="database/./intro/image-20230919131146137.png" alt="image-20230919131146137" /></p>
<h3 id="storage-manager"><a class="header" href="#storage-manager">Storage Manager</a></h3>
<p>Storage Management is a program module that provides the interface between the low level data stored in the database and the application programs and queries submitted to the system.</p>
<h3 id="query-processor"><a class="header" href="#query-processor">Query Processor</a></h3>
<ul>
<li>DDL interpreter</li>
<li>DML compiler</li>
<li>Query optimization</li>
<li>Query evaluation engine</li>
</ul>
<h3 id="transaction-management"><a class="header" href="#transaction-management">Transaction Management</a></h3>
<p>A <strong>transaction</strong> is a collection of operations that performs a single logical function in a database application.</p>
<p>Transaction management component ensures that the database remains in a consistent state. Concurrency-control manager controls the interaction among the concurrent transactions, to ensure the consistency of the database.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-model"><a class="header" href="#relation-model">Relation Model</a></h1>
<h2 id="relational-data-structure"><a class="header" href="#relational-data-structure">Relational Data Structure</a></h2>
<p>We define a <strong>relation</strong> to be a subset of a Cartesian product of a list of <strong>domains</strong>.</p>
<p>Formally, given sets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , a relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is  a subset of
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
Thus a relation is a set of n-tuples <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>And the difference here are :</p>
<ul>
<li>Assign attribute name to every domain</li>
<li>Finite set</li>
</ul>
<h4 id="relation-schema"><a class="header" href="#relation-schema">Relation Schema</a></h4>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are attributes, each attribute of a relation has a name, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> is a relation schema. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> is a relation on the relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
<h4 id="relation-instance"><a class="header" href="#relation-instance">Relation Instance</a></h4>
<p>The current values(a.k.a. <strong>relation instance</strong>) of a relation are specified by a table. An element <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a tuple, represented by a row in a table.</p>
<p><img src="database/./relation-model/image-20230919140820132.png" alt="image-20230919140820132" /></p>
<ul>
<li>Order of tuples is <strong>irrelevant</strong>, tuples may be stored in an arbitrary order</li>
<li>Order of attributes is <strong>irrelevant</strong></li>
<li>For all relations, the domains of all attributes be <strong>atomic</strong></li>
<li>Attributes names must be <strong>different</strong></li>
<li>Several attributes can have the same domain</li>
<li>Tuples are <strong>not duplicate</strong></li>
</ul>
<h4 id="super-key"><a class="header" href="#super-key">Super Key</a></h4>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> is a relation schema, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is a <strong>super key</strong> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>,for any <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>, no two distinct tuples have the same values on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>. That is, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> and  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">]</span></span></span></span>. Values for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> are sufficient to identify a unique tuple of each possible relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> by "possible <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>".</p>
<p>A <strong>candidate key</strong> of en entity set is a minimal super key. Although several candidate keys may exist, one of the candidate keys is selected to be the <strong>primary key</strong>.</p>
<p>Candidate Key has two properties:</p>
<ul>
<li><strong>Uniqueness</strong>. No legal value of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> ever contains two distinct tuples with the same value for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></li>
<li><strong>Irreducibility</strong>. No proper subset of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> has the uniqueness property.</li>
</ul>
<h4 id="foreign-key"><a class="header" href="#foreign-key">Foreign Key</a></h4>
<p>For <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> includes the Primary Key <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> is called a foreign key referencing <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is called the referencing relation of the foreign key dependency. <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is called the referenced relation of the foreign key.</p>
<h4 id="integrity-constraint"><a class="header" href="#integrity-constraint">Integrity Constraint</a></h4>
<p>Integrity constraint of primary key: each specified column of primary key is assumed to be <strong>not null</strong>.</p>
<p>Referential integrity constraint: the value of foreign key in any tuple of relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are either null or must appear as the value of primary key of a tuple of relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<h2 id="fundamental-relational-algebra-operations"><a class="header" href="#fundamental-relational-algebra-operations">Fundamental Relational-Algebra-Operations</a></h2>
<p>We have six basic operators:</p>
<ul>
<li>Select</li>
<li>Project</li>
<li>Union</li>
<li>Set difference</li>
<li>Cartesian Product</li>
<li>Rename</li>
</ul>
<h3 id="select"><a class="header" href="#select">Select</a></h3>
<p>Notation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> is called the selection predicate, defined as
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span></span></span>
where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> is a formula in propositional calculus consisting of terms connected by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∨</span></span></span></span> and,  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∧</span></span></span></span> or , <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">¬</span></span></span></span> not.</p>
<h3 id="project"><a class="header" href="#project">Project</a></h3>
<p>Notation:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight">...</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></span>
where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are attribute names and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a relation name.</p>
<p>The result is defined as the relation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> columns obtained by erasing the columns that are not listed. And the duplicate rows will be removed since relations are sets.</p>
<h3 id="union"><a class="header" href="#union">Union</a></h3>
<p>Notation:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">ror</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">}</span></span></span></span></span>
For <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> to be valid:</p>
<ul>
<li>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> must have the same number of attribute</p>
</li>
<li>
<p>The attribute domains must be <strong>compatible</strong></p>
</li>
<li>
<p>And the attribute name can be not the same</p>
</li>
</ul>
<h3 id="set-difference"><a class="header" href="#set-difference">Set Difference</a></h3>
<p>Notation:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.0556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">}</span></span></span></span></span>
For <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> to be valid, the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> has the same requirements with union operation.</p>
<h3 id="cartesian-product"><a class="header" href="#cartesian-product">Cartesian Product</a></h3>
<p>Notation:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">}</span></span></span></span></span>
Combine information from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>. Assume that there are <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> relations in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> , <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> relations in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>, there will be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>; Assume that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> attributes and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> attributes, there will be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></p>
<h3 id="rename"><a class="header" href="#rename">Rename</a></h3>
<p>Allow us to rename and therefore to refer to the result of relational-algebra expressions. And allow use to refer to a relation by more than one name.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> returns the expression <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> under the name of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>.</p>
<h2 id="additional-relational-algebra-operations"><a class="header" href="#additional-relational-algebra-operations">Additional Relational-Algebra-Operations</a></h2>
<p>We define additional operations that do not add any power to the relation algebra but simplify common queries.</p>
<h3 id="set-intersection"><a class="header" href="#set-intersection">Set Intersection</a></h3>
<p>Notation:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">}</span></span></span></span></span>
Having the same requirements with union operation.</p>
<p>And we have:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="join"><a class="header" href="#join">Join</a></h3>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.655em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">⋈</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">ϑB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">t</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mclose">]</span><span class="mord mathnormal">ϑt</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]}</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">ϑB</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span></p>
<p>And the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">ϑ</span></span></span></span> is
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">ϑ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">}</span></span></span></span></span></p>
<h3 id="natural-join"><a class="header" href="#natural-join">Natural Join</a></h3>
<p>Natural join is the default of join:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.51em;vertical-align:-0.005em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">tt</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span><span class="mbin mtight">∪</span><span class="mopen mtight">{</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mclose mtight">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mtight">.</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">s</span><span class="mord mtight">.</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> is the same attribute of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span>.</p>
<h3 id="outer-join"><a class="header" href="#outer-join">Outer Join</a></h3>
<p>An extension of the join operation to avoid loss of information. Computes the join and then adds tuples from one relation that does not match tuples in other relation to the result of the join; use <strong>null</strong> value to fulfill the nonexistent attribute.</p>
<p>And there are three outer join:</p>
<ul>
<li>Left outer join</li>
<li>Right outer join</li>
<li>Full outer join</li>
</ul>
<h2 id="extended-relational-algebra-operations"><a class="header" href="#extended-relational-algebra-operations">Extended Relational-Algebra-Operations</a></h2>
<h2 id="null-values"><a class="header" href="#null-values">Null Values</a></h2>
<p>It is possible for tuples to have a null value denoted by <em>null</em> for some of their attributes.</p>
<p><strong>Null</strong> signifies an unknown value or that a value does not exist.  The result of any arithmetic expression involving <em>null</em> is <em>null</em>. Aggregate functions simply ignore <em>null</em> values. Duplicate elimination and grouping, <em>null</em> is treated like any other value and two <em>null</em> are assumed to be the same.</p>
<p>Comparisons with null values return the special truth value: <strong>unknown</strong>. And we can extend logic to three values with:</p>
<ul>
<li>
<p>Unknown or true is true</p>
<p>Unknown or false is unknown</p>
<p>Unknown or Unknown is unknown</p>
</li>
<li>
<p>True and unknown is unknown</p>
<p>False and unknown is false</p>
<p>Unknown and Unknown is unknown</p>
</li>
<li>
<p>Not unknown is unknown</p>
</li>
</ul>
<h2 id="modification-of-the-database"><a class="header" href="#modification-of-the-database">Modification Of the Database</a></h2>
<h3 id="deleting"><a class="header" href="#deleting">Deleting</a></h3>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a relation and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> is a relation algebra query.</p>
<h3 id="insertion"><a class="header" href="#insertion">Insertion</a></h3>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a relation and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> is a relation algebra query.</p>
<h3 id="updating"><a class="header" href="#updating">Updating</a></h3>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">⋯</span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></span></p>
<p>Each <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is either the ith attribute of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>, if this attribute is not updated or if the attribute is to be updated, as an expression.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relation-database-design"><a class="header" href="#relation-database-design">Relation Database Design</a></h1>
<h2 id="pitfalls-in-relational-database-design"><a class="header" href="#pitfalls-in-relational-database-design">Pitfalls in Relational Database Design</a></h2>
<p>A bad design may lead to:</p>
<ul>
<li>Repetition of information</li>
<li>Inability to represent certain information</li>
</ul>
<p>So the design goal are:</p>
<ul>
<li>Avoid redundant data</li>
<li>Ensure that relationships among attributes are represented</li>
<li>Facilitate the checking of updates for violation of database integrity constraints.</li>
</ul>
<h2 id="functional-dependencies"><a class="header" href="#functional-dependencies">Functional Dependencies</a></h2>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> be a relation schema
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace"> </span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span>
The functional dependency
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span>
holds on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> if and only if for any legal relations <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> whenever any two tuples <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> agree on the attributes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> they also agree on the attributes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">]</span></span></span></span></span>
Using functional dependency define key.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is a super key for relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> if and only if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is a candidate key for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> if and only if:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
<li>for no <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> , <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
</ul>
<p>We use functional dependencies to:</p>
<ul>
<li>Test relations to see if they are legal under a given set of functional dependencies</li>
<li>Specify constraints on the set of legal relations</li>
</ul>
<p><strong>Trivial dependency</strong>: a functional dependency is trivial if it is satisfied by all instances of a relation. In general, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> is trivial if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>.</p>
<p><strong>Transitive dependency</strong>: a functional dependency is transitive if
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0966em;vertical-align:-0.3027em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⊈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span>
then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span> is transitive dependency on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>.</p>
<p><strong>Partial dependency</strong>: a functional dependency is partial if:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span>
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> is partially dependent on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>.</p>
<p><strong>Logical imply</strong>: a function dependency <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> is logically implied by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, the set of functional dependencies on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, if every relation instance <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> satisfies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>.</p>
<p><strong>Closure of a Set of Functional Dependencies</strong>: for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span>, the set of all functional dependencies logically implied by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> is the closure of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, denoting the closure by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>Armstrong's Axioms:</p>
<ul>
<li><strong>Reflexivity</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></li>
<li><strong>Augmentation</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></li>
<li><strong>Transitivity</strong>: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></li>
</ul>
<p>And some additional rules:</p>
<ul>
<li>
<p>union: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></p>
</li>
<li>
<p>decomposition:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span></p>
</li>
<li>
<p>pseudo transitivity:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span></span></p>
</li>
</ul>
<p><strong>Closure of attributes</strong>, the set of attributes that are functionally determined by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> under <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>.
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8213em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span>
And using attribute closure:</p>
<ul>
<li>Test for superkey: if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is a superkey, we computer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> and check if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> contains all attributes of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
<li>Test functional dependencies: To check if a functional dependency <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> holds, just check if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></li>
<li>Computing closure of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></li>
</ul>
<p><strong>Equvialent functional dependencies</strong>: Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> be two sets of functional dependencies: if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> are equvialent.</p>
<h3 id="extraneous-attributes"><a class="header" href="#extraneous-attributes">Extraneous Attributes</a></h3>
<p>An attribute of a functional dependency is said to be extraneous if remove it without changing the closure of the set of functional dependencies.</p>
<p>Consider a set of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> of functional dependencies and the functional dependency <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>:</p>
<ul>
<li>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> logical implies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">})</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">}</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is an extraneous attribute.</li>
<li>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> logical implies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">})</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)}</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is an extraneous attribute.</li>
</ul>
<p>Giving two ways to judge whether attribute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is a extraneous attribute:</p>
<ol>
<li>
<p>Attribute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is extraneous in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> logically implies
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">})</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">}</span></span></span></span></span></p>
</li>
<li>
<p>Attibute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is extraneous in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> and the set of functional dependencies
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">})</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)}</span></span></span></span></span>
logically implies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>.</p>
</li>
</ol>
<h3 id="canonicalminimal-cover"><a class="header" href="#canonicalminimal-cover">Canonical/Minimal Cover</a></h3>
<p>Set of functional dependencies may contains redundant dependencies that can be inferred from the others.</p>
<p>A <strong>canonical cover</strong> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, a.k.a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a minimal set of functional dependencies equivalent to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>, with no redundant dependencies or having redundant parts of dependencies.</p>
<p>No functional dependency in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> contains an extraeouse attribute. Each left side of fucntional dependenyc in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is unique.</p>
<h2 id="normal-forms"><a class="header" href="#normal-forms">Normal Forms</a></h2>
<h3 id="first-normal-form"><a class="header" href="#first-normal-form">First Normal Form</a></h3>
<p>Domain is atomic if its elements are considered to be indivisible units.</p>
<p>A relational schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is in <strong>first normal form</strong> if the domains of all attributes of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> are atomic.</p>
<h3 id="second-normal-form"><a class="header" href="#second-normal-form">Second Normal Form</a></h3>
<p>A relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is in second normal form if each attribute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> meets one of the following criteria:</p>
<ul>
<li>It apperars in a candiate key</li>
<li>It is not partially dependent on a candidate key</li>
</ul>
<p>In practice, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is a first normal form and every non-key attribute is not a partial dependency of candidate key <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is third normal form.</p>
<h3 id="third-normal-form"><a class="header" href="#third-normal-form">Third Normal Form</a></h3>
<p>A realtion schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is in third normal form if for all:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8213em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span>
at least one of the following holds:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> is trivial</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is a superkey for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
<li>Each attribute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is contained in a candidate key for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
</ul>
<p>In practise, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is a second normal form and every non-key attribute is not a tranitive dependency of candidate key, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is third normal form.</p>
<h3 id="boyce-codd-normal-form"><a class="header" href="#boyce-codd-normal-form">Boyce-Codd Normal Form</a></h3>
<p>A relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is in boyce codd normal form with respect to a set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> of functional dependencies if for all functional dependencies in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> of the form <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> at least one of the following holds:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span> is trivial</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span> is a superkey for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
</ul>
<p>In practise, if any non-keys attribute directly dpendent on all candidate keys.</p>
<p>If a relation is in boyce codd normal form, it is in third normal form.</p>
<p>For emaxple, for relation</p>
<pre><code>SPC(SNO, PNO, CNO)
</code></pre>
<p>and functional dependencies:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">PNO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">PNO</span></span></span></span></span>
This relation is third normal form but not boyce-codd normal form as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">PNO</span></span></span></span> is not a superkey of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
<blockquote>
<p>求一个关系模式的所有候选键：</p>
<p>将关系模式中的所有属性分成四类：</p>
<ol>
<li>L类：只出现在函数依赖左部的属性</li>
<li>R类：只出现在函数依赖右部的属性</li>
<li>N类：在函数依赖左右均未出现的属性</li>
<li>LR类：在函数依赖左右两边均出现的属性</li>
</ol>
<p>如果LN的闭包包含了R中的所有属性，那么LN就是关系模式的所有候选键。</p>
<p>但是LN的闭包中不包含R中所有的属性，那么需要从LR类属性中添加。</p>
</blockquote>
<h2 id="decomposition"><a class="header" href="#decomposition">Decomposition</a></h2>
<p>If a relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is not in a <em>good</em> form, decompose it into a set of relations:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>
And all attributes of an original schema must appear in the decomposition:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="lossless-join-decomposition"><a class="header" href="#lossless-join-decomposition">Lossless-join Decomposition</a></h3>
<p>If a decomposition of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> into a set of relations <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> has:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.51em;vertical-align:-0.005em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.0077em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></span>
the decomposition is lossy join decompositions.</p>
<p>A descomposition of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> into <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is lossless join if and only if at least one fo the following dependencies is in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="dependency-preservation"><a class="header" href="#dependency-preservation">Dependency Preservation</a></h3>
<p>Decompose a relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> with a set of fucntional dependencies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> into <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ... <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the set of dependencies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span> that include only attributes in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>If
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0713em;vertical-align:-0.25em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8213em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8213em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span>
this decomposition is dependency preservation.</p>
<p>Follow the algorithm to test for dependency preservation:</p>
<p><img src="database/./relation-database-design/image-20231121151217639.png" alt="image-20231121151217639" /></p>
<h3 id="third-normal-function-decompition-algorithm"><a class="header" href="#third-normal-function-decompition-algorithm">Third Normal Function Decompition algorithm</a></h3>
<p><img src="database/./relation-database-design/image-20231121151633413.png" alt="image-20231121151633413" /></p>
<p>The algorithm ensures:</p>
<ul>
<li>Each relation schema <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is in third normal form</li>
<li>Decomposition is dependency preservation</li>
<li>DeComposition is lossless-join</li>
</ul>
<p>For example:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span></span></p>
<p>Firstly, get the canonical cover:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MN</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span></span>
Secondly, get sets:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">}</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">MN</span><span class="mclose">}</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02778em;">SNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">CNO</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mclose">}</span></span></span></span></span></p>
<p>Thirdly, check the candidate key.</p>
<h3 id="boyce-codd-decomposition-algorithm"><a class="header" href="#boyce-codd-decomposition-algorithm">Boyce-codd Decomposition Algorithm</a></h3>
<p><img src="database/./relation-database-design/image-20231121152556940.png" alt="image-20231121152556940" /></p>
<p>The main problem in BCNF decomposition is to get dependency function set after decomposition in the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>.</p>
<h2 id="overall-database-design-process"><a class="header" href="#overall-database-design-process">Overall Database Design Process</a></h2>
<h3 id="design-goals"><a class="header" href="#design-goals">Design Goals</a></h3>
<p>Goal for a relation database design is to :</p>
<ul>
<li>BCNF</li>
<li>Lossless join</li>
<li>Dependency preservation</li>
</ul>
<p>And if we cannot achieve this. we accept one of:</p>
<ul>
<li>Lack of dependency preservation</li>
<li>Redundancy due to use of 3NF</li>
</ul>
<p>When an E-R diagram is carefully designed, identifuing all entities correctly, the tables generated from the E-R diagram should not need further normalization. However, in a real design there can be a function dependence from non-key attributes of an entity to other attributes of the entity. And we may want to use non-normalized schema for performance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql"><a class="header" href="#sql">SQL</a></h1>
<h2 id="background"><a class="header" href="#background">Background</a></h2>
<p>SQL is bases on set and relation operation with certain modifications and enhancements.</p>
<h2 id="basic-structure-query"><a class="header" href="#basic-structure-query">Basic Structure Query</a></h2>
<p>A typical SQL query has the form:</p>
<p><img src="database/./sql/image-20231020134315524.png" alt="image-20231020134315524" /></p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> represent attributes, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> represent relations and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> is a predicate. And this query is equivalent to the relation algebra expression:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="minner mtight">⋯</span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span>
The result of an SQL query is a relation.</p>
<h3 id="the-select-clause"><a class="header" href="#the-select-clause">The Select Clause</a></h3>
<p>The <strong>select clause</strong> corresponds to the projection operation of the relation algebra. It is used to list the attribute desired in the result of a query. The query finding the names of all instructors <strong>select name from instructor</strong> will be
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nam</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">in</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mclose">)</span></span></span></span></span>
An asterisk in the select clause denotes all attributes.</p>
<p>The select clause can contain arithmetic expressions involving the operation and operating on constants or attributes of tuples. For example:</p>
<pre><code class="language-sql">select ID, name, salary/12
from instructor
</code></pre>
<p>SQL allows duplicates in relations as well as in query results. So there are two keywords:</p>
<ul>
<li><strong>distinct</strong> to force the elimination of duplicates</li>
<li><strong>all</strong> to force that duplicates should not be removed</li>
</ul>
<h3 id="the-where-clause"><a class="header" href="#the-where-clause">The Where Clause</a></h3>
<p>The where clause corresponds to the selection predicate of the relational algebra.</p>
<p>Comparison results can be combined using the logical connectives <strong>and</strong> , <strong>or</strong> and <strong>not</strong>. Comparisons can be applied to result to results of arithmetic expressions. And there is a <strong>between</strong> comparison operator, for example:</p>
<pre><code class="language-sql">select name
from instructor
where salary between 90000 and 100000
</code></pre>
<h3 id="the-from-clause"><a class="header" href="#the-from-clause">The from clause</a></h3>
<p>The <strong>from</strong> clause corresponds to the Cartesian product operation of the relation algebra. It lists the relations to be scanned in the evaluation of the express. For the common attributes, the attributes in the resulting table are renamed using the relation name.</p>
<h3 id="the-rename-operation"><a class="header" href="#the-rename-operation">The Rename Operation</a></h3>
<p>The SQL allows renaming relations and attributes using the <strong>as</strong> clause: <em>old_name as new_name</em>. For example:</p>
<pre><code class="language-sql">select distince T.name
from instructor as T, instructor as S
where T.salary &gt; S.salary and S.dept_name == 'Comp. Sci.'
</code></pre>
<p>The query will find the names of all instructors who have a higher salary than some instructor in 'Comp. Sci.'.</p>
<h3 id="string-operations"><a class="header" href="#string-operations">String Operations</a></h3>
<ul>
<li><strong>%</strong> character matches any substring</li>
<li><strong>_</strong> character matches any character</li>
</ul>
<p>For example:</p>
<pre><code class="language-sql">select name
from instructor
where name like '%dar%'
</code></pre>
<h3 id="ordering-the-display-of-tuples"><a class="header" href="#ordering-the-display-of-tuples">Ordering the Display of Tuples</a></h3>
<p>The SQL allows <strong>order by</strong> clause to order the result by the attributes, for example:</p>
<pre><code class="language-sql">select distinct name
from instructor
order by name
</code></pre>
<p>And we can specify <strong>desc</strong> for descending order or <strong>asc</strong> for ascending order. And the default is ascending order.</p>
<h3 id="set-operations"><a class="header" href="#set-operations">Set Operations</a></h3>
<p>The set operations <strong>union</strong>, <strong>intersect</strong> and <strong>except</strong> operator on relations and correspond to the relational algebra operations <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∩</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"></span><span class="mord">∪</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">−</span></span></span></span>. Each of the above operations automatically eliminates duplicates. To retain all duplicates use the corresponding <strong>union all</strong>, <strong>intersect all</strong> and <strong>except all</strong>.</p>
<pre><code class="language-sql">(select course_id from section where sem = 'Fall' and year = 2009)
except
(select course_id from section where sem = 'Spring' and year = 2010)
</code></pre>
<h3 id="aggregate-functions"><a class="header" href="#aggregate-functions">Aggregate Functions</a></h3>
<p>These functions operate on the multi set of values of a column of a relation and return a value.</p>
<ul>
<li><strong>avg</strong> average value</li>
<li><strong>min</strong> minimum value</li>
<li><strong>max</strong> maximum value</li>
<li><strong>sum</strong> sum of values</li>
<li><strong>count</strong> number of values</li>
</ul>
<p>For example:</p>
<pre><code class="language-sql">select avg(salary)
from instructor
where dept_name = 'Comp. Sci.'
</code></pre>
<h4 id="group-by"><a class="header" href="#group-by">Group By</a></h4>
<pre><code class="language-sql">select dept_name, avg(salary) as avg_salary
from instructor
group by dept_name
</code></pre>
<p><img src="database/./sql/image-20231020143046506.png" alt="image-20231020143046506" /></p>
<blockquote>
<p>Attributes in select clause outside of aggregate functions must appear in <strong>group by</strong> list.</p>
</blockquote>
<h4 id="having"><a class="header" href="#having">Having</a></h4>
<pre><code class="language-sql">select dept_name, avg(salary)
from instructor
group by dept_name
having avg(salary) &gt; 42000;
</code></pre>
<p>The predicates in the having clause are applied after the formation of groups whereas predicates in the where clause are applied before forming groups.</p>
<h3 id="null-values-1"><a class="header" href="#null-values-1">Null Values</a></h3>
<p>The predicate <strong>is null</strong> can be used to check for null values.</p>
<p>All aggregate operations except count ignore tuples with null values on the aggregated attributes.</p>
<h3 id="nested-queries"><a class="header" href="#nested-queries">Nested Queries</a></h3>
<p>SQL provides a mechanism for the nesting of subqueries. A subquery is a select-from-where expression that is nested within another query.</p>
<h4 id="queries-in-the-where-clause"><a class="header" href="#queries-in-the-where-clause">Queries in the Where Clause</a></h4>
<p>A common use of subqueries is to perform tests:</p>
<ol>
<li>
<p>Set Membership</p>
<pre><code class="language-sql">select distinct course_id
from section
where semester = 'Fall' and year = 2009 and 
	course_id in (select  course_id
                 from section
                 where semester = 'Spring' and year = 2010);
</code></pre>
</li>
<li>
<p>Set Comparisons</p>
<p>Comparisons has two clauses:</p>
<ul>
<li>some</li>
<li>all</li>
</ul>
<pre><code class="language-sql">select name
from instructors
where salary &gt; some (select salary
                    from instructor
                    where dept_name = 'Biology');
</code></pre>
<pre><code class="language-sql">select name
from instructor
where salary &gt; all (select salary
                   from instructor
                   where dept_name = 'Biology');
</code></pre>
</li>
<li>
<p>Set cardinality</p>
<p>The <strong>exists</strong> construct returns the value true of the argument query is nonempty.</p>
<pre><code class="language-sql">select course_id
from section as S
where semester = 'Fall' and year = 2009 and 
exitst (select *
       from secion as T
       where semester = 'Spring' and year = 2010 and S.course_id = T.course_id)
</code></pre>
<p>The <strong>unique</strong> construct tests whether a query has any duplicate tuples in its result. The <strong>unique</strong> construct evaluates to true if a given query contains no duplicates.</p>
<pre><code class="language-sql">select T.course_id
from course as T
where unique (select R.course_id
             from section as R
             where T.course_id = R.course_id
             and R.year = 2009)
</code></pre>
</li>
</ol>
<h4 id="queries-in-the-from-clause"><a class="header" href="#queries-in-the-from-clause">Queries in the From Clause</a></h4>
<p>SQL allows a query expression to be used in the <strong>from</strong> clause.</p>
<pre><code class="language-sql">select dept_name, avg_salary
from (select dept_name, avg(salary) as avg_salary 
      from instructor
      group by dept_name
      where avg_salary &gt; 42000); 
</code></pre>
<p>The <strong>with</strong> clause provides a way of defining a temporary relation whose definition is available only to the query in which the <strong>with</strong> clause occurs.</p>
<pre><code class="language-sql">with max_buget(value) as
	(select max(budget)
    from department)
select department.name
from department, max_budget
where department.budget = max_budget.value;
</code></pre>
<h4 id="queries-in-the-select-clause"><a class="header" href="#queries-in-the-select-clause">Queries in the Select Clause</a></h4>
<p>Select query is one which is used where a single value is expected.</p>
<pre><code class="language-sql">select dept_name, (select count(*)
                  from instructor
                  where department.dept_name = instructor.dept_name)
                  as num_instrcutors
from department;
</code></pre>
<h2 id="data-definition-language"><a class="header" href="#data-definition-language">Data Definition Language</a></h2>
<p>Data definition language allows the specification of not only a set of relations but also information about each relation, including:</p>
<ul>
<li>The schema of each relation</li>
<li>The domain of values associated with each attribute</li>
<li>Integrity constrains</li>
<li>The set of indices to be maintained for each relations</li>
<li>Security and authorization information for each relation</li>
<li>The physical storage structure of each relation on disk</li>
</ul>
<h3 id="create-table-construct"><a class="header" href="#create-table-construct">Create Table Construct</a></h3>
<p><img src="database/./sql/image-20231020132956048.png" alt="image-20231020132956048" /></p>
<p><em>r</em> is the name of the relation, each <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is an attribute name in the schema of relation <em>r</em>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the data type of values in the domain of attribute <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>For example:</p>
<pre><code class="language-sql">create table instructor (
	ID char(5),
	name varchar(20) not null,
    dept_name varchar(20),
    salary numeric(8,2),
    primary key(ID),
    foreign key (dept_name) references department
);
</code></pre>
<h3 id="domain-type-in-sql"><a class="header" href="#domain-type-in-sql">Domain Type in SQL</a></h3>
<ul>
<li><strong>char(n)</strong> Fixed length character string, with user specified length <em>n</em></li>
<li><strong>varchar(n)</strong> Variable length character strings, with user specified maximum length <em>n</em></li>
<li><strong>int</strong> Integer, a finite subset of the integers that is machine dependent</li>
<li><strong>smallint</strong> Small Integer,  a machine dependent subset of the integer domain type.</li>
<li><strong>numeric(p, d)</strong> Fixed point number, with user specified precision of <em>p</em> digits and <em>n</em> digits to the right decimal point</li>
<li><strong>real/double precision</strong> Floating point and double precision floating point numbers, with machine dependent precision</li>
<li><strong>float(n)</strong> Floating point number, with user specified precision of at least <em>n</em> digits</li>
</ul>
<h2 id="data-manipulation-language"><a class="header" href="#data-manipulation-language">Data manipulation language</a></h2>
<h3 id="drop-and-alter-table-constructs"><a class="header" href="#drop-and-alter-table-constructs">Drop and Alter Table Constructs</a></h3>
<p>The <strong>drop table</strong> command deletes all information about the dropped relation from the database.</p>
<p>The <strong>alter table</strong> command is  used add attributes to an existing relation. For example, <em>alter table r add A D</em> where <em>A</em> is the name of the attribute to be added to relation <em>r</em> and <em>D</em> is the domain of <em>A</em>.</p>
<h3 id="insertion-1"><a class="header" href="#insertion-1">Insertion</a></h3>
<p>Add a new tuples to relations.</p>
<pre><code class="language-sql">insert into course 
values ('CS-437', 'Database Systems', 'Comp. Sci.', 4)
</code></pre>
<pre><code class="language-sql">insert into student
	select ID, name, dept_name, 0
	from instructor
</code></pre>
<h3 id="update"><a class="header" href="#update">Update</a></h3>
<p>Update the data in the relation.</p>
<pre><code class="language-sql">update instructor set salary = case
	when salary &lt;= 100000 then salary * 1.05
	else salary * 1.03
	end
</code></pre>
<h2 id="embedded-sql"><a class="header" href="#embedded-sql">Embedded SQL</a></h2>
<h2 id="odbc--jdbc"><a class="header" href="#odbc--jdbc">ODBC &amp; JDBC</a></h2>
<h2 id="transact-sql"><a class="header" href="#transact-sql">Transact SQL</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="intermediate-sql"><a class="header" href="#intermediate-sql">Intermediate SQL</a></h1>
<h2 id="join-expressions"><a class="header" href="#join-expressions">Join Expressions</a></h2>
<p>Join operations take tow relations and return a result as another relation. A join operation is  a Cartesian product which requires that tuples in the two relations match. It also specifies the attributes that are present in the result of the join.</p>
<h3 id="natural-join-operations"><a class="header" href="#natural-join-operations">Natural Join Operations</a></h3>
<pre><code class="language-sql">select * 
from course natural join prereq
</code></pre>
<p>are the same as:</p>
<pre><code class="language-sql">select *
from course join prereq 
on course.course_id = prereq.course_id
</code></pre>
<p>Beware of  unrelated attributes with same name which get equated <strong>incorrectly</strong>. To avoid the danger of equating attributes erroneously, we can use the <strong>using</strong> construct that allows us to specify exactly which columns should be equated. For example:</p>
<pre><code class="language-sql">select name, title
from (student natural join takes) join course
using (course_id)
</code></pre>
<h2 id="join-condition"><a class="header" href="#join-condition">Join Condition</a></h2>
<p>The <strong>on</strong> condition allows a general predicate over the relations be joined. This predicate is written like a <strong>where</strong> clause predicate.</p>
<h3 id="outer-join-1"><a class="header" href="#outer-join-1">Outer Join</a></h3>
<p>An extension of the join operation that avoids loss of the information. Computes the join and then adds tuples form one relation that does not match tuples in the other relation to the result of the join using the null values.</p>
<ul>
<li>Left outer join</li>
<li>Right outer join</li>
<li>Full outer join</li>
</ul>
<h2 id="views"><a class="header" href="#views">Views</a></h2>
<p>In some cases, it is not desirable for all users to see the entire logical model(the actual relations stored in the database). The <strong>view</strong> provides a mechanism to hide certain data from the view of certain users. Any relations that is not of the conceptual model but is made visible to a user as a <em>virtual relation</em> is called a view.</p>
<p>A view is defined using the <strong>create view</strong> statement:</p>
<pre><code class="language-sql">create view V as &lt;query expression&gt;
</code></pre>
<p>where <code>query expression</code> is any legal SQL expression. The view name is represented by <code>V</code>.</p>
<p>View definition is not the same as creating a new relation by evaluating the query expression. Instead, a view definition causes the saving of an expression, the expression is substituted into queries using the view.</p>
<h3 id="update-of-a-view"><a class="header" href="#update-of-a-view">Update of a View</a></h3>
<p>We can add a tuple to the view and the unspecified attribute will be filled with null.</p>
<p>But there are some updates that can not be translated uniquely. For example:</p>
<pre><code class="language-sql">create view instructor_info as
	select ID, name, building
	from insructor, department
	where instructor.dept_name = department.dept_name
</code></pre>
<p>The follow <code>insert</code> will fail because</p>
<ul>
<li>which department, if multiple departments in Taylor?</li>
<li>what if no department is in Taylor?</li>
</ul>
<pre><code class="language-sql">insert into instructor_info values ('123', 'White', 'Taylor')
</code></pre>
<p>So most SQL implementations only allow updates on simple views.</p>
<h3 id="materialized-views"><a class="header" href="#materialized-views">Materialized Views</a></h3>
<p>Materializing a view is to create a physical table containing all the tuples in the result of the query defining the view.</p>
<p>Need to <strong>maintain</strong> the view by updating the view whenever the underlying relations are updated.</p>
<h2 id="transactions"><a class="header" href="#transactions">Transactions</a></h2>
<p>Unit of work.</p>
<p>The <strong>atomic transaction</strong> is either fully executed or rolled back as if it never occurred.</p>
<h2 id="integrity-constraints"><a class="header" href="#integrity-constraints">Integrity Constraints</a></h2>
<p>Integrity constraints guard against accidental damage to the database, by ensuring that authorized changes to the database do not result in a loss of date consistency.</p>
<h3 id="integrity-constraints-on-a-single-relation"><a class="header" href="#integrity-constraints-on-a-single-relation">Integrity Constraints on a Single Relation</a></h3>
<ul>
<li><code>not null</code></li>
<li><code>primary key</code></li>
<li><code>unique</code></li>
<li><code>check(P)</code> where P is a predicate</li>
</ul>
<h3 id="referential-integrity"><a class="header" href="#referential-integrity">Referential Integrity</a></h3>
<p>Ensures that a value that appears in one relation for a given set of attributes also appears for a certain set of attributes in another relation.</p>
<p>Let <em>A</em> be a set of attributes. Let <em>R</em> and <em>S</em> be tow relations that contain attributes <em>A</em> and where <em>A</em> is the primary key of <em>S</em>. <em>A</em> is said to he a <strong>foreign key</strong> of <em>R</em> if for any values of <em>A</em> appearing in <em>R</em> these values also appear in <em>S</em>.</p>
<pre><code class="language-sql">create table course (
    dept_name varchar(20),
    foreign key (dept_name) references department
    	on delete cascade
    	on update cascade
)
</code></pre>
<p>This is an example of cascading actions in referential integrity.</p>
<h2 id="sql-date-types-and-schemes"><a class="header" href="#sql-date-types-and-schemes">SQL Date Types and Schemes</a></h2>
<h3 id="built-in-data-types-in-sql"><a class="header" href="#built-in-data-types-in-sql">Built-in Data Types in SQL</a></h3>
<ul>
<li><strong>date</strong> Dates, containing a year, month and date</li>
<li><strong>time</strong> Time of day, in hours, minutes and seconds</li>
<li><strong>timestamp</strong> date plus time of  day</li>
<li><strong>interval</strong> period of time</li>
</ul>
<h3 id="index-creating"><a class="header" href="#index-creating">Index Creating</a></h3>
<pre><code class="language-sql">create index studentID_index on stduent(ID)
</code></pre>
<p>Indices are data structures used to speed up access to records with specified values for index attributes.</p>
<h3 id="user-defined-types"><a class="header" href="#user-defined-types">User-Defined Types</a></h3>
<p><strong>create type</strong> construct in SQL creates user-defined type.</p>
<pre><code class="language-sql">create type Dollars as numberic (12, 2) final
</code></pre>
<p><strong>create domain</strong> construct in SQL creates user-defined domain types.</p>
<p>Types and domains are similar. Domains can have constraints, such as <strong>not null</strong>, specified on them.</p>
<h3 id="large-object-types"><a class="header" href="#large-object-types">Large Object Types</a></h3>
<ul>
<li><strong>blob</strong> binary large object</li>
<li><strong>clob</strong> character large object</li>
</ul>
<p>When a query returns a large object, a pointer is returned rather than the large object itself.</p>
<h2 id="authorization"><a class="header" href="#authorization">Authorization</a></h2>
<h3 id="granting-of-privileges"><a class="header" href="#granting-of-privileges">Granting of Privileges</a></h3>
<p>The passage of authorization from one user to another may be represented by an authorization graph.</p>
<p><img src="database/./intermediate-sql/image-20231029170058077.png" alt="image-20231029170058077" /></p>
<p><strong>Requirement</strong>: All edges in an authorization graph must be part of some path originating with the database administrator.</p>
<h3 id="privileges"><a class="header" href="#privileges">Privileges</a></h3>
<p>Forms of authorization on parts of the database:</p>
<ul>
<li>Read</li>
<li>Insert</li>
<li>Update</li>
<li>Delete</li>
</ul>
<p>Forms of authorization to modify the database schema:</p>
<ul>
<li>Index</li>
<li>Resources</li>
<li>Alteration</li>
<li>Drop</li>
</ul>
<p>The <strong>grant</strong> statement is used to confer authorization.</p>
<ul>
<li>Granting a privileges on a view does not imply granting any privileges on the underlying relations</li>
<li>The grantor of the privilege must already hold the privilege on the specified item or be the database administrator.</li>
</ul>
<p>The <strong>revoke</strong> statement is used to revoke authorization.</p>
<h3 id="roles"><a class="header" href="#roles">Roles</a></h3>
<p>Privileges can be granted to roles. Roles can be granted to users as well as to other roles.</p>
<p>The roles is a set of privileges.</p>
<h2 id="trigger"><a class="header" href="#trigger">Trigger</a></h2>
<p>A trigger is statement that is executed automatically by the system as a side effect of a modification to the database. To design a trigger mechanism, we must:</p>
<ul>
<li>Specify the condition under which the trigger is to be executed</li>
<li>Specify the actions to be taken when the trigger executed</li>
</ul>
<p>Triggering event can be insert, delete or update. Triggers can be activated before or after an event, which can server an extra constraints.</p>
<p>Instead of executing a separate action for each affected row, a single action can be executed for all rows affected by single transaction.</p>
<pre><code class="language-sql">create trigger credits_earned after update of takes 
on (grade)
referencing new row as nrow
referencing old row as orow
for each row
when nrow.grade &lt;&gt; ’F’ and nrow.grade is not null
 	and (orow.grade = ’F’ or orow.grade is null)
begin atomic
 	update student
 	set tot_cred= tot_cred + 
 		(select credits
 		from course
 		where course.course_id= nrow.course_id)
 	where student.id = nrow.id;
end
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="database-design-using-the-e-r-model"><a class="header" href="#database-design-using-the-e-r-model">Database Design Using the E-R Model</a></h1>
<h2 id="outline-of-the-er-model"><a class="header" href="#outline-of-the-er-model">Outline of the ER Model</a></h2>
<p>The ER data model employs three basic concepts:</p>
<ul>
<li>entity set</li>
<li>relationship sets</li>
<li>attributes</li>
</ul>
<h3 id="entity-set"><a class="header" href="#entity-set">Entity Set</a></h3>
<p>An <strong>entity</strong> is an object that exists and is distinguishable from other objects.</p>
<p>An <strong>entity set</strong> is a set of entities of the same type that share the same properties.</p>
<p>An entity is represented by a set of attributes. And a subset of the attributes forms the <strong>primary key</strong> of the entity set, uniquely identifying each member of the set.</p>
<h3 id="attributes"><a class="header" href="#attributes">Attributes</a></h3>
<p>There are many attributes types:</p>
<ul>
<li>
<p>Simple or composite</p>
<p><img src="database/./entity-relation-model/image-20231031133432024.png" alt="image-20231031133432024" /></p>
</li>
<li>
<p>Single-valued or multivalued</p>
</li>
<li>
<p>Derived</p>
<p>Can be computed from other attributes</p>
</li>
</ul>
<h3 id="relationship-set"><a class="header" href="#relationship-set">Relationship Set</a></h3>
<p>A <strong>relationship</strong> is an association among several entities.</p>
<p>A <strong>relationship set</strong> is a mathematical relation among <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> entities, each taken from entity sets.
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>
An attribute can also be associated with a relationship set.</p>
<h4 id="degree-of-a-relationship-set"><a class="header" href="#degree-of-a-relationship-set">Degree of a Relationship Set</a></h4>
<p>Binary relationship:</p>
<ul>
<li>involve two entity sets</li>
<li>most relationship sets in a database system are binary</li>
</ul>
<p>Relationships between more than two entity sets are rare.</p>
<h4 id="mapping-cardinality-constraints"><a class="header" href="#mapping-cardinality-constraints">Mapping Cardinality Constraints</a></h4>
<p>Express the number of entities to which another entity can be associated via a relationship set. Most useful in describing binary relationship set.</p>
<p>For a binary relationship set the mapping cardinality must be one of:</p>
<ul>
<li>One to one</li>
<li>One to many</li>
<li>Many to many</li>
</ul>
<h4 id="weak-entity-sets"><a class="header" href="#weak-entity-sets">Weak Entity Sets</a></h4>
<p>A weak entity set is one whose existence is dependent on another entity, called its identifying entity. Instead of associating a primary key with a weak entity, use the identifying entity along with extra attributes called <strong>discriminator</strong> to uniquely identify a weak entity.</p>
<h2 id="e-r-diagrams"><a class="header" href="#e-r-diagrams">E-R Diagrams</a></h2>
<p>Entities can be represented graphically as follows:</p>
<p><img src="database/./entity-relation-model/image-20231031141515241.png" alt="image-20231031141515241" /></p>
<p>Diamonds represent relationship sets:</p>
<p><img src="database/./entity-relation-model/image-20231031141550958.png" alt="image-20231031141550958" />Attributes can be associated with a relationship:</p>
<p><img src="database/./entity-relation-model/image-20231031141627746.png" alt="image-20231031141627746" /></p>
<p>Entities sets of a relationship need not to be distinct.</p>
<p>Each occurrence of an entity set plays a <strong>role</strong> in the relationship.</p>
<p>Express cardinality constrains by drawing either a directed ling, signifying one and an undirected line signifying many between the relationship set and the entity set. Total participation(indicated by double line) means every entity in the entity set participates in at least one relationship in the relationship set.</p>
<p>A line may have an associated minimum and maximum cardinality, shown in the form <code>l..r</code> where <code>l</code> is the minimum and <code>h</code> is the maximum cardinality.</p>
<ul>
<li>A minimum value of 1 indicates total participation</li>
<li>A maximum value of 1 indicates that the entity participates in at most one relationship</li>
<li>A maximum value of * indicates no limit</li>
</ul>
<h2 id="advanced-topics"><a class="header" href="#advanced-topics">Advanced Topics</a></h2>
<h3 id="non-binary-relationship-sets"><a class="header" href="#non-binary-relationship-sets">Non-binary Relationship Sets</a></h3>
<p>E-R diagram with a ternary relationship:</p>
<p><img src="database/./entity-relation-model/image-20231031152245682.png" alt="image-20231031152245682" /></p>
<p>Cardinality constraints on ternary relations:</p>
<ul>
<li>Allow at most one arrow out of a ternary (or greater) relationship to indicate a cardinality constraint. If there is more than one arrow, there are two ways of defining meaning. So outlaw more than one arrow to avoid confusion.</li>
</ul>
<h3 id="specialization"><a class="header" href="#specialization">Specialization</a></h3>
<p>We designate sub-groupings within an entity set that are distinctive from other entities in the set. These sub-groupings become lower-level entity sets that have attributes or participate on relationships that do not apply to the higher level entity set. <strong>Attribute inheritance</strong>: a lower-level entity set inherits all the attributes and relationship participation of the higher-level entity set to which it is linked.</p>
<p>Constraints on whether or not entities may belong to more than one lower-level entity set within a single generalization.</p>
<ul>
<li>Disjoint: an entity can belong to only one lower-level entity</li>
<li>Overlapping: an entity can belong to more than one lower-level entity set</li>
</ul>
<p>Constraints on whether or not an entity in the higher-level entity set must belong to at least one of the lower-level entity sets within a generalization.</p>
<ul>
<li>total: an entity must belong to one of the lower-level sets</li>
<li>partial: an entity need not belong to one of the lower-level entity sets</li>
</ul>
<h3 id="generalization"><a class="header" href="#generalization">Generalization</a></h3>
<p><em>A bottom up design process</em>: combine a number of entity sets that share the same features into a higher-level entity set.</p>
<p>Specialization and generalization are simple inversion of each other.</p>
<h2 id="reduction-to-relation-schemes"><a class="header" href="#reduction-to-relation-schemes">Reduction to Relation Schemes</a></h2>
<p>Entity sets and relationship sets can be expressed uniformly as relation schemes that represent the contents of the database.</p>
<h3 id="representing-entity-sets"><a class="header" href="#representing-entity-sets">Representing Entity Sets</a></h3>
<p>A strong entity set reduces to a schema with the same attributes.</p>
<p>A weak entity set becomes a table that includes a column for the primary key of the identifying strong entity set.</p>
<p>If there are composite attribute: flat out by creating a separate attribute for each component attribute. For example: the composite attribute <em>name</em> ends with <em>name_first_name</em> and <em>name_last_name</em> attributes in the schemes. And prefix can be omitted if there is no ambiguity: <em>first_name</em> and <em>last_name</em>.</p>
<p>If there is a multivalued attribute: create a separate schema for this attribute. This schema has attributes corresponding to the primary key of the original entity and an attribute corresponding to the multivalued attributes.</p>
<h3 id="representing-relationship-sets"><a class="header" href="#representing-relationship-sets">Representing Relationship Sets</a></h3>
<p>A many-to-many relationship set is represented as a schema with attributes for the primary keys for the two participating entity sets and any descriptive attributes of the relationship sets.</p>
<p>Many-to-one and one-to-many relationship sets that are total on the many-side can be represented by adding an extra attribute to the <em>many</em> side containing the primary key of the <em>one</em> side.</p>
<blockquote>
<p>If participation is <strong>partial</strong> on the <em>many</em> side, the extra attribute in the schema corresponding to the <em>many</em> side could result in <strong>null</strong> value.</p>
</blockquote>
<h3 id="representing-specialization-and-generalization"><a class="header" href="#representing-specialization-and-generalization">Representing Specialization and Generalization</a></h3>
<p>Method 1:</p>
<ul>
<li>Form a schema for the higher-level entity</li>
<li>Form a schema for each lower-level entity set, include primary key of higher-level entity set and local attributes</li>
</ul>
<p>Method 2:</p>
<ul>
<li>Form a schema for each entity set with all local and inherited attributes</li>
</ul>
<p>Drawback:</p>
<ul>
<li>Method 1: getting information requires accessing two relations</li>
<li>Method 2: attributes may be stored redundantly</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-storage-structures"><a class="header" href="#data-storage-structures">Data Storage Structures</a></h1>
<h2 id="storage-access"><a class="header" href="#storage-access">Storage Access</a></h2>
<p>A database file is partitioned into fixed-length units called <strong>blocks</strong>. Blocks are units of both storages allocation and data transfer.</p>
<p>Database system seeks to minimize the number of block transfers between the disk and memory and try to keep as many blocks in main memory. <strong>Buffer</strong> is the portion of main memory available to store copies of disk blocks. And <strong>buffer manager</strong> is the subsystem responsible for all allocating buffer space in main memory.</p>
<h3 id="buffer-manager"><a class="header" href="#buffer-manager">Buffer Manager</a></h3>
<p>If the block is already in the buffer, the requesting program is given the address of the block in main memory. If the block is not in the buffer:</p>
<ol>
<li>The buffer manager allocates space int the buffer for the block, replacing (throwing out) some other block, if required, to make space for the new block.</li>
<li>The block is thrown out is written back to disk only if it was modified since the most recent time that it was written to/fetched from the disk.</li>
<li>Once space is allocated in the buffer, the buffer manager reads the block from the disk to the buffer, and passes the address of the block in main memory to requester.</li>
</ol>
<h4 id="buffer-replacement-policies"><a class="header" href="#buffer-replacement-policies">Buffer Replacement Policies</a></h4>
<p><strong>Least recently used</strong> (LRU) strategy is used by most operating system to replace block, but can be a bad strategy for database buffer manager.</p>
<p><strong>Pinned block</strong> is that memory block is not allowed to be written back to disk.</p>
<p>There are also <strong>forced output</strong> and <strong>Toss immediate</strong> strategies.</p>
<h2 id="file-organization"><a class="header" href="#file-organization">File Organization</a></h2>
<p>The database is stored as collection of files. Each file is a sequence of records, A record is a sequence of fields. Files are provided as a basic construct in OS, The records are mapped onto disk blocks.</p>
<p>Recors can be fix-length and variable-length. For fixed-length records, store record <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> starting from byte <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> is the size of each record. Record access is simple but records may cross blocks. So do not allow records to cross block buundaries. And there are three alternatives for deletion of record:</p>
<ul>
<li>Move record <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li>Move record <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></li>
<li>Do not move record, but links all free records on a free list</li>
</ul>
<blockquote>
<p>Free List: store the address of the first deleted record in the file header. Use this first record to store the address of the second deleted record and so on. Using free list can lead to more space efficient representation: reuse spce for normal attributes of free records to store points.</p>
</blockquote>
<p>Variable length records arise in database systems in several ways:</p>
<ul>
<li>Storage of multiplx record types in a file</li>
<li>Record types that allow variable lengths for one or more fields</li>
<li>Record types that allow repeating fields</li>
</ul>
<p>Can store variable-length records in byte string representation and attact a <em>end of record</em> control character to the end of each record but result in difficulty with deletion and growth.</p>
<h3 id="slotted-page-structure"><a class="header" href="#slotted-page-structure">Slotted Page Structure</a></h3>
<p><img src="database/./data-storage-structure/image-20231128141505506.png" alt="image-20231128141505506" /></p>
<p>Slotted page header contains:</p>
<ul>
<li>number of record entities</li>
<li>end of free space in the block</li>
<li>location and size of each record</li>
</ul>
<p>Records can be moved around within a page to keep then contigous with no empty space between them, entry in the header must be updated. Pointers should not point directly to record, instead they should point to the entry for the record in header.</p>
<p>To store records than bigger than pages, e.g. <code>blob</code> <code>clob</code> types:</p>
<ul>
<li>Store as files in file system</li>
<li>Store as files managed by database</li>
<li>Break into pieces and store in multiple tuples in separate relation</li>
</ul>
<h2 id="organization-of-records-in-files"><a class="header" href="#organization-of-records-in-files">Organization of Records in Files</a></h2>
<h4 id="heap-file-organization"><a class="header" href="#heap-file-organization">Heap File Organization</a></h4>
<p>Records can be placed anywhere in the file where there is free space. Once allocated, records usually do not move.</p>
<p>This is important to be able to efficiently find free space within file. So design <strong>free space map</strong>:</p>
<ul>
<li>Array with 1 entry per block. Each entry is a few bits to a byte and records fraction of block that is free</li>
<li>Can have second-level free-space map</li>
</ul>
<h4 id="sequential-file-organization"><a class="header" href="#sequential-file-organization">Sequential File Organization</a></h4>
<p>Suitable for application that requires sequential processing of the entire file. The records in the file are ordered by a search-key. Deletion uses pointer chain and insert need to locate the position where the record is to be inserted:</p>
<ul>
<li>If there is free space then insert there</li>
<li>If there is no free space then insert the record in an overflow block</li>
</ul>
<p>In both case, point chain must be updated. And need to reorganize the file from time to time to restore sequential order.</p>
<h4 id="multitable-clustering-file-organization"><a class="header" href="#multitable-clustering-file-organization">Multitable Clustering File Organization</a></h4>
<p>Store several relations in one file using a clustering file organization.</p>
<p><img src="database/./data-storage-structure/image-20231129212834935.png" alt="image-20231129212834935" /></p>
<p>Such structure is good for queries involving <em>department</em> and <em>instructor</em> and for queries involving one single <em>department</em> and its <em>instructors</em>. But bad for queries involving only <em>department</em>. And may result in variable size record.</p>
<p>Can add pointer chain to link records of a particular relation. For example, in image below we add a pointer chain for <em>department</em>.</p>
<p><img src="database/./data-storage-structure/image-20231129213256408.png" alt="image-20231129213256408" /></p>
<h2 id="data-dictionary-storage"><a class="header" href="#data-dictionary-storage">Data Dictionary Storage</a></h2>
<p>Data dictionary, also called system catalog, stores metadata, such as :</p>
<ul>
<li>Information about relations
<ul>
<li>Names of relations</li>
<li>Names and types of attributes of each relation</li>
<li>Names and definitions of views</li>
<li>Integrity constraints</li>
</ul>
</li>
<li>User and accounting information including password</li>
<li>Statistical and descriptive data
<ul>
<li>Number of tuples in each relation</li>
</ul>
</li>
<li>Physical file organization information
<ul>
<li>How relation is stored</li>
<li>Physical location of relation, such as operating system filename or disk addresses of blocks containing records of the relation</li>
</ul>
</li>
<li>Information about index</li>
</ul>
<p><img src="database/./data-storage-structure/image-20231129215045489.png" alt="image-20231129215045489" /></p>
<p>There are two catalog structures to store:</p>
<ul>
<li>Specialized data structures designed for efficient access</li>
<li>A set of relations, with existing system features used to ensure efficient access</li>
</ul>
<p>Relational representation on disk, and specialized data structures designed for efficient access in memory.</p>
<h2 id="column-oriented-storage"><a class="header" href="#column-oriented-storage">Column Oriented Storage</a></h2>
<p>Also known as <strong>columnar representation</strong>, store each attribute of a relation separately.</p>
<p>The benefits are:</p>
<ul>
<li>Reduced IO if only some attributes are accessed</li>
<li>Improved CPU cache performance</li>
<li>Improved compression</li>
<li>Support <strong>vector processing</strong> on modern CPU architectures</li>
</ul>
<p>The drawbacks are:</p>
<ul>
<li>Cost of reconstrcution from columnar representation</li>
<li>Cost of tuple deletion and update</li>
<li>Cost of decompression</li>
</ul>
<p>Columnar representation found to more efficient for decision support than row oriented representation as traditional row oriented representation preferable for transaction processing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="index"><a class="header" href="#index">Index</a></h1>
<h2 id="basic-concepts"><a class="header" href="#basic-concepts">Basic Concepts</a></h2>
<p>Indexing mechanism used to speed up access to desired data.</p>
<p><strong>Search key</strong> is an attribute or set of attributes used to look up records in a file. And an index file consisting of records (called index entries) of the form:</p>
<p><img src="database/./database-index/image-20231128145351143.png" alt="image-20231128145351143" /></p>
<p>Two basic kinds of index:</p>
<ul>
<li>Ordered index: search keys are stored in sorted order</li>
<li>Hash index: search keys are distributed uniformly across <em>buckets</em> using a <em>hash function</em></li>
</ul>
<blockquote>
<p>Index Evaluation Metrics:</p>
<ul>
<li>Access types supported efficiently</li>
</ul>
<p>Records with a specified value in the attribute</p>
<p>Records with an attribute value falling in a specified range of values</p>
<ul>
<li>
<p>Access time</p>
</li>
<li>
<p>Insertion time</p>
</li>
<li>
<p>Deletion time</p>
</li>
<li>
<p>Space overhead</p>
</li>
</ul>
</blockquote>
<h2 id="ordered-index"><a class="header" href="#ordered-index">Ordered Index</a></h2>
<p>In an  ordered index, index entries are stored sorted on the search key value.</p>
<p><strong>Primary index</strong>: in a sequentially ordered file,  the index whose search key specifies the sequential order of the file, also called as <strong>clustering index</strong>. The search key of a primary index is usually but not necessarily the primary key and ordered sequential file with a primary index is called index-sequential file.</p>
<p><strong>Secondary index</strong>: an  index whose search key specifies an order different from the sequential order of the file, also called non-clustering index.</p>
<p><strong>Dense Index</strong>: index record appears for every search key in the file.</p>
<p><strong>Sparse Index</strong>: contains index records for only some search key values. And to locate a record with search-key value <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> we need to:</p>
<ul>
<li>Find index record with largest search key value &lt; <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></li>
<li>Search file sequentially starting at the record to which the index record points</li>
</ul>
<h3 id="multilevel-index"><a class="header" href="#multilevel-index">Multilevel Index</a></h3>
<p>If primary index does not fit in memory, access becomes expensive. So to reduce number of disk accesses to index records, treat primary index kept on disk as s sequential file and construct a sparse index on it.</p>
<ul>
<li>Outer index:  a sparse index of primary index</li>
<li>Inner index: the primary index file</li>
</ul>
<p>If the outer index is still too large to fit in main memory, yet another level of index can be created and so on. But index at all levels must be updated on insertion pr deletion from the file.</p>
<p><img src="database/./database-index/image-20231202155411732.png" alt="image-20231202155411732" /></p>
<h3 id="index-update"><a class="header" href="#index-update">Index Update</a></h3>
<h4 id="deletion"><a class="header" href="#deletion">Deletion</a></h4>
<p>If deleted record was the only record in the file with its particular search-key value, the search-key is deleted from the index also.</p>
<p>For single-level index deletion:</p>
<ul>
<li>Dense index: delete the pointer when storing pointers to all records or update the pointer when storing pointer to the first record.</li>
<li>Sparse index: nothing done or replace with next search-key value or updates the pointer</li>
</ul>
<p>The multi-level deletion are simple extensions of the single-level deletion.</p>
<h4 id="insertion-2"><a class="header" href="#insertion-2">Insertion</a></h4>
<p>For single-level index insertion:</p>
<ul>
<li>Perform a look up using the search-key value appearing in the record to be inserted.</li>
<li>Dense index: insert index/add pointer/update pointer</li>
<li>Sparse index: no change/insert index/update pointer</li>
</ul>
<p>The multi-level insertion are simple extensions of the single-level insertion.</p>
<h3 id="secondary-index"><a class="header" href="#secondary-index">Secondary Index</a></h3>
<p><img src="database/./database-index/image-20231202162829845.png" alt="image-20231202162829845" /></p>
<p>There are some differences between primary and secondary index:</p>
<ul>
<li>Secondary index have to be dense</li>
<li>Index offers substantial benefits  when searching for record</li>
<li>When a file is updated, every index on the file must be updated. Updating index imposes overhead on database modification</li>
<li>Sequential scan using primary index is efficient, bu a sequential scan using a secondary index is expensive, as each scan may fetch a new block from the disk.</li>
</ul>
<h2 id="b-tree"><a class="header" href="#b-tree">B+ Tree</a></h2>
<p>No thing to say.</p>
<h2 id="hash-index"><a class="header" href="#hash-index">Hash Index</a></h2>
<p>A  <strong>bucket</strong> is a unit for storage containing one or more records, typically a disk block. A <strong>hash function</strong> is a function from the set of all search key to the set of all bucket addresses. Hash function is used to locate records for access, insertion and deletion. In a hash file organization we obtain the bucket of a record directly from its search-key value using a hash function.</p>
<h4 id="hash-function"><a class="header" href="#hash-function">Hash Function</a></h4>
<p>Typical hash function perform computation on the binary representation of the search key. An ideal hash function is</p>
<ul>
<li><strong>Uniform</strong>: each bucket is assigned with the same number of search-key values from the set all possible values</li>
<li><strong>Random</strong>: Each bucket will have the same number of records assigned to it irrespective of the actual distribution of search-key values in the file</li>
</ul>
<h4 id="bucket-overflow-handling"><a class="header" href="#bucket-overflow-handling">Bucket Overflow Handling</a></h4>
<p>Bucket overflow can occur because of:</p>
<ul>
<li>Insufficient bucket</li>
<li>Skew in distribution of record: multiple records have the same search-key value or chosen hash function produces non-uniform distribution of key values.</li>
</ul>
<p>Handling the overflow using the <strong>overflow chain</strong>: the overflow buckets of a given bucket are chained together using a linked list.</p>
<p><img src="database/./database-index/image-20231202164021909.png" alt="image-20231202164021909" /></p>
<p>A <strong>hash index</strong> organize the search keys with their associated record pointers into a hash file structure. And strictly speaking, every hash index is a secondary index.</p>
<h4 id="deficiencies-of-static-hashing"><a class="header" href="#deficiencies-of-static-hashing">Deficiencies of Static Hashing</a></h4>
<p>In static hashing, hash function maps search-key values into a fixed set of bucket addresses.</p>
<ul>
<li>When databases grow with time, if initial number of bucket is small, performance will degrade due to too much overflows</li>
<li>If file size at some point in the future is anticipated and number of buckets allocated accordingly, significant number of space will be wasted initially</li>
<li>When database shrinks, again space will be wasted.</li>
</ul>
<p>One solution is to periodic reorganization of the file with a new hash function, but it is very expensive.</p>
<h2 id="index-definition-in-sql"><a class="header" href="#index-definition-in-sql">Index Definition in SQL</a></h2>
<pre><code class="language-sql">create index b-index on branch(branch-name);

drop index &lt;index-name&gt;
</code></pre>
<p>And when creating index on multiple attributes, the index only can be used efficiently when fetching only records that satisfy all conditions.</p>
<p><img src="database/./database-index/image-20231202165448572.png" alt="image-20231202165448572" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-processing"><a class="header" href="#query-processing">Query Processing</a></h1>
<h2 id="basic-stpes-in-query-processing"><a class="header" href="#basic-stpes-in-query-processing">Basic Stpes in Query Processing</a></h2>
<p><img src="database/./query-processing/image-20231205130439464.png" alt="image-20231205130439464" /></p>
<p><strong>Parsing and translation</strong>: Translate the query into its internal form, which is then translated into relation algebra. And the parser will checks syntax, verfies relations.</p>
<p><strong>Query optimization</strong>: Among all equivalent evaluation plans choose the one with lowest cost.</p>
<p><strong>Evaluation</strong>: The query-execution engine takes a query-evaluation plan, executes that plan and returns the answers to the query.</p>
<h3 id="optimization"><a class="header" href="#optimization">Optimization</a></h3>
<p>A relation algebra expression may have many equivalent expressions, for example:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">ry</span><span class="mrel mtight">&lt;</span><span class="mord mtight">1000</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">ry</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">in</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mclose">))</span></span></span></span></span>
is equivalent to
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord">Π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">ry</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">ry</span><span class="mrel mtight">&lt;</span><span class="mord mtight">1000</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">in</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mclose">))</span></span></span></span></span>
But this chapter will mainly focus on how to measure query cost.</p>
<h2 id="measures-of-query-cost"><a class="header" href="#measures-of-query-cost">Measures of Query Cost</a></h2>
<p>Cost is generally measured as total elapsed time for answering query. And many factors contribute to time cost:</p>
<ul>
<li>Disk accesses</li>
<li>CPU</li>
<li>Netowork communication</li>
</ul>
<p>And typicially <strong>disk access</strong> is the predominant cost and is also relatively easy to estimate, measured by taking into account:</p>
<ul>
<li>Number of seeks: average seek cost</li>
<li>Number of blocks read: average block read cost</li>
<li>Number of blocks written: average block write cost</li>
</ul>
<p>And for simplicity, we just use <strong>number of block transferd from disk</strong> and <strong>the number of seeks</strong> as the cost measures.</p>
<h3 id="select-operation"><a class="header" href="#select-operation">Select Operation</a></h3>
<p><strong>File Scan</strong> serch algorithms that locate and retrieve records that fulfill a selection condition.</p>
<h4 id="linear-search"><a class="header" href="#linear-search">Linear Search</a></h4>
<p>Sacn each file block and test all records to see whether they satisfy the selection condition.</p>
<h3 id=""><a class="header" href="#"></a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-optimization"><a class="header" href="#query-optimization">Query Optimization</a></h1>
<h2 id="why-optimization"><a class="header" href="#why-optimization">Why Optimization</a></h2>
<h2 id="cost-based-optimization"><a class="header" href="#cost-based-optimization">Cost-based Optimization</a></h2>
<h2 id="heuristic-optimization"><a class="header" href="#heuristic-optimization">Heuristic Optimization</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="离散数学笔记"><a class="header" href="#离散数学笔记">离散数学笔记</a></h1>
<p>这是大二上的《离散数学下》的笔记。</p>
<p>这门课主要的教材是<code>Kenneth H.Rosen</code>的<em>Discrete Mathematics and Its Application(Seven Edition)</em> 和<code>Bernard Kolman</code>的<em>Discrete Mathematical Structures(Sixth Edition)</em> ，这学期学习的内容在两本书上都有，大致为：</p>
<ul>
<li><em>Discrete Mathematics and Its Application(Seven Edition)</em>
<ul>
<li>关系</li>
<li>图</li>
<li>树</li>
<li>高级计数技巧</li>
</ul>
</li>
<li><em>Discrete Mathematical Structures(Sixth Edition)</em>
<ul>
<li>群</li>
<li>编码</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="relations"><a class="header" href="#relations">Relations</a></h1>
<h2 id="relations-and-their-properties"><a class="header" href="#relations-and-their-properties">Relations and Their Properties</a></h2>
<h3 id="definition-of-relations"><a class="header" href="#definition-of-relations">Definition of Relations</a></h3>
<ul>
<li>
<p>Relations are <strong>formal means</strong> to specify which elements from two or more sets are related to each other.</p>
<p>For example, students who takes courses, there are relations between students and courses; integers and their divisors, there are relations between integers and divisors.</p>
</li>
<li>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> be two sets. A <strong>binary relation</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> is a <strong>subset</strong> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>.</p>
</li>
<li>
<p>Generally, let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> sets. An <strong>n-ary relation</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> on these sets is a subset of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
</li>
<li>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">b</span></span></span></span> means that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
</li>
</ul>
<h3 id="complementary-and-inverse-of--relations"><a class="header" href="#complementary-and-inverse-of--relations">Complementary and Inverse of  Relations</a></h3>
<ul>
<li>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> be any binary relations, the complement of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, is the binary relation defined by  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mord">∣</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
<li>Any binary relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, has an inverse relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, which is defined by<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord">∣</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span>.</li>
</ul>
<h3 id="functions-as-relations"><a class="header" href="#functions-as-relations">Functions as relations</a></h3>
<ul>
<li>A function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> is a special case of a relation from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>.</li>
<li>Relations are a generalization of function.
<ul>
<li>Relations allow unmapped elements in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>.</li>
<li>Relations allow one-to-many mappings.</li>
<li>Relations also allow many-to-one and many-to-many mappings.</li>
</ul>
</li>
</ul>
<h3 id="relations-on-a-set"><a class="header" href="#relations-on-a-set">Relations on a Set</a></h3>
<ul>
<li>A binary from a set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> to itself is called a <strong>relation on the set ​<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></strong>.</li>
<li>A relation on a set A is <strong>a subset of ​<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></strong>.</li>
</ul>
<h3 id="properties-of-relations"><a class="header" href="#properties-of-relations">Properties of Relations</a></h3>
<h4 id="reflexivity"><a class="header" href="#reflexivity">Reflexivity</a></h4>
<ul>
<li>A relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is reflexive if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord">∀</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">a</span></span></span></span>.</li>
<li>A relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is irreflexive if its complementary relation is reflexive.</li>
</ul>
<h4 id="symmetry"><a class="header" href="#symmetry">Symmetry</a></h4>
<ul>
<li>A binary relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is symmetry if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>, that is if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">↔</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
<li>A binary relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is antisymmetric if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">∀</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
</ul>
<h4 id="transitivity"><a class="header" href="#transitivity">Transitivity</a></h4>
<ul>
<li>A relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is transitive if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
</ul>
<p>Examples in Mathematics:</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>reflexive</th><th>symmetric</th><th>antisymmetric</th><th>transitive</th></tr></thead><tbody>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span></td><td>yes</td><td>yes</td><td>yes</td><td>yes</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span></td><td>no</td><td>yes</td><td>no</td><td>no</td></tr>
<tr><td><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">∅</span></span></span></span></td><td>no</td><td>yes</td><td>yes</td><td>yes</td></tr>
</tbody></table>
</div>
<h3 id="composition"><a class="header" href="#composition">Composition</a></h3>
<p>The composition of two relations <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>, denoted by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, is the relation from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> containing all pairs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span> such that there is one <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>.</p>
<h3 id="power-of-a-relation"><a class="header" href="#power-of-a-relation">Power of a Relation</a></h3>
<blockquote>
<p>Composing the Parent relation with itself</p>
</blockquote>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> be a binary relation on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, then the power <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> of the relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> can be defined inductively by:</p>
<ul>
<li>Basic Step: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
<li>Inductive Step: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></li>
</ul>
<p><strong>Theorem</strong>:  The relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> on a set A is transitive if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span>.</p>
<h2 id="n-ary-relations-and-their-applications"><a class="header" href="#n-ary-relations-and-their-applications">n-ary Relations and Their Applications</a></h2>
<h3 id="n-ary-relations"><a class="header" href="#n-ary-relations">n-ary Relations</a></h3>
<ul>
<li>An n-ary relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> on sets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, a subset <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>The sets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are called the <strong>domains</strong> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
<li>The degree of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>.</li>
</ul>
<h3 id="relational-database"><a class="header" href="#relational-database">Relational Database</a></h3>
<h4 id="database"><a class="header" href="#database">Database</a></h4>
<ul>
<li>A database is viewed as a collection of records, each being a tuple of the form <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</li>
<li>In order to uniquely identify tuples in a database, we need to specify a field , which is the <strong>primary key</strong>.</li>
<li>Some database may not have primary key, instead they use a <strong>composite key</strong> made up of multiple fields.</li>
</ul>
<h4 id="relational-database-1"><a class="header" href="#relational-database-1">Relational Database</a></h4>
<ul>
<li>A model for databases, based on relations.</li>
<li>A domain <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is a primary key for the database if the relation R is functional in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>A composite key for the database is a set of domains <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span></span>, such that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> contains at most 1 n-tuple <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">)</span></span></span></span>for each composite  value.</li>
</ul>
<h4 id="operations-on-n-ary-relations"><a class="header" href="#operations-on-n-ary-relations">Operations on n-ary relations</a></h4>
<ul>
<li>Selection</li>
<li>Projection</li>
<li>Join</li>
</ul>
<h2 id="representing-of-relations"><a class="header" href="#representing-of-relations">Representing of Relations</a></h2>
<h3 id="using-zero-one-matrices"><a class="header" href="#using-zero-one-matrices">Using Zero-One Matrices</a></h3>
<p>We can represent a binary relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> by an <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span></span></span></span> 0-1 matrix <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>, let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
<p>We can see some relation characteristics in the zero-one matrix.</p>
<ul>
<li>Reflexive: all 1 are on diagonal</li>
<li>Irreflexive: all 0 are on diagonal</li>
<li>Symmetric: all identical across diagonal</li>
<li>Antisymmetric: all 1 are across from 0.</li>
</ul>
<h3 id="using-directed-graphs"><a class="header" href="#using-directed-graphs">Using Directed Graphs</a></h3>
<p>A relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> can be represented as a graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>.</p>
<h2 id="closures-of-relations"><a class="header" href="#closures-of-relations">Closures of Relations</a></h2>
<h3 id="closures"><a class="header" href="#closures">Closures</a></h3>
<p>For any property X , the "X closure" of a set A is defined as the smallest superset of A that has the given property.</p>
<p>For example:</p>
<ul>
<li>The reflexive closure of relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is obtained by adding <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> for each <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</li>
<li>The symmetric closure of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is obtained by adding <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>.</li>
<li>The transitive closure or connectivity relation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is obtained by repeatedly adding <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> for each <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</li>
</ul>
<h3 id="paths-in-digraphs"><a class="header" href="#paths-in-digraphs">Paths in Digraphs</a></h3>
<p>A <strong>path</strong> of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> from node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> in the directed graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is a sequence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> ordered pairs in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<ul>
<li>An empty sequence of edges is considered a path of length 0 from a to a.</li>
<li>If any path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> exists, then we say that a<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> is connected to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>.</li>
<li>A path of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> from a to itself is called a circuit or a cycle.</li>
<li>There exists a path of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> if and only if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>.</li>
</ul>
<p>Let R be a relation on a set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, the connectivity relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> consist of their pairs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> such that there is a path of length at least one from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>.</p>
<p>As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> consists of the pairs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> such that there is a path of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>, it follows that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> is the union of all the sets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Theorem</strong>: Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> be a relation on a set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> equals the transitive closure of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7387em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>But in fact if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> is a set with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>, and let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> be a relation on <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>. Then</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>which is much easier to calculate.</p>
<h3 id="warshalls-algorithm"><a class="header" href="#warshalls-algorithm">Warshall's Algorithm</a></h3>
<p>As we have seen, using the Theorem and its lemma, it is still difficult to calculate the transitive closure, so we have a algorithm:</p>
<pre><code>procedure Warshall(M, n X n zero-one matrix)
W := M
for k:=1 to n
	for j:=1 to n
		for j:=1 to n
		w[ij] = w[ij] | (W[ik] &amp; W[ki])
return W
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="advanced-counting-techniques"><a class="header" href="#advanced-counting-techniques">Advanced Counting Techniques</a></h1>
<p>Example: How many bit string of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> do not contain two consecutive zeros?</p>
<p>To solve this problem, let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the number of such strings of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>. An argument can be given that show that the sequence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> satisifies the recurrence relation <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> and the initial condition <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>.</p>
<h2 id="review-of-the-definition-of-recurrence-relation"><a class="header" href="#review-of-the-definition-of-recurrence-relation">Review of the definition of recurrence relation</a></h2>
<p>A recurrence relation for a sequence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> is an equation that expresses <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in terms of one or more previous elements of the sequence, for all <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>A particular sequence, described non-recurisely, is said to solve the given recurrence relation if it is consistent with the definition of the recurence.</p>
<blockquote>
<p>A given recurrence relation may have many solutions.</p>
</blockquote>
<h3 id="some-examples"><a class="header" href="#some-examples">Some Examples</a></h3>
<h4 id="the-tower-of-hanoi"><a class="header" href="#the-tower-of-hanoi">The Tower of Hanoi</a></h4>
<p>​<img src="discrete-math/./assets/image-20221122203100-6jtn1ng.png" alt="image" />​</p>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> represent the number of moves for a stack of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> disks.</p>
<p>And we will have such a strategy:</p>
<ul>
<li>Move the top <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> disks to spare peg, which is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>​</li>
<li>Move the bottom disk, 1</li>
<li>Move the top <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> disks to target reg, alos <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>​</li>
</ul>
<p>So we will have <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p>
<p>And <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.</p>
<h4 id="the-number-of-bit-string"><a class="header" href="#the-number-of-bit-string">The Number of Bit String</a></h4>
<p>Find a recurence relation and give initial conditions for the number of bits strings of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> that do not have two consecutive 0s. How many such bit strings are there of length five?</p>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> denote the number of bit strings of lenght <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>;</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>,as 0 and 1;</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>, as 01, 10 and 11;</p>
<p>and we have the two ways to construct the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> bit string, add <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> and add <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>, so we get the recurrence realtion <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<h4 id="catalan-numbers"><a class="header" href="#catalan-numbers">Catalan Numbers</a></h4>
<p>Find a recurrence relation for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, the number of ways to parenthesize the product of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> numbers <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to specify the order of multiplication. For example <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span> since there are five ways to parenthesize <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to determine the order of multiplication: <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>,<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6153em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6153em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span>.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.9032em;vertical-align:-2.2016em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7016em;"><span style="top:-5.6627em;"><span class="pstrut" style="height:3.8011em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2016em;"><span class="pstrut" style="height:3.8011em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2016em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7016em;"><span style="top:-5.6627em;"><span class="pstrut" style="height:3.8011em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2016em;"><span class="pstrut" style="height:3.8011em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2016em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="solving-recurrences"><a class="header" href="#solving-recurrences">Solving Recurrences</a></h2>
<p>A linear homogeneous recurrence of degree <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> wih constant coefficients , a.k.a k-LiHoReCoCo, is a recurence of the form</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>where the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are all real and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>.</p>
<p>The solution is uniquely determined if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> initial conitions are provided.</p>
<h3 id="solving-lihorecocos"><a class="header" href="#solving-lihorecocos">Solving LiHoReCoCos</a></h3>
<p>Basic idea: look for solutions of the form <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a constant.</p>
<p>This requires the characterisitic equation:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0141em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0491em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.9824em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0491em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>The solutions, called as characteristic roots,  can yield an explicit formula for the sequence.</p>
<p>Consider an arbitary 2-LiHoReCoCos:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>It has the characteristic equation:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<h4 id="theorem-1"><a class="header" href="#theorem-1">Theorem 1</a></h4>
<p>If this CE has 2 roots <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9125em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9125em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span> for <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> for some constants <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<h4 id="theorem-2"><a class="header" href="#theorem-2">Theorem 2</a></h4>
<p>If this CE has only 1 root <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9125em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9125em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span>, for all <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>, for some constants <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<h2 id="generating-functions"><a class="header" href="#generating-functions">Generating Functions</a></h2>
<p>The generating function for the sequence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> is the infinite power series</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8644em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">…</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="theroem-1"><a class="header" href="#theroem-1">Theroem 1</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1488em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1488em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>, and we have:</p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4248em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="extended-binomail-coefficient"><a class="header" href="#extended-binomail-coefficient">Extended Binomail Coefficient</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mclose">}</span></span></span></span>, the extended binomail coeffcient <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0331em;vertical-align:-0.2831em;"></span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> is defined by</p>
<p>​<img src="discrete-math/./assets/image-20221125175435-ttdbxdp.png" alt="image" />​</p>
<h4 id="extended-binomail-theroem"><a class="header" href="#extended-binomail-theroem">Extended Binomail Theroem</a></h4>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>, then</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mopen"><span class="mopen">(</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>As we have two theroems about generating functions, we give a list of some generating functions:</p>
<p>​<img src="discrete-math/./assets/image-20221125180112-75cweb2.png" alt="image" />​</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tree"><a class="header" href="#tree">Tree</a></h1>
<h2 id="introduction-of-tree"><a class="header" href="#introduction-of-tree">Introduction of Tree</a></h2>
<h3 id="defination-of-tree"><a class="header" href="#defination-of-tree">Defination of Tree</a></h3>
<p>A <strong>tree</strong> is a connected undirected graph with no simple circuits.</p>
<p>An undirected graph without simple circuits is called a <strong>forest</strong>​.</p>
<h3 id="rooted-tree"><a class="header" href="#rooted-tree">Rooted Tree</a></h3>
<p>A <strong>rooted tree</strong> is a tree in which one node has been designed the root. There are some terms related to rooted tree:</p>
<ul>
<li>Parent</li>
<li>child</li>
<li>silibings</li>
<li>ancestors</li>
<li>descentents</li>
<li>leaf</li>
<li>internal node</li>
<li>subtree</li>
</ul>
<h3 id="ordered-rooted-tree"><a class="header" href="#ordered-rooted-tree">Ordered Rooted Tree</a></h3>
<h3 id="trees-as-models"><a class="header" href="#trees-as-models">Trees as Models</a></h3>
<h3 id="tree-theorems"><a class="header" href="#tree-theorems">Tree Theorems</a></h3>
<h2 id="applications-of-trees"><a class="header" href="#applications-of-trees">Applications of Trees</a></h2>
<h3 id="binary-search-tree"><a class="header" href="#binary-search-tree">Binary Search Tree</a></h3>
<h3 id="decision-tree"><a class="header" href="#decision-tree">Decision Tree</a></h3>
<h3 id="prefix-code"><a class="header" href="#prefix-code">Prefix Code</a></h3>
<h4 id="huffman-code"><a class="header" href="#huffman-code">Huffman Code</a></h4>
<h2 id="tree-traversal"><a class="header" href="#tree-traversal">Tree Traversal</a></h2>
<h3 id="preorder-traversal"><a class="header" href="#preorder-traversal">Preorder Traversal</a></h3>
<h3 id="inorder-traversal"><a class="header" href="#inorder-traversal">Inorder Traversal</a></h3>
<h3 id="postorder-traversal"><a class="header" href="#postorder-traversal">Postorder Traversal</a></h3>
<h3 id="prefixpolish-form"><a class="header" href="#prefixpolish-form">Prefix/Polish Form</a></h3>
<h2 id="spanning-tree"><a class="header" href="#spanning-tree">Spanning Tree</a></h2>
<h3 id="depth-first-search"><a class="header" href="#depth-first-search">Depth-First Search</a></h3>
<h3 id="breadth-first-search"><a class="header" href="#breadth-first-search">Breadth-First Search</a></h3>
<h2 id="minimal-spanning-trees"><a class="header" href="#minimal-spanning-trees">Minimal Spanning Trees</a></h2>
<h3 id="weight-graph"><a class="header" href="#weight-graph">Weight Graph</a></h3>
<h3 id="minimal-spanning-tree"><a class="header" href="#minimal-spanning-tree">Minimal Spanning Tree</a></h3>
<h4 id="prims-algorithm"><a class="header" href="#prims-algorithm">Prim's Algorithm</a></h4>
<blockquote>
<p>This is a greedy algorithm</p>
</blockquote>
<h4 id="kruskals-algorithm"><a class="header" href="#kruskals-algorithm">Kruskal's Algorithm</a></h4>
<p>‍</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graph"><a class="header" href="#graph">Graph</a></h1>
<h2 id="introduction-of-graph"><a class="header" href="#introduction-of-graph">Introduction of Graph</a></h2>
<h3 id="definition-of-graph"><a class="header" href="#definition-of-graph">Definition of Graph</a></h3>
<h4 id="multigraphs"><a class="header" href="#multigraphs">Multigraphs</a></h4>
<h4 id="pseduographs"><a class="header" href="#pseduographs">Pseduographs</a></h4>
<h4 id="directed-graphs"><a class="header" href="#directed-graphs">Directed Graphs</a></h4>
<h4 id="directed-multigraphs"><a class="header" href="#directed-multigraphs">Directed Multigraphs</a></h4>
<p>​<img src="discrete-math/./assets/image-20221226213219-vhgne1f.png" alt="image" />​</p>
<h3 id="graphs-models"><a class="header" href="#graphs-models">Graphs Models</a></h3>
<h2 id="graph-terminology"><a class="header" href="#graph-terminology">Graph Terminology</a></h2>
<p>We will learn the following terms:</p>
<ul>
<li>Adjacent</li>
<li>connect</li>
<li>endpoint</li>
<li>neighborhood</li>
<li>degree</li>
<li>initial</li>
<li>terminal</li>
<li>in-degree</li>
<li>out-degree</li>
<li>complete</li>
<li>cycles</li>
<li>wheels</li>
<li>n-cubes</li>
<li>bipartite</li>
<li>subgraph</li>
<li>union</li>
</ul>
<h3 id="special-types-of-graphs"><a class="header" href="#special-types-of-graphs">Special Types of Graphs</a></h3>
<h3 id="bipartite-graphs"><a class="header" href="#bipartite-graphs">Bipartite Graphs</a></h3>
<h3 id="new-graphs-from-olds"><a class="header" href="#new-graphs-from-olds">New Graphs from Olds</a></h3>
<h2 id="graph-representation--isomorphism"><a class="header" href="#graph-representation--isomorphism">Graph Representation &amp; Isomorphism</a></h2>
<h3 id="graph-representation"><a class="header" href="#graph-representation">Graph Representation</a></h3>
<h4 id="adjacency-list"><a class="header" href="#adjacency-list">Adjacency List</a></h4>
<h4 id="adjacency-matrices"><a class="header" href="#adjacency-matrices">Adjacency Matrices</a></h4>
<h4 id="incidence-matrices"><a class="header" href="#incidence-matrices">Incidence Matrices</a></h4>
<h3 id="graph-isomorphism"><a class="header" href="#graph-isomorphism">Graph Isomorphism</a></h3>
<h2 id="connectivity"><a class="header" href="#connectivity">Connectivity</a></h2>
<h3 id="path"><a class="header" href="#path">Path</a></h3>
<p>In a undirected graph, a <strong>path</strong> of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> is a sequence of adjacent edges going from vertex <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span>.</p>
<ul>
<li>A path is a <strong>circuit</strong> , or close walk, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></li>
<li>A path traverses then vertices along it</li>
<li>A path is simple if it contains no edge more than once. When a path is simple, we can denote this path by these vertices sequence <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h4 id="path-in-directed-graphs"><a class="header" href="#path-in-directed-graphs">Path in Directed Graphs</a></h4>
<p>Same as in undirected graphs, but the path must go in the direction of the arrows.</p>
<ul>
<li>When there are no multiple edged in the directed graph, this path is denoted by its vertices sequence same as that in undirected graph</li>
<li>A path of length greater than zero and begins and ends at the same vertex is called a circuit or cycle</li>
</ul>
<h3 id="connectedness"><a class="header" href="#connectedness">Connectedness</a></h3>
<p>An undirected graphs is connected if there is a path between every pair of distinct vertices in the graph. An undirected graph that is not connected is called disconnected. We say that we disconnect a graph when we remove vertices or edges, or both, to produce disconnected subgraph.</p>
<p><strong>Theorem</strong>: There is a simple path between any pair of vertices in a connected undirected graph.</p>
<h4 id="cut-vertices--cut-edge"><a class="header" href="#cut-vertices--cut-edge">Cut Vertices &amp; Cut Edge</a></h4>
<blockquote>
<p>We call a connected graph is a connected component</p>
</blockquote>
<ul>
<li>The removal from a graph of a vertex and all incident edges produces a subgraph with more connected components. Such vertices are called <strong>cut vertices</strong> or <strong>articulation points</strong>.</li>
<li>An edge whose removal produces a graph with more connected components than in the original graph is called a <strong>cut edge</strong> or <strong>bridge</strong>.</li>
<li>A cut vertex or cut edge separates 1 connected component into 2 if removed.</li>
</ul>
<h4 id="vertex-connectivity--edge-connectivity"><a class="header" href="#vertex-connectivity--edge-connectivity">Vertex Connectivity &amp; Edge Connectivity</a></h4>
<p>Connected graphs without cut vertices are called <strong>nonseparable graphs</strong>, and can be thought of as more connected than those with a cut vertex.</p>
<p>A subset <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> of the vertex set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> is a vertex cut, or separating set, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is disconnected. We define the <strong>vertex connectivity</strong> of a noncomplete graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> as the minimum number of vertices in a vertex cut, denoted by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>. The larger <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span> is, the more connected we consider <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> to be. A graph is <strong>k-connected</strong>, if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>.</p>
<p>Same as vertex connectivity, we can define the edge connectivity. A set of edges <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is called an <strong>edge cut</strong> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> if the subgraph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is disconnected. The <strong>edge connectivity</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span> of a graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>, denoted by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>, is the minimum number of edges in an edge cut of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<p>And we have <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">min</span><span class="mopen">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">}</span></span></span></span></p>
<h4 id="directed-connectedness"><a class="header" href="#directed-connectedness">Directed Connectedness</a></h4>
<p>A directed graph is strongly connected if there is a directed path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> for any two vertices <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>.</p>
<blockquote>
<p>That means there is path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> and also a path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></p>
</blockquote>
<p>It is weakly connected if and only if the underlying undirected graph is connected. And we can get strongly implies weakly but not vice-verse.</p>
<h3 id="counting-paths-using-adjacency-matrices"><a class="header" href="#counting-paths-using-adjacency-matrices">Counting Paths using Adjacency Matrices</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> be the adjacency Matrices of graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>. The number of different paths of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> is a positive integer,equals the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>th entry of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span>.</p>
<h3 id="paths--isomorphism"><a class="header" href="#paths--isomorphism">Paths &amp; Isomorphism</a></h3>
<p>The connectedness and the existence of a circuit or simple circuit of length <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> are graph invariants with respect to isomorphism.</p>
<h2 id="euler-and-hamilton-paths"><a class="header" href="#euler-and-hamilton-paths">Euler and Hamilton Paths</a></h2>
<blockquote>
<p>LEAD-IN: Bridges of Königsberg Problem七桥问题</p>
</blockquote>
<h3 id="eulerian-graph"><a class="header" href="#eulerian-graph">Eulerian Graph</a></h3>
<p>An <strong>Euler Circuit</strong> in a graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is a simple circuit containing every edge of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<p>An <strong>Euler Path</strong> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is a simple path containing every edge of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<p>An <strong>Euler Tour</strong> is a a walk in a graph if it starts and ends in the same place and uses each edge exactly once.</p>
<p>An <strong>Euler Trail</strong> is a walk in a graph if it uses each edge exactly once.</p>
<p>A connected graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is Eulerian when it has at least two vertices has an Euler circuit. And a graph is Eulerian if and only if G is connected and has no vertices of odd degree.</p>
<p>A connected graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> has an Euler trail from node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to some other node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> if and only if <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is connected and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span> are the only two nodes of odd degrees.</p>
<h4 id="constructing-euler-circuit-algorithm"><a class="header" href="#constructing-euler-circuit-algorithm">Constructing Euler Circuit Algorithm</a></h4>
<pre><code>procedure Euler(G: connected multigraph with all vertices of even degree)
circuit := a circuit in G begining at an arbitrarily chosen vertex with edges
        successively added to form a path that returns to this vertex
H := G whith the edges of this circuit removed
while H has edges:
        subcircuit := a circuit in H beginning at a vertex in H that also is an
                endpoint of an edge of circuit
        H := H with edges of subcircuit and all isolated vertices removed
        circuit := circuit with subcircuit inserted at the appropriate vertex
return circuit {circuit is an Euler circuit}
</code></pre>
<h3 id="hamilton-graph"><a class="header" href="#hamilton-graph">Hamilton Graph</a></h3>
<p>A graph has a Hamiltonian tour if there is a tour that visits every vertex exactly once (and returns to its starting point).</p>
<p>A graph with a Hamiltonian tour is called a Hamiltonian graph.</p>
<p>A Hamiltonian path is a path that contains each vertex exactly once.</p>
<p>A Hamiltonian circuit is a circuit that traverses each vertex in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> exactly once.</p>
<p>At this time, we don't have nice characterization of Hamiltonian graphs the way there was with Eulerian graphs. But we have some experience in this area. For example, there are some properties imply a graph not a Hamilton, such as (1) vertex with degree 1, (2) vertex with two degrees must be in the circuit. When a circuit is being constructed and this circuit has passed through a vertex, then all remaining edges incident with this vertex, other than the two used circuit, can be removed from consideration. And a Hamilton circuit can't contain a smaller circuit within it.</p>
<h4 id="hamiltonian-path-theorems"><a class="header" href="#hamiltonian-path-theorems">Hamiltonian Path Theorems</a></h4>
<ul>
<li>Dirac's Theorem: If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is connected, simple, has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> vertices, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> has a Hamiltonian circuit.</li>
<li>Ore's Corollary: If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is connected, simple, has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> nodes, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> for every pair <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> of non-adjacent nodes, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> has a Hamiltonian circuit.</li>
</ul>
<h2 id="shortest-path-problems"><a class="header" href="#shortest-path-problems">Shortest Path Problems</a></h2>
<h3 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h3>
<ul>
<li>A <strong>weight graph</strong> is one in which weight are assigned to all edges connecting each two vertices.</li>
<li>Such number may have different meanings, such as instance, travelling distance, monthly cost or travelling time between two vertices.</li>
<li>The <strong>length</strong> of a path in a weight graph is the sum of the weights of the edges of this path. This length is different from the number of edges in a path in a graph without weights.</li>
</ul>
<h3 id="shortest-path-algorithm"><a class="header" href="#shortest-path-algorithm">Shortest Path Algorithm</a></h3>
<blockquote>
<p>Powered by Dijkstra</p>
</blockquote>
<ol>
<li>起始点的路径标为0，其他路径标为无穷大，在后续遍历中更新</li>
<li>定义一个已经标好最短路径的点的集合S</li>
<li>将最短路径的点放进去</li>
<li>从新放入的店开始，寻找其他点的最短路径</li>
<li>重复3~4，直到达到路径的目标</li>
</ol>
<h4 id="dijkstras-algorithm-complexity"><a class="header" href="#dijkstras-algorithm-complexity">Dijkstra's Algorithm Complexity</a></h4>
<ul>
<li>Dijkstra's algorithm finds the length of a shortest path between two vertices in a connected simple undirected and weighted graph.</li>
<li>Dijkstra's algorithm uses <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> operations(additions and comparisons) to find.</li>
</ul>
<h3 id="related-problems"><a class="header" href="#related-problems">Related Problems</a></h3>
<ul>
<li>Determining the shortest path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> to an assigned vertex</li>
<li>Determining the shortest path of any two vertices in the graph</li>
</ul>
<h4 id="finding-the-shortest-path-between-any-two-vertices-using-distance-matrix"><a class="header" href="#finding-the-shortest-path-between-any-two-vertices-using-distance-matrix">Finding the shortest path between any two vertices using distance matrix</a></h4>
<p>Distance Matrix: Let G is a graph with n vertices. The distance matrix of G is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> represent the weights of the edges <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>If there is no edge between <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span></li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span> is the shortest length of the path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> with two edges</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.3948em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span> is the shortest length of the path from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> edges</li>
</ul>
<p>To get the shortest length of path, we define <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊕</span></span></span></span>: Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>So we can define <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>, and in such matrix, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> represent the shortest length from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<h4 id="travelling-salesperson-problem"><a class="header" href="#travelling-salesperson-problem">Travelling Salesperson Problem</a></h4>
<p>In an undirected simple weighted graph, we need to find the shortest length of Hamilton path.</p>
<blockquote>
<p>This is a NP problem</p>
</blockquote>
<h2 id="planar-graph"><a class="header" href="#planar-graph">Planar Graph</a></h2>
<h3 id="definition"><a class="header" href="#definition">Definition</a></h3>
<p>A graph is called planar if it can be drawn in the plane in such way that no two edges cross.</p>
<p>A planar representation of a graph splits the plane into regions that we call it faces, including an unbound region.</p>
<h3 id="euler-theorem"><a class="header" href="#euler-theorem">Euler Theorem</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> be a connected planar simple graph with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> edges , <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> vertices. Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> be the number of regions in a planar representation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>, then we have <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></p>
<p>We can prove this theorem by mathematical induction. Constructing a sequence of subgraphs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> successively adding an edge at each stage.</p>
<ul>
<li>Basic step: G have no cycle, so <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li>Inductive step: there are two ways to add an edge:
<ul>
<li>Adding an edge by connecting two existing vertices, which add a new region</li>
<li>Adding a new vertex and connect it with graph, which keeps region unchanged</li>
</ul>
</li>
</ul>
<h4 id="corollary"><a class="header" href="#corollary">Corollary</a></h4>
<ul>
<li>
<p>No matter how we redraw a planar graph it will have the same number of region</p>
</li>
<li>
<p>Every simple <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>-node (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>) planar graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> has at most <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span> edges.</p>
</li>
<li>
<p>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> a connected planar simple graph, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> has a vertex of degree not exceeding five.</p>
<p>The main idea in proof: Every face has at least 3 edges no its boundary. Every edge lies on the boundary of at most 2 faces Thus <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">2</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></p>
</li>
<li>
<p>If a connected planar simple graph has <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> edges and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> vertices with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> and no circuit of length three, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></p>
</li>
</ul>
<h3 id="kuratowski-theorem"><a class="header" href="#kuratowski-theorem">Kuratowski Theorem</a></h3>
<h4 id="kuratowski-graph"><a class="header" href="#kuratowski-graph">Kuratowski Graph</a></h4>
<p>Kuratowski graphs are two typically non-planar graphs.</p>
<p><img src="discrete-math/./assets/kuratowski-graph-20221120150711-hjoqnax.png" alt="" /></p>
<p>In the Kuratowski graph, we can find that:</p>
<ul>
<li>If we replace edges in a Kuratowski graph by paths of whatever length, they remain non-replace.</li>
<li>If a graph contains a subgraph obtained by starting with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> and replacing edges with paths, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is non-planar.</li>
</ul>
<h4 id="homeomorphic-graph"><a class="header" href="#homeomorphic-graph">Homeomorphic Graph</a></h4>
<p>If a graph is planar, so will be any graph obtained by removing an edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">}</span></span></span></span> and adding a new vertex <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> with edges <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">}</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">}</span></span></span></span> . Such an operation is called an <strong>elementary subdivision</strong> .</p>
<p>The graphs are called <strong>homeomorphic</strong> if they are obtained from the same graph by a sequence of elementary subdivisions.</p>
<h4 id="kuratowski-theorem-1"><a class="header" href="#kuratowski-theorem-1">Kuratowski Theorem</a></h4>
<p>A graph is planar if and only if it contains no subgraph obtained from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> or <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> by replacing edges with paths.</p>
<h2 id="graph-coloring"><a class="header" href="#graph-coloring">Graph Coloring</a></h2>
<blockquote>
<p>Lead in: four colors are always enough to color any map drawn on a plane.</p>
</blockquote>
<h3 id="coloring-graphs"><a class="header" href="#coloring-graphs">Coloring graphs</a></h3>
<p>Suppose that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span> is a graph without no multiple edges, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span></span></span></span></span> is any set of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> colors. Any function <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is called <strong>a coloring of the graph ​<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>​ using ​<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>​ colors</strong>.</p>
<p>A coloring is proper if any two adjacent vertices <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span> have different colors. The smallest number of colors needed to produce a proper coloring of a graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is called the <strong>chromatic number of ​<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span></strong>, which is denoted by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">χ</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>.</p>
<h3 id="four-color-theorem"><a class="header" href="#four-color-theorem">Four-color Theorem</a></h3>
<p>The vertices of ant planar graph can be 4-colored in such a way that no two adjacent vertices receive the same color.</p>
<blockquote>
<p>This is hard to prove.</p>
</blockquote>
<h3 id="five-color-theorem"><a class="header" href="#five-color-theorem">Five-Color Theorem</a></h3>
<p>Any planar graph can be colored with five colors.</p>
<h4 id="prove"><a class="header" href="#prove">Prove</a></h4>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> be a node-minimal counter-example to the theorem, for example,  a planar graph that requires 6 colros.</p>
<p>As <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is a planar graph, we can get <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> must have a node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> with degree <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5</span></span></span></span>. Let the nodes adjacent to q be named as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and this five nodes can not form <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, also because this is a planar graph. So there must be two vertices <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in this five vertices that have no edge between them.</p>
<p>So we can "contract" the edges <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> to get a new planar graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>, and the vertices <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span> become a new vertices in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>.  <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> is 5 colorable since it has fewer nodes than <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>, so we can find that we color the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> using the five colors in the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>, which meaning the counter example is not counter.</p>
<h3 id="applications-of-graph-coloring"><a class="header" href="#applications-of-graph-coloring">Applications of Graph Coloring</a></h3>
<ul>
<li>Fifteen different foods are to be held in refrigerated compartments within the same refrigator.</li>
<li>How can the final exams be scheduled at a university so that no students has two exams at the same time.</li>
<li>Frequency assignment. we need to assign different radio frequency to two radio station whose distance is to short.</li>
</ul>
<h2 id="chromatic-polynomials"><a class="header" href="#chromatic-polynomials">Chromatic Polynomials</a></h2>
<p>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>  is a graph and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> is an integer, let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> be the number of ways to color <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> properly using <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> or fewer colors.<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> is called the chromatic polynomials. And if we can find the chromatic polynomials ,we can easily get the chromatic number of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<p>For example, for a linear graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, we have the chromatic polynomials <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>,  so <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>, so <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">χ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>.</p>
<h3 id="theorem-1-1"><a class="header" href="#theorem-1-1">Theorem 1</a></h3>
<p>If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is disconnected graph with components <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, then <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> is the product of the chromatic polynomials for each components.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="subgraph-and-quotient-graphs"><a class="header" href="#subgraph-and-quotient-graphs">Subgraph and Quotient Graphs</a></h3>
<p>One of the most important subgraphs is the one that arises by deleting one edge and no vertices. If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span> is a graph and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>, then we denote by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> the subgraph obtained by omitting the edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span> and keeping all vertices.</p>
<p>Suppose that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span> is a graph without multiple edges between the same vertices and that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> is an equivalence relation on the set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>. Construct the quotient graphs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span> as follow: The vertices of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span> are the equivalence classes of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> produced by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>. If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span> are the equivalence classes of vertices <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>, then there is an edge in 	<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span> from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span> if and only if some vertices in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">]</span></span></span></span> is connected to sone vertices in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span> in the graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<h3 id="theorem-2-1"><a class="header" href="#theorem-2-1">Theorem 2</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span> be a graph without multiple edges, and let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>, say <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">}</span></span></span></span>. So we have <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, subgraph obtained by deleting <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span>, the quotient graph of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> obtained by merging  the end points of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span>. And then with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> colors:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5935em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="transport-networks"><a class="header" href="#transport-networks">Transport Networks</a></h2>
<p>An important use of labeled graph is to model what are commonly called transport networks. The label on an edge represents the maximum flow that can be passed through that edge and is called the capacity of the edge.</p>
<h3 id="transport-network"><a class="header" href="#transport-network">Transport Network</a></h3>
<p>A transport network,  or a network, is a connected digraph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> with the following properties:</p>
<ul>
<li>There is a unique node, the source, that has in-degree 0. We always label the source with node 1.</li>
<li>There is a unique node, the sink, that has out-degree 0. If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> has n nodes, and we always label the sink with node n.</li>
<li>The graph <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is labeled. The label, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, on edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> is a nonnegative number called the capacity of the edge.</li>
</ul>
<h4 id="flow"><a class="header" href="#flow">Flow</a></h4>
<p>A flow in a network is a function that assigns to each edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> a nonnegative number <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> that does not exceed <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p>And when talking about flow, we have:</p>
<ul>
<li>Conservation of flow</li>
<li>Value of flow</li>
</ul>
<p>For any network, an important question is to determine the maximum value of a flow through the network and to describe a flow that has the maximum value.</p>
<p>Although edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> is not in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, there is no harm in consideration such a virtual flow as long as it only has effect of reducing the existing flow in the actual edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>)</p>
<h3 id="labeling-algorithm"><a class="header" href="#labeling-algorithm">Labeling Algorithm</a></h3>
<p>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> be a network with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> nodes and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> be the symmetric closure of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>. All edges and paths used are in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>.</p>
<ul>
<li>Begin with all flows set to 0.</li>
<li>As we proceed, it will be convenient to track the excess capacities in the edges and how they change rather than tracking the increasing flows.</li>
<li>When the algorithm terminates, it is easy to find the maximum flow from the final excess capacities.</li>
</ul>
<h4 id="step-1"><a class="header" href="#step-1">STEP 1</a></h4>
<ul>
<li>Let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the set of all nodes connected to the source by an edge with positive excess capacities.</li>
<li>Label each node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> is the excess capacity <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> of edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>. The 1 in the label indicates that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> is connected to the source, node 1.</li>
</ul>
<h4 id="step-2"><a class="header" href="#step-2">STEP 2</a></h4>
<ul>
<li>
<p>Let node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be the node with the smallest node number  and let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> be the set of all unlabeled nodes,</p>
<p>other than the source and those are joined to node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> and have positive excess capacity.</p>
</li>
<li>
<p>Suppose that node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> is in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span> is the edge with positive excess capacity. Label node <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the minimum of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> and the excess capacity <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">jk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> of edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span>.</p>
</li>
<li>
<p>When all the nodes in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> are all labeled in this way, repeat this process for the other nodes in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Let</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.109em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span></p>
</li>
</ul>
<h4 id="step-3"><a class="header" href="#step-3">STEP 3</a></h4>
<ul>
<li>
<p>Repeat Step 2 , labeling all previously unlabeled nodes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> that can be reached from a node in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> by an edge having positive excess capacity.</p>
</li>
<li>
<p>Continue this process forming  sets <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, ... until after a finite number or steps</p>
</li>
<li></li>
<li>
<p>either the sink has not been labeled and no other nodes can be labeled. It can happened that no nodes have been labeled; remember that the source is not labeled or the sink has been reached.</p>
<p>In this case, the algorithm terminates and the total flow is a maximum flow.</p>
</li>
<li>
<p>or the sink has been labeled.</p>
<p>In this case,  the sink has been labeled with <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span> where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the amount of extra flow that can be made to reach the sink through the path.</p>
</li>
</ul>
<h4 id="step-4"><a class="header" href="#step-4">STEP 4</a></h4>
<p>We examine the path in reverse:</p>
<ul>
<li>If edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, we increase the flow in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>  and decrease the excess capacity <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> by the sam amount. Simultaneously, we increase excess capacity of the virtual edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></li>
<li>If  on the other hand , edge <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, we decrease the flow in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> and increase its excess capacity. Same as before, decrease the excess capcaity in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<p>Back to the step 1.</p>
<blockquote>
<p>What a complex algorithm!</p>
</blockquote>
<h3 id="cut"><a class="header" href="#cut">Cut</a></h3>
<p>A cut in a network is a set <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> of edges having the property that every path from the source to the sink contains at least one edge from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>.</p>
<p>The capacity of a cut <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is the sum of the capacities of all edges in <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>. If <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> is any flow and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> is any cut, there must be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span></span></span></span>.</p>
<p>And we have a theorem that a maximum flow <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> in a network has value equal to the capacity of a minimum cut of the network.</p>
<h3 id="super-source--super-sink"><a class="header" href="#super-source--super-sink">Super Source &amp; Super Sink</a></h3>
<p>When we meet a network with sources or sinks more than one, we can add a virtual source or virtual sink to use the labeling algorithm, which is connected with the real source and sink with large enough edge. These virtual source and sink is are called super source and super sink.</p>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="形式语言与自动机笔记"><a class="header" href="#形式语言与自动机笔记">形式语言与自动机笔记</a></h1>
<p>大二下学期专业课 《形式语言与自动机》课程笔记。</p>
<p>授课教师：<a href="http://shichuan.org/">石川</a></p>
<p>笔记贡献者：<a href="https://github.com/112292454">112292454</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="有限自动机"><a class="header" href="#有限自动机">有限自动机</a></h1>
<h2 id="dfanfaϵnfare的互相转换"><a class="header" href="#dfanfaϵnfare的互相转换"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NF</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mord mathnormal" style="margin-right:0.13889em;">NF</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">RE</span></span></span></span>的互相转换</a></h2>
<p><img src="formal-language/./assets/image-20230418021019905.png" alt="image-20230418021019905" /></p>
<h3 id="①-p49nfa转dfa"><a class="header" href="#①-p49nfa转dfa">① P49：NFA转DFA</a></h3>
<p>T：不变</p>
<p>Q及<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span>：从NFA的初始状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>开始，将某个状态q接受某个字符x所可能转移到的状态合并到一个状态中，作为DFA的Q中一个新状态，这个转移规则作为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span>的一项</p>
<p>F：构造完上述步骤之后，遍历DFA的Q，只要含有NFA的F中任意一个的状态，都是DFA的F</p>
<p>​		如：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>经a可能得<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，经b得<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则构造状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>、<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>加入到DFA的状态。然后再对<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>中的两个状态分别使用字符a进行推断，将得到的状态如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>放在一起作为一个新的状态。如此循环，直至不再出现新的状态。而NFA的终结状态为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则只要含有状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，就是DFA的终结状态</p>
<p>例：</p>
<p><img src="formal-language/./assets/image-20230418010318487.png" alt="image-20230418010318487" /></p>
<p><img src="formal-language/./assets/image-20230418010359247.png" alt="image-20230418010359247" /></p>
<p><img src="formal-language/./assets/image-20230418010408625.png" alt="image-20230418010408625" /></p>
<h3 id="②-p54ϵnfa转nfa"><a class="header" href="#②-p54ϵnfa转nfa">② P54：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NF</span><span class="mord mathnormal">A</span></span></span></span>转NFA</a></h3>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: 若<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">os</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span></span></span>闭包包含了原本F里的任意状态，则<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为 F并<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，否则就是原本的F</p>
<p>Q、T、<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：不变</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：<strong>重点。</strong></p>
<p>​		对于某一条转换规则<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>，</p>
<ul>
<li>
<p>（在原先的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>-NFA中）先去寻找<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">os</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span></span></span>，</p>
</li>
<li>
<p>然后对这个闭包里的每一个状态都输入字符a（有可能某个状态不接受a，那么它的转换结果就是空集，不写出来），</p>
</li>
<li>
<p>再把得到的这个状态集里的每一个状态都求一遍<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">os</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span></span></span>，结果取并集，</p>
</li>
<li>
<p>然后对原先所有的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span>都走如上的流程，就得到新的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0379em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</p>
</li>
</ul>
<p>更直观的描述就是把<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>不接受任何字符就能达到的状态作为起始（取第一个<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">os</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span></span></span>），然后用他去接收字符a（推一步），然后把结果状态及其空转换的状态作为结果（取第二个<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">os</span><span class="mord mathnormal">u</span><span class="mord mathnormal">re</span></span></span></span>）</p>
<p>例：</p>
<p><img src="formal-language/./assets/image-20230418012034814.png" alt="image-20230418012034814" /></p>
<h3 id="③-p60re转nfa"><a class="header" href="#③-p60re转nfa">③ P60：RE转NFA</a></h3>
<p>根据如下三种规则构造即可</p>
<ul>
<li><img src="formal-language/./assets/image-20230418012419839.png" alt="image-20230418012419839" /></li>
<li><img src="formal-language/./assets/image-20230418022001144.png" alt="image-20230418022001144" /></li>
<li><img src="formal-language/./assets/image-20230418012447034.png" alt="image-20230418012447034" /></li>
</ul>
<p>值得一提的是，此处图中构造的是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">NF</span><span class="mord mathnormal">A</span></span></span></span>，如果不特别要求的话，完全可以直接构造NFA，此时还能大大化简上图（比如<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，可以只有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的两部分）</p>
<h3 id="④-p62dfa构造正则式"><a class="header" href="#④-p62dfa构造正则式">④ P62：DFA构造正则式</a></h3>
<p>首先对于每一个终态q，化简初态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>到q的路径上的状态（这里只关注<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>到特定q的路径，路上的某个状态是不是可以去另外的某个终态是不关心的，可以当它那条边不存在）</p>
<p>将③中的规则逆过来即可</p>
<p>概括性的，如（糊了，是左上角的到右上角的状态）<img src="formal-language/./assets/image-20230418013527928.png" alt="image-20230418013527928" /></p>
<p>化简到类似下图（a）的形式，套公式构造即可</p>
<p><img src="formal-language/./assets/image-20230418013010327.png" alt="image-20230418013010327" /></p>
<ul>
<li>形如（a）的，表示为 <strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></strong></li>
<li>形如（b）的，表示为 <strong><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6887em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></strong></li>
</ul>
<p>至此，以上四者的相互转换就完成了，一些没有列出的途径可以多用几次上述来间接的完成，比如从NFA得到一个正则式，可以先走①变成DFA，然后走④变成正则式——当然，如果熟练也可以直接完成转换，这里是纯粹只用书上讲过的方法来完成</p>
<h2 id="加入文法的转换"><a class="header" href="#加入文法的转换">加入文法的转换</a></h2>
<p><img src="formal-language/./assets/image-20230418021135976.png" alt="image-20230418021135976" /></p>
<h3 id="⑤-p56右线性文法转re"><a class="header" href="#⑤-p56右线性文法转re">⑤ P56：右线性文法转RE</a></h3>
<p>直接带入公式即可</p>
<p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">设</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">αx</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9331em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">其解</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9331em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span></p>
<p>唯一需要注意的一点是，一定要<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">αx</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，不要看到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>就直接带入公式了。得要都是相同的非终结符，不能一个是S一个是A，那样子的不能用这个。另外注意<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord cjk_fallback">和</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>的定义</p>
<p>例：</p>
<p><img src="formal-language/./assets/image-20230418015523220.png" alt="image-20230418015523220" /></p>
<h3 id="⑥-p63-64-右线性文法转nfa"><a class="header" href="#⑥-p63-64-右线性文法转nfa">⑥ P63-64： 右线性文法转NFA</a></h3>
<p>如图即可</p>
<p><img src="formal-language/./assets/image-20230418022202561.png" alt="image-20230418022202561" /></p>
<h3 id="⑦-p65dfa转右线性文法"><a class="header" href="#⑦-p65dfa转右线性文法">⑦ P65：DFA转右线性文法</a></h3>
<p>终结符T：字母表T</p>
<p>非终结符N：状态集Q</p>
<p>初始字符S：初始状态<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>生成式P：如下</p>
<p>​		<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">当</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">则有</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></p>
<p>​		<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">当</span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">，且</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">则有</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></p>
<p>​		此外，根据文法会不会有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>，可能结果会不一样，但是可以推出空串的往往更简洁</p>
<p>至此，3.8节及之前可以构建成系统的内容就概括完了</p>
<h2 id="其他内容"><a class="header" href="#其他内容">其他内容</a></h2>
<p>暂 略</p>
<h3 id="泵浦引理"><a class="header" href="#泵浦引理">泵浦引理</a></h3>
<p><img src="formal-language/./assets/image-20230620191731431.png" alt="image-20230620191731431" /></p>
<p>例：<img src="formal-language/./assets/image-20230620191929970.png" alt="image-20230620191929970" style="zoom:67%;" /></p>
<h3 id="自动机的最小化填表法"><a class="header" href="#自动机的最小化填表法">自动机的最小化：填表法</a></h3>
<img src="formal-language/./assets/image-20230620192010372.png" alt="image-20230620192010372" style="zoom:67%;" />
<p>首先在终结状态和非终结状态的状态对应的格子里标X，他们显然可以区分。</p>
<p>其次，如果两个状态同时通过一个符号（比如a）可以走到一对可区分的状态上，那么也标上X。</p>
<p>如果他们走到的状态不是已知可区分的，就记录下来，直到填完整个标，如果还是不能断定他们可区分，那就是不可区分的，合为一个状态。注意，这个过程中，记录下来他们通过每一个符号（a、b、c……）走到的一对状态，其中任意一对可区分就认为他们也可区分</p>
<h3 id="米兰机与摩尔机"><a class="header" href="#米兰机与摩尔机">米兰机与摩尔机</a></h3>
<h1 id="下推自动机"><a class="header" href="#下推自动机">下推自动机</a></h1>
<ul>
<li>最左/最右推导：每次将最左/右的非终结符进行一次推导</li>
<li>二义性：同一个字符串可以由两颗不同但边缘相同（从左到右叶子结点相同）的树得出</li>
</ul>
<h2 id="上下文无关文法cfl的变换"><a class="header" href="#上下文无关文法cfl的变换">上下文无关文法CFL的变换</a></h2>
<h3 id="1消除无用符号"><a class="header" href="#1消除无用符号">1、消除无用符号</a></h3>
<ul>
<li>找出有用非终结符：找出所有能直接或间接<strong>推出终结符串的非终结符</strong>作为有用符号</li>
<li>找出有用符号：找出所有<strong>从S直接或间接可达的符号</strong>（包括终结符和非终结符）作为有用符号</li>
</ul>
<p>例：<img src="formal-language/./assets/image-20230620143922837.png" alt="image-20230620143922837" style="zoom:67%;" /></p>
<p><img src="formal-language/./assets/image-20230620143936603.png" alt="image-20230620143936603" /></p>
<p>（注意，如第一题，C不能推出终结符，所以后面从S出发的时候，<strong>含有</strong>C的式子<strong>都</strong>直接扔掉）</p>
<h3 id="2消除ϵ生成式"><a class="header" href="#2消除ϵ生成式">2、消除<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>生成式</a></h3>
<p><img src="formal-language/./assets/image-20230620144320351.png" alt="image-20230620144320351" /></p>
<p>即，若<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.04398em;">yz</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span></span></span></span>，则枚举ABC中可能为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>的元素为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>的情况。即，若ABC都有可能推出空，那就枚举均不为空、A为空、b为空……AB为空……ABC为空（如果都为空的情况下是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>就不写出来了）的8种情况</p>
<p>且，如果S也可以推出<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>，就加入一个<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>作为起始符，并特别写明它可以推出原S或<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></p>
<p>例：<img src="formal-language/./assets/image-20230620144941089.png" alt="image-20230620144941089" /></p>
<p><img src="formal-language/./assets/image-20230620144923761.png" alt="image-20230620144923761" /></p>
<h3 id="3消除单生成式"><a class="header" href="#3消除单生成式">3、消除单生成式</a></h3>
<p><img src="formal-language/./assets/image-20230620145336114.png" alt="image-20230620145336114" /></p>
<p>但是讲的不是很好用</p>
<p>速通：对于<img src="formal-language/./assets/image-20230620145517887.png" alt="image-20230620145517887" />，S可以推出A，是一个单生成式，那就把A带入，得到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>，现在S推出B还是，继续带入，得到<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal">a</span></span></span></span></p>
<p>对于循环的问题，如<img src="formal-language/./assets/image-20230620150106967.png" alt="image-20230620150106967" style="zoom: 50%;" /></p>
<p>S可以推出<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，它们也都可以再推出S。所以将S可以推出非终结符的集合记作<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中的非终结符的非单生成式结果才是S可以推出的结果（即如果<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>里有单生成式，不填给S）</p>
<h3 id="4消除左递归"><a class="header" href="#4消除左递归">4、消除左递归</a></h3>
<p>省流：<img src="formal-language/./assets/image-20230620150519885.png" alt="image-20230620150519885" /></p>
<ul>
<li>
<p>非终结符排序：若A推出的式子里，第一个符号有B，那B排在A的后面。下一步时先从最后面的开始变换，然后带回到前面的式子里再变换<img src="formal-language/./assets/image-20230620153455011.png" alt="image-20230620153455011" /></p>
</li>
<li>
<p><img src="formal-language/./assets/image-20230620152213752.png" alt="image-20230620152213752" />
即，将原本的非左递归式<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>取出来保留在A的生成式，然后将他们的每一个再写作<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，而A'是将原本左递归的一项变成两项：删除左递归的A，和将这个A移到后面 的两个生成式。
即：<img src="formal-language/./assets/image-20230620152659262.png" alt="image-20230620152659262" /></p>
<p>或<img src="formal-language/./assets/image-20230620153310957.png" alt="image-20230620153310957" /></p>
<p>（A3A4A5不包含A2，所以和b同样地位处理）</p>
</li>
</ul>
<p><strong>使用顺序：先消<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>，再消单生成式，再消无用符号</strong></p>
<h3 id="cnf范式的转换"><a class="header" href="#cnf范式的转换">CNF范式的转换</a></h3>
<p><img src="formal-language/./assets/image-20230620151621318.png" alt="image-20230620151621318" /></p>
<p>用上面三步跑完，然后把长度大于2的生成式两个一分即可（注意，A推出aa这种式子要写成A推出BB，B推出a才行）</p>
<p>例：</p>
<p><img src="formal-language/./assets/image-20230620151349896.png" alt="image-20230620151349896" /></p>
<h3 id="gnf范式的转换"><a class="header" href="#gnf范式的转换">GNF范式的转换</a></h3>
<p><img src="formal-language/./assets/image-20230620151638866.png" alt="image-20230620151638866" /></p>
<p>即，在前三个算法之后，再消除左递归，带入使其符合上面概念</p>
<h2 id="下推自动机-1"><a class="header" href="#下推自动机-1">下推自动机</a></h2>
<h3 id="定义-1"><a class="header" href="#定义-1">定义</a></h3>
<p><img src="formal-language/./assets/image-20230620162900508.png" alt="image-20230620162900508" /></p>
<img src="formal-language/./assets/image-20230620165320234.png" alt="image-20230620165320234" style="zoom:67%;" />
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span>表示在状态q，读入a，栈顶为Z时，转成状态p，栈顶变为r。等价于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">aω</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span></span></span></span>的格局推导。</p>
<img src="formal-language/./assets/image-20230620165706286.png" alt="image-20230620165706286" style="zoom:67%;" />
<p>终态接受必然可以变成空栈接受</p>
<h2 id="cfl转pda"><a class="header" href="#cfl转pda">CFL转PDA</a></h2>
<p><img src="formal-language/./assets/image-20230620170038523.png" alt="image-20230620170038523" /></p>
<p>即，将每一个非终结符X推导出<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>都写成一条<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>边；将每个终结符都写一个可以抵消的转移边(<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">ϵ</span></span></span></span>)。</p>
<p><img src="formal-language/./assets/image-20230620170211660.png" alt="image-20230620170211660" /></p>
<p>或：<img src="formal-language/./assets/image-20230620170325252.png" alt="image-20230620170325252" style="zoom:50%;" /></p>
<p>PDA的边，即：状态q到状态p的边上，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>，表示：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span></span></span></span>。即状态q，<strong>读入a，栈顶就从B变为<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></strong>。</p>
<h2 id="cfl的泵浦引理"><a class="header" href="#cfl的泵浦引理">CFL的泵浦引理</a></h2>
<p><img src="formal-language/./assets/image-20230620174558367.png" alt="image-20230620174558367" /></p>
<ul>
<li>取一常数p，构造一个特殊的语言L的字符串长度大于p，且可以切分，分出来的结果中，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>长度<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>非空</li>
<li>讨论<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的位置的情况，证明：存在一个特定的字符串中，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>在所有位置的情况都不能满足<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>重复任意次仍属于语言L（或者无关位置的话就证明长度之类的，这种不用分类讨论）</li>
</ul>
<p>例：</p>
<p><img src="formal-language/./assets/image-20230620175034395.png" alt="image-20230620175034395" /></p>
<p><img src="formal-language/./assets/image-20230620175054257.png" alt="image-20230620175054257" /></p>
<p><img src="formal-language/./assets/image-20230620175103775.png" alt="image-20230620175103775" /></p>
<p>或<img src="formal-language/./assets/image-20230620175130579.png" alt="image-20230620175130579" /></p>
<p><img src="formal-language/./assets/image-20230620175138988.png" alt="image-20230620175138988" /></p>
<p>（这里关键是构造x为特殊的形态：<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span></span></span>，只要这一个不满足引理就可以说明他不是CFL了）</p>
<h1 id="图灵机"><a class="header" href="#图灵机">图灵机</a></h1>
<h2 id="定义-2"><a class="header" href="#定义-2">定义</a></h2>
<p><img src="formal-language/./assets/image-20230620161341941.png" alt="image-20230620161341941" /></p>
<p>用<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>描述图灵机的瞬间工作状态，表示读写头正扫描w2的最左字符</p>
<p><img src="formal-language/./assets/image-20230620161530388.png" alt="image-20230620161530388" /></p>
<p>即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span>表示读头如果在状态q时读到Xi，那么将Xi修改为Y，并且状态变为p，同时读头左移一格（R就是右移）</p>
<h2 id="例题"><a class="header" href="#例题">例题</a></h2>
<p>1、</p>
<p><img src="formal-language/./assets/image-20230620161758596.png" alt="image-20230620161758596" /></p>
<p>自动机图中，<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">到</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的边上写<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>或<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span></span></span></span>表示“若读头在状态q0读入了a，就在a的地方写上X，然后右移一格，状态变为q1”，即<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span></p>
<p>2、</p>
<p><img src="formal-language/./assets/image-20230620162100770.png" alt="image-20230620162100770" /></p>
<p>对于这种，思想就是0读一个，改写为X；然后右移把1读一个，改写Y；然后右移把2读一个，改写Z；然后一直移到左边，读一个0，循环。最后没0了，就跑到最右边，看是不是B（即为空），是B就能接受（能停机）。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机教学中消失的一学期学习笔记"><a class="header" href="#计算机教学中消失的一学期学习笔记">"计算机教学中消失的一学期"学习笔记</a></h1>
<p>该系列是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记，一共十篇笔记，对应该课程的十次课。该课程在Github上已经被翻译为了中文，地址为<a href="https://missing-semester-cn.github.io/">计算机教育中缺失的一课</a>。</p>
<p>在前面的部分课程中，我附上了对应习题的解答，<del>后面的摸了</del>。</p>
<blockquote>
<p>该系列首次发布在我的博客，在知识库网站搭建起来之后，就被搬运到了这里</p>
</blockquote>
<p>‍</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs"><a class="header" href="#the-missing-semester-in-the-cs">The missing semester in the CS</a></h1>
<h2 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第一篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇为<code>Shell</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/course-shell/">Course-Shell</a></p>
<!--more-->
<h2 id="what-is-the-shell"><a class="header" href="#what-is-the-shell">what is the shell?</a></h2>
<p>Run programs, give them input, and inspect their output in a semi-structured way.</p>
<p>This course will introduce the bash, Bourne Again Shell. To run open a shell prompt(where you can type commands),  you first need a <em>terminal</em>.</p>
<blockquote>
<p>我在Windows的Windows Subsystem for linux里学习这个玩意儿</p>
</blockquote>
<h2 id="using-the-shell"><a class="header" href="#using-the-shell">Using the shell</a></h2>
<pre><code class="language-bash">ricardo@g15:~$
</code></pre>
<p>The main textual interface to the shell. The "missing" means you are in the machine "missing", and your "current working directory". or where you currently are, is <code>~</code>(short for home).</p>
<p>At this prompt you can type a <em>command</em>, which will then be interpreted by the shell.</p>
<pre><code class="language-bash">ricardo@g15:~$ date
Sun Mar 27 21:51:49 CST 2022
ricardo@g15:~$
</code></pre>
<p>The shell parses the command by splitting it by whitespace, and then runs the program indicated by the first word, supplying each subsequent word as an argument that the program can access. If you want to provide an argument that contains spaces or other special characters (like a directory named “My Photos”), you can either quote the argument with <code>'</code> or <code>"</code> (<code>"My Photos"</code>), or escape just the relevant characters with <code>\</code> (<code>My\ Photos</code>).</p>
<p>the shell is a programming environment, just like Python or Ruby, and so it has variables, conditionals, loops, and functions. When you run commands in your shell, you are really writing a small bit of code that your shell interprets. If the shell is asked to execute a command that doesn’t match one of its programming keywords, it consults an <em>environment variable</em> called <code>$PATH</code> that lists which directories the shell should search for programs when it is given a command:</p>
<pre><code class="language-bash">ricardo@g15:~$ echo $PATH
/home/ricardo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib
ricardo@g15:~$ which echo
/usr/bin/echo
ricardo@g15:~$ /usr/bin/echo $PATH
/home/ricardo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib
</code></pre>
<p>When we run the <code>echo</code> command, the shell sees that it should execute the program <code>echo</code>, and then searches through the <code>:</code>-separated list of directories in <code>$PATH</code> for a file by that name. When it finds it, it runs it (assuming the file is <em>executable</em>; more on that later). We can find out which file is executed for a given program name using the <code>which</code> program. We can also bypass <code>$PATH</code> entirely by giving the <em>path</em> to the file we want to execute.</p>
<h2 id="navigating-in-the-shell"><a class="header" href="#navigating-in-the-shell">Navigating in the shell</a></h2>
<p>A path on the shell is a delimited(分隔的) list of directories; separated by <code>/</code> on Linux and macOS, where  the path <code>/</code> is the root of the file system, under which all directories and files lie.A path that starts with <code>/</code> is called an <em>absolute</em> path. Any other path is a <em>relative</em> path. Relative paths are relative to the current working directory, which we can see with the <code>pwd</code> command and change with the <code>cd</code> command. In a path, <code>.</code> refers to the current directory, and <code>..</code> to its parent directory.</p>
<pre><code class="language-bash">ricardo@g15:~$ pwd
/home/ricardo
ricardo@g15:~$ cd /home
ricardo@g15:/home$ cd ..
ricardo@g15:/$ pwd
/
ricardo@g15:/$ cd ./home/
ricardo@g15:/home$ pwd
/home
ricardo@g15:/home$ cd missing
-bash: cd: missing: No such file or directory
ricardo@g15:/home$ cd ricardo/
ricardo@g15:~$ pwd
/home/ricardo
ricardo@g15:~$ ../../usr/bin/echo hello
hello
</code></pre>
<p>In general, when we run a program, it will operate in the current directory unless we tell it otherwise. For example, it will usually search for files there, and create new files there if it needs to.</p>
<p>To see what lives in a given directory, we use the <code>ls</code> command</p>
<pre><code class="language-bash">ricardo@g15:~$ ls
bin  code  download  github  tmp
ricardo@g15:~$ cd ..
ricardo@g15:/home$ ls
ricardo
ricardo@g15:/home$ cd ..
ricardo@g15:/$ ls
bin  boot  build  dev  etc  home  init  lib  lib32  lib64  libx32  lost+found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var
</code></pre>
<p>Unless a directory is given as its first argument, <code>ls</code> will print the contents of the current directory.</p>
<p>Most commands accept flags and options (flags with values) that start with <code>-</code> to modify their behavior. Usually, running a program with the <code>-h</code> or <code>--help</code> flag will print some help text that tells you what flags and options are available.</p>
<p>For example, <code>ls --help</code> tells us</p>
<pre><code class="language-bash">  -l                         use a long listing format
</code></pre>
<pre><code class="language-bash">ricardo@g15:/$ ls -l /home
total 4
drwxr-xr-x 15 ricardo ricardo 4096 Mar 25 19:14 ricardo
</code></pre>
<p>This gives us a bunch more information about each file or directory present. First, the <code>d</code> at the beginning of the line tells us that <code>ricardo</code> is a directory. Then follow three groups of three characters (<code>rwx</code>). These indicate what permissions the owner of the file (<code>ricardo</code>), the owning group (<code>ricardo</code>), and everyone else respectively have on the relevant item. A <code>-</code> indicates that the given principal does not have the given permission. Above, only the owner is allowed to modify (<code>w</code>) the <code>ricardo</code> directory (i.e., add/remove files in it). To enter a directory, a user must have “search” (represented by “execute”: <code>x</code>) permissions on that directory (and its parents). To list its contents, a user must have read (<code>r</code>) permissions on that directory. For files, the permissions are as you would expect. Notice that nearly all the files in <code>/bin</code> have the <code>x</code> permission set for the last group, “everyone else”, so that anyone can execute those programs.</p>
<p>Some other handy programs to know about at this point are <code>mv</code> (to rename/move a file), <code>cp</code> (to copy a file), and <code>mkdir</code> (to make a new directory).</p>
<blockquote>
<p><code>mv</code>可以重命名大概就是把一个文件原地移动一下，移动的时候目标文件改个名（</p>
</blockquote>
<p>If you ever want <em>more</em> information about a program’s arguments, inputs, outputs, or how it works in general, give the <code>man</code> program a try. It takes as an argument the name of a program, and shows you its <em>manual page</em>. Press <code>q</code> to exit.</p>
<h2 id="connecting-programs"><a class="header" href="#connecting-programs">Connecting programs</a></h2>
<p>In the shell, programs have two primary “streams” associated with them: their input stream and their output stream. When the program tries to read input, it reads from the input stream, and when it prints something, it prints to its output stream. Normally, a program’s input and output are both your terminal. That is, your keyboard as input and your screen as output. However, we can also rewire those streams!</p>
<p>The simplest form of redirection is <code>&lt; file</code> and <code>&gt; file</code>. These let you rewire the input and output streams of a program to a file respectively:</p>
<pre><code class="language-bash">ricardo@g15:~$ echo hello &gt; hello.txt
ricardo@g15:~$ cat hello.txt
hello
ricardo@g15:~$ cat &lt; hello.txt
hello
ricardo@g15:~$ cat &lt; hello.txt &gt; hello2.txt
ricardo@g15:~$ cat hello2.txt
hello
</code></pre>
<p>Demonstrated(展示，证明) in the example above, <code>cat</code> is a program that con<code>cat</code>enates files. When given file names as arguments, it prints the contents of each of the files in sequence to its output stream. But when <code>cat</code> is not given any arguments, it prints contents from its input stream to its output stream (like in the third example above).</p>
<blockquote>
<p>上文中的<code>concatenate</code> 是一个单词，表示连接，这里的大概意思是表示cat的含义是连接</p>
</blockquote>
<p>You can also use <code>&gt;&gt;</code>to append to a file.</p>
<p>Where this kind of input/output redirection really shines is in the use of <em>pipes</em>. The <code>|</code> operator lets you “chain” programs such that the output of one is the input of another:</p>
<pre><code class="language-bash">ricardo@g15:~$ ls -l / | tail -n1
drwxr-xr-x  13 root root   4096 Apr 23  2020 var
ricardo@g15:~$ curl --head --silent baidu.com | grep --ignore-case content-length | cut --delimiter=' ' -f2
81
</code></pre>
<blockquote>
<p>在教程中是访问了google.com，我修改为baidu.com</p>
</blockquote>
<h2 id="a-versatile-and-powerful-tool"><a class="header" href="#a-versatile-and-powerful-tool">A versatile and powerful tool</a></h2>
<blockquote>
<p>versatile原义是指多才多艺的</p>
</blockquote>
<p>On most Unix-like systems, one user is special: the “root” user. You may have seen it in the file listings above. The root user is above (almost) all access restrictions, and can create, read, update, and delete any file in the system. You will not usually log into your system as the root user though, since it’s too easy to accidentally break something. Instead, you will be using the <code>sudo</code> command. As its name implies, it lets you “do” something “as su” (short for “super user”, or “root”). When you get permission denied errors, it is usually because you need to do something as root. Though make sure you first double-check that you really wanted to do it that way!</p>
<p>One thing you need to be root in order to do is writing to the <code>sysfs</code> file system mounted under <code>/sys</code>. <code>sysfs</code> exposes a number of kernel parameters as files, so that you can easily reconfigure the kernel on the fly without specialized tools.</p>
<blockquote>
<p>这里<code>sysfs</code>"将一系列内核的参数利用文件的形式暴露出来"体现了Unix"文件就是系统“的设计思想。</p>
</blockquote>
<blockquote>
<p>这里教程通过在<code>/sys/class/backlight</code>下属的文件中写值的方式改变亮度，但是我Linux环境中并没有这个文件，也就是我的Linux不支持调节亮度。</p>
</blockquote>
<blockquote>
<p>在这个例子中还提到了像<code>|</code>, <code>&gt;</code>, <code>&lt;</code>这类的操作是由shell程序来完成的，因此他们的执行权限仅仅是当前登录用户的权限，在写入一些需要高权限的文件是可能会出现<code>Permission denied</code></p>
</blockquote>
<h2 id="exercises"><a class="header" href="#exercises">Exercises</a></h2>
<ol>
<li>
<p>直接查看<code>$SHELL</code>变量就可以</p>
<pre><code class="language-bash">ricardo@g15:~$ echo $SHELL
/bin/bash
</code></pre>
</li>
<li>
<p>创建文件夹</p>
<pre><code class="language-bash">ricardo@g15:/tmp$ mkdir missing
</code></pre>
</li>
<li>
<p>查看<code>touch</code>命令的用法</p>
<pre><code class="language-bash">ricardo@g15:/tmp$ man touch
</code></pre>
<blockquote>
<p>touch 就是改变一个文件的最后修改时间，如果没有就是创建</p>
</blockquote>
</li>
<li>
<p>利用<code>touch</code>创建文件</p>
<pre><code class="language-bash">ricardo@g15:/tmp$ touch missing/semester
</code></pre>
</li>
<li>
<p>在文件中写入数据</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ touch semester
ricardo@g15:/tmp/missing$ echo '#!/bin/sh' &gt; semester
ricardo@g15:/tmp/missing$ echo curl --head --silent https://missing.csail.mit.edu &gt;&gt; semester
ricardo@g15:/tmp/missing$ cat semester
#!/bin/sh
curl --head --silent https://missing.csail.mit.edu
</code></pre>
</li>
<li>
<p>尝试直接运行文件，发现文件没有直接被执行的权限</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ ./semester
-bash: ./semester: Permission denied
ricardo@g15:/tmp/missing$ ll
total 32
drwxr-xr-x 2 ricardo ricardo  4096 Mar 28 08:47 ./
drwxrwxrwt 7 root    root    20480 Mar 28 08:38 ../
-rw-r--r-- 1 ricardo ricardo    61 Mar 28 08:47 semester
</code></pre>
</li>
<li>
<p>利用指定的解释器运行写入的程序</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ sh ./semester
HTTP/2 200
server: GitHub.com
content-type: text/html; charset=utf-8
last-modified: Fri, 04 Mar 2022 17:03:44 GMT
access-control-allow-origin: *
etag: "62224670-1f37"
expires: Mon, 28 Mar 2022 00:59:14 GMT
cache-control: max-age=600
x-proxy-cache: MISS
x-github-request-id: 3814:0F07:F7E95E:1022BDD:62410609
accept-ranges: bytes
date: Mon, 28 Mar 2022 00:49:14 GMT
via: 1.1 varnish
age: 0
x-served-by: cache-itm18847-ITM
x-cache: MISS
x-cache-hits: 0
x-timer: S1648428554.944692,VS0,VE156
vary: Accept-Encoding
x-fastly-request-id: e71e5760a7ed66425c9ad2eb9572e5a12b23bee6
content-length: 7991
</code></pre>
</li>
<li>
<blockquote>
<p>chmod命令用于修改文件的权限</p>
</blockquote>
</li>
<li>
<p>修改文件的权限后直接执行</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ sudo chmod 777 semester
[sudo] password for ricardo:
ricardo@g15:/tmp/missing$ ll
total 32
drwxr-xr-x 2 ricardo ricardo  4096 Mar 28 08:47 ./
drwxrwxrwt 7 root    root    20480 Mar 28 08:38 ../
-rwxrwxrwx 1 ricardo ricardo    61 Mar 28 08:47 semester*
ricardo@g15:/tmp/missing$ ./semester
HTTP/2 200
server: GitHub.com
content-type: text/html; charset=utf-8
last-modified: Fri, 04 Mar 2022 17:03:44 GMT
access-control-allow-origin: *
etag: "62224670-1f37"
expires: Sun, 27 Mar 2022 14:38:22 GMT
cache-control: max-age=600
x-proxy-cache: MISS
x-github-request-id: 083A:17A2:291CE6:2F68B7:62407485
fastly-original-body-size: 0
accept-ranges: bytes
date: Mon, 28 Mar 2022 00:51:23 GMT
via: 1.1 varnish
age: 0
x-served-by: cache-hkg17932-HKG
x-cache: HIT
x-cache-hits: 1
x-timer: S1648428683.136854,VS0,VE260
vary: Accept-Encoding
x-fastly-request-id: 8271d76f868dc9951a9dc5b5d2b1da1d1ace0e89
content-length: 7991
</code></pre>
</li>
<li>
<p>用<code>grep</code>命令筛选指定的内容</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ ./semester | grep --ignore-case last-modified | cut --delimiter=':' -f2 &gt; /home/ricardo/last-modified.txt
ricardo@g15:/tmp/missing$ cat /home/ricardo/last-modified.txt
 Fri, 04 Mar 2022 17
</code></pre>
</li>
<li>
<blockquote>
<p>卡牌名称：WSL系统</p>
<p>卡牌效果:当遇到使用<code>sysfs</code>的题目时，打出此牌，即可跳过该回合</p>
</blockquote>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-1"><a class="header" href="#the-missing-semester-in-the-cs-1">The missing semester in the CS</a></h1>
<h2 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第二篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇为<code>Shell Tools and Scripting</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/shell-tools/">Shell-tools</a></p>
<!--more-->
<h2 id="shell-scripting"><a class="header" href="#shell-scripting">Shell Scripting</a></h2>
<p>Shell scripts are the next step in complexity. Most shells have their own scripting language with variables, control flow and its own syntax. What makes shell scripting different from other scripting programming language is that it is optimized for performing shell-related tasks. Thus, creating command pipelines, saving results into files, and reading from standard input are primitives in shell scripting, which makes it easier to use than general purpose scripting languages. For this section we will focus on bash scripting since it is the most common.</p>
<blockquote>
<p><code>primitive</code>表示原始人，原函数的意思，这里表示管道，保存到文件等等的工具是<code>bash</code>本来就有的，可以使在<code>bash</code>脚本中的工作更加顺利。</p>
</blockquote>
<p>To assign variables in bash, use the syntax <code>foo=bar</code> and access the value of the variable with <code>$foo</code>. Note that <code>foo = bar</code> will not work since it is interpreted as calling the <code>foo</code> program with arguments <code>=</code> and <code>bar</code>. In general, in shell scripts the space character will perform argument splitting. This behavior can be confusing to use at first, so always check for that.</p>
<p>Strings in bash can be defined with <code>'</code> and <code>"</code> delimiters, but they are not equivalent. Strings delimited with <code>'</code> are literal strings and will not substitute variable values whereas <code>"</code> delimited strings will.</p>
<blockquote>
<p><code>subsitute</code> 是“代替，替代”的意思。</p>
</blockquote>
<pre><code class="language-bash">ricardo@g15:~$ foo=bar
ricardo@g15:~$ echo "$foo"
bar
ricardo@g15:~$ echo '$foo'
$foo
</code></pre>
<blockquote>
<p>直接用<code>""</code>就可以进行字符串内插，还是非常方便的。</p>
</blockquote>
<p>As with most programming languages, bash supports control flow techniques including <code>if</code>, <code>case</code>, <code>while</code> and <code>for</code>. Similarly, <code>bash</code> has functions that take arguments and can operate with them. Bash uses a variety of special variables to refer to arguments, error codes, and other relevant variables. Below is a list of some of them.</p>
<ul>
<li><code>$0</code> Name of the script</li>
<li><code>$1</code> to <code>$9</code> - Arguments to the script. <code>$1</code> is the first argument and so on.</li>
<li><code>$@</code> - All the arguments</li>
<li><code>$#</code> - Number of arguments</li>
<li><code>$?</code> - Return code of the previous command</li>
<li><code>$$</code> - Process identification number (PID) for the current script</li>
<li><code>!!</code> - Entire last command, including arguments.</li>
<li><code>$_</code> - Last argument from the last command.</li>
</ul>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ date
Sat Apr  2 18:11:40 CST 2022
ricardo@g15:/tmp/missing$ !!
date
Sat Apr  2 18:11:42 CST 2022
ricardo@g15:/tmp/missing$ ls -l
total 8
-rwxrwxrwx 1 ricardo ricardo 61 Mar 28 08:47 semester
-rw-r--r-- 1 ricardo ricardo 34 Apr  2 18:07 shell.sh
ricardo@g15:/tmp/missing$ echo $_
-l
</code></pre>
<p>Commands will often return output using <code>STDOUT</code>, errors through <code>STDERR</code>, and a Return Code to report errors in a more script-friendly manner. A value of 0 usually means everything went OK; anything different from 0 means an error occurred.</p>
<p>Exit codes can be used to conditionally execute commands using <code>&amp;&amp;</code> (and operator) and <code>||</code> (or operator), both of which are short-circuiting operators. Commands can also be separated within the same line using a semicolon <code>;</code>. The <code>true</code> program will always have a 0 return code and the <code>false</code> command will always have a 1 return code.</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ false || echo "Oops, fail"
Oops, fail
ricardo@g15:/tmp/missing$ true || echo "Will not be printed"
ricardo@g15:/tmp/missing$ true &amp;&amp; echo "Things went well"
Things went well
ricardo@g15:/tmp/missing$ false &amp;&amp; echo "Will not be printed"
ricardo@g15:/tmp/missing$ true ; echo "This will always run"
This will always run
ricardo@g15:/tmp/missing$ false ; echo "This will always run"
This will always run
</code></pre>
<p>Another common pattern is wanting to get the output of a command as a variable. This can be done with <em>command substitution</em>. Whenever you place <code>$( CMD )</code> it will execute <code>CMD</code>, get the output of the command and substitute it in place.</p>
<pre><code class="language-bash">ricardo@g15:/tmp/missing$ cat shell.sh
#!/bin/bash

echo "Starting program at $(date)" # Date will be substituted

echo "Running program $0 with $# arguments with pid $$"

for file in "$@"; do
    grep foobar "$file" &gt; /dev/null 2&gt; /dev/null
    # When pattern is not found, grep has exit status 1
    # We redirect STDOUT and STDERR to a null register since we do not care about them
    if [[ $? -ne 0 ]]; then
        echo "File $file does not have any foobar, adding one"
        echo "# foobar" &gt;&gt; "$file"
    fi
done
ricardo@g15:/tmp/missing$ cat temp
foobar
ricardo@g15:/tmp/missing$ ./shell.sh
Starting program at Sat Apr  2 20:20:05 CST 2022
Running program ./shell.sh with 0 arguments with pid 10569
ricardo@g15:/tmp/missing$ ./shell.sh temp
Starting program at Sat Apr  2 20:20:16 CST 2022
Running program ./shell.sh with 1 arguments with pid 10573
ricardo@g15:/tmp/missing$ echo "foo" &gt; temp
ricardo@g15:/tmp/missing$ cat temp
foo
ricardo@g15:/tmp/missing$ ./shell.sh temp
Starting program at Sat Apr  2 20:21:15 CST 2022
Running program ./shell.sh with 1 arguments with pid 10577
File temp does not have any foobar, adding one
</code></pre>
<ul>
<li>Wildcards - Whenever you want to perform some sort of wildcard matching, you can use <code>?</code> and <code>*</code> to match one or any amount of characters respectively. For instance, given files <code>foo</code>, <code>foo1</code>, <code>foo2</code>, <code>foo10</code> and <code>bar</code>, the command <code>rm foo?</code> will delete <code>foo1</code> and <code>foo2</code> whereas <code>rm foo*</code> will delete all but <code>bar</code>.</li>
<li>Curly braces <code>{}</code> - Whenever you have a common substring in a series of commands, you can use curly braces for bash to expand this automatically. This comes in very handy when moving or converting files.</li>
</ul>
<p>Note that scripts need not necessarily be written in bash to be called from the terminal. The kernel knows to execute this script with a python interpreter instead of a shell command because we included a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">shebang</a> line at the top of the script. It is good practice to write shebang lines using the <a href="missing-semester/">env</a>`` command that will resolve to wherever the command lives in the system, increasing the portability of your scripts. To resolve the location, <code>env</code> will make use of the <code>PATH</code> environment variable we introduced in the first lecture. For this example the shebang line would look like <code>#!/usr/bin/env python</code>.</p>
<h2 id="shell-tools"><a class="header" href="#shell-tools">Shell Tools</a></h2>
<h3 id="finding-how-to-use-commands"><a class="header" href="#finding-how-to-use-commands">Finding how to use commands</a></h3>
<p>The first-order approach is to call said command with the <code>-h</code> or <code>--help</code> flags. A more detailed approach is to use the <code>man</code> command. Short for manual, <a href="missing-semester/">man</a>`` provides a manual page (called manpage) for a command you specify.</p>
<p>Sometimes manpages can provide overly detailed descriptions of the commands, making it hard to decipher what flags/syntax to use for common use cases. <a href="https://tldr.sh/">TLDR pages</a> are a nifty complementary solution that focuses on giving example use cases of a command so you can quickly figure out which options to use.</p>
<h3 id="finding-files"><a class="header" href="#finding-files">Finding files</a></h3>
<p>One of the most common repetitive tasks that every programmer faces is finding files or directories. All UNIX-like systems come packaged with <a href="missing-semester/">find</a>``, a great shell tool to find files. <code>find</code> will recursively search for files matching some criteria.</p>
<pre><code class="language-bash"># Find all directories named src
find . -name src -type d
# Find all python files that have a folder named test in their path
find . -path '*/test/*.py' -type f
# Find all files modified in the last day
find . -mtime -1
# Find all zip files with size in range 500k to 10M
find . -size +500k -size -10M -name '*.tar.gz'
# Delete all files with .tmp extension
find . -name '*.tmp' -exec rm {} \;
# Find all PNG files and convert them to JPG
find . -name '*.png' -exec convert {} {}.jpg \;
</code></pre>
<p>For instance, <a href="missing-semester/">fd</a>`` is a simple, fast, and user-friendly alternative to <code>find</code>. It offers some nice defaults like colorized output, default regex matching, and Unicode support.</p>
<p>Most would agree that <code>find</code> and <code>fd</code> are good, but some of you might be wondering about the efficiency of looking for files every time versus compiling some sort of index or database for quickly searching. That is what <a href="missing-semester/">locate</a><code> is for. `locate` uses a database that is updated using [updatedb]()</code>. In most systems, <code>updatedb</code> is updated daily via <a href="missing-semester/">cron</a>``. Therefore one trade-off between the two is speed vs freshness. Moreover <code>find</code> and similar tools can also find files using attributes such as file size, modification time, or file permissions, while <code>locate</code> just uses the file name.</p>
<h3 id="finding-code"><a class="header" href="#finding-code">Finding code</a></h3>
<p>A common scenario is wanting to search for all files that contain some pattern, along with where in those files said pattern occurs. To achieve this, most UNIX-like systems provide <a href="missing-semester/">grep</a>``, a generic tool for matching patterns from the input text.</p>
<h3 id="finding-shell-commands"><a class="header" href="#finding-shell-commands">Finding shell commands</a></h3>
<p>The first thing to know is that typing the up arrow will give you back your last command, and if you keep pressing it you will slowly go through your shell history.</p>
<p>The <code>history</code> command will let you access your shell history programmatically. It will print your shell history to the standard output. If we want to search there we can pipe that output to <code>grep</code> and search for patterns. <code>history | grep find</code> will print commands that contain the substring “find”.</p>
<p>In most shells, you can make use of <code>Ctrl+R</code> to perform backwards search through your history. After pressing <code>Ctrl+R</code>, you can type a substring you want to match for commands in your history. As you keep pressing it, you will cycle through the matches in your history.</p>
<p>Another cool history-related trick I really enjoy is <strong>history-based autosuggestions</strong>. First introduced by the <a href="https://fishshell.com/">fish</a> shell, this feature dynamically autocompletes your current shell command with the most recent command that you typed that shares a common prefix with it. It can be enabled in <a href="https://github.com/zsh-users/zsh-autosuggestions">zsh</a> and it is a great quality of life trick for your shell.</p>
<h3 id="directory-navigation"><a class="header" href="#directory-navigation">Directory Navigation</a></h3>
<p>As with the theme of this course, you often want to optimize for the common case. Finding frequent and/or recent files and directories can be done through tools like <a href="missing-semester/">fasd</a><code> and [autojump]()</code>. Fasd ranks files and directories by <em><a href="https://web.archive.org/web/20210421120120/https://developer.mozilla.org/en-US/docs/Mozilla/Tech/Places/Frecency_algorithm">frecency</a></em>, that is, by both <em>frequency</em> and <em>recency</em>. By default, <code>fasd</code> adds a <code>z</code> command that you can use to quickly <code>cd</code> using a substring of a <em>frecent</em> directory.</p>
<p>More complex tools exist to quickly get an overview of a directory structure: <a href="missing-semester/">tree</a><code>, [broot]()</code> or even full fledged file managers like <a href="missing-semester/">nnn</a><code> or [ranger]()</code>.</p>
<blockquote>
<p>学完感觉自己还是不会用bash编写脚本，建议在看看专门讲bash脚本编写的教程</p>
</blockquote>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<ol>
<li>
<p>利用<code>man ls</code>查看<code>ls</code>相关的参数，满足自己的要求</p>
<pre><code class="language-bash">ricardo@g15:~$ ls -l -h -t
total 20K
drwxr-xr-x 2 ricardo ricardo 4.0K Apr  5 11:42 tmp
drwxr-xr-x 8 ricardo ricardo 4.0K Mar 24 20:11 code
drwxr-xr-x 2 ricardo ricardo 4.0K Mar 16 21:26 bin
drwxr-xr-x 4 ricardo ricardo 4.0K Mar 16 21:25 download
drwxr-xr-x 3 ricardo ricardo 4.0K Jan 21 18:21 github
</code></pre>
</li>
<li>
<p>直接在<code>.bashrc</code>文件里面添加</p>
<pre><code class="language-bash">path=/home/ricardo

marco () {
  path=$(pwd)
}

polo () {
  cd $path
}
</code></pre>
<p>测试一下</p>
<pre><code class="language-bash">ricardo@g15:~/tmp$ marco
ricardo@g15:~/tmp$ cd ..
ricardo@g15:~$ polo
ricardo@g15:~/tmp$
</code></pre>
</li>
<li>
<p>将给出的运行代码保存为<code>exe.sh</code>,编写下列测试代码</p>
<pre><code class="language-bash">#!/usr/bin/env bash

number=0

while true; do
    ((number++))
    result=$(bash ./exe.sh)
    if [ "$?" = "1" ]; then #这里中括号和需要比较的式子之间必须要有空格，否则会报错
        echo $result
        echo "It has run for $number times."
        break
    fi
done
</code></pre>
<p>测试</p>
<pre><code class="language-bash">ricardo@g15:~/tmp$ bash test.sh
The error was using magic numbers
Something went wrong
It has run for 228 times.
</code></pre>
</li>
<li>
<p>将找到的文件通过<code>xargs</code>传递给压缩程序</p>
<pre><code class="language-bash">find . -name '*.html' | xargs tar
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-2"><a class="header" href="#the-missing-semester-in-the-cs-2">The Missing Semester in the CS</a></h1>
<h2 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第三篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Editors(Vim)</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/editors/">editors</a></p>
<blockquote>
<p>If it seems like there should be a better way to do something, there probably is.</p>
</blockquote>
<!--more-->
<h2 id="which-editor-to-learn"><a class="header" href="#which-editor-to-learn">Which editor to learn?</a></h2>
<p>Programmers have <a href="https://en.wikipedia.org/wiki/Editor_war">strong opinions</a> about their text editors. <a href="https://code.visualstudio.com/">Visual Studio Code</a> is the most popular editor. <a href="https://www.vim.org/">Vim</a> is the most popular command-line-based editor.</p>
<h3 id="vim"><a class="header" href="#vim">Vim</a></h3>
<p>Vim has a rich history; it originated from the Vi editor (1976), and it’s still being developed today. Vim has some really neat ideas behind it, and for this reason, lots of tools support a Vim emulation mode.</p>
<blockquote>
<p>由于许多的IDE都有Vim模式，在学习这篇的时候，也不必一定使用命令行界面的Vim编辑器，也可以使用各种IDE的Vim模式。</p>
</blockquote>
<h2 id="philosophy-of-vim"><a class="header" href="#philosophy-of-vim">Philosophy of Vim</a></h2>
<p>When programming, you spend most of your time reading/editing, not writing. For this reason, Vim is a <em>modal</em> editor: it has different modes for inserting text vs manipulating text. Vim is programmable (with Vimscript and also other languages like Python), and Vim’s interface itself is a programming language: keystrokes (with mnemonic names) are commands, and these commands are composable. Vim avoids the use of the mouse, because it’s too slow; Vim even avoids using the arrow keys because it requires too much movement.</p>
<blockquote>
<p>manipulate 操纵；keystroke 击键；mnemonic 助记符；</p>
</blockquote>
<h2 id="model-editing"><a class="header" href="#model-editing">Model editing</a></h2>
<p>Vim’s design is based on the idea that a lot of programmer time is spent reading, navigating, and making small edits, as opposed to writing long streams of text. For this reason, Vim has multiple operating modes. Keystrokes have different meanings in different operating modes.</p>
<ul>
<li><strong>Normal</strong>: for moving around a file and making edits</li>
<li><strong>Insert</strong>: for inserting text</li>
<li><strong>Replace</strong>: for replacing text</li>
<li><strong>Visual</strong> (plain, line, or block): for selecting blocks of text</li>
<li><strong>Command-line</strong>: for running a command</li>
</ul>
<p>In its default configuration, Vim shows the current mode in the bottom left. The initial/default mode is Normal mode.</p>
<p>You change modes by pressing <code>&lt;ESC&gt;</code> (the escape key) to switch from any mode back to Normal mode. From Normal mode, enter Insert mode with <code>i</code>, Replace mode with <code>R</code>, Visual mode with <code>v</code>, Visual Line mode with <code>V</code>, Visual Block mode with <code>&lt;C-v&gt;</code> (Ctrl-V, sometimes also written <code>^V</code>), and Command-line mode with <code>:</code>.You will use the <code>&lt;ESC&gt;</code>key a lot when using Vim, consider remapping Caps Lock to Escape.</p>
<blockquote>
<p>在Windows系统中重设键盘键位时，不需要修改注册表值，可以使用<a href="https://github.com/microsoft/PowerToys">PowerToys</a>这个微软官方开发的辅助开发者的工具集。他的官方文档在[这里](<a href="https://docs.microsoft.com/zh-cn/windows/powertoys/">Microsoft PowerToys | Microsoft Docs</a>)</p>
</blockquote>
<h2 id="basics"><a class="header" href="#basics">Basics</a></h2>
<h3 id="inserting-text"><a class="header" href="#inserting-text">Inserting text</a></h3>
<p>From Normal mode, press <code>i</code> to enter Insert mode. Now, Vim behaves like any other text editor, until you press <code>&lt;ESC&gt;</code> to return to Normal mode.</p>
<h3 id="bufferstabs-and-windows"><a class="header" href="#bufferstabs-and-windows">Buffers,tabs, and windows</a></h3>
<p>Vim maintains a set of open files, called “buffers”. A Vim session has a number of tabs, each of which has a number of windows (split panes). Each window shows a single buffer. Unlike other programs you are familiar with, like web browsers, there is not a 1-to-1 correspondence between buffers and windows; windows are merely views. A given buffer may be open in <em>multiple</em> windows, even within the same tab. This can be quite handy, for example, to view two different parts of a file at the same time.</p>
<p>By default, Vim opens with a single tab, which contains a single window.</p>
<blockquote>
<p>buffer 缓冲区; pane 窗格;</p>
</blockquote>
<h3 id="command-line"><a class="header" href="#command-line">Command-line</a></h3>
<p>Command mode can be entered by typing <code>:</code> in Normal mode. Your cursor will jump to the command line at the bottom of the screen upon pressing <code>:</code>. This mode has many functionalities, including opening, saving, and closing files, and <a href="https://twitter.com/iamdevloper/status/435555976687923200">quitting Vim</a>.</p>
<blockquote>
<p>这个链接指向一条推文，是一个关于退出Vim编辑器的冷笑话。（个人理解</p>
<p>推文如下：</p>
<p>I've been using Vim for about 2 years now, mostly because I can't figure out how to exit it.</p>
</blockquote>
<ul>
<li><code>:q</code> quit (close window)</li>
<li><code>:w</code> save (“write”)</li>
<li><code>:wq</code> save and quit</li>
<li><code>:e {name of file}</code> open file for editing</li>
<li><code>:ls</code> show open buffers</li>
<li><code>:help {topic}</code> open help
<ul>
<li><code>:help :w</code> opens help for the <code>:w</code> command</li>
<li><code>:help w</code> opens help for the <code>w</code> movement</li>
</ul>
</li>
</ul>
<h2 id="vims-interface-is-a-proggramming-language"><a class="header" href="#vims-interface-is-a-proggramming-language">Vim's interface is a proggramming language</a></h2>
<p>The most important idea in Vim is that Vim’s interface itself is a programming language. Keystrokes (with mnemonic names) are commands, and these commands <em>compose</em>. This enables efficient movement and edits, especially once the commands become muscle memory.</p>
<h3 id="movement"><a class="header" href="#movement">Movement</a></h3>
<p>You should spend most of your time in Normal mode, using movement commands to navigate the buffer. Movements in Vim are also called “nouns”, because they refer to chunks of text.</p>
<blockquote>
<p>nouns 名词; chunk 块;</p>
</blockquote>
<ul>
<li>Basic movement: <code>hjkl</code> (left, down, up, right)</li>
<li>Words: <code>w</code> (next word), <code>b</code> (beginning of word), <code>e</code> (end of word)</li>
<li>Lines: <code>0</code> (beginning of line), <code>^</code> (first non-blank character), <code>$</code> (end of line)</li>
<li>Screen: <code>H</code> (top of screen), <code>M</code> (middle of screen), <code>L</code> (bottom of screen)</li>
<li>Scroll: <code>Ctrl-u</code> (up), <code>Ctrl-d</code> (down)</li>
<li>File: <code>gg</code> (beginning of file), <code>G</code> (end of file)</li>
<li>Line numbers: <code>:{number}&lt;CR&gt;</code> or <code>{number}G</code> (line {number})</li>
<li>Misc: <code>%</code> (corresponding item)</li>
<li>Find: <code>f{character}</code>, <code>t{character}</code>, <code>F{character}</code>, <code>T{character}</code>
<ul>
<li>find/to forward/backward {character} on the current line</li>
<li><code>,</code> / <code>;</code> for navigating matches</li>
</ul>
</li>
<li>Search: <code>/{regex}</code>, <code>n</code> / <code>N</code> for navigating matches</li>
</ul>
<h3 id="selection"><a class="header" href="#selection">Selection</a></h3>
<p>Visual modes:</p>
<ul>
<li>Visual: <code>v</code></li>
<li>Visual Line: <code>V</code></li>
<li>Visual Block: <code>Ctrl-v</code></li>
</ul>
<p>Can use movement keys to make selection.</p>
<h3 id="edits"><a class="header" href="#edits">Edits</a></h3>
<p>Everything that you used to do with the mouse, you now do with the keyboard using editing commands that compose with movement commands. Here’s where Vim’s interface starts to look like a programming language. Vim’s editing commands are also called “verbs”, because verbs act on nouns.</p>
<ul>
<li><code>i</code>enter Insert mode
<ul>
<li>but for manipulating/deleting text, want to use something more than backspace</li>
</ul>
</li>
<li><code>o</code> / <code>O</code> insert line below / above</li>
<li><code>d{motion}</code>delete {motion}
<ul>
<li>e.g. <code>dw</code> is delete word, <code>d$</code> is delete to end of line, <code>d0</code> is delete to beginning of line</li>
</ul>
</li>
<li><code>c{motion}</code>change {motion}
<ul>
<li>e.g. <code>cw</code> is change word</li>
<li>like <code>d{motion}</code> followed by <code>i</code></li>
</ul>
</li>
<li><code>x</code> delete character (equal do <code>dl</code>)</li>
<li><code>s</code> substitute character (equal to <code>xi</code>)</li>
<li>Visual mode + manipulation
<ul>
<li>select text, <code>d</code> to delete it or <code>c</code> to change it</li>
</ul>
</li>
<li><code>u</code> to undo, <code>&lt;C-r&gt;</code> to redo</li>
<li><code>y</code> to copy / “yank” (some other commands like <code>d</code> also copy)</li>
<li><code>p</code> to paste</li>
<li>Lots more to learn: e.g. <code>~</code> flips the case of a character</li>
</ul>
<h3 id="counts"><a class="header" href="#counts">Counts</a></h3>
<p>You can combine nouns and verbs with a count, which will perform a given action a number of times.</p>
<ul>
<li><code>3w</code> move 3 words forward</li>
<li><code>5j</code> move 5 lines down</li>
<li><code>7dw</code> delete 7 words</li>
</ul>
<h3 id="modifiers"><a class="header" href="#modifiers">Modifiers</a></h3>
<p>You can use modifiers to change the meaning of a noun. Some modifiers are <code>i</code>, which means “inner” or “inside”, and <code>a</code>, which means “around”.</p>
<ul>
<li><code>ci(</code> change the contents inside the current pair of parentheses</li>
<li><code>ci[</code> change the contents inside the current pair of square brackets</li>
<li><code>da'</code> delete a single-quoted string, including the surrounding single quotes</li>
</ul>
<h2 id="customizing-vim"><a class="header" href="#customizing-vim">Customizing Vim</a></h2>
<p>Vim is customized through a plain-text configuration file in <code>~/.vimrc</code> (containing Vimscript commands). There are probably lots of basic settings that you want to turn on.</p>
<p>We are providing a well-documented basic config that you can use as a starting point. We recommend using this because it fixes some of Vim’s quirky default behavior. <strong>Download our config ​</strong>​<a href="https://missing.csail.mit.edu/2020/files/vimrc">here</a><strong><strong>​<strong>​ and save it to ​</strong>​</strong><code>~/.vimrc</code><strong>​</strong>.</strong></p>
<blockquote>
<p>quirky 古怪的；</p>
</blockquote>
<p>Vim is heavily customizable, and it’s worth spending time exploring customization options. You can look at people’s dotfiles on GitHub for inspiration. There are lots of good blog posts on this topic too. Try not to copy-and-paste people’s full configuration, but read it, understand it, and take what you need.</p>
<h2 id="extending-vim"><a class="header" href="#extending-vim">Extending Vim</a></h2>
<p>There are tons of plugins for extending Vim. Contrary to outdated advice that you might find on the internet, you do <em>not</em> need to use a plugin manager for Vim (since Vim 8.0). Instead, you can use the built-in package management system. Simply create the directory <code>~/.vim/pack/vendor/start/</code>, and put plugins in there (e.g. via <code>git clone</code>).</p>
<p>Here are some of our favorite plugins:</p>
<ul>
<li><a href="https://github.com/ctrlpvim/ctrlp.vim">ctrlp.vim</a>: fuzzy file finder</li>
<li><a href="https://github.com/mileszs/ack.vim">ack.vim</a>: code search</li>
<li><a href="https://github.com/scrooloose/nerdtree">nerdtree</a>: file explorer</li>
<li><a href="https://github.com/easymotion/vim-easymotion">vim-easymotion</a>: magic motions</li>
</ul>
<p>We’re trying to avoid giving an overwhelmingly long list of plugins here. You can check out the instructors’ dotfiles (<a href="https://github.com/anishathalye/dotfiles">Anish</a>, <a href="https://github.com/jonhoo/configs">Jon</a>, <a href="https://github.com/JJGO/dotfiles">Jose</a>) to see what other plugins we use. Check out <a href="https://vimawesome.com/">Vim Awesome</a> for more awesome Vim plugins.</p>
<h2 id="vim-mode-in-other-programs"><a class="header" href="#vim-mode-in-other-programs">Vim mode in other programs</a></h2>
<p>Many tools support Vim emulation. The quality varies from good to great; depending on the tool, it may not support the fancier Vim features, but most cover the basics pretty well.</p>
<h3 id="shell"><a class="header" href="#shell">Shell</a></h3>
<p>Use</p>
<pre><code class="language-bash">export EDITOR=vim
</code></pre>
<p>This is the environment variable used to decide which editor is launched when a program wants to start an editor.</p>
<h3 id="readline"><a class="header" href="#readline">Readline</a></h3>
<p>Many programs use the <a href="https://tiswww.case.edu/php/chet/readline/rltop.html">GNU Readline</a> library for their command-line interface. Readline supports (basic) Vim emulation too, which can be enabled by adding the following line to the <code>~/.inputrc</code> file:</p>
<pre><code>set editing-mode vi
</code></pre>
<p>With this setting, for example, the Python REPL will support Vim bindings.</p>
<h2 id="advanced-vim"><a class="header" href="#advanced-vim">Advanced Vim</a></h2>
<p>Here are a few examples to show you the power of the editor. We can’t teach you all of these kinds of things, but you’ll learn them as you go. A good heuristic: whenever you’re using your editor and you think “there must be a better way of doing this”, there probably is: look it up online.</p>
<blockquote>
<p>heuristic 启发式；</p>
</blockquote>
<h3 id="search-and-replace"><a class="header" href="#search-and-replace">Search and replace</a></h3>
<p><code>:s</code> (substitute) command (<a href="http://vim.wikia.com/wiki/Search_and_replace">documentation</a>).</p>
<pre><code>%s/foo/bar/g
</code></pre>
<ul>
<li>replace foo with bar globally in file</li>
</ul>
<pre><code>%s/\[.*\](\(.*\))/\1/g
</code></pre>
<ul>
<li>replace named Markdown links with plain URLs</li>
</ul>
<h3 id="multiple-windows"><a class="header" href="#multiple-windows">Multiple windows</a></h3>
<ul>
<li><code>:sp</code> / <code>:vsp</code> to split windows</li>
<li>Can have multiple views of the same buffer.</li>
</ul>
<h3 id="macros"><a class="header" href="#macros">Macros</a></h3>
<ul>
<li><code>q{character}</code> to start recording a macro in register <code>{character}</code></li>
<li><code>q</code> to stop recording</li>
<li><code>@{character}</code> replays the macro</li>
<li>Macro execution stops on error</li>
<li><code>{number}@{character}</code> executes a macro {number} times</li>
<li>Macros can be recursive
<ul>
<li>first clear the macro with <code>q{character}q</code></li>
<li>record the macro, with <code>@{character}</code> to invoke the macro recursively (will be a no-op until recording is complete)</li>
</ul>
</li>
<li>Example: convert xml to json (<a href="https://missing.csail.mit.edu/2020/files/example-data.xml">file</a>)
<ul>
<li>Array of objects with keys “name” / “email”</li>
<li>Use a Python program?</li>
<li>Use sed / regexes
<ul>
<li><code>g/people/d</code></li>
<li><code>%s/&lt;person&gt;/{/g</code></li>
<li><code>%s/&lt;name&gt;\(.*\)&lt;\/name&gt;/"name": "\1",/g</code></li>
<li>…</li>
</ul>
</li>
<li>Vim commands / macros
<ul>
<li><code>Gdd</code>, <code>ggdd</code> delete first and last lines</li>
<li>Macro to format a single element (register<code>e</code>)
<ul>
<li>Go to line with <code>&lt;name&gt;</code></li>
<li><code>qe^r"f&gt;s": "&lt;ESC&gt;f&lt;C"&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>Macro to format a person
<ul>
<li>Go to line with <code>&lt;person&gt;</code></li>
<li><code>qpS{&lt;ESC&gt;j@eA,&lt;ESC&gt;j@ejS},&lt;ESC&gt;q</code></li>
</ul>
</li>
<li>Macro to format a person and go to the next person
<ul>
<li>Go to line with <code>&lt;person&gt;</code></li>
<li><code>qq@pjq</code></li>
</ul>
</li>
<li>Execute macro until end of file
<ul>
<li><code>999@q</code></li>
</ul>
</li>
<li>Manually remove last <code>,</code> and add <code>[</code> and <code>]</code> delimiters</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>这个部分就已经是魔法了</p>
</blockquote>
<blockquote>
<p>学习Vim还是得多练，这就在vscode里装Vim插件</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-3"><a class="header" href="#the-missing-semester-in-the-cs-3">The Missing Semester in the CS</a></h1>
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第四篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Data Wrangling</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/data-wrangling/">Data-Wrangling</a>。</p>
<!--more-->
<h2 id="contents"><a class="header" href="#contents">Contents</a></h2>
<blockquote>
<p>这一章节我感觉是从实战出发，这里从讲解过滤服务器上登录<code>ssh</code>服务的日志开始</p>
</blockquote>
<p>Let’s start from the beginning. To wrangle data, we need two things: data to wrangle, and something to do with it. Logs often make for a good use-case, because you often want to investigate things about them, and reading the whole thing isn’t feasible.</p>
<pre><code class="language-bash">ssh myserver journalctl
</code></pre>
<p>That’s far too much stuff. Let’s limit it to ssh stuff:</p>
<pre><code class="language-bash">ssh myserver journalctl | grep sshd
</code></pre>
<p>Notice that we’re using a pipe to stream a <em>remote</em> file through <code>grep</code> on our local computer! <code>ssh</code> is magical, and we will talk more about it in the next lecture on the command-line environment. This is still way more stuff than we wanted though. And pretty hard to read. Let’s do better:</p>
<pre><code class="language-bash">ssh myserver 'journalctl | grep sshd | grep "Disconnected from"' | less
</code></pre>
<p>Why the additional quoting? Well, our logs may be quite large, and it’s wasteful to stream it all to our computer and then do the filtering. Instead, we can do the filtering on the remote server, and then massage the data locally. <code>less</code> gives us a “pager” that allows us to scroll up and down through the long output. To save some additional traffic while we debug our command-line, we can even stick the current filtered logs into a file so that we don’t have to access the network while developing:</p>
<pre><code class="language-bash">$ ssh myserver 'journalctl | grep sshd | grep "Disconnected from"' &gt; ssh.log
$ less ssh.log
</code></pre>
<p><code>sed</code> is a “stream editor” that builds on top of the old <code>ed</code> editor. In it, you basically give short commands for how to modify the file, rather than manipulate its contents directly (although you can do that too). There are tons of commands, but one of the most common ones is <code>s</code>: substitution. For example, we can write:</p>
<blockquote>
<p>manipulate 操纵;</p>
</blockquote>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed 's/.*Disconnected from //'
</code></pre>
<p>What we just wrote was a simple <em>regular expression</em>; a powerful construct that lets you match text against patterns. The <code>s</code> command is written on the form: <code>s/REGEX/SUBSTITUTION/</code>, where <code>REGEX</code> is the regular expression you want to search for, and <code>SUBSTITUTION</code> is the text you want to substitute matching text with.</p>
<h3 id="regular-expressions"><a class="header" href="#regular-expressions">Regular expressions</a></h3>
<p>Let’s start by looking at the one we used above: <code>/.*Disconnected from /</code>. Regular expressions are usually (though not always) surrounded by <code>/</code>. Most ASCII characters just carry their normal meaning, but some characters have “special” matching behavior. Exactly which characters do what vary somewhat between different implementations of regular expressions, which is a source of great frustration.</p>
<blockquote>
<p>implementation 执行; frustration 挫折;</p>
</blockquote>
<p>Very common patterns are:</p>
<ul>
<li><code>.</code> means “any single character” except newline</li>
<li><code>*</code> zero or more of the preceding match</li>
<li><code>+</code> one or more of the preceding match</li>
<li><code>[abc]</code> any one character of <code>a</code>, <code>b</code>, and <code>c</code></li>
<li><code>(RX1|RX2)</code> either something that matches <code>RX1</code> or <code>RX2</code></li>
<li><code>^</code> the start of the line</li>
<li><code>$</code> the end of the line</li>
</ul>
<p><code>sed</code>’s regular expressions are somewhat weird, and will require you to put a <code>\</code> before most of these to give them their special meaning. Or you can pass <code>-E</code>.</p>
<p>So, looking back at <code>/.*Disconnected from /</code>, we see that it matches any text that starts with any number of characters, followed by the literal string “Disconnected from ”. Which is what we wanted. But beware, regular expressions are trixy. What if someone tried to log in with the username “Disconnected from”? We’d have:</p>
<pre><code class="language-bash">Jan 17 03:13:00 thesquareplanet.com sshd[2631]: Disconnected from invalid user Disconnected from 46.97.239.16 port 55920 [preauth]
</code></pre>
<p>What would we end up with? Well, <code>*</code> and <code>+</code> are, by default, “greedy”. They will match as much text as they can. So, in the above, we’d end up with just</p>
<pre><code class="language-bash">46.97.239.16 port 55920 [preauth]
</code></pre>
<blockquote>
<p>这里是说<code>*</code>和<code>+</code>都是贪婪匹配的，他会匹配到最后一次出现的位置。</p>
</blockquote>
<p>Which may not be what we wanted. In some regular expression implementations, you can just suffix <code>*</code> or <code>+</code> with a <code>?</code> to make them non-greedy, but sadly <code>sed</code> doesn’t support that. We <em>could</em> switch to perl’s command-line mode though, which <em>does</em> support that construct:</p>
<pre><code class="language-bash">perl -pe 's/.*?Disconnected from //'
</code></pre>
<p>Okay, so we also have a suffix we’d like to get rid of. How might we do that? It’s a little tricky to match just the text that follows the username, especially if the username can have spaces and such! What we need to do is match the <em>whole</em> line:</p>
<pre><code class="language-bash">sed -E 's/.*Disconnected from (invalid |authenticating )?user .* [^ ]+ port [0-9]+( \[preauth\])?$//'
</code></pre>
<p>Let’s look at what’s going on with a <a href="https://regex101.com/r/qqbZqh/2">regex debugger</a>. Okay, so the start is still as before. Then, we’re matching any of the “user” variants (there are two prefixes in the logs). Then we’re matching on any string of characters where the username is. Then we’re matching on any single word (<code>[^ ]+</code>; any non-empty sequence of non-space characters). Then the word “port” followed by a sequence of digits. Then possibly the suffix <code>[preauth]</code>, and then the end of the line.</p>
<p>There is one problem with this though, and that is that the entire log becomes empty. We want to <em>keep</em> the username after all. For this, we can use “capture groups”. Any text matched by a regex surrounded by parentheses is stored in a numbered capture group. These are available in the substitution (and in some engines, even in the pattern itself!) as <code>\1</code>, <code>\2</code>, <code>\3</code>, etc. So:</p>
<pre><code class="language-bash"> | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
</code></pre>
<p>As you can probably imagine, you can come up with <em>really</em> complicated regular expressions. For example, here’s an article on how you might match an <a href="https://www.regular-expressions.info/email.html">e-mail address</a>. It’s <a href="https://emailregex.com/">not easy</a>. And there’s <a href="https://stackoverflow.com/questions/201323/how-to-validate-an-email-address-using-a-regular-expression/1917982">lots of discussion</a>. And people have <a href="https://fightingforalostcause.net/content/misc/2006/compare-email-regex.php">written tests</a>. And <a href="https://mathiasbynens.be/demo/url-regex">test matrices</a>. You can even write a regex for determining if a given number <a href="https://www.noulakaz.net/2007/03/18/a-regular-expression-to-check-for-prime-numbers/">is a prime number</a>.</p>
<p>Regular expressions are notoriously hard to get right, but they are also very handy to have in your toolbox!</p>
<h3 id="back-to-data-wrangling"><a class="header" href="#back-to-data-wrangling">Back to data wrangling</a></h3>
<p>What we have now gives us a list of all the usernames that have attempted to log in. But this is pretty unhelpful. Let’s look for common ones:</p>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
</code></pre>
<p><code>sort</code> will, well, sort its input. <code>uniq -c</code> will collapse consecutive lines that are the same into a single line, prefixed with a count of the number of occurrences.</p>
<blockquote>
<p>collapse 坍塌; consecutive 连续的; prefixed 前缀;</p>
</blockquote>
<p>We probably want to sort that too and only keep the most common usernames:</p>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
 | sort -nk1,1 | tail -n10
</code></pre>
<p><code>sort -n</code> will sort in numeric (instead of lexicographic) order. <code>-k1,1</code> means “sort by only the first whitespace-separated column”. The <code>,n</code> part says “sort until the <code>n</code>th field, where the default is the end of the line. In this <em>particular</em> example, sorting by the whole line wouldn’t matter, but we’re here to learn!</p>
<blockquote>
<p>lexicographic 字典序的;</p>
</blockquote>
<blockquote>
<p>md， 开始魔法起来了</p>
</blockquote>
<p>Okay, so that’s pretty cool, but what if we’d like these extract only the usernames as a comma-separated list instead of one per line, perhaps for a config file?</p>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
 | sort -nk1,1 | tail -n10
 | awk '{print $2}' | paste -sd,
</code></pre>
<p>Let’s start with <code>paste</code>: it lets you combine lines (<code>-s</code>) by a given single-character delimiter (<code>-d</code>; <code>,</code> in this case). But what’s this <code>awk</code> business?</p>
<blockquote>
<p>delimiter 分隔符;</p>
</blockquote>
<h3 id="awk-another-editor"><a class="header" href="#awk-another-editor">awk-another editor</a></h3>
<p><code>awk</code> is a programming language that just happens to be really good at processing text streams.</p>
<p>First, what does <code>{print $2}</code> do? Well, <code>awk</code> programs take the form of an optional pattern plus a block saying what to do if the pattern matches a given line. The default pattern (which we used above) matches all lines. Inside the block, <code>$0</code> is set to the entire line’s contents, and <code>$1</code> through <code>$n</code> are set to the <code>n</code>th <em>field</em> of that line, when separated by the <code>awk</code> field separator (whitespace by default, change with <code>-F</code>). In this case, we’re saying that, for every line, print the contents of the second field, which happens to be the username!</p>
<p>Let’s see if we can do something fancier. Let’s compute the number of single-use usernames that start with <code>c</code> and end with <code>e</code>:</p>
<pre><code class="language-bash"> | awk '$1 == 1 &amp;&amp; $2 ~ /^c[^ ]*e$/ { print $2 }' | wc -l
</code></pre>
<p>There’s a lot to unpack here. First, notice that we now have a pattern (the stuff that goes before <code>{...}</code>). The pattern says that the first field of the line should be equal to 1 (that’s the count from <code>uniq -c</code>), and that the second field should match the given regular expression. And the block just says to print the username. We then count the number of lines in the output with <code>wc -l</code>.</p>
<p>However, <code>awk</code> is a programming language, remember?</p>
<pre><code class="language-bash">BEGIN { rows = 0 }
$1 == 1 &amp;&amp; $2 ~ /^c[^ ]*e$/ { rows += $1 }
END { print rows }
</code></pre>
<p><code>BEGIN</code> is a pattern that matches the start of the input (and <code>END</code> matches the end). Now, the per-line block just adds the count from the first field (although it’ll always be 1 in this case), and then we print it out at the end. In fact, we <em>could</em> get rid of <code>grep</code> and <code>sed</code> entirely, because <code>awk</code> <a href="https://backreference.org/2010/02/10/idiomatic-awk/">can do it all</a>, but we’ll leave that as an exercise to the reader.</p>
<h3 id="analyzing-data"><a class="header" href="#analyzing-data">Analyzing data</a></h3>
<p>You can do math directly in your shell using <code>bc</code>, a calculator that can read from STDIN! For example, add the numbers on each line together by concatenating them together, delimited by <code>+</code>:</p>
<pre><code class="language-bash"> | paste -sd+ | bc -l
</code></pre>
<p>Or produce more elaborate expressions:</p>
<pre><code class="language-bash">echo "2*($(data | paste -sd+))" | bc -l
</code></pre>
<blockquote>
<p>elaborate 精心制作的;</p>
</blockquote>
<p>You can get stats in a variety of ways. <a href="missing-semester/">st</a>`` is pretty neat, but if you already have <a href="https://www.r-project.org/">R</a>:</p>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
 | awk '{print $1}' | R --no-echo -e 'x &lt;- scan(file="stdin", quiet=TRUE); summary(x)'
</code></pre>
<p>R is another (weird) programming language that’s great at data analysis and <a href="https://ggplot2.tidyverse.org/">plotting</a>. We won’t go into too much detail, but suffice to say that <code>summary</code> prints summary statistics for a vector, and we created a vector containing the input stream of numbers, so R gives us the statistics we wanted!</p>
<p>If you just want some simple plotting, <code>gnuplot</code> is your friend:</p>
<pre><code class="language-bash">ssh myserver journalctl
 | grep sshd
 | grep "Disconnected from"
 | sed -E 's/.*Disconnected from (invalid |authenticating )?user (.*) [^ ]+ port [0-9]+( \[preauth\])?$/\2/'
 | sort | uniq -c
 | sort -nk1,1 | tail -n10
 | gnuplot -p -e 'set boxwidth 0.5; plot "-" using 1:xtic(2) with boxes'
</code></pre>
<blockquote>
<p>这些寄巧未免有点太过于高端</p>
</blockquote>
<h3 id="data-wrangling-to-make-arguments"><a class="header" href="#data-wrangling-to-make-arguments">Data wrangling to make arguments</a></h3>
<p>Sometimes you want to do data wrangling to find things to install or remove based on some longer list. The data wrangling we’ve talked about so far + <code>xargs</code> can be a powerful combo.</p>
<p>For example, as seen in lecture, I can use the following command to uninstall old nightly builds of Rust from my system by extracting the old build names using data wrangling tools and then passing them via <code>xargs</code> to the uninstaller:</p>
<pre><code class="language-bash">rustup toolchain list | grep nightly | grep -vE "nightly-x86" | sed 's/-x86.*//' | xargs rustup toolchain uninstall
</code></pre>
<blockquote>
<p>这个倒是蛮有用的，不过就是调试的时间可能比一个个的手动输入还长就是了</p>
</blockquote>
<h3 id="wrangling-binary-data"><a class="header" href="#wrangling-binary-data">Wrangling binary data</a></h3>
<p>So far, we have mostly talked about wrangling textual data, but pipes are just as useful for binary data. For example, we can use ffmpeg to capture an image from our camera, convert it to grayscale, compress it, send it to a remote machine over SSH, decompress it there, make a copy, and then display it.</p>
<pre><code class="language-bash">ffmpeg -loglevel panic -i /dev/video0 -frames 1 -f image2 -
 | convert - -colorspace gray -
 | gzip
 | ssh mymachine 'gzip -d | tee copy.jpg | env DISPLAY=:0 feh -'
</code></pre>
<h2 id="exercises-1"><a class="header" href="#exercises-1">Exercises</a></h2>
<ol>
<li>第一个练习挺好的，建议认真做一做。</li>
</ol>
<p><a href="https://%E6%91%86%E7%83%82.top">只要我开摆了，那我就是无敌的</a></p>
<blockquote>
<p>这种鬼才地址，不要问我是怎么发现的。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-4"><a class="header" href="#the-missing-semester-in-the-cs-4">The Missing Semester in the CS</a></h1>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第五篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Command line environment</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/command-line/">Command-ling</a></p>
<!--more-->
<h2 id="job-control"><a class="header" href="#job-control">Job Control</a></h2>
<h3 id="killing-a-process"><a class="header" href="#killing-a-process">Killing a process</a></h3>
<p>Shell is using a UNIX communication mechanism called a <em>signal</em> to communicate information to the process. When a process receives a signal it stops its execution, deals with the signal and potentially changes the flow of execution based on the information that the signal delivered. For this reason, signals are <em>software interrupts</em>.</p>
<p>When typing <code>Ctrl-C</code> this prompts the shell to deliver a <code>SIGINT</code> signal to the process.</p>
<p>Here’s a minimal example of a Python program that captures <code>SIGINT</code> and ignores it, no longer stopping. To kill this program we can now use the <code>SIGQUIT</code> signal instead, by typing <code>Ctrl-\</code>.</p>
<pre><code class="language-python">#!/usr/bin/env python
import signal, time

def handler(signum, time):
    print("\nI got a SIGINT, but I am not stopping")

signal.signal(signal.SIGINT, handler)
i = 0
while True:
    time.sleep(.1)
    print("\r{}".format(i), end="")
    i += 1
</code></pre>
<p>When running on my laptop:</p>
<pre><code class="language-bash">➜  tmp python shell.py
14^C
I got a SIGINT, but I am not stopping
32^C
I got a SIGINT, but I am not stopping
47^\[1]    89 quit       python3 shell.py
</code></pre>
<p>While <code>SIGINT</code> and <code>SIGQUIT</code> are both usually associated with terminal related requests, a more generic signal for asking a process to exit gracefully is the <code>SIGTERM</code> signal. To send this signal we can use the <a href="missing-semester/">kill</a>`` command, with the syntax <code>kill -TERM &lt;PID&gt;</code>.</p>
<h3 id="pausing-and-backgrounding-process"><a class="header" href="#pausing-and-backgrounding-process">Pausing and backgrounding process</a></h3>
<p>Signals can do other things beyond killing a process. For instance, <code>SIGSTOP</code> pauses a process. In the terminal, typing <code>Ctrl-Z</code> will prompt the shell to send a <code>SIGTSTP</code> signal, short for Terminal Stop (i.e. the terminal’s version of <code>SIGSTOP</code>).</p>
<p>We can then continue the paused job in the foreground or in the background using <a href="missing-semester/">fg</a><code> or [bg]()</code>, respectively.</p>
<p>The <a href="missing-semester/">jobs</a><code> command lists the unfinished jobs associated with the current terminal session. You can refer to those jobs using their pid (you can use [pgrep]()</code> to find that out). More intuitively, you can also refer to a process using the percent symbol followed by its job number (displayed by <code>jobs</code>). To refer to the last backgrounded job you can use the <code>$!</code> special parameter.</p>
<p>One more thing to know is that the <code>&amp;</code> suffix in a command will run the command in the background, giving you the prompt back, although it will still use the shell’s STDOUT which can be annoying (use shell redirections in that case).</p>
<p>To background an already running program you can do <code>Ctrl-Z</code> followed by <code>bg</code>. Note that backgrounded processes are still children processes of your terminal and will die if you close the terminal (this will send yet another signal, <code>SIGHUP</code>). To prevent that from happening you can run the program with <a href="missing-semester/">nohup</a>`` (a wrapper to ignore <code>SIGHUP</code>), or use <code>disown</code> if the process has already been started. Alternatively, you can use a terminal multiplexer as we will see in the next section.</p>
<pre><code class="language-bash">➜  tmp sleep 1000
^Z
[1]  + 95 suspended  sleep 1000
➜  tmp nohup sleep 2000 &amp;
[2] 98
➜  tmp nohup: ignoring input and appending output to 'nohup.out'
jobs
[1]  + suspended  sleep 1000
[2]  - running    nohup sleep 2000
➜  tmp bg %1
[1]  - 95 continued  sleep 1000
➜  tmp jobs
[1]  - running    sleep 1000
[2]  + running    nohup sleep 2000
➜  tmp kill -STOP %1
[1]  + 95 suspended (signal)  sleep 1000
➜  tmp jobs
[1]  + suspended (signal)  sleep 1000
[2]  - running    nohup sleep 2000
➜  tmp kill -SIGHUP %1
[1]  + 95 hangup     sleep 1000
➜  tmp jobs
[2]  + running    nohup sleep 2000
➜  tmp kill %2
[2]  + 98 terminated  nohup sleep 2000
➜  tmp jobs
➜  tmp
</code></pre>
<p>A special signal is <code>SIGKILL</code> since it cannot be captured by the process and it will always terminate it immediately. However, it can have bad side effects such as leaving orphaned children processes.</p>
<blockquote>
<p>orphaned 孤儿的;</p>
</blockquote>
<p>You can learn more about these and other signals <a href="https://en.wikipedia.org/wiki/Signal_(IPC)">here</a> or typing <a href="missing-semester/">man signal</a>`` or <code>kill -l</code>.</p>
<h2 id="terminal-multiplexers"><a class="header" href="#terminal-multiplexers">Terminal Multiplexers</a></h2>
<p>Terminal multiplexers like <a href="missing-semester/">tmux</a>`` allow you to multiplex terminal windows using panes and tabs so you can interact with multiple shell sessions. Moreover, terminal multiplexers let you detach a current terminal session and reattach at some point later in time. This can make your workflow much better when working with remote machines since it avoids the need to use <code>nohup</code> and similar tricks.</p>
<p><code>tmux</code> expects you to know its keybindings, and they all have the form <code>&lt;C-b&gt; x</code> where that means (1) press <code>Ctrl+b</code>, (2) release <code>Ctrl+b</code>, and then (3) press <code>x</code>.</p>
<p><code>tmux</code> has the following hierarchy of objects:</p>
<blockquote>
<p>hierarchy 等级制度;</p>
</blockquote>
<ul>
<li>
<p>Sessions</p>
<ul>
<li>
<p>a session is an independent workspace with one or more windows</p>
</li>
<li>
<p><code>tmux</code> starts a new session.</p>
</li>
<li>
<p><code>tmux new -s NAME</code> starts it with that name.</p>
</li>
<li>
<p><code>tmux ls</code> lists the current sessions</p>
</li>
<li>
<p>Within <code>tmux</code> typing <code>&lt;C-b&gt; d</code> detaches the current session</p>
</li>
<li>
<p><code>tmux a</code> attaches the last session. You can use <code>-t</code> flag to specify which</p>
</li>
</ul>
</li>
<li>
<p>Windows</p>
<ul>
<li>
<p>Equivalent to tabs in editors or browsers, they are visually separate parts of the same session</p>
</li>
<li>
<p><code>&lt;C-b&gt; c</code> Creates a new window. To close it you can just terminate the shells doing <code>&lt;C-d&gt;</code></p>
</li>
<li>
<p><code>&lt;C-b&gt; N</code> Go to the <em>N</em> th window. Note they are numbered</p>
</li>
<li>
<p><code>&lt;C-b&gt; p</code> Goes to the previous window</p>
</li>
<li>
<p><code>&lt;C-b&gt; n</code> Goes to the next window</p>
</li>
<li>
<p><code>&lt;C-b&gt; ,</code> Rename the current window</p>
</li>
<li>
<p><code>&lt;C-b&gt; w</code> List current windows</p>
</li>
</ul>
</li>
<li>
<p>Panes</p>
<ul>
<li>
<p>Like vim splits, panes let you have multiple shells in the same visual display.</p>
</li>
<li>
<p><code>&lt;C-b&gt; "</code> Split the current pane horizontally</p>
</li>
<li>
<p><code>&lt;C-b&gt; %</code> Split the current pane vertically</p>
</li>
<li>
<p><code>&lt;C-b&gt; &lt;direction&gt;</code> Move to the pane in the specified <em>direction</em>. Direction here means arrow keys.</p>
</li>
<li>
<p><code>&lt;C-b&gt; z</code> Toggle zoom for the current pane</p>
</li>
<li>
<p><code>&lt;C-b&gt; [</code> Start scrollback. You can then press <code>&lt;space&gt;</code> to start a selection and <code>&lt;enter&gt;</code> to copy that selection.</p>
</li>
<li>
<p><code>&lt;C-b&gt; &lt;space&gt;</code> Cycle through pane arrangements.</p>
</li>
</ul>
</li>
</ul>
<p><img src="missing-semester/./assets/1-20221120150726-k7252bf.png" alt="tmux截图" /></p>
<h2 id="alias"><a class="header" href="#alias">Alias</a></h2>
<p>It can become tiresome typing long commands that involve many flags or verbose options. For this reason, most shells support <em>aliasing</em>. A shell alias is a short form for another command that your shell will replace automatically for you. For instance, an alias in bash has the following structure:</p>
<pre><code class="language-bash">alias alias_name="command_to_alias arg1 arg2"
</code></pre>
<p>Note that there is no space around the equal sign <code>=</code>, because <a href="missing-semester/">alias</a>`` is a shell command that takes a single argument.</p>
<pre><code class="language-bash"># Make shorthands for common flags
alias ll="ls -lh"

# Save a lot of typing for common commands
alias gs="git status"
alias gc="git commit"
alias v="vim"

# Save you from mistyping
alias sl=ls

# Overwrite existing commands for better defaults
alias mv="mv -i"           # -i prompts before overwrite
alias mkdir="mkdir -p"     # -p make parent dirs as needed
alias df="df -h"           # -h prints human readable format

# Alias can be composed
alias la="ls -A"
alias lla="la -l"

# To ignore an alias run it prepended with \
\ls
# Or disable an alias altogether with unalias
unalias la

# To get an alias definition just call it with alias
alias ll
# Will print ll='ls -lh'
</code></pre>
<h2 id="dotfiles"><a class="header" href="#dotfiles">Dotfiles</a></h2>
<p>Many programs are configured using plain-text files known as <em>dotfiles</em> (because the file names begin with a <code>.</code>, e.g. <code>~/.vimrc</code>, so that they are hidden in the directory listing <code>ls</code> by default).</p>
<p>Shells are one example of programs configured with such files. On startup, your shell will read many files to load its configuration. Depending on the shell, whether you are starting a login and/or interactive the entire process can be quite complex. For <code>bash</code>, editing your <code>.bashrc</code> or <code>.bash_profile</code> will work in most systems. Here you can include commands that you want to run on startup, like the alias we just described or modifications to your <code>PATH</code> environment variable.</p>
<p>Some other examples of tools that can be configured through dotfiles are:</p>
<ul>
<li><code>bash</code> - <code>~/.bashrc</code>, <code>~/.bash_profile</code></li>
<li><code>git</code> - <code>~/.gitconfig</code></li>
<li><code>vim</code> - <code>~/.vimrc</code> and the <code>~/.vim</code> folder</li>
<li><code>ssh</code> - <code>~/.ssh/config</code></li>
<li><code>tmux</code> - <code>~/.tmux.conf</code></li>
</ul>
<p>How should you organize your dotfiles? They should be in their own folder, under version control, and <strong>symlinked</strong> into place using a script. This has the benefits of:</p>
<ul>
<li><strong>Easy installation</strong>: if you log in to a new machine, applying your customizations will only take a minute.</li>
<li><strong>Portability</strong>: your tools will work the same way everywhere.</li>
<li><strong>Synchronization</strong>: you can update your dotfiles anywhere and keep them all in sync.</li>
<li><strong>Change tracking</strong>: you’re probably going to be maintaining your dotfiles for your entire programming career, and version history is nice to have for long-lived projects.</li>
</ul>
<h3 id="portability"><a class="header" href="#portability">Portability</a></h3>
<p>A common pain with dotfiles is that the configurations might not work when working with several machines, e.g. if they have different operating systems or shells. Sometimes you also want some configuration to be applied only in a given machine.</p>
<p>There are some tricks for making this easier. If the configuration file supports it, use the equivalent of if-statements to apply machine specific customizations. For example, your shell could have something like:</p>
<pre><code class="language-bash">if [[ "$(uname)" == "Linux" ]]; then {do_something}; fi

# Check before using shell-specific features
if [[ "$SHELL" == "zsh" ]]; then {do_something}; fi

# You can also make it machine-specific
if [[ "$(hostname)" == "myServer" ]]; then {do_something}; fi
</code></pre>
<blockquote>
<p>显然Windows用户就没戏了，<code>uname</code>这个指令在Windows下就没有。</p>
</blockquote>
<p>If the configuration file supports it, make use of includes. For example, a <code>~/.gitconfig</code> can have a setting:</p>
<pre><code class="language-bash">[include]
    path = ~/.gitconfig_local
</code></pre>
<p>And then on each machine, <code>~/.gitconfig_local</code> can contain machine-specific settings. You could even track these in a separate repository for machine-specific settings.</p>
<p>This idea is also useful if you want different programs to share some configurations. For instance, if you want both <code>bash</code> and <code>zsh</code> to share the same set of aliases you can write them under <code>.aliases</code> and have the following block in both:</p>
<pre><code class="language-bash"># Test if ~/.aliases exists and source it
if [ -f ~/.aliases]; then
	source ~/.aliases
fi
</code></pre>
<h2 id="remote-machine"><a class="header" href="#remote-machine">Remote Machine</a></h2>
<p>To <code>ssh</code> into a server you execute a command as follows</p>
<pre><code class="language-bash">ssh foo@bar.mit.edu
</code></pre>
<p>Here we are trying to ssh as user <code>foo</code> in server <code>bar.mit.edu</code>. The server can be specified with a URL (like <code>bar.mit.edu</code>) or an IP (something like <code>foobar@192.168.1.42</code>).</p>
<h3 id="executing-commands"><a class="header" href="#executing-commands">Executing commands</a></h3>
<p>An often overlooked feature of <code>ssh</code> is the ability to run commands directly. <code>ssh foobar@server ls</code> will execute <code>ls</code> in the home folder of foobar. It works with pipes, so <code>ssh foobar@server ls | grep PATTERN</code> will grep locally the remote output of <code>ls</code> and <code>ls | ssh foobar@server grep PATTERN</code> will grep remotely the local output of <code>ls</code>.</p>
<h3 id="ssh-keys"><a class="header" href="#ssh-keys">SSH Keys</a></h3>
<p>Key-based authentication exploits public-key cryptography to prove to the server that the client owns the secret private key without revealing the key. This way you do not need to reenter your password every time. Nevertheless, the private key (often <code>~/.ssh/id_rsa</code> and more recently <code>~/.ssh/id_ed25519</code>) is effectively your password, so treat it like so.</p>
<h4 id="key-generating"><a class="header" href="#key-generating">Key generating</a></h4>
<p>To generate a pair you can run <a href="missing-semester/">ssh-keygen</a>``.</p>
<pre><code class="language-bash">ssh-keygen -o -a 100 -t ed25519 -f ~/.ssh/id_ed25519
</code></pre>
<p>You should choose a passphrase, to avoid someone who gets hold of your private key to access authorized servers. Use <a href="missing-semester/">ssh-agent</a><code> or [gpg-agent]()</code> so you do not have to type your passphrase every time.</p>
<p>If you have ever configured pushing to GitHub using SSH keys, then you have probably done the steps outlined <a href="https://help.github.com/articles/connecting-to-github-with-ssh/">here</a> and have a valid key pair already. To check if you have a passphrase and validate it you can run <code>ssh-keygen -y -f /path/to/key</code>.</p>
<h4 id="key-based-authentication"><a class="header" href="#key-based-authentication">key based authentication</a></h4>
<p><code>ssh</code> will look into <code>.ssh/authorized_keys</code> to determine which clients it should let in.</p>
<pre><code class="language-bash">ssh-copy-id -i .ssh/id_ed25519 foobar@remote
</code></pre>
<h3 id="copying-files-over-ssh"><a class="header" href="#copying-files-over-ssh">Copying files over SSH</a></h3>
<p>There are many ways to copy files over ssh:</p>
<ul>
<li><code>ssh+tee</code>, the simplest is to use <code>ssh</code> command execution and STDIN input by doing <code>cat localfile | ssh remote_server tee serverfile</code>. Recall that <a href="missing-semester/">tee</a>`` writes the output from STDIN into a file.</li>
<li><a href="missing-semester/">scp</a>`` when copying large amounts of files/directories, the secure copy <code>scp</code> command is more convenient since it can easily recurse over paths. The syntax is <code>scp path/to/local_file remote_host:path/to/remote_file</code></li>
<li><a href="missing-semester/">rsync</a>`` improves upon <code>scp</code> by detecting identical files in local and remote, and preventing copying them again. It also provides more fine grained control over symlinks, permissions and has extra features like the <code>--partial</code> flag that can resume from a previously interrupted copy. <code>rsync</code> has a similar syntax to <code>scp</code>.</li>
</ul>
<h3 id="port-forwarding"><a class="header" href="#port-forwarding">Port Forwarding</a></h3>
<p>In many scenarios you will run into software that listens to specific ports in the machine. When this happens in your local machine you can type <code>localhost:PORT</code> or <code>127.0.0.1:PORT</code>, but what do you do with a remote server that does not have its ports directly available through the network/internet?</p>
<p>This is called <em>port forwarding</em> and it comes in two flavors: Local Port Forwarding and Remote Port Forwarding (see the pictures for more details, credit of the pictures from <a href="https://unix.stackexchange.com/questions/115897/whats-ssh-port-forwarding-and-whats-the-difference-between-ssh-local-and-remot">this StackOverflow post</a>).</p>
<h4 id="local-port-forwarding"><a class="header" href="#local-port-forwarding">Local Port Forwarding</a></h4>
<p><img src="missing-semester/./assets/2-20221120150726-pnr9n1t.png" alt="本地代理" /></p>
<h4 id="remote-port-forwarding"><a class="header" href="#remote-port-forwarding">Remote Port Forwarding</a></h4>
<p><img src="missing-semester/./assets/3-20221120150726-4gx9ds3.png" alt="远程代理" /></p>
<p>The most common scenario is local port forwarding, where a service in the remote machine listens in a port and you want to link a port in your local machine to forward to the remote port. For example, if we execute <code>jupyter notebook</code> in the remote server that listens to the port <code>8888</code>. Thus, to forward that to the local port <code>9999</code>, we would do <code>ssh -L 9999:localhost:8888 foobar@remote_server</code> and then navigate to <code>locahost:9999</code> in our local machine.</p>
<blockquote>
<p>相当于是把远程服务器上的端口映射在本地的计算机上，这样就是在本地上访问，或者反过来。</p>
</blockquote>
<h3 id="ssh-configuration"><a class="header" href="#ssh-configuration">SSH Configuration</a></h3>
<p>We have covered many many arguments that we can pass. A tempting alternative is to create shell aliases that look like</p>
<pre><code class="language-bash">alias my_server="ssh -i ~/.id_ed25519 --port 2222 -L 9999:localhost:8888 foobar@remote_server
</code></pre>
<p>However, there is a better alternative using <code>~/.ssh/config</code>.</p>
<pre><code>Host vm
    User foobar
    HostName 172.16.174.141
    Port 2222
    IdentityFile ~/.ssh/id_ed25519
    LocalForward 9999 localhost:8888

# Configs can also take wildcards
Host *.mit.edu
    User foobaz
</code></pre>
<p>An additional advantage of using the <code>~/.ssh/config</code> file over aliases is that other programs like <code>scp</code>, <code>rsync</code>, <code>mosh</code>, &amp;c are able to read it as well and convert the settings into the corresponding flags.</p>
<p>Note that the <code>~/.ssh/config</code> file can be considered a dotfile, and in general it is fine for it to be included with the rest of your dotfiles. However, if you make it public, think about the information that you are potentially providing strangers on the internet: addresses of your servers, users, open ports, &amp;c. This may facilitate some types of attacks so be thoughtful about sharing your SSH configuration.</p>
<blockquote>
<p>一定不要随便在github上传东西！</p>
</blockquote>
<p>Server side configuration is usually specified in <code>/etc/ssh/sshd_config</code>. Here you can make changes like disabling password authentication, changing ssh ports, enabling X11 forwarding, &amp;c. You can specify config settings on a per user basis.</p>
<h3 id="miscellaneous"><a class="header" href="#miscellaneous">Miscellaneous</a></h3>
<blockquote>
<p>miscellaneous 各种各样的，杂项;</p>
</blockquote>
<p>A common pain when connecting to a remote server are disconnections due to shutting down/sleeping your computer or changing a network. Moreover if one has a connection with significant lag using ssh can become quite frustrating. <a href="https://mosh.org/">Mosh</a>, the mobile shell, improves upon ssh, allowing roaming connections, intermittent connectivity and providing intelligent local echo.</p>
<p>Sometimes it is convenient to mount a remote folder. <a href="https://github.com/libfuse/sshfs">sshfs</a> can mount a folder on a remote server locally, and then you can use a local editor.</p>
<h2 id="shells--frameworks"><a class="header" href="#shells--frameworks">Shells &amp; Frameworks</a></h2>
<p>The <code>zsh</code> shell is a superset of <code>bash</code> and provides many convenient features out of the box such as:</p>
<ul>
<li>Smarter globbing, <code>**</code></li>
<li>Inline globbing/wildcard expansion</li>
<li>Spelling correction</li>
<li>Better tab completion/selection</li>
<li>Path expansion (<code>cd /u/lo/b</code> will expand as <code>/usr/local/bin</code>)</li>
</ul>
<p><strong>Frameworks</strong> can improve your shell as well. Some popular general frameworks are <a href="https://github.com/sorin-ionescu/prezto">prezto</a> or <a href="https://ohmyz.sh/">oh-my-zsh</a>, and smaller ones that focus on specific features such as <a href="https://github.com/zsh-users/zsh-syntax-highlighting">zsh-syntax-highlighting</a> or <a href="https://github.com/zsh-users/zsh-history-substring-search">zsh-history-substring-search</a>. Shells like <a href="https://fishshell.com/">fish</a> include many of these user-friendly features by default. Some of these features include:</p>
<ul>
<li>Right prompt</li>
<li>Command syntax highlighting</li>
<li>History substring search</li>
<li>manpage based flag completions</li>
<li>Smarter autocompletion</li>
<li>Prompt themes</li>
</ul>
<p>One thing to note when using these frameworks is that they may slow down your shell, especially if the code they run is not properly optimized or it is too much code. You can always profile it and disable the features that you do not use often or value over speed.</p>
<h2 id="terminal-emulators"><a class="header" href="#terminal-emulators">Terminal Emulators</a></h2>
<p>Along with customizing your shell, it is worth spending some time figuring out your choice of <strong>terminal emulator</strong> and its settings.</p>
<p>Since you might be spending hundreds to thousands of hours in your terminal it pays off to look into its settings. Some of the aspects that you may want to modify in your terminal include:</p>
<ul>
<li>Font choice</li>
<li>Color Scheme</li>
<li>Keyboard shortcuts</li>
<li>Tab/Pane support</li>
<li>Scrollback configuration</li>
<li>Performance (some newer terminals like <a href="https://github.com/jwilm/alacritty">Alacritty</a> or <a href="https://sw.kovidgoyal.net/kitty/">kitty</a> offer GPU acceleration).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-5"><a class="header" href="#the-missing-semester-in-the-cs-5">The Missing Semester in the CS</a></h1>
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第五篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Potpourri</code>的学习笔记，说成人话就是大杂烩，课程的地址为<a href="https://missing.csail.mit.edu/2020/potpourri/">Potpourri</a>。</p>
<blockquote>
<p>potpourri 肉菜杂烩，这里引申为很多东西的综合体;</p>
</blockquote>
<!--more-->
<h2 id="keyboard-remapping"><a class="header" href="#keyboard-remapping">Keyboard Remapping</a></h2>
<p>The most basic change is to remap keys. This usually involves some software that is listening and, whenever a certain key is pressed, it intercepts that event and replaces it with another event corresponding to a different key. Some examples:</p>
<ul>
<li>Remap Caps Lock to Ctrl or Escape. We (the instructors) highly encourage this setting since Caps Lock has a very convenient location but is rarely used.</li>
<li>Remapping PrtSc to Play/Pause music. Most OSes have a play/pause key.</li>
<li>Swapping Ctrl and the Meta (Windows or Command) key.</li>
</ul>
<blockquote>
<p>从一个游戏人的角度出发，最好在玩游戏的时候不要把<code>Cap Locks</code>绑定为<code>Esc</code>，否则一些不愉快的体验可能在游戏过程中出现。</p>
</blockquote>
<p>You can also map keys to arbitrary commands of your choosing. This is useful for common tasks that you perform. Here, some software listens for a specific key combination and executes some script whenever that event is detected.</p>
<ul>
<li>Open a new terminal or browser window.</li>
<li>Inserting some specific text, e.g. your long email address or your MIT ID number.</li>
<li>Sleeping the computer or the displays.</li>
</ul>
<p>There are even more complex modifications you can configure:</p>
<ul>
<li>Remapping sequences of keys, e.g. pressing shift five times toggles Caps Lock.</li>
<li>Remapping on tap vs on hold, e.g. Caps Lock key is remapped to Esc if you quickly tap it, but is remapped to Ctrl if you hold it and use it as a modifier.</li>
<li>Having remaps being keyboard or software specific.</li>
</ul>
<blockquote>
<p>在Windows平台下面，我还是强力推荐<a href="https://github.com/microsoft/PowerToys">PowerToys</a>这个微软和社区合作开发的开发者工具，它的官方文档在<a href="https://docs.microsoft.com/zh-cn/windows/powertoys">这里</a>。这个软件不仅有键盘自定义这种功能，还提供了其他一下开发者可能用到的实用工具。</p>
</blockquote>
<h2 id="daemons"><a class="header" href="#daemons">Daemons</a></h2>
<blockquote>
<p>daemons 守护进程;</p>
</blockquote>
<p>Most computers have a series of processes that are always running in the background rather than waiting for a user to launch them and interact with them. These processes are called daemons and the programs that run as daemons often end with a <code>d</code> to indicate so. For example <code>sshd</code>, the SSH daemon, is the program responsible for listening to incoming SSH requests and checking that the remote user has the necessary credentials to log in.</p>
<p>In Linux, <code>systemd</code> (the system daemon) is the most common solution for running and setting up daemon processes. You can run <code>systemctl status</code> to list the current running daemons. Most of them might sound unfamiliar but are responsible for core parts of the system such as managing the network, solving DNS queries or displaying the graphical interface for the system. <code>systemd</code> can be interacted with the <code>systemctl</code> command in order to <code>enable</code>, <code>disable</code>, <code>start</code>, <code>stop</code>, <code>restart</code> or check the <code>status</code> of services (those are the <code>systemctl</code> commands).</p>
<p>More interestingly, <code>systemd</code> has a fairly accessible interface for configuring and enabling new daemons (or services). Below is an example of a daemon for running a simple Python app. We won’t go in the details but as you can see most of the fields are pretty self explanatory.</p>
<pre><code class="language-bash"># /etc/systemd/system/myapp.service
[Unit]
Description=My Custom App
After=network.target

[Service]
User=foo
Group=foo
WorkingDirectory=/home/foo/projects/mydaemon
ExecStart=/usr/bin/local/python3.7 app.py
Restart=on-failure

[Install]
WantedBy=multi-user.target
</code></pre>
<p>Also, if you just want to run some program with a given frequency there is no need to build a custom daemon, you can use <a href="missing-semester/">cron</a>``, a daemon your system already runs to perform scheduled tasks.</p>
<h2 id="fuse"><a class="header" href="#fuse">FUSE</a></h2>
<p>Modern software systems are usually composed of smaller building blocks that are composed together. Your operating system supports using different filesystem backends because there is a common language of what operations a filesystem supports. For instance, when you run <code>touch</code> to create a file, <code>touch</code> performs a system call to the kernel to create the file and the kernel performs the appropriate filesystem call to create the given file. A caveat is that UNIX filesystems are traditionally implemented as kernel modules and only the kernel is allowed to perform filesystem calls.</p>
<blockquote>
<p>caveat 警告; implement 实施;</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace">FUSE</a> (Filesystem in User Space) allows filesystems to be implemented by a user program. FUSE lets users run user space code for filesystem calls and then bridges the necessary calls to the kernel interfaces. In practice, this means that users can implement arbitrary functionality for filesystem calls.</p>
<p>For example, FUSE can be used so whenever you perform an operation in a virtual filesystem, that operation is forwarded through SSH to a remote machine, performed there, and the output is returned back to you. This way, local programs can see the file as if it was in your computer while in reality it’s in a remote server. This is effectively what <code>sshfs</code> does.</p>
<p>Some interesting examples of FUSE filesystems are:</p>
<ul>
<li><a href="https://github.com/libfuse/sshfs">sshfs</a> - Open locally remote files/folder through an SSH connection.</li>
<li><a href="https://rclone.org/commands/rclone_mount/">rclone</a> - Mount cloud storage services like Dropbox, GDrive, Amazon S3 or Google Cloud Storage and open data locally.</li>
<li><a href="https://nuetzlich.net/gocryptfs/">gocryptfs</a> - Encrypted overlay system. Files are stored encrypted but once the FS is mounted they appear as plaintext in the mountpoint.</li>
<li><a href="https://keybase.io/docs/kbfs">kbfs</a> - Distributed filesystem with end-to-end encryption. You can have private, shared and public folders.</li>
<li><a href="https://borgbackup.readthedocs.io/en/stable/usage/mount.html">borgbackup</a> - Mount your deduplicated, compressed and encrypted backups for ease of browsing.</li>
</ul>
<blockquote>
<p>感觉在WSL2中访问Windows下的文件就是利用的这类东西，只不过由于是利用网络作为桥梁在性能上不堪重任。</p>
</blockquote>
<h2 id="backups"><a class="header" href="#backups">Backups</a></h2>
<p>Any data that you haven’t backed up is data that could be gone at any moment, forever. It’s easy to copy data around, it’s hard to reliably backup data. Here are some good backup basics and the pitfalls of some approaches.</p>
<blockquote>
<p>pitfalls 陷阱;</p>
</blockquote>
<p>First, a copy of the data in the same disk is not a backup, because the disk is the single point of failure for all the data. Similarly, an external drive in your home is also a weak backup solution since it could be lost in a fire/robbery/&amp;c. Instead, having an off-site backup is a recommended practice.</p>
<p>Synchronization solutions are not backups. For instance, Dropbox/GDrive are convenient solutions, but when data is erased or corrupted they propagate the change. For the same reason, disk mirroring solutions like RAID are not backups. They don’t help if data gets deleted, corrupted or encrypted by ransomware.</p>
<blockquote>
<p>synchronization 同步; erase 擦除; corrupted 损坏的; propagate 传播; ransomware 勒索软件;</p>
</blockquote>
<p>Some core features of good backups solutions are versioning, deduplication and security. Versioning backups ensure that you can access your history of changes and efficiently recover files. Efficient backup solutions use data deduplication to only store incremental changes and reduce the storage overhead. Regarding security, you should ask yourself what someone would need to know/have in order to read your data and, more importantly, to delete all your data and associated backups. Lastly, blindly trusting backups is a terrible idea and you should verify regularly that you can use them to recover data.</p>
<blockquote>
<p>deduplication 重复数据删除; incremental 增加的;</p>
</blockquote>
<p>Backups go beyond local files in your computer. Given the significant growth of web applications, large amounts of your data are only stored in the cloud. For instance, your webmail, social media photos, music playlists in streaming services or online docs are gone if you lose access to the corresponding accounts. Having an offline copy of this information is the way to go, and you can find online tools that people have built to fetch the data and save it.</p>
<blockquote>
<p>这种数据备份未免有点过于未雨绸缪了;</p>
</blockquote>
<h2 id="apis"><a class="header" href="#apis">APIs</a></h2>
<p>We’ve talked a lot in this class about using your computer more efficiently to accomplish <em>local</em> tasks, but you will find that many of these lessons also extend to the wider internet. Most services online will have “APIs” that let you programmatically access their data.</p>
<blockquote>
<p>讲道理，中国的政府机构也应该设计一套比较完善的数据接口供公众使用，这也应该是“数字政府”的重要组成部分。</p>
</blockquote>
<p>Most of these APIs have a similar format. They are structured URLs, often rooted at <code>api.service.com</code>, where the path and query parameters indicate what data you want to read or what action you want to perform.</p>
<p>Some APIs require authentication, and this usually takes the form of some sort of secret <em>token</em> that you need to include with the request. You should read the documentation for the API to see what the particular service you are looking for uses, but “<a href="https://www.oauth.com/">OAuth</a>” is a protocol you will often see used. At its heart, OAuth is a way to give you tokens that can “act as you” on a given service, and can only be used for particular purposes. Keep in mind that these tokens are <em>secret</em>, and anyone who gains access to your token can do whatever the token allows under <em>your</em> account!</p>
<blockquote>
<p>比如<code>github</code>就有相关的token供开发者可以自己生成。</p>
</blockquote>
<h2 id="common-command-line-flagspatterns"><a class="header" href="#common-command-line-flagspatterns">Common command-line flags/patterns</a></h2>
<p>Command-line tools vary a lot, and you will often want to check out their <code>man</code> pages before using them. They often share some common features though that can be good to be aware of:</p>
<ul>
<li>Most tools support some kind of <code>--help</code> flag to display brief usage instructions for the tool.</li>
<li>Many tools that can cause irrevocable change support the notion of a “dry run” in which they only print what they <em>would have done</em>, but do not actually perform the change. Similarly, they often have an “interactive” flag that will prompt you for each destructive action.</li>
<li>You can usually use <code>--version</code> or <code>-V</code> to have the program print its own version (handy for reporting bugs!).</li>
<li>Almost all tools have a <code>--verbose</code> or <code>-v</code> flag to produce more verbose output. You can usually include the flag multiple times (<code>-vvv</code>) to get <em>more</em> verbose output, which can be handy for debugging. Similarly, many tools have a <code>--quiet</code> flag for making it only print something on error.</li>
</ul>
<blockquote>
<p>verbose 冗长的;</p>
</blockquote>
<ul>
<li>In many tools, <code>-</code> in place of a file name means “standard input” or “standard output”, depending on the argument.</li>
<li>Possibly destructive tools are generally not recursive by default, but support a “recursive” flag (often <code>-r</code>) to make them recurse.</li>
<li>Sometimes, you want to pass something that <em>looks</em> like a flag as a normal argument. For example, imagine you wanted to remove a file called <code>-r</code>. Or you want to run one program “through” another, like <code>ssh machine foo</code>, and you want to pass a flag to the “inner” program (<code>foo</code>). The special argument <code>--</code> makes a program <em>stop</em> processing flags and options (things starting with <code>-</code>) in what follows, letting you pass things that look like flags without them being interpreted as such: <code>rm -- -r</code> or <code>ssh machine --for-ssh -- foo --for-foo</code>.</li>
</ul>
<h2 id="windows-managers"><a class="header" href="#windows-managers">Windows Managers</a></h2>
<p>Most of you are used to using a “drag and drop” window manager, like what comes with Windows, macOS, and Ubuntu by default. There are windows that just sort of hang there on screen, and you can drag them around, resize them, and have them overlap one another. But these are only one <em>type</em> of window manager, often referred to as a “floating” window manager. There are many others, especially on Linux. A particularly common alternative is a “tiling” window manager. In a tiling window manager, windows never overlap, and are instead arranged as tiles on your screen, sort of like panes in tmux. With a tiling window manager, the screen is always filled by whatever windows are open, arranged according to some <em>layout</em>. If you have just one window, it takes up the full screen. If you then open another, the original window shrinks to make room for it (often something like 2/3 and 1/3). If you open a third, the other windows will again shrink to accommodate the new window. Just like with tmux panes, you can navigate around these tiled windows with your keyboard, and you can resize them and move them around, all without touching the mouse. They are worth looking into!</p>
<blockquote>
<p>有·高级</p>
</blockquote>
<h2 id="vpns"><a class="header" href="#vpns">VPNs</a></h2>
<p>VPNs are all the rage these days, but it’s not clear that’s for <a href="https://gist.github.com/joepie91/5a9909939e6ce7d09e29">any good reason</a>. You should be aware of what a VPN does and does not get you. A VPN, in the best case, is <em>really</em> just a way for you to change your internet service provider as far as the internet is concerned. All your traffic will look like it’s coming from the VPN provider instead of your “real” location, and the network you are connected to will only see encrypted traffic.</p>
<p>While that may seem attractive, keep in mind that when you use a VPN, all you are really doing is shifting your trust from you current ISP to the VPN hosting company. Whatever your ISP <em>could</em> see, the VPN provider now sees <em>instead</em>. If you trust them <em>more</em> than your ISP, that is a win, but otherwise, it is not clear that you have gained much. If you are sitting on some dodgy unencrypted public Wi-Fi at an airport, then maybe you don’t trust the connection much, but at home, the trade-off is not quite as clear.</p>
<p>You should also know that these days, much of your traffic, at least of a sensitive nature, is <em>already</em> encrypted through HTTPS or TLS more generally. In that case, it usually matters little whether you are on a “bad” network or not – the network operator will only learn what servers you talk to, but not anything about the data that is exchanged.</p>
<p>Notice that I said “in the best case” above. It is not unheard of for VPN providers to accidentally misconfigure their software such that the encryption is either weak or entirely disabled. Some VPN providers are malicious (or at the very least opportunist), and will log all your traffic, and possibly sell information about it to third parties. Choosing a bad VPN provider is often worse than not using one in the first place.</p>
<blockquote>
<p>确实，尽管由于各种各样的原因，我们可能需要VPN的辅助，但是VPN并不是可信的。</p>
</blockquote>
<h2 id="markdown"><a class="header" href="#markdown">Markdown</a></h2>
<blockquote>
<p>Markdown yyds</p>
</blockquote>
<p>You have probably seen Markdown already, or at least some variant of it. Subsets of it are used and supported almost everywhere, even if it’s not under the name Markdown. At its core, Markdown is an attempt to codify the way that people already often mark up text when they are writing plain text documents. Emphasis (<em>italics</em>) is added by surrounding a word with <code>*</code>. Strong emphasis (<strong>bold</strong>) is added using <code>**</code>. Lines starting with <code>#</code> are headings (and the number of <code>#</code>s is the subheading level). Any line starting with <code>-</code> is a bullet list item, and any line starting with a number + <code>.</code> is a numbered list item. Backtick is used to show words in <code>code font</code>, and a code block can be entered by indenting a line with four spaces or surrounding it with triple-backticks:</p>
<pre><code class="language-markdown">```
code here
```
</code></pre>
<p>To add a link, place the <em>text</em> for the link in square brackets, and the URL immediately following that in parentheses: <code>[name](url)</code>. Markdown is easy to get started with, and you can use it nearly everywhere.</p>
<h2 id="hammerspoon"><a class="header" href="#hammerspoon">Hammerspoon</a></h2>
<blockquote>
<p>Hammerspoon 很强大，但是只支持macOS，对不起，穷苦人家告辞。</p>
</blockquote>
<h2 id="bootinglive-usbs"><a class="header" href="#bootinglive-usbs">Booting+Live USBs</a></h2>
<p>When your machine boots up, before the operating system is loaded, the <a href="https://en.wikipedia.org/wiki/BIOS">BIOS</a>/<a href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a> initializes the system. During this process, you can press a specific key combination to configure this layer of software. For example, your computer may say something like “Press F9 to configure BIOS. Press F12 to enter boot menu.” during the boot process. You can configure all sorts of hardware-related settings in the BIOS menu. You can also enter the boot menu to boot from an alternate device instead of your hard drive.</p>
<p><a href="https://en.wikipedia.org/wiki/Live_USB">Live USBs</a> are USB flash drives containing an operating system. You can create one of these by downloading an operating system (e.g. a Linux distribution) and burning it to the flash drive. This process is a little bit more complicated than simply copying a <code>.iso</code> file to the disk. There are tools like <a href="https://unetbootin.github.io/">UNetbootin</a> to help you create live USBs.</p>
<p>Live USBs are useful for all sorts of purposes. Among other things, if you break your existing operating system installation so that it no longer boots, you can use a live USB to recover data or fix the operating system.</p>
<blockquote>
<p>中国人对于这个更熟悉的名称是PE盘。</p>
</blockquote>
<h2 id="docker-vagrant-vms-cloud"><a class="header" href="#docker-vagrant-vms-cloud">Docker, Vagrant, VMs, Cloud</a></h2>
<p><a href="https://en.wikipedia.org/wiki/Virtual_machine">Virtual machines</a> and similar tools like containers let you emulate a whole computer system, including the operating system. This can be useful for creating an isolated environment for testing, development, or exploration (e.g. running potentially malicious code).</p>
<p><a href="https://www.vagrantup.com/">Vagrant</a> is a tool that lets you describe machine configurations (operating system, services, packages, etc.) in code, and then instantiate VMs with a simple <code>vagrant up</code>. <a href="https://www.docker.com/">Docker</a> is conceptually similar but it uses containers instead.</p>
<p>You can also rent virtual machines on the cloud, and it’s a nice way to get instant access to:</p>
<ul>
<li>A cheap always-on machine that has a public IP address, used to host services</li>
<li>A machine with a lot of CPU, disk, RAM, and/or GPU</li>
<li>Many more machines than you physically have access to (billing is often by the second, so if you want a lot of computing for a short amount of time, it’s feasible to rent 1000 computers for a couple of minutes)</li>
</ul>
<h2 id="notebook-programming"><a class="header" href="#notebook-programming">Notebook Programming</a></h2>
<p><a href="https://en.wikipedia.org/wiki/Notebook_interface">Notebook programming environments</a> can be really handy for doing certain types of interactive or exploratory development. Perhaps the most popular notebook programming environment today is <a href="https://jupyter.org/">Jupyter</a>, for Python (and several other languages). <a href="https://www.wolfram.com/mathematica/">Wolfram Mathematica</a> is another notebook programming environment that’s great for doing math-oriented programming.</p>
<h2 id="github"><a class="header" href="#github">GitHub</a></h2>
<p><a href="https://github.com/">GitHub</a> is one of the most popular platforms for open-source software development. Many of the tools we’ve talked about in this class, from <a href="https://github.com/vim/vim">vim</a> to <a href="https://github.com/Hammerspoon/hammerspoon">Hammerspoon</a>, are hosted on GitHub. It’s easy to get started contributing to open-source to help improve the tools that you use every day.</p>
<p>There are two primary ways in which people contribute to projects on GitHub:</p>
<ul>
<li>Creating an <a href="https://help.github.com/en/github/managing-your-work-on-github/creating-an-issue">issue</a>. This can be used to report bugs or request a new feature. Neither of these involves reading or writing code, so it can be pretty lightweight to do. High-quality bug reports can be extremely valuable to developers. Commenting on existing discussions can be helpful too.</li>
<li>Contribute code through a <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">pull request</a>. This is generally more involved than creating an issue. You can <a href="https://help.github.com/en/github/getting-started-with-github/fork-a-repo">fork</a> a repository on GitHub, clone your fork, create a new branch, make some changes (e.g. fix a bug or implement a feature), push the branch, and then <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request">create a pull request</a>. After this, there will generally be some back-and-forth with the project maintainers, who will give you feedback on your patch. Finally, if all goes well, your patch will be merged into the upstream repository. Often times, larger projects will have a contributing guide, tag beginner-friendly issues, and some even have mentorship programs to help first-time contributors become familiar with the project.</li>
</ul>
<blockquote>
<p>没有什么是比合作开发一个开源软件更令人激动的了。</p>
</blockquote>
<blockquote>
<p>昨天我搞懂了<code>GitHub</code>和<code>GitLab</code>的区别，顺便在这里记一下</p>
<ul>
<li>GitHub是一个支持<code>git</code>的代码托管网站，只是不少的开源软件托管在上面。</li>
<li>GitLab则是一个支持<code>git</code>的软件开发平台，相当是是一个用来搭建GitHub的软件。</li>
</ul>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-6"><a class="header" href="#the-missing-semester-in-the-cs-6">The Missing Semester in the CS</a></h1>
<h2 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第六篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Version Control(Git)</code>部分的学习笔记，课程地址<a href="https://missing.csail.mit.edu/2020/version-control/">Version Control(Git)</a></p>
<!--more-->
<blockquote>
<p>这篇还是很好的，它没有教你怎么用<code>git</code>,而是教你<code>git</code>背后的原理是什么。</p>
<p>授之以’道‘，而非授之以’术‘。</p>
</blockquote>
<p>Version control systems (VCSs) are tools used to track changes to source code (or other collections of files and folders). As the name implies, these tools help maintain a history of changes; furthermore, they facilitate collaboration. VCSs track changes to a folder and its contents in a series of snapshots, where each snapshot encapsulates the entire state of files/folders within a top-level directory. VCSs also maintain metadata like who created each snapshot, messages associated with each snapshot, and so on.</p>
<blockquote>
<p>facilitate 促进; collaboration 合作; snapshot 快照;</p>
</blockquote>
<p>Modern VCSs also let you easily (and often automatically) answer questions like:</p>
<ul>
<li>Who wrote this module?</li>
<li>When was this particular line of this particular file edited? By whom? Why was it edited?</li>
<li>Over the last 1000 revisions, when/why did a particular unit test stop working?</li>
</ul>
<p>Because Git’s interface is a leaky abstraction, learning Git top-down (starting with its interface / command-line interface) can lead to a lot of confusion. While Git admittedly has an ugly interface, its underlying design and ideas are beautiful. While an ugly interface has to be <em>memorized</em>, a beautiful design can be <em>understood</em>. For this reason, we give a bottom-up explanation of Git, starting with its data model and later covering the command-line interface. Once the data model is understood, the commands can be better understood in terms of how they manipulate the underlying data model.</p>
<h2 id="gits-data-model"><a class="header" href="#gits-data-model">Git's data model</a></h2>
<h3 id="snapshots"><a class="header" href="#snapshots">Snapshots</a></h3>
<p>Git models the history of a collection of files and folders within some top-level directory as a series of snapshots. In Git terminology, a file is called a “blob”, and it’s just a bunch of bytes. A directory is called a “tree”, and it maps names to blobs or trees (so directories can contain other directories). A snapshot is the top-level tree that is being tracked. For example, we might have a tree as follows:</p>
<blockquote>
<p>terminology 术语;</p>
</blockquote>
<pre><code>&lt;root&gt; (tree)
|
+- foo (tree)
|  |
|  + bar.txt (blob, contents = "hello world")
|
+- baz.txt (blob, contents = "git is wonderful")
</code></pre>
<h3 id="modeling-history-relating-snapshots"><a class="header" href="#modeling-history-relating-snapshots">Modeling history: relating snapshots</a></h3>
<p>In Git, a history is a directed acyclic graph (DAG) of snapshots. That may sound like a fancy math word, but don’t be intimidated. All this means is that each snapshot in Git refers to a set of “parents”, the snapshots that preceded it. It’s a set of parents rather than a single parent (as would be the case in a linear history) because a snapshot might descend from multiple parents, for example, due to combining (merging) two parallel branches of development.</p>
<blockquote>
<p>acyclic 无环的; preceded 先于;</p>
</blockquote>
<p>Git calls these snapshots “commit”s. Visualizing a commit history might look something like this:</p>
<pre><code>o &lt;-- o &lt;-- o &lt;-- o
            ^
             \
              --- o &lt;-- o
</code></pre>
<p>In the ASCII art above, the <code>o</code>s correspond to individual commits (snapshots). The arrows point to the parent of each commit (it’s a “comes before” relation, not “comes after”). After the third commit, the history branches into two separate branches. This might correspond to, for example, two separate features being developed in parallel, independently from each other. In the future, these branches may be merged to create a new snapshot that incorporates both of the features, producing a new history that looks like this, with the newly created merge commit shown in bold:</p>
<blockquote>
<p>incorporate 包含;</p>
</blockquote>
<pre><code>o &lt;-- o &lt;-- o &lt;-- o &lt;---- o
            ^            /
             \          v
              --- o &lt;-- o
</code></pre>
<h3 id="data-model-as-pseudocode"><a class="header" href="#data-model-as-pseudocode">Data model, as pseudocode</a></h3>
<blockquote>
<p>pseudocode 伪代码;</p>
</blockquote>
<p>It may be instructive to see Git’s data model written down in pseudocode:</p>
<pre><code>// a file is a bunch of bytes
type blob = array&lt;byte&gt;

// a directory contains named files and directories
type tree = map&lt;string, tree | blob&gt;

// a commit has parents, metadata, and the top-level tree
type commit = struct {
    parents: array&lt;commit&gt;
    author: string
    message: string
    snapshot: tree
}
</code></pre>
<h3 id="objects-and-content-addressing"><a class="header" href="#objects-and-content-addressing">Objects and content-addressing</a></h3>
<p>An "object" is a blob, tree or commit:</p>
<pre><code>type object = blob | tree | commit
</code></pre>
<p>In Git data store, all objects are content-addressed by their <a href="https://en.wikipedia.org/wiki/SHA-1">SHA-1 hash</a>.</p>
<pre><code>objects = map&lt;string, object&gt;

def store(object):
    id = sha1(object)
    objects[id] = object

def load(id):
    return objects[id]
</code></pre>
<p>Blobs, trees, and commits are unified in this way: they are all objects. When they reference other objects, they don’t actually <em>contain</em> them in their on-disk representation, but have a reference to them by their hash.</p>
<p>For example, the tree for the example directory structure above (visualized using <code>git cat-file -p 698281bc680d1995c5f4caaf3359721a5a58d48d</code>), looks like this:</p>
<pre><code>100644 blob 4448adbf7ecd394f42ae135bbeed9676e894af85    baz.txt
040000 tree c68d233a33c5c06e0340e4c224f0afca87c8ce87    foo
</code></pre>
<p>The tree itself contains pointers to its contents, <code>baz.txt</code> (a blob) and <code>foo</code> (a tree). If we look at the contents addressed by the hash corresponding to baz.txt with <code>git cat-file -p 4448adbf7ecd394f42ae135bbeed9676e894af85</code>, we get the following:</p>
<pre><code>git is wonderful
</code></pre>
<h3 id="references"><a class="header" href="#references">References</a></h3>
<p>Now, all snapshots can be identified by their SHA-1 hashes. That’s inconvenient, because humans aren’t good at remembering strings of 40 hexadecimal characters.</p>
<p>Git’s solution to this problem is human-readable names for SHA-1 hashes, called “references”. References are pointers to commits. Unlike objects, which are immutable, references are mutable (can be updated to point to a new commit). For example, the <code>master</code> reference usually points to the latest commit in the main branch of development.</p>
<blockquote>
<p>mutable 可变的;</p>
</blockquote>
<pre><code>references = map&lt;string, string&gt;

def update_reference(name, id):
    references[name] = id

def read_reference(name):
    return references[name]

def load_reference(name_or_id):
    if name_or_id in references:
        return load(references[name_or_id])
    else:
        return load(name_or_id)
</code></pre>
<p>With this, Git can use human-readable names like “master” to refer to a particular snapshot in the history, instead of a long hexadecimal string.</p>
<p>One detail is that we often want a notion of “where we currently are” in the history, so that when we take a new snapshot, we know what it is relative to (how we set the <code>parents</code> field of the commit). In Git, that “where we currently are” is a special reference called “HEAD”.</p>
<h3 id="repositories"><a class="header" href="#repositories">Repositories</a></h3>
<p>Finally, we can define what (roughly) is a Git <em>repository</em>: it is the data <code>objects</code> and <code>references</code>.</p>
<p>On disk, all Git stores are objects and references: that’s all there is to Git’s data model. All <code>git</code> commands map to some manipulation of the commit DAG by adding objects and adding/updating references.</p>
<p>Whenever you’re typing in any command, think about what manipulation the command is making to the underlying graph data structure. Conversely, if you’re trying to make a particular kind of change to the commit DAG.</p>
<h2 id="staging-area"><a class="header" href="#staging-area">Staging area</a></h2>
<p>This is another concept that’s orthogonal to the data model, but it’s a part of the interface to create commits.</p>
<blockquote>
<p>orthogonal 正交的;</p>
</blockquote>
<p>One way you might imagine implementing snapshotting as described above is to have a “create snapshot” command that creates a new snapshot based on the <em>current state</em> of the working directory. Some version control tools work like this, but not Git. We want clean snapshots, and it might not always be ideal to make a snapshot from the current state. For example, imagine a scenario where you’ve implemented two separate features, and you want to create two separate commits, where the first introduces the first feature, and the next introduces the second feature. Or imagine a scenario where you have debugging print statements added all over your code, along with a bugfix; you want to commit the bugfix while discarding all the print statements.</p>
<p>Git accommodates such scenarios by allowing you to specify which modifications should be included in the next snapshot through a mechanism called the “staging area”.</p>
<h2 id="git-command-line-interface"><a class="header" href="#git-command-line-interface">Git command-line interface</a></h2>
<h3 id="basics-1"><a class="header" href="#basics-1">Basics</a></h3>
<ul>
<li><code>git help &lt;command&gt;</code>: get help for a git command</li>
<li><code>git init</code>: creates a new git repo, with data stored in the <code>.git</code> directory</li>
<li><code>git status</code>: tells you what’s going on</li>
<li><code>git add &lt;filename&gt;</code>: adds files to staging area</li>
<li><code>git commit</code>: creates a new commit
<ul>
<li>Write <a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">good commit messages</a>!</li>
<li>Even more reasons to write <a href="https://chris.beams.io/posts/git-commit/">good commit messages</a>!</li>
</ul>
</li>
<li><code>git log</code>: shows a flattened log of history</li>
<li><code>git log --all --graph --decorate</code>: visualizes history as a DAG</li>
<li><code>git diff &lt;filename&gt;</code>: show changes you made relative to the staging area</li>
<li><code>git diff &lt;revision&gt; &lt;filename&gt;</code>: shows differences in a file between snapshots</li>
<li><code>git checkout &lt;revision&gt;</code>: updates HEAD and current branch</li>
</ul>
<h3 id="branching-and-merging"><a class="header" href="#branching-and-merging">Branching and merging</a></h3>
<ul>
<li><code>git branch</code>: shows branches</li>
<li><code>git branch &lt;name&gt;</code>: creates a branch</li>
<li><code>git checkout -b &lt;name&gt;</code>: creates a branch and switches to it
<ul>
<li>same as <code>git branch &lt;name&gt;; git checkout &lt;name&gt;</code></li>
</ul>
</li>
<li><code>git merge &lt;revision&gt;</code>: merges into current branch</li>
<li><code>git mergetool</code>: use a fancy tool to help resolve merge conflicts</li>
<li><code>git rebase</code>: rebase set of patches onto a new base</li>
</ul>
<h3 id="remotes"><a class="header" href="#remotes">Remotes</a></h3>
<ul>
<li><code>git remote</code>: list remotes</li>
<li><code>git remote add &lt;name&gt; &lt;url&gt;</code>: add a remote</li>
<li><code>git push &lt;remote&gt; &lt;local branch&gt;:&lt;remote branch&gt;</code>: send objects to remote, and update remote reference</li>
<li><code>git branch --set-upstream-to=&lt;remote&gt;/&lt;remote branch&gt;</code>: set up correspondence between local and remote branch</li>
<li><code>git fetch</code>: retrieve objects/references from a remote</li>
<li><code>git pull</code>: same as <code>git fetch; git merge</code></li>
<li><code>git clone</code>: download repository from remote</li>
</ul>
<h3 id="undo"><a class="header" href="#undo">Undo</a></h3>
<ul>
<li><code>git commit --amend</code>: edit a commit’s contents/message</li>
<li><code>git reset HEAD &lt;file&gt;</code>: unstage a file</li>
<li><code>git checkout -- &lt;file&gt;</code>: discard changes</li>
</ul>
<h2 id="advanced-git"><a class="header" href="#advanced-git">Advanced Git</a></h2>
<ul>
<li><code>git config</code>: Git is <a href="https://git-scm.com/docs/git-config">highly customizable</a></li>
<li><code>git clone --depth=1</code>: shallow clone, without entire version history</li>
<li><code>git add -p</code>: interactive staging</li>
<li><code>git rebase -i</code>: interactive rebasing</li>
<li><code>git blame</code>: show who last edited which line</li>
<li><code>git stash</code>: temporarily remove modifications to working directory</li>
<li><code>git bisect</code>: binary search history (e.g. for regressions)</li>
<li><code>.gitignore</code>: <a href="https://git-scm.com/docs/gitignore">specify</a> intentionally untracked files to ignore</li>
</ul>
<h2 id="miscellaneous-1"><a class="header" href="#miscellaneous-1">Miscellaneous</a></h2>
<ul>
<li><strong>GUIs</strong>: there are many <a href="https://git-scm.com/downloads/guis">GUI clients</a> out there for Git. We personally don’t use them and use the command-line interface instead.</li>
<li><strong>Shell integration</strong>: it’s super handy to have a Git status as part of your shell prompt (<a href="https://github.com/olivierverdier/zsh-git-prompt">zsh</a>, <a href="https://github.com/magicmonty/bash-git-prompt">bash</a>). Often included in frameworks like <a href="https://github.com/ohmyzsh/ohmyzsh">Oh My Zsh</a>.</li>
<li><strong>Editor integration</strong>: similarly to the above, handy integrations with many features. <a href="https://github.com/tpope/vim-fugitive">fugitive.vim</a> is the standard one for Vim.</li>
<li><strong>GitHub</strong>: Git is not GitHub. GitHub has a specific way of contributing code to other projects, called <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">pull requests</a>.</li>
<li><strong>Other Git providers</strong>: GitHub is not special: there are many Git repository hosts, like <a href="https://about.gitlab.com/">GitLab</a> and <a href="https://bitbucket.org/">BitBucket</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-7"><a class="header" href="#the-missing-semester-in-the-cs-7">The Missing Semester in the CS</a></h1>
<h2 id="introduction-9"><a class="header" href="#introduction-9">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第七篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Debugging and Profiling</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/debugging-profiling/">Debugging and Profiling</a>.</p>
<blockquote>
<p>A golden rule in programming is that code does not do what you expect it to do, but what you tell it to do.</p>
</blockquote>
<!--more-->
<h2 id="debugging"><a class="header" href="#debugging">Debugging</a></h2>
<h3 id="printf-debugging-and-logging"><a class="header" href="#printf-debugging-and-logging">Printf debugging and Logging</a></h3>
<blockquote>
<p>“The most effective debugging tool is still careful thought, coupled with judiciously placed print statements” — Brian Kernighan, <em>Unix for Beginners</em>.</p>
</blockquote>
<p>A first approach to debug a program is to add print statements around where you have detected the problem, and keep iterating until you have extracted enough information to understand what is responsible for the issue.</p>
<blockquote>
<p>extract 提炼;</p>
</blockquote>
<p>A second approach is to use logging in your program, instead of ad hoc print statements. Logging is better than regular print statements for several reasons:</p>
<ul>
<li>You can log to files, sockets or even remote servers instead of standard output.</li>
<li>Logging supports severity levels (such as INFO, DEBUG, WARN, ERROR, &amp;c), that allow you to filter the output accordingly.</li>
<li>For new issues, there’s a fair chance that your logs will contain enough information to detect what is going wrong.</li>
</ul>
<pre><code class="language-bash">python logger.py
</code></pre>
<p><img src="missing-semester/./assets/8-20221120150726-9ymve52.png" alt="print" /></p>
<pre><code class="language-bash">python logger.py log
</code></pre>
<p><img src="missing-semester/./assets/9-20221120150727-46cjhzb.png" alt="log" /></p>
<pre><code class="language-bash">python logger.py log ERROR
</code></pre>
<p><img src="missing-semester/./assets/10-20221120150727-rwko7y4.png" alt="ERROR" /></p>
<pre><code class="language-bash">python logger.py color
</code></pre>
<p><img src="missing-semester/./assets/4-20221120150727-p4teqn2.png" alt="color" /></p>
<p>By now you probably have realized that your terminal uses colors to make things more readable. But how does it do it? Programs like <code>ls</code> or <code>grep</code> are using <a href="https://en.wikipedia.org/wiki/ANSI_escape_code">ANSI escape codes</a>, which are special sequences of characters to indicate your shell to change the color of the output. For example, executing <code>echo -e "\e[38;2;255;0;0mThis is red\e[0m"</code> prints the message <code>This is red</code> in red on your terminal, as long as it supports <a href="https://github.com/termstandard/colors#truecolor-support-in-output-devices">true color</a>. If your terminal doesn’t support this (e.g. macOS’s Terminal.app), you can use the more universally supported escape codes for 16 color choices, for example <code>echo -e "\e[31;1mThis is red\e[0m"</code>.</p>
<p>The following script shows how to print many RGB colors into your terminal (again, as long as it supports true color).</p>
<pre><code class="language-bash">#!/usr/bin/env bash
for R in $(seq 0 20 255); do
    for G in $(seq 0 20 255); do
        for B in $(seq 0 20 255); do
            printf "\e[38;2;${R};${G};${B}m█\e[0m";
        done
    done
done
</code></pre>
<p><img src="missing-semester/./assets/5-20221120150727-5excbbk.png" alt="Colorful" /></p>
<h3 id="third-party-logs"><a class="header" href="#third-party-logs">Third party logs</a></h3>
<p>As you start building larger software systems you will most probably run into dependencies that run as separate programs. Web servers, databases or message brokers are common examples of this kind of dependencies. When interacting with these systems it is often necessary to read their logs, since client side error messages might not suffice.</p>
<p>Luckily, most programs write their own logs somewhere in your system. In UNIX systems, it is commonplace for programs to write their logs under <code>/var/log</code>. For instance, the <a href="https://www.nginx.com/">NGINX</a> webserver places its logs under <code>/var/log/nginx</code>. More recently, systems have started using a <strong>system log</strong>, which is increasingly where all of your log messages go. Most (but not all) Linux systems use <code>systemd</code>, a system daemon that controls many things in your system such as which services are enabled and running. <code>systemd</code> places the logs under <code>/var/log/journal</code> in a specialized format and you can use the <a href="missing-semester/">journalctl</a><code> command to display the messages. Similarly, on macOS there is still `/var/log/system.log` but an increasing number of tools use the system log, that can be displayed with [log show]()</code>. On most UNIX systems you can also use the <a href="missing-semester/">dmesg</a>`` command to access the kernel log.</p>
<h3 id="debuggers"><a class="header" href="#debuggers">Debuggers</a></h3>
<p>When printf debugging is not enough you should use a debugger. Debuggers are programs that let you interact with the execution of a program, allowing the following:</p>
<ul>
<li>Halt execution of the program when it reaches a certain line.</li>
<li>Step through the program one instruction at a time.</li>
<li>Inspect values of variables after the program crashed.</li>
<li>Conditionally halt the execution when a given condition is met.</li>
<li>And many more advanced features</li>
</ul>
<p>Many programming languages come with some form of debugger. In Python this is the Python Debugger <a href="missing-semester/">pdb</a>``.</p>
<p>Here is a brief description of some of the commands <code>pdb</code> supports:</p>
<ul>
<li><strong>l</strong>(ist) - Displays 11 lines around the current line or continue the previous listing.</li>
<li><strong>s</strong>(tep) - Execute the current line, stop at the first possible occasion.</li>
<li><strong>n</strong>(ext) - Continue execution until the next line in the current function is reached or it returns.</li>
<li><strong>b</strong>(reak) - Set a breakpoint (depending on the argument provided).</li>
<li><strong>p</strong>(rint) - Evaluate the expression in the current context and print its value. There’s also <strong>pp</strong> to display using <a href="missing-semester/">pprint</a>`` instead.</li>
<li><strong>r</strong>(eturn) - Continue execution until the current function returns.</li>
<li><strong>q</strong>(uit) - Quit the debugger.</li>
</ul>
<p>Note that since Python is an interpreted language we can use the <code>pdb</code> shell to execute commands and to execute instructions. <a href="missing-semester/">ipdb</a><code> is an improved `pdb` that uses the [IPython]()</code> REPL enabling tab completion, syntax highlighting, better tracebacks, and better introspection while retaining the same interface as the <code>pdb</code> module.</p>
<blockquote>
<p>REPL read-eval-print loop 读取-求值-输出循环，即为交互式编程环境</p>
</blockquote>
<p>For more low level programming you will probably want to look into <a href="missing-semester/">gdb</a><code> (and its quality of life modification [pwndbg]()</code>) and <a href="missing-semester/">lldb</a>``. They are optimized for C-like language debugging but will let you probe pretty much any process and get its current machine state: registers, stack, program counter, &amp;c.</p>
<h3 id="specialized-tools"><a class="header" href="#specialized-tools">Specialized Tools</a></h3>
<p>Even if what you are trying to debug is a black box binary there are tools that can help you with that. Whenever programs need to perform actions that only the kernel can, they use <a href="https://en.wikipedia.org/wiki/System_call">System Calls</a>. There are commands that let you trace the syscalls your program makes. In Linux there’s <a href="missing-semester/">strace</a><code> and macOS and BSD have [dtrace]()</code>. <code>dtrace</code> can be tricky to use because it uses its own <code>D</code> language, but there is a wrapper called <a href="missing-semester/">dtruss</a>`` that provides an interface more similar to <code>strace</code> (more details <a href="https://8thlight.com/blog/colin-jones/2015/11/06/dtrace-even-better-than-strace-for-osx.html">here</a>).</p>
<p>Under some circumstances, you may need to look at the network packets to figure out the issue in your program. Tools like <a href="missing-semester/">tcpdump</a>`` and <a href="https://www.wireshark.org/">Wireshark</a> are network packet analyzers that let you read the contents of network packets and filter them based on different criteria.</p>
<p>For web development, the Chrome/Firefox developer tools are quite handy. They feature a large number of tools, including:</p>
<ul>
<li>Source code - Inspect the HTML/CSS/JS source code of any website.</li>
<li>Live HTML, CSS, JS modification - Change the website content, styles and behavior to test (you can see for yourself that website screenshots are not valid proofs).</li>
<li>Javascript shell - Execute commands in the JS REPL.</li>
<li>Network - Analyze the requests timeline.</li>
<li>Storage - Look into the Cookies and local application storage.</li>
</ul>
<h3 id="static-analysis"><a class="header" href="#static-analysis">Static Analysis</a></h3>
<p>For some issues you do not need to run any code. For example, just by carefully looking at a piece of code you could realize that your loop variable is shadowing an already existing variable or function name; or that a program reads a variable before defining it. Here is where <a href="https://en.wikipedia.org/wiki/Static_program_analysis">static analysis</a> tools come into play. Static analysis programs take source code as input and analyze it using coding rules to reason about its correctness.</p>
<p>In the shell tools lecture we covered <a href="missing-semester/">shellcheck</a>``, which is a similar tool for shell scripts.</p>
<p>Most editors and IDEs support displaying the output of these tools within the editor itself, highlighting the locations of warnings and errors. This is often called <strong>code linting</strong> and it can also be used to display other types of issues such as stylistic violations or insecure constructs.</p>
<p>In vim, the plugins <a href="missing-semester/">ale</a><code> or [syntastic]()</code> will let you do that. For Python, <a href="missing-semester/">pylint</a><code> and [pep8]()</code> are examples of stylistic linters and <a href="missing-semester/">bandit</a>`` is a tool designed to find common security issues. For other languages people have compiled comprehensive lists of useful static analysis tools, such as <a href="https://github.com/mre/awesome-static-analysis">Awesome Static Analysis</a> (you may want to take a look at the <em>Writing</em> section) and for linters there is <a href="https://github.com/caramelomartins/awesome-linters">Awesome Linters</a>.</p>
<p>A complementary tool to stylistic linting are code formatters such as <a href="missing-semester/">black</a><code> for Python, `gofmt` for Go, `rustfmt` for Rust or [prettier]()</code> for JavaScript, HTML and CSS. These tools autoformat your code so that it’s consistent with common stylistic patterns for the given programming language. Although you might be unwilling to give stylistic control about your code, standardizing code format will help other people read your code and will make you better at reading other people’s (stylistically standardized) code.</p>
<h2 id="profiling"><a class="header" href="#profiling">Profiling</a></h2>
<p>Even if your code functionally behaves as you would expect, that might not be good enough if it takes all your CPU or memory in the process. Algorithms classes often teach big <em>O</em> notation but not how to find hot spots in your programs. Since <a href="http://wiki.c2.com/?PrematureOptimization">premature optimization is the root of all evil</a>, you should learn about profilers and monitoring tools. They will help you understand which parts of your program are taking most of the time and/or resources so you can focus on optimizing those parts.</p>
<blockquote>
<p>Premature optimization is the root of all evil.</p>
<p>过早的优化是所有罪恶的根源。</p>
</blockquote>
<h3 id="timing"><a class="header" href="#timing">Timing</a></h3>
<p>Similarly to the debugging case, in many scenarios it can be enough to just print the time it took your code between two points. Here is an example in Python using the <a href="missing-semester/">time</a>`` module.</p>
<pre><code class="language-python">import time, random
n = random.randint(1, 10) * 100

# Get current time
start = time.time()

# Do some work
print("Sleeping for {} ms".format(n))
time.sleep(n/1000)

# Compute time between start and now
print(time.time() - start)

# Output
# Sleeping for 500 ms
# 0.5713930130004883
</code></pre>
<p>However, wall clock time can be misleading since your computer might be running other processes at the same time or waiting for events to happen. It is common for tools to make a distinction between <em>Real</em>, <em>User</em> and <em>Sys</em> time. In general, <em>User</em> + <em>Sys</em> tells you how much time your process actually spent in the CPU (more detailed explanation <a href="https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1">here</a>).</p>
<ul>
<li><em>Real</em> - Wall clock elapsed time from start to finish of the program, including the time taken by other processes and time taken while blocked (e.g. waiting for I/O or network)</li>
<li><em>User</em> - Amount of time spent in the CPU running user code</li>
<li><em>Sys</em> - Amount of time spent in the CPU running kernel code</li>
</ul>
<pre><code class="language-bash">➜  tmp time curl https://missing.csail.mit.edu &amp;&gt; /dev/null
curl https://missing.csail.mit.edu &amp;&gt; /dev/null  0.03s user 0.00s system 3% cpu 0.775 total
</code></pre>
<h3 id="profiling-1"><a class="header" href="#profiling-1">Profiling</a></h3>
<h4 id="cpu"><a class="header" href="#cpu">CPU</a></h4>
<p>Most of the time when people refer to <em>profilers</em> they actually mean <em>CPU profilers</em>, which are the most common. There are two main types of CPU profilers: <em>tracing</em> and <em>sampling</em> profilers. Tracing profilers keep a record of every function call your program makes whereas sampling profilers probe your program periodically (commonly every millisecond) and record the program’s stack. They use these records to present aggregate statistics of what your program spent the most time doing. <a href="https://jvns.ca/blog/2017/12/17/how-do-ruby---python-profilers-work-">Here</a> is a good intro article if you want more detail on this topic.</p>
<p>Most programming languages have some sort of command line profiler that you can use to analyze your code. They often integrate with full fledged IDEs but for this lecture we are going to focus on the command line tools themselves.</p>
<p>In Python we can use the <code>cProfile</code> module to profile time per function call. Here is a simple example that implements a rudimentary grep in Python:</p>
<pre><code class="language-python">#!/usr/bin/env python

import sys, re

def grep(pattern, file):
    with open(file, 'r') as f:
        print(file)
        for i, line in enumerate(f.readlines()):
            pattern = re.compile(pattern)
            match = pattern.search(line)
            if match is not None:
                print("{}: {}".format(i, line), end="")

if __name__ == '__main__':
    times = int(sys.argv[1])
    pattern = sys.argv[2]
    for i in range(times):
        for file in sys.argv[3:]:
            grep(pattern, file)
</code></pre>
<p>We can profile this code using the following command. Analyzing the output we can see that IO is taking most of the time and that compiling the regex takes a fair amount of time as well. Since the regex only needs to be compiled once, we can factor it out of the for.</p>
<pre><code class="language-bash">python -m cProfile -s tottime grep.py 1000 '^(import|\s*def)[^,]*$' *.py
</code></pre>
<p><img src="missing-semester/./assets/6-20221120150727-8r13x07.png" alt="profile" /></p>
<p>A caveat of Python’s <code>cProfile</code> profiler (and many profilers for that matter) is that they display time per function call. That can become unintuitive really fast, especially if you are using third party libraries in your code since internal function calls are also accounted for. A more intuitive way of displaying profiling information is to include the time taken per line of code, which is what <em>line profilers</em> do.</p>
<blockquote>
<p>caveat 警告; unintuitive 不直观的;</p>
</blockquote>
<p>For instance, the following piece of Python code performs a request to the class website and parses the response to get all URLs in the page:</p>
<pre><code class="language-python">#!/usr/bin/env python
import requests
from bs4 import BeautifulSoup

# This is a decorator that tells line_profiler
# that we want to analyze this function
@profile
def get_urls():
    response = requests.get('https://missing.csail.mit.edu')
    s = BeautifulSoup(response.content, 'lxml')
    urls = []
    for url in s.find_all('a'):
        urls.append(url['href'])

if __name__ == '__main__':
    get_urls()
</code></pre>
<p>If we used Python’s <code>cProfile</code> profiler we’d get over 2500 lines of output, and even with sorting it’d be hard to understand where the time is being spent. A quick run with <a href="missing-semester/">line_profiler</a>`` shows the time taken per line:</p>
<pre><code class="language-bash">$ kernprof -l -v a.py
Wrote profile results to urls.py.lprof
Timer unit: 1e-06 s

Total time: 0.636188 s
File: a.py
Function: get_urls at line 5

Line #  Hits         Time  Per Hit   % Time  Line Contents
==============================================================
 5                                           @profile
 6                                           def get_urls():
 7         1     613909.0 613909.0     96.5      response = requests.get('https://missing.csail.mit.edu')
 8         1      21559.0  21559.0      3.4      s = BeautifulSoup(response.content, 'lxml')
 9         1          2.0      2.0      0.0      urls = []
10        25        685.0     27.4      0.1      for url in s.find_all('a'):
11        24         33.0      1.4      0.0          urls.append(url['href'])
</code></pre>
<h4 id="memory"><a class="header" href="#memory">Memory</a></h4>
<p>In languages like C or C++ memory leaks can cause your program to never release memory that it doesn’t need anymore. To help in the process of memory debugging you can use tools like <a href="https://valgrind.org/">Valgrind</a> that will help you identify memory leaks.</p>
<p>In garbage collected languages like Python it is still useful to use a memory profiler because as long as you have pointers to objects in memory they won’t be garbage collected. Here’s an example program and its associated output when running it with <a href="https://pypi.org/project/memory-profiler/">memory-profiler</a> (note the decorator like in <code>line-profiler</code>).</p>
<pre><code class="language-python">@profile
def my_func():
    a = [1] * (10 ** 6)
    b = [2] * (2 * 10 ** 7)
    del b
    return a

if __name__ == '__main__':
    my_func()
</code></pre>
<p><img src="missing-semester/./assets/7-20221120150727-o51hmvv.png" alt="memory" /></p>
<h4 id="event-profiling"><a class="header" href="#event-profiling">Event Profiling</a></h4>
<p>As it was the case for <code>strace</code> for debugging, you might want to ignore the specifics of the code that you are running and treat it like a black box when profiling. The <a href="missing-semester/">perf</a>`` command abstracts CPU differences away and does not report time or memory, but instead it reports system events related to your programs. For example, <code>perf</code> can easily report poor cache locality, high amounts of page faults or livelocks. Here is an overview of the command:</p>
<ul>
<li><code>perf list</code> - List the events that can be traced with perf</li>
<li><code>perf stat COMMAND ARG1 ARG2</code> - Gets counts of different events related a process or command</li>
<li><code>perf record COMMAND ARG1 ARG2</code> - Records the run of a command and saves the statistical data into a file called <code>perf.data</code></li>
<li><code>perf report</code> - Formats and prints the data collected in <code>perf.data</code></li>
</ul>
<h4 id="visualization"><a class="header" href="#visualization">Visualization</a></h4>
<p>Profiler output for real world programs will contain large amounts of information because of the inherent complexity of software projects. Humans are visual creatures and are quite terrible at reading large amounts of numbers and making sense of them. Thus there are many tools for displaying profiler’s output in an easier to parse way.</p>
<blockquote>
<p>parse 解析;</p>
</blockquote>
<p>One common way to display CPU profiling information for sampling profilers is to use a <a href="http://www.brendangregg.com/flamegraphs.html">Flame Graph</a>, which will display a hierarchy of function calls across the Y axis and time taken proportional to the X axis. They are also interactive, letting you zoom into specific parts of the program and get their stack traces.</p>
<p>Call graphs or control flow graphs display the relationships between subroutines within a program by including functions as nodes and functions calls between them as directed edges. When coupled with profiling information such as the number of calls and time taken, call graphs can be quite useful for interpreting the flow of a program. In Python you can use the <a href="missing-semester/">pycallgraph</a>`` library to generate them.</p>
<blockquote>
<p>subroutine 子程序;</p>
</blockquote>
<h3 id="resource-monitoring"><a class="header" href="#resource-monitoring">Resource Monitoring</a></h3>
<p>Sometimes, the first step towards analyzing the performance of your program is to understand what its actual resource consumption is. Programs often run slowly when they are resource constrained, e.g. without enough memory or on a slow network connection. There are a myriad of command line tools for probing and displaying different system resources like CPU usage, memory usage, network, disk usage and so on.</p>
<blockquote>
<p>constrain 约束; myriad 无数;</p>
</blockquote>
<ul>
<li><strong>General Monitoring</strong> - Probably the most popular is <a href="missing-semester/">htop</a><code>, which is an improved version of [top]()</code>. <code>htop</code> presents various statistics for the currently running processes on the system. <code>htop</code> has a myriad of options and keybinds, some useful ones are: <code>&lt;F6&gt;</code> to sort processes, <code>t</code> to show tree hierarchy and <code>h</code> to toggle threads. See also <a href="missing-semester/">glances</a><code> for similar implementation with a great UI. For getting aggregate measures across all processes, [dstat]()</code> is another nifty tool that computes real-time resource metrics for lots of different subsystems like I/O, networking, CPU utilization, context switches, &amp;c.</li>
<li><strong>I/O operations</strong> - <a href="missing-semester/">iotop</a>`` displays live I/O usage information and is handy to check if a process is doing heavy I/O disk operations</li>
<li><strong>Disk Usage</strong> - <a href="missing-semester/">df</a><code> displays metrics per partitions and [du]()</code> displays <strong>d</strong>isk <strong>u</strong>sage per file for the current directory. In these tools the <code>-h</code> flag tells the program to print with <strong>h</strong>uman readable format. A more interactive version of <code>du</code> is <a href="missing-semester/">ncdu</a>`` which lets you navigate folders and delete files and folders as you navigate.</li>
</ul>
<blockquote>
<p>metrics 指标; partitions 分区;</p>
</blockquote>
<ul>
<li><strong>Memory Usage</strong> - <a href="missing-semester/">free</a>`` displays the total amount of free and used memory in the system. Memory is also displayed in tools like <code>htop</code>.</li>
<li><strong>Open Files</strong> - <a href="missing-semester/">lsof</a>`` lists file information about files opened by processes. It can be quite useful for checking which process has opened a specific file.</li>
</ul>
<blockquote>
<p>弹出U盘时有大用（大雾</p>
</blockquote>
<ul>
<li><strong>Network Connections and Config</strong> - <a href="missing-semester/">ss</a><code> lets you monitor incoming and outgoing network packets statistics as well as interface statistics. A common use case of `ss` is figuring out what process is using a given port in a machine. For displaying routing, network devices and interfaces you can use [ip]()</code>. Note that <code>netstat</code> and <code>ifconfig</code> have been deprecated in favor of the former tools respectively.</li>
<li><strong>Network Usage</strong> - <a href="missing-semester/">nethogs</a><code> and [iftop]()</code> are good interactive CLI tools for monitoring network usage.</li>
</ul>
<blockquote>
<p>有一说一，这些都是命令行下的工具，至少对于我来说，使用起来还是或多或少不是十分的方便，相比之下，我更倾向于使用各种成熟的IDE。</p>
</blockquote>
<p>If you want to test these tools you can also artificially impose loads on the machine using the <a href="missing-semester/">stress</a>`` command.</p>
<h3 id="specialized-tools-1"><a class="header" href="#specialized-tools-1">Specialized tools</a></h3>
<p>Sometimes, black box benchmarking is all you need to determine what software to use. Tools like <a href="missing-semester/">hyperfine</a>`` let you quickly benchmark command line programs. For instance, in the shell tools and scripting lecture we recommended <code>fd</code> over <code>find</code>. We can use <code>hyperfine</code> to compare them in tasks we run often.</p>
<pre><code class="language-bash">$ hyperfine --warmup 3 'fd -e jpg' 'find . -iname "*.jpg"'
Benchmark #1: fd -e jpg
  Time (mean ± σ):      51.4 ms ±   2.9 ms    [User: 121.0 ms, System: 160.5 ms]
  Range (min … max):    44.2 ms …  60.1 ms    56 runs

Benchmark #2: find . -iname "*.jpg"
  Time (mean ± σ):      1.126 s ±  0.101 s    [User: 141.1 ms, System: 956.1 ms]
  Range (min … max):    0.975 s …  1.287 s    10 runs

Summary
  'fd -e jpg' ran
   21.89 ± 2.33 times faster than 'find . -iname "*.jpg"'
</code></pre>
<p>As it was the case for debugging, browsers also come with a fantastic set of tools for profiling webpage loading, letting you figure out where time is being spent (loading, rendering, scripting, &amp;c). More info for <a href="https://profiler.firefox.com/docs/">Firefox</a> and <a href="https://developers.google.com/web/tools/chrome-devtools/rendering-tools">Chrome</a>.</p>
<h2 id="exercises-2"><a class="header" href="#exercises-2">Exercises</a></h2>
<blockquote>
<p>由于是在命令行界面中，我不是太想做。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-8"><a class="header" href="#the-missing-semester-in-the-cs-8">The Missing Semester in the CS</a></h1>
<h2 id="introduction-10"><a class="header" href="#introduction-10">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第八篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Metaprogramming</code>部分的学习笔记，课程地址为<a href="https://missing.csail.mit.edu/2020/metaprogramming/">Metaprogramming</a></p>
<!--more-->
<blockquote>
<p>The metaprogramming there means the sets of things that are more about process than they are about writing code or working more efficiently. They include systems for building and testing your code, and for managing dependencies.</p>
</blockquote>
<h2 id="build-systems"><a class="header" href="#build-systems">Build systems</a></h2>
<p>For most projects, whether they contain code or not, there is a “build process”. Some sequence of operations you need to do to go from your inputs to your outputs. Often, that process might have many steps, and many branches. As with so many of the things we have seen in this class, you are not the first to encounter this annoyance, and luckily there exist many tools to help you!</p>
<p>These are usually called “build systems”, and there are <em>many</em> of them. Which one you use depends on the task at hand, your language of preference, and the size of the project. At their core, they are all very similar though. You define a number of <em>dependencies</em>, a number of <em>targets</em>, and <em>rules</em> for going from one to the other. You tell the build system that you want a particular target, and its job is to find all the transitive dependencies of that target, and then apply the rules to produce intermediate targets all the way until the final target has been produced. Ideally, the build system does this without unnecessarily executing rules for targets whose dependencies haven’t changed and where the result is available from a previous build.</p>
<blockquote>
<p>intermediate 中间的;</p>
</blockquote>
<p><code>make</code> is one of the most common build systems out there, and you will usually find it installed on pretty much any UNIX-based computer. It has its warts, but works quite well for simple-to-moderate projects. When you run <code>make</code>, it consults a file called <code>Makefile</code> in the current directory. All the targets, their dependencies, and the rules are defined in that file.</p>
<pre><code class="language-makefile">paper.pdf: paper.tex plot-data.png
	pdflatex paper.tex

plot-%.png: %.dat plot.py
	./plot.py -i $*.dat -o $@
</code></pre>
<blockquote>
<p><code>make</code>原来还可以这样用，蚌埠住了， 我原本以为<code>make</code>只能用来编译<code>C/C++</code>程序。</p>
</blockquote>
<p>Each directive in this file is a rule for how to produce the left-hand side using the right-hand side. Or, phrased differently, the things named on the right-hand side are dependencies, and the left-hand side is the target. The indented block is a sequence of programs to produce the target from those dependencies. In <code>make</code>, the first directive also defines the default goal. If you run <code>make</code> with no arguments, this is the target it will build. Alternatively, you can run something like <code>make plot-data.png</code>, and it will build that target instead.</p>
<p>The <code>%</code> in a rule is a “pattern”, and will match the same string on the left and on the right. For example, if the target <code>plot-foo.png</code> is requested, <code>make</code> will look for the dependencies <code>foo.dat</code> and <code>plot.py</code>.</p>
<blockquote>
<p>这里的例子在我的<code>WSL</code>里面没有装<code>latex</code>，就没有办法实操。我就直接复制粘贴了。</p>
</blockquote>
<p><code>paper.tex</code>:</p>
<pre><code class="language-tex">\documentclass{article}
\usepackage{graphicx}
\begin{document}
\includegraphics[scale=0.65]{plot-data.png}
\end{document}
</code></pre>
<p><code>plot.py</code>:</p>
<pre><code class="language-python">import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('-i', type=argparse.FileType('r'))
parser.add_argument('-o')
args = parser.parse_args()

data = np.loadtxt(args.i)
plt.plot(data[:, 0], data[:, 1])
plt.savefig(args.o)
</code></pre>
<p>Now we run <code>make</code>:</p>
<pre><code class="language-bash">$ make
./plot.py -i data.dat -o plot-data.png
pdflatex paper.tex
... lots of output ...
</code></pre>
<p>If we run <code>make</code> again:</p>
<pre><code class="language-bash">$ make
make: 'paper.pdf' is up to date.
</code></pre>
<p>It didn’t do anything! Why not? Well, because it didn’t need to. It checked that all of the previously-built targets were still up to date with respect to their listed dependencies. We can test this by modifying <code>paper.tex</code> and then re-running <code>make</code>:</p>
<pre><code class="language-bash">$ vim paper.tex
$ make
pdflatex paper.tex
...
</code></pre>
<p>Notice that <code>make</code> did <em>not</em> re-run <code>plot.py</code> because that was not necessary; none of <code>plot-data.png</code>’s dependencies changed!</p>
<blockquote>
<p>竟然没有讲<code>make</code>用在<code>C/C++</code>中的例子，不过也正常，那算是<code>C/C++</code>课程的内容。</p>
</blockquote>
<h2 id="dependency-management"><a class="header" href="#dependency-management">Dependency management</a></h2>
<p>At a more macro level, your software projects are likely to have dependencies that are themselves projects. You might depend on installed programs (like <code>python</code>), system packages (like <code>openssl</code>), or libraries within your programming language (like <code>matplotlib</code>). These days, most dependencies will be available through a <em>repository</em> that hosts a large number of such dependencies in a single place, and provides a convenient mechanism for installing them. Some examples include the Ubuntu package repositories for Ubuntu system packages, which you access through the <code>apt</code> tool, <code>RubyGems</code> for Ruby libraries, <code>PyPi</code> for Python libraries, or the Arch User Repository for Arch Linux user-contributed packages.</p>
<blockquote>
<p>macro 宏;</p>
</blockquote>
<p>What we <em>will</em> cover is some of the common terminology they all use. The first among these is <em>versioning</em>. Most projects that other projects depend on issue a <em>version number</em> with every release. Usually something like 8.1.3 or 64.1.20192004. They are often, but not always, numerical. Version numbers serve many purposes, and one of the most important of them is to ensure that software keeps working. Imagine, for example, that I release a new version of my library where I have renamed a particular function. If someone tried to build some software that depends on my library after I release that update, the build might fail because it calls a function that no longer exists! Versioning attempts to solve this problem by letting a project say that it depends on a particular version, or range of versions, of some other project. That way, even if the underlying library changes, dependent software continues building by using an older version of my library.</p>
<blockquote>
<p>underlying 底层的;</p>
</blockquote>
<p>That also isn’t ideal though! What if I issue a security update which does <em>not</em> change the public interface of my library (its “API”), and which any project that depended on the old version should immediately start using? This is where the different groups of numbers in a version come in. The exact meaning of each one varies between projects, but one relatively common standard is <em><a href="https://semver.org/">semantic versioning</a></em>. With semantic versioning, every version number is of the form: major.minor.patch. The rules are:</p>
<ul>
<li>If a new release does not change the API, increase the patch version.</li>
<li>If you <em>add</em> to your API in a backwards-compatible way, increase the minor version.</li>
<li>If you change the API in a non-backwards-compatible way, increase the major version.</li>
</ul>
<p>This already provides some major advantages. Now, if my project depends on your project, it <em>should</em> be safe to use the latest release with the same major version as the one I built against when I developed it, as long as its minor version is at least what it was back then. In other words, if I depend on your library at version <code>1.3.7</code>, then it <em>should</em> be fine to build it with <code>1.3.8</code>, <code>1.6.1</code>, or even <code>1.3.0</code>.</p>
<p>When working with dependency management systems, you may also come across the notion of <em>lock files</em>. A lock file is simply a file that lists the exact version you are <em>currently</em> depending on of each dependency. Usually, you need to explicitly run an update program to upgrade to newer versions of your dependencies. There are many reasons for this, such as avoiding unnecessary recompiles, having reproducible builds, or not automatically updating to the latest version (which may be broken). An extreme version of this kind of dependency locking is <em>vendoring</em>, which is where you copy all the code of your dependencies into your own project. That gives you total control over any changes to it, and lets you introduce your own changes to it, but also means you have to explicitly pull in any updates from the upstream maintainers over time.</p>
<h2 id="continuous-integration-systems"><a class="header" href="#continuous-integration-systems">Continuous integration systems</a></h2>
<p>As you work on larger and larger projects, you’ll find that there are often additional tasks you have to do whenever you make a change to it. You might have to upload a new version of the documentation, upload a compiled version somewhere, release the code to pypi, run your test suite, and all sort of other things. Maybe every time someone sends you a pull request on GitHub, you want their code to be style checked and you want some benchmarks to run? When these kinds of needs arise, it’s time to take a look at continuous integration.</p>
<p>Continuous integration, or CI, is an umbrella term for “stuff that runs whenever your code changes”, and there are many companies out there that provide various types of CI, often for free for open-source projects. Some of the big ones are Travis CI, Azure Pipelines, and GitHub Actions. They all work in roughly the same way: you add a file to your repository that describes what should happen when various things happen to that repository. By far the most common one is a rule like “when someone pushes code, run the test suite”. When the event triggers, the CI provider spins up a virtual machines (or more), runs the commands in your “recipe”, and then usually notes down the results somewhere. You might set it up so that you are notified if the test suite stops passing, or so that a little badge appears on your repository as long as the tests pass.</p>
<blockquote>
<p>umbrella term 总称;</p>
</blockquote>
<blockquote>
<p>README.md里面的badge是相当好玩的。</p>
</blockquote>
<h3 id="a-brief-aside-on-testing"><a class="header" href="#a-brief-aside-on-testing">A brief aside on testing</a></h3>
<p>Most large software projects come with a “test suite”. You may already be familiar with the general concept of testing, but we thought we’d quickly mention some approaches to testing and testing terminology that you may encounter in the wild:</p>
<ul>
<li>Test suite: a collective term for all the tests</li>
<li>Unit test: a “micro-test” that tests a specific feature in isolation</li>
<li>Integration test: a “macro-test” that runs a larger part of the system to check that different feature or components work <em>together</em>.</li>
<li>Regression test: a test that implements a particular pattern that <em>previously</em> caused a bug to ensure that the bug does not resurface.</li>
<li>Mocking: to replace a function, module, or type with a fake implementation to avoid testing unrelated functionality. For example, you might “mock the network” or “mock the disk”.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-missing-semester-in-the-cs-9"><a class="header" href="#the-missing-semester-in-the-cs-9">The Missing Semester in the CS</a></h1>
<h2 id="introduction-11"><a class="header" href="#introduction-11">Introduction</a></h2>
<p>本篇是MIT的公开课程<a href="https://missing.csail.mit.edu/">计算机教学中消失的一学期</a>的学习笔记第八篇。在笔记中，我将摘抄我认为是重点的语句，文中举出的例子我会在自己的电脑上操作一遍并给出其产生的结果。</p>
<p>本篇是<code>Security and Cryptography</code>的学习资料，课程地址为<a href="https://missing.csail.mit.edu/2020/security/">Security</a>.</p>
<!--more-->
<p>We will focus on security and cryptography concepts that are relevant in understanding tools covered earlier in this class, such as the use of hash functions in Git or key derivation functions and symmetric/asymmetric cryptosystems in SSH. This lecture has a very informal (but we think practical) treatment of basic cryptography concepts.</p>
<h2 id="entropy"><a class="header" href="#entropy">Entropy</a></h2>
<blockquote>
<p>entropy 熵;</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">Entropy</a> is a measure of randomness. This is useful, for example, when determining the strength of a password.</p>
<p>Entropy is measured in <em>bits</em>, and when selecting uniformly at random from a set of possible outcomes, the entropy is equal to <code>log_2(# of possibilities)</code>. A fair coin flip gives 1 bit of entropy. A dice roll (of a 6-sided die) has ~2.58 bits of entropy.</p>
<p>You should consider that the attacker knows the <em>model</em> of the password, but not the randomness (e.g. from <a href="https://en.wikipedia.org/wiki/Diceware">dice rolls</a>) used to select a particular password.</p>
<blockquote>
<p>dice rolls 骰子;</p>
</blockquote>
<p>How many bits of entropy is enough? It depends on your threat model. For online guessing, ~40 bits of entropy is pretty good. To be resistant to offline guessing, a stronger password would be necessary (e.g. 80 bits, or more).</p>
<h2 id="hash-functions"><a class="header" href="#hash-functions">Hash functions</a></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash function</a> maps data of arbitrary size to a fixed size, and has some special properties. A rough specification of a hash function is as follows:</p>
<pre><code>hash(value: array&lt;byte&gt;) -&gt; vector&lt;byte, N&gt;  (for some fixed N)
</code></pre>
<p>An example of a hash function is <a href="https://en.wikipedia.org/wiki/SHA-1">SHA1</a>, which is used in Git. It maps arbitrary-sized inputs to 160-bit outputs (which can be represented as 40 hexadecimal characters). We can try out the SHA1 hash on an input using the <code>sha1sum</code> command:</p>
<pre><code class="language-bash">➜  ~ echo 'hello' | sha1sum
f572d396fae9206628714fb2ce00f72e94f2258f  -
➜  ~ echo 'hello' | sha1sum
f572d396fae9206628714fb2ce00f72e94f2258f  -
➜  ~ echo 'Hello' | sha1sum
1d229271928d3f9e2bb0375bd6ce5db6c6d348d9
</code></pre>
<p>At a high level, a hash function can be thought of as a hard-to-invert random-looking (but deterministic) function. A hash function has the following properties:</p>
<ul>
<li>Deterministic: the same input always generates the same output.</li>
<li>Non-invertible: it is hard to find an input <code>m</code> such that <code>hash(m) = h</code> for some desired output <code>h</code>.</li>
<li>Target collision resistant: given an input <code>m_1</code>, it’s hard to find a different input <code>m_2</code> such that <code>hash(m_1) = hash(m_2)</code>.</li>
<li>Collision resistant: it’s hard to find two inputs <code>m_1</code> and <code>m_2</code> such that <code>hash(m_1) = hash(m_2)</code> (note that this is a strictly stronger property than target collision resistance).</li>
</ul>
<p>Note: while it may work for certain purposes, SHA-1 is <a href="https://shattered.io/">no longer</a> considered a strong cryptographic hash function. You might find this table of <a href="https://valerieaurora.org/hash.html">lifetimes of cryptographic hash functions</a> interesting.</p>
<h3 id="application"><a class="header" href="#application">Application</a></h3>
<ul>
<li>Git, for content-addressed storage. The idea of a <a href="https://en.wikipedia.org/wiki/Hash_function">hash function</a> is a more general concept (there are non-cryptographic hash functions).</li>
<li>A short summary of the contents of a file. Software can often be downloaded from (potentially less trustworthy) mirrors, e.g. Linux ISOs, and it would be nice to not have to trust them. The official sites usually post hashes alongside the download links (that point to third-party mirrors), so that the hash can be checked after downloading a file.</li>
<li><a href="https://en.wikipedia.org/wiki/Commitment_scheme">Commitment schemes</a>. Suppose you want to commit to a particular value, but reveal the value itself later. For example, I want to do a fair coin toss “in my head”, without a trusted shared coin that two parties can see. I could choose a value <code>r = random()</code>, and then share <code>h = sha256(r)</code>. Then, you could call heads or tails (we’ll agree that even <code>r</code> means heads, and odd <code>r</code> means tails). After you call, I can reveal my value <code>r</code>, and you can confirm that I haven’t cheated by checking <code>sha256(r)</code> matches the hash I shared earlier.</li>
</ul>
<h2 id="key-derivation-functions"><a class="header" href="#key-derivation-functions">Key derivation functions</a></h2>
<blockquote>
<p>derivation 推导;</p>
</blockquote>
<blockquote>
<p>中文译名为密钥导出函数。</p>
</blockquote>
<p>A related concept to cryptographic hashes, <a href="https://en.wikipedia.org/wiki/Key_derivation_function">key derivation functions</a> (KDFs) are used for a number of applications, including producing fixed-length output for use as keys in other cryptographic algorithms. Usually, KDFs are deliberately slow, in order to slow down offline brute-force attacks.</p>
<blockquote>
<p>故意降低速度真的有用吗?</p>
</blockquote>
<h3 id="application-1"><a class="header" href="#application-1">Application</a></h3>
<ul>
<li>Producing keys from passphrases for use in other cryptographic algorithms (e.g. symmetric cryptography, see below).</li>
<li>Storing login credentials. Storing plaintext passwords is bad; the right approach is to generate and store a random <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)">salt</a> <code>salt = random()</code> for each user, store <code>KDF(password + salt)</code>, and verify login attempts by re-computing the KDF given the entered password and the stored salt.</li>
</ul>
<h2 id="symmetric-cryptography"><a class="header" href="#symmetric-cryptography">Symmetric cryptography</a></h2>
<blockquote>
<p>symmetric 对称的;</p>
</blockquote>
<p>Hiding message contents is probably the first concept you think about when you think about cryptography. Symmetric cryptography accomplishes this with the following set of functionality:</p>
<pre><code>keygen() -&gt; key  (this function is randomized)

encrypt(plaintext: array&lt;byte&gt;, key) -&gt; array&lt;byte&gt;  (the ciphertext)
decrypt(ciphertext: array&lt;byte&gt;, key) -&gt; array&lt;byte&gt;  (the plaintext)
</code></pre>
<p>The encrypt function has the property that given the output (ciphertext), it’s hard to determine the input (plaintext) without the key. The decrypt function has the obvious correctness property, that <code>decrypt(encrypt(m, k), k) = m</code>.</p>
<p>An example of a symmetric cryptosystem in wide use today is <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a>.</p>
<h3 id="application-2"><a class="header" href="#application-2">Application</a></h3>
<ul>
<li>Encrypting files for storage in an untrusted cloud service. This can be combined with KDFs, so you can encrypt a file with a passphrase. Generate <code>key = KDF(passphrase)</code>, and then store <code>encrypt(file, key)</code>.</li>
</ul>
<h2 id="asymmetric-cryptography"><a class="header" href="#asymmetric-cryptography">Asymmetric cryptography</a></h2>
<blockquote>
<p>asymmetric 非对称的;</p>
</blockquote>
<p>The term “asymmetric” refers to there being two keys, with two different roles. A private key, as its name implies, is meant to be kept private, while the public key can be publicly shared and it won’t affect security (unlike sharing the key in a symmetric cryptosystem). Asymmetric cryptosystems provide the following set of functionality, to encrypt/decrypt and to sign/verify:</p>
<pre><code>keygen() -&gt; (public key, private key)  (this function is randomized)

encrypt(plaintext: array&lt;byte&gt;, public key) -&gt; array&lt;byte&gt;  (the ciphertext)
decrypt(ciphertext: array&lt;byte&gt;, private key) -&gt; array&lt;byte&gt;  (the plaintext)

sign(message: array&lt;byte&gt;, private key) -&gt; array&lt;byte&gt;  (the signature)
verify(message: array&lt;byte&gt;, signature: array&lt;byte&gt;, public key) -&gt; bool  (whether or not the signature is valid)
</code></pre>
<p>The encrypt/decrypt functions have properties similar to their analogs from symmetric cryptosystems. A message can be encrypted using the <em>public</em> key. Given the output (ciphertext), it’s hard to determine the input (plaintext) without the <em>private</em> key. The decrypt function has the obvious correctness property, that <code>decrypt(encrypt(m, public key), private key) = m</code>.</p>
<p>Symmetric and asymmetric encryption can be compared to physical locks. A symmetric cryptosystem is like a door lock: anyone with the key can lock and unlock it. Asymmetric encryption is like a padlock with a key. You could give the unlocked lock to someone (the public key), they could put a message in a box and then put the lock on, and after that, only you could open the lock because you kept the key (the private key).</p>
<p>The sign/verify functions have the same properties that you would hope physical signatures would have, in that it’s hard to forge a signature. No matter the message, without the <em>private</em> key, it’s hard to produce a signature such that <code>verify(message, signature, public key)</code> returns true. And of course, the verify function has the obvious correctness property that <code>verify(message, sign(message, private key), public key) = true</code>.</p>
<h3 id="applications"><a class="header" href="#applications">Applications</a></h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Pretty_Good_Privacy">PGP email encryption</a>. People can have their public keys posted online (e.g. in a PGP keyserver, or on <a href="https://keybase.io/">Keybase</a>). Anyone can send them encrypted email.</li>
<li>Private messaging. Apps like <a href="https://signal.org/">Signal</a> and <a href="https://keybase.io/">Keybase</a> use asymmetric keys to establish private communication channels.</li>
<li>Signing software. Git can have GPG-signed commits and tags. With a posted public key, anyone can verify the authenticity of downloaded software.</li>
</ul>
<h3 id="key-distribution"><a class="header" href="#key-distribution">Key distribution</a></h3>
<p>Asymmetric-key cryptography is wonderful, but it has a big challenge of distributing public keys / mapping public keys to real-world identities. There are many solutions to this problem. Signal has one simple solution: trust on first use, and support out-of-band public key exchange (you verify your friends’ “safety numbers” in person). PGP has a different solution, which is <a href="https://en.wikipedia.org/wiki/Web_of_trust">web of trust</a>. Keybase has yet another solution of <a href="https://keybase.io/blog/chat-apps-softer-than-tofu">social proof</a> (along with other neat ideas).</p>
<h2 id="case-stduies"><a class="header" href="#case-stduies">Case stduies</a></h2>
<h3 id="password-managers"><a class="header" href="#password-managers">Password managers</a></h3>
<p>This is an essential tool that everyone should try to use (e.g. <a href="https://keepassxc.org/">KeePassXC</a>, <a href="https://www.passwordstore.org/">pass</a>, and <a href="https://1password.com/">1Password</a>). Password managers make it convenient to use unique, randomly generated high-entropy passwords for all your logins, and they save all your passwords in one place, encrypted with a symmetric cipher with a key produced from a passphrase using a KDF.</p>
<p>Using a password manager lets you avoid password reuse (so you’re less impacted when websites get compromised), use high-entropy passwords (so you’re less likely to get compromised), and only need to remember a single high-entropy password.</p>
<blockquote>
<p>compromised 被盗的;</p>
</blockquote>
<h3 id="two-factor-authentication"><a class="header" href="#two-factor-authentication">Two-factor authentication</a></h3>
<p><a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">Two-factor authentication</a> (2FA) requires you to use a passphrase (“something you know”) along with a 2FA authenticator (like a <a href="https://www.yubico.com/">YubiKey</a>, “something you have”) in order to protect against stolen passwords and <a href="https://en.wikipedia.org/wiki/Phishing">phishing</a> attacks.</p>
<h3 id="full-disk-encryption"><a class="header" href="#full-disk-encryption">Full disk encryption</a></h3>
<p>Keeping your laptop’s entire disk encrypted is an easy way to protect your data in the case that your laptop is stolen. You can use <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Encrypting_a_non-root_file_system">cryptsetup + LUKS</a> on Linux, <a href="https://fossbytes.com/enable-full-disk-encryption-windows-10/">BitLocker</a> on Windows, or <a href="https://support.apple.com/en-us/HT204837">FileVault</a> on macOS. This encrypts the entire disk with a symmetric cipher, with a key protected by a passphrase.</p>
<h3 id="private-messaging"><a class="header" href="#private-messaging">Private messaging</a></h3>
<p>Use <a href="https://signal.org/">Signal</a> or <a href="https://keybase.io/">Keybase</a>. End-to-end security is bootstrapped from asymmetric-key encryption. Obtaining your contacts’ public keys is the critical step here. If you want good security, you need to authenticate public keys out-of-band (with Signal or Keybase), or trust social proofs (with Keybase).</p>
<h3 id="ssh"><a class="header" href="#ssh">SSH</a></h3>
<p>When you run <code>ssh-keygen</code>, it generates an asymmetric keypair, <code>public_key, private_key</code>. This is generated randomly, using entropy provided by the operating system (collected from hardware events, etc.). The public key is stored as-is (it’s public, so keeping it a secret is not important), but at rest, the private key should be encrypted on disk. The <code>ssh-keygen</code> program prompts the user for a passphrase, and this is fed through a key derivation function to produce a key, which is then used to encrypt the private key with a symmetric cipher.</p>
<blockquote>
<p>不过我们貌似在ssh-keygen时，都是把passphrase留空的。</p>
</blockquote>
<p>In use, once the server knows the client’s public key (stored in the <code>.ssh/authorized_keys</code> file), a connecting client can prove its identity using asymmetric signatures. This is done through <a href="https://en.wikipedia.org/wiki/Challenge%E2%80%93response_authentication">challenge-response</a>. At a high level, the server picks a random number and sends it to the client. The client then signs this message and sends the signature back to the server, which checks the signature against the public key on record. This effectively proves that the client is in possession of the private key corresponding to the public key that’s in the server’s <code>.ssh/authorized_keys</code> file, so the server can allow the client to log in.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="操作系统"><a class="header" href="#操作系统">操作系统</a></h1>
<p>大三上学期专业必修课——操作系统。</p>
<p>授课教师：孟祥武</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="intro"><a class="header" href="#intro">Intro</a></h1>
<h2 id="what-operating-systems-do"><a class="header" href="#what-operating-systems-do">What Operating Systems Do?</a></h2>
<p>A program that acts as an intermediary between a user of a computer and the computer hardware.</p>
<p><img src="operating-system/./intro/image-20230918174041584.png" alt="image-20230918174041584" /></p>
<p>In user view, depending the number using this computer, operating system does differently:</p>
<ul>
<li>For single user: the operating system is designed mostly for ease of use and non paid to <strong>resource utilization</strong></li>
<li>For many user: maximize resource utilization</li>
</ul>
<p>In system view, operating system is</p>
<ul>
<li>Resource allocator</li>
<li>Control program</li>
</ul>
<h3 id="defining-operating-system"><a class="header" href="#defining-operating-system">Defining Operating System</a></h3>
<p>In general, we have no completely adequate definition of an operating system.</p>
<p>A common definition is that operating system is the one program running at all times on the computer. This program is usually called as <strong>kernel</strong>. Along with kernel, we have two types of programs:</p>
<ul>
<li><strong>System programs</strong>: associated with the operating system but are not necessarily part of the kernel</li>
<li><strong>Application programs</strong></li>
</ul>
<h2 id="computer-system-organization"><a class="header" href="#computer-system-organization">Computer-System Organization</a></h2>
<h2 id="operating-system-structure"><a class="header" href="#operating-system-structure">Operating System Structure</a></h2>
<h3 id="io-structure"><a class="header" href="#io-structure">I/O Structure</a></h3>
<p>There are two I/O methods:</p>
<p><img src="operating-system/./intro/image-20230918174709496.png" alt="image-20230918174709496" /></p>
<ul>
<li><strong>Synchronous</strong>: after I/O starts, control returns to user program only upon I/O completion.</li>
<li><strong>Asynchronous</strong>: after I/O starts, control returns to user program without waiting for I/O completion.</li>
</ul>
<h4 id="direct-memory-access-structure"><a class="header" href="#direct-memory-access-structure">Direct Memory Access Structure</a></h4>
<p>Device controller transfers blocks of data from buffer storage directly to main memory without CPU intervention, used for hight-speed I/O devices able to transmit information at close to memory speeds.</p>
<h3 id="storage-structure"><a class="header" href="#storage-structure">Storage Structure</a></h3>
<p>Storage systems organized in hierarchy, as speed, cost, volatility.</p>
<p><strong>Caching</strong>: copying information into faster storage system, main memory can be viewed as a last cache for secondary storage.</p>
<p><img src="operating-system/./intro/image-20230918175211759.png" alt="image-20230918175211759" /></p>
<h3 id="computer-system-architecture"><a class="header" href="#computer-system-architecture">Computer System Architecture</a></h3>
<ul>
<li>Single-processor Systems</li>
<li>Multi-processor Systems</li>
<li>Clustered Systems</li>
</ul>
<h3 id="operation-system-structure"><a class="header" href="#operation-system-structure">Operation System Structure</a></h3>
<p><strong>Multiprogramming</strong> need for efficiency. Single user cannot keep CPU and I/O devices busy at all times. Multiprogramming organizes jobs so CPU always has one to execute. Several jobs are kept in main memory at the same time, and the CPU is multiplexed among them.</p>
<p><strong>Timesharing(multitasking)</strong> is logical extension in which CPU switches jobs so frequently that users can interact with each jobs while it is running, creating <strong>interactive</strong> computing.</p>
<p><img src="operating-system/./intro/image-20230918175638084.png" alt="image-20230918175638084" /></p>
<p><img src="operating-system/./intro/image-20230918175719296.png" alt="image-20230918175719296" /></p>
<p>OS need these features for multiprogramming:</p>
<ul>
<li>I/O routine supplied by the system</li>
<li>Memory management, the system must allocate the memory to several jobs</li>
<li>CPU scheduling, the system must choose among several jobs ready to run</li>
<li>Allocation of devices</li>
</ul>
<h2 id="operating-system-operations"><a class="header" href="#operating-system-operations">Operating System Operations</a></h2>
<h3 id="interupt"><a class="header" href="#interupt">Interupt</a></h3>
<ul>
<li>Interrupt driven by hardware</li>
<li>Software error or request create <strong>exception</strong> or <strong>trap</strong></li>
<li>Other process problems: infinite loop, processes modifying each other or operating system.</li>
</ul>
<h4 id="dual-mode"><a class="header" href="#dual-mode">Dual Mode</a></h4>
<p><strong>Dual-mode</strong> operation allows OS to protect itself and other system components.</p>
<ul>
<li>User Mode</li>
<li>Kernel Mode.</li>
</ul>
<p>And there is a <strong>mode bit</strong> provided by hardware, providing ability to distinguish when system is running user code or kernel code. Some instructions designated as privileged, only executable in kernel mode. System call change mode to kernel mode, return from call resets it to user mode.</p>
<p>Transition from user to kernel mode:</p>
<p><strong>Timer</strong> to prevent infinite loop/ process hogging resources.</p>
<ul>
<li>Set interrupt after specific period</li>
<li>Operating system decrements counter</li>
<li>When counter zero generate an interrupt</li>
<li>Set up before scheduling process to regain control or terminate program that exceeds alloted time.</li>
</ul>
<h2 id="process-management"><a class="header" href="#process-management">Process Management</a></h2>
<p>A process is a program in execution. It is a unit of work within the system. Program is a passive entity, process is an active entity. Process needs resources to accomplish its task:</p>
<ul>
<li>CPU, memory, I/O and files</li>
<li>data</li>
</ul>
<p>And process termination requires reclaim of any reusable resources.</p>
<p>Single-threaded process has one <strong>program counter</strong> specifying location of next instruction to execute. Multi-threaded process has one program counter per thread.</p>
<p>Operating system is responsible for the following activities in connection with process management:</p>
<ul>
<li>Creating and deleting both user and system process</li>
<li>Suspending and resuming processes</li>
<li>Providing mechanisms for process synchronization</li>
<li>Providing mechanism for process communication</li>
<li>Providing mechanisms for deadlock handling</li>
</ul>
<h2 id="memory-management"><a class="header" href="#memory-management">Memory Management</a></h2>
<p>Memory management determines what is in memory when optimizing CPU utilization and computer response to users.</p>
<ul>
<li>Keeping track of which parts of memory are currently being used and by whom</li>
<li>Deciding which processes and data to move into and out of memory</li>
<li>Allocating and deallocating memory space as needed</li>
</ul>
<h2 id="storage-management"><a class="header" href="#storage-management">Storage Management</a></h2>
<p>OS provides uniform, logical view of information storage.</p>
<ul>
<li>Abstracts physical properties to logical storage unit: <strong>file</strong></li>
<li>Each medium is controlled by device</li>
<li>File System management</li>
</ul>
<h3 id="mass-storage-management"><a class="header" href="#mass-storage-management">Mass-Storage Management</a></h3>
<p>Proper management is of central importance.</p>
<h3 id="io-subsystem"><a class="header" href="#io-subsystem">I/O Subsystem</a></h3>
<p>One purpose of OS is to hide peculiarities of hardware devices from the user.</p>
<p>I/O subsystem responsible for</p>
<ul>
<li>Memory management of I/O including buffering, caching, spooling</li>
<li>General device-driver interface</li>
<li>Drivers fro specific hardware devices</li>
</ul>
<h2 id="protection-and-security"><a class="header" href="#protection-and-security">Protection and Security</a></h2>
<p>Protection: any mechanism for controlling access of processes or users to resources defined by the OS.</p>
<p>Security: defense of the system against internal and external attacks.</p>
<p>Systems generally first distinguish among users, to determine who can do what.</p>
<ul>
<li>User identities include name and associated number, one per user</li>
<li>User ID then associated with all files, processes of tha user to determine access control</li>
<li>Group ID allows set of users to be defined and controls managed, then be associated with processes and files</li>
</ul>
<p>And we have <strong>privilege escalation</strong> allows user to change to effective ID with more rights.</p>
<h2 id="system-and-computing-environment"><a class="header" href="#system-and-computing-environment">System and Computing Environment</a></h2>
<h3 id="time-sharing-systems-interactive-computing"><a class="header" href="#time-sharing-systems-interactive-computing">Time-Sharing Systems-Interactive Computing</a></h3>
<p>The CPU is multiplexed among serveral jobs that are kept in memory and on disk, and the concept <strong>time slot</strong> is used to describe one single job use the CPU time.</p>
<h3 id="parallel-systems"><a class="header" href="#parallel-systems">Parallel Systems</a></h3>
<p>Multiprocessor systems with more than one CPU in close communication. The advantages of parallel system:</p>
<ul>
<li>Increased throughput</li>
<li>Economical</li>
<li>Increased reliability</li>
</ul>
<p>There are two kinds of paralled systems:</p>
<ul>
<li>
<p>Symmetric multiprocessing <code>SMP</code></p>
<p>Each processor runs identical copy of the operating system. Many processes can run at once without performace deterioration. Most modern operating systems support SMP</p>
</li>
<li>
<p>Asymmertic multiprocessing</p>
<p>Each processor is assigned a specific task, master processor schedules and allocated work to slave processors. Most common in extremely large systems.</p>
</li>
</ul>
<h3 id="distributed-systems"><a class="header" href="#distributed-systems">Distributed Systems</a></h3>
<p>Distribute the computation among serveral physical processors. <strong>Loosely coulped system</strong>: each processor has its own local memory, processors communicate with one another through various communications lines,such as high-speed buses or telephone lins. Distributed systems has advantages:</p>
<ul>
<li>Resources sharing</li>
<li>Computation speed up - load sharing</li>
<li>Reliability</li>
<li>Communications</li>
</ul>
<p>Distributed systems require networking infratructure, local area networks (LAN) or wide area networks (WAN) both are ok. A distribued system can be either client-server or peer-to-peer systems.</p>
<h3 id="clustered-systems"><a class="header" href="#clustered-systems">Clustered Systems</a></h3>
<p>Clustering allows two or more systems to share storage, provides high reliability.</p>
<ul>
<li>Asymmetric clustering: one server runs the application while other servers standby.</li>
<li>Symmetic clustering: all N hosts are running the application</li>
</ul>
<h3 id="real-time-systems"><a class="header" href="#real-time-systems">Real-Time Systems</a></h3>
<p>Ofter used as a control device in a dedicated application such as controlling scientific experiments, medical imaging systems, industrial control systems and some display systems. Real time systems has well-defined fixed-time constraints.</p>
<p>Real time systems may be either <em>hard</em> or <em>soft</em> real-time.</p>
<ul>
<li>Hard real-time: secondary storage limited or absent, data stored in short term memory or read-only memory. This mode will conflicts with time-sharing systems, not supported by general-purpose operating systems</li>
<li>Soft real-time: limited utility in industrial control of robotics, useful in applications but requiring advanced operating-system features</li>
</ul>
<h3 id="handheld-systems"><a class="header" href="#handheld-systems">Handheld Systems</a></h3>
<p>The handheld systems is the operating systems used by personal digital assistants (PDAs) or cellular telephones. The issues with handheld systems are:</p>
<ul>
<li>Limited memory</li>
<li>Slow processors</li>
<li>Small display screens</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operating-system-structures"><a class="header" href="#operating-system-structures">Operating System Structures</a></h1>
<h2 id="operating-system-services"><a class="header" href="#operating-system-services">Operating System Services</a></h2>
<ol>
<li>
<p>User interface</p>
<p>Almost all operating systems have a user interface, command-line or graphics user interface.</p>
</li>
<li>
<p>Program execution</p>
<p>System capability to load a program into memory and to run it.</p>
</li>
<li>
<p>I/O operations</p>
<p>Since user programs can't execute I/O operations directly, the operating system must provide some means.</p>
</li>
<li>
<p>File system manipulation</p>
<p>Program capability to read, write, create and delete files.</p>
</li>
<li>
<p>Communications</p>
<p>Exchange of information between processors, both on the same computer and the other computers.</p>
</li>
<li>
<p>Error detect</p>
<p>Ensure correct computing by detecting errors in the CPU, memory hardware, I/O devices and user programs.</p>
</li>
</ol>
<p>And there are additional operating system functions that exist not for helping the user, but for ensuring the efficient system operations.</p>
<ul>
<li>Resource allocation</li>
<li>Accounting</li>
<li>Protection</li>
</ul>
<h2 id="user-operating-system-interface"><a class="header" href="#user-operating-system-interface">User Operating System Interface</a></h2>
<h3 id="command-line-interface"><a class="header" href="#command-line-interface">Command Line Interface</a></h3>
<p><code>CLI</code> allows direct command entry, sometimes implemented in the kernel and sometimes by one system program. And there are multiple flavors implemented called <code>shell</code>.</p>
<h3 id="graphics-user-interface"><a class="header" href="#graphics-user-interface">Graphics User Interface</a></h3>
<p><code>GUI</code> is a user-friendly desktop metaphor interface, usually containing mouse, keyboard and monitor. Many systems now include both <code>CLI</code> and <code>GUI</code>.</p>
<h2 id="system-calls"><a class="header" href="#system-calls">System Calls</a></h2>
<p>System calls provide the interface between a running program and the operating system. The system calls are generally available as assembly language instructions, and languages defined to replace assembly language for systems programming allow system calls to be made directly, for example <code>C</code> and <code>C++</code>.</p>
<p><img src="operating-system/./os-structures/image-20230921155918085.png" alt="image-20230921155918085" /></p>
<p>There are three general methods are used to pass parameters between a running program and the operating system.</p>
<ol>
<li>Using registers</li>
<li>Store the parameters in a table in memory, and the table address is passed as a parameter in a register</li>
<li>Push the parameters onto the stack by the program, and pop off the stack by the operating system</li>
</ol>
<h2 id="types-of-system-calls"><a class="header" href="#types-of-system-calls">Types of System Calls</a></h2>
<p>There are five types of system calls:</p>
<ul>
<li>Process control</li>
<li>File management</li>
<li>Device management</li>
<li>Information maintenance</li>
<li>Communications</li>
</ul>
<p>The communications may take place using either message passing or shard memory:</p>
<p><img src="operating-system/./os-structures/image-20230921160429687.png" alt="image-20230921160429687" /></p>
<h2 id="system-programs"><a class="header" href="#system-programs">System Programs</a></h2>
<p>System programs provide a convenient environment for program development and execution. They can be divided into</p>
<ul>
<li>File manipulation</li>
<li>Status information</li>
<li>File modification</li>
<li>Programming language support</li>
<li>Program loading and execution</li>
<li>Communications</li>
<li>Application programs</li>
</ul>
<p>And most users' views of the operating system is defined by the system program, not by system calls.</p>
<h2 id="operating-system-design-and-implementation"><a class="header" href="#operating-system-design-and-implementation">Operating System Design and Implementation</a></h2>
<p>The operating system design and implementation is started by defining goals and specifications, and will be affected by choice of hardware and type of system.</p>
<p>The Operating system goals can be divided into user goals and system goals:</p>
<ul>
<li>User goals: operating system should be convenient to use, easy to learn, reliable and safe and fast</li>
<li>System goals: operating system should be easy to design, implement and maintain, as well as flexible, reliable, error-free and efficient</li>
</ul>
<h3 id="mechanisms-and-policies"><a class="header" href="#mechanisms-and-policies">Mechanisms and Policies</a></h3>
<p>Mechanisms determine how to do something, policies decide what will be done.</p>
<p>The separation of policy from mechanism is a very important principle, it allows maximum flexibility if policy decisions  are to be changed later.</p>
<h3 id="system-implementation"><a class="header" href="#system-implementation">System Implementation</a></h3>
<p>The operating system is written in assembly language traditionally, now can be written in higher-level languages.</p>
<p>Using the high-level language have the benefits:</p>
<ul>
<li>Can be written faster</li>
<li>Is more compact</li>
<li>Is easier to understand and debug</li>
<li>Is far easier to port to other hardware</li>
</ul>
<h2 id="operating-system-structure-1"><a class="header" href="#operating-system-structure-1">Operating System Structure</a></h2>
<p>We will introduce two operating system structures: the MS-DOS system structure and Unix system structure.</p>
<h3 id="ms-dos-system-structure"><a class="header" href="#ms-dos-system-structure">MS-DOS System structure</a></h3>
<p>The MS-DOS system structure is written to provide the most functionality in the least space, not divided into modules. Although MS-DOS has some structure, its interfaces and levels of functionality are not well separated.</p>
<p><img src="operating-system/./os-structures/image-20230922134327718.png" alt="image-20230922134327718" /></p>
<h3 id="unix-system-structure"><a class="header" href="#unix-system-structure">Unix System Structure</a></h3>
<p>The Unix system structure is limited by hardware functionality, the original Unix operating system had limited structuring. The Unix operating system consists of two separable parts:</p>
<ul>
<li>
<p>System programs</p>
</li>
<li>
<p>The kernel</p>
<p>The kernel consisting of everything below the system-call interface and above the physical hardware. And the kernel providers the file system, CPU scheduling, memory management and other operating system functions.</p>
</li>
</ul>
<p><img src="operating-system/./os-structures/image-20230922135210825.png" alt="image-20230922135210825" /></p>
<h3 id="layered-approach"><a class="header" href="#layered-approach">Layered Approach</a></h3>
<p>The operating system is divided into a number of layers, each built on the top of lower layers. The bottom layer is the hardware, the highest layer is the user interface.</p>
<p>With modularity, layers are selected such that each uses functions (operations) and services of only lower-level layers.</p>
<p><img src="operating-system/./os-structures/image-20230922135427322.png" alt="image-20230922135427322" /></p>
<h3 id="micro-kernel-system-structure"><a class="header" href="#micro-kernel-system-structure">Micro Kernel System Structure</a></h3>
<p>The micro kernel system structure is aimed to move as much from the kernel into <em>user</em> space, the communication takes place between user modules using message passing. The benefits of micro kernel system structure are:</p>
<ul>
<li>Easier to extend a micro kernel</li>
<li>Easier to port the operating system to new architectures</li>
<li>More reliable and secure, as less code is running in kernel mode</li>
</ul>
<h2 id="virtual-machine"><a class="header" href="#virtual-machine">Virtual Machine</a></h2>
<p>A virtual machine takes the layered approach to its logical conclusion, it treats hardware and the operating system kernel as though they were all hardware. A virtual machine provides an interface <strong>identical</strong> to the underlying bard hardware.</p>
<p>The resources of the physical computer are shared to create the virtual machines:</p>
<ul>
<li>CPU scheduling can create the appearance that users have their own processor</li>
<li>Spooling and a file system can provide virtual card readers and virtual line printer</li>
<li>A normal user time-sharing terminal serves as the virtual machine operator's console</li>
</ul>
<p><img src="operating-system/./os-structures/image-20230922140819129.png" alt="image-20230922140819129" /></p>
<h3 id="the-advantages-and-disadvantages-of-virtual-machines"><a class="header" href="#the-advantages-and-disadvantages-of-virtual-machines">The Advantages and Disadvantages of Virtual Machines</a></h3>
<p>The virtual machine concept provides complete protection of system resources since each virtual machine is isolated from all other virtual machines. This isolation, however, permits no direct sharing of resources.</p>
<p>The virtual machine system is a perfect vehicle for operating system research and development. System development is done on the virtual machine, instead of on a physical machine and so does not disrupt norm system operation.</p>
<p>But the virtual machine concept is difficult to implement due to the effort required to provide an exact duplicate to the underlying machine.</p>
<h2 id="system-generation-and-system-boot"><a class="header" href="#system-generation-and-system-boot">System Generation and System Boot</a></h2>
<p>Operating systems are designed to run on any of a class of machines, the system must be configured for each specific computer site.</p>
<p>The system generation program obtains information concerning the specific configuration of the hardware system.</p>
<p>The booting is starting a computer by loading the kernel. System boot will use the <strong>bootstrap program</strong> ,code stored in ROM that is able to locate the kernel, load it into memory and start its execution.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes"><a class="header" href="#processes">Processes</a></h1>
<h2 id="process-concept"><a class="header" href="#process-concept">Process Concept</a></h2>
<p>An operating system executes a variety of programs:</p>
<ul>
<li>For batch system: jobs</li>
<li>For time-shared systems: user programs or tasks</li>
</ul>
<blockquote>
<p>In textbook, the terms <em>job</em> and <em>process</em> are used almost interchangeably.</p>
</blockquote>
<p>Process is a program in execution, process execution must progress in sequential fashion. A process includes:</p>
<ul>
<li>Program counter</li>
<li>Stack</li>
<li>Data section</li>
</ul>
<h3 id="process-state"><a class="header" href="#process-state">Process State</a></h3>
<p>As a process executes, it changes state:</p>
<ul>
<li><strong>new</strong>: The process is being created</li>
<li><strong>running</strong>: Instructions are being executed</li>
<li><strong>waiting</strong>: The process is waiting for some event to occur</li>
<li><strong>ready</strong>: The process is waiting to be assigned to a processor</li>
<li><strong>terminated</strong>: The process has finished execution</li>
</ul>
<p><img src="operating-system/./processes/image-20230920084215594.png" alt="image-20230920084215594" /></p>
<h3 id="process-control-block"><a class="header" href="#process-control-block">Process Control Block</a></h3>
<p>Information associated with each process:</p>
<ul>
<li>Process state</li>
<li>Program counter</li>
<li>CPU registers</li>
<li>CPU scheduling information</li>
<li>Memory management information</li>
<li>Accounting information</li>
<li>I/O status information</li>
</ul>
<h2 id="process-scheduling"><a class="header" href="#process-scheduling">Process Scheduling</a></h2>
<p><img src="operating-system/./processes/image-20230920091907169.png" alt="image-20230920091907169" /></p>
<p>There are four queues in process scheduling:</p>
<ul>
<li>Job queue: set of all processes in the system</li>
<li>Ready queue: set of all processes residing in the main memory, ready and wait to execute</li>
<li>Device queue: set of processes waiting for an I/O device</li>
<li>Processes migration between the various queues</li>
</ul>
<p><img src="operating-system/./processes/image-20230920092245289.png" alt="image-20230920092245289" /></p>
<p>And there are two schedulers:</p>
<ul>
<li>Long-term scheduler(job scheduler): selects processes should be brought into the ready queue</li>
<li>Short-term scheduler(CPU scheduler): selects which process should executed next and allocate CPU</li>
</ul>
<p>The short-term scheduler is invoked very frequently and must be fast, the long-tern scheduler is invoked very infrequently so it may be slow. The long-term scheduler controls he degree of multiprogramming.</p>
<h2 id="operations-on-processes"><a class="header" href="#operations-on-processes">Operations on Processes</a></h2>
<h3 id="context-switch"><a class="header" href="#context-switch">Context Switch</a></h3>
<p>When CPU switches to another process, the system must save the state of the old process and load the saved state for the new process. The context switch depend on hardware switching.</p>
<p>Context-switch time is a waste; the system does no useful work while switching.</p>
<h3 id="process-creation"><a class="header" href="#process-creation">Process Creation</a></h3>
<p>Parent process create children processes, which, in turn create other processes, forming a tree of processes.</p>
<p>There exist three situations in resource sharing of parent and children processes:</p>
<ul>
<li>Parent and children processes share all resources</li>
<li>Children share subset of parent's resources</li>
<li>Parent and child share no resources</li>
</ul>
<p>The execution of the processes:</p>
<ul>
<li>Parent and children execute concurrently</li>
<li>Parent waits until children terminate</li>
</ul>
<p>The address space of processes:</p>
<ul>
<li>Child duplicate of parent</li>
<li>Child has a program loaded into it</li>
</ul>
<p><img src="operating-system/./processes/image-20230925170022317.png" alt="image-20230925170022317" /></p>
<h3 id="process-termination"><a class="header" href="#process-termination">Process Termination</a></h3>
<p>Process executes last statement and asks the operating system to decide it:</p>
<ul>
<li>Output data from child to parent</li>
<li>Process's resource are deallocated by operating system</li>
</ul>
<p>Parent process can terminate execution of children processes.</p>
<h2 id="cooperating-processes"><a class="header" href="#cooperating-processes">Cooperating Processes</a></h2>
<p>Independent process cannot affect or be affected by the execution of another process.</p>
<p>Cooperating process can affect or be affected by the execution of another process.</p>
<p>The advantages of process cooperation:</p>
<ul>
<li>Information sharing</li>
<li>Computation speed-up</li>
<li>Modularity</li>
<li>Convenience</li>
</ul>
<h3 id="producer-consumer-problem"><a class="header" href="#producer-consumer-problem">Producer-Consumer Problem</a></h3>
<p>Paradigm for cooperating processes, <strong>producer</strong> process produces information that is consumed by a <strong>consumer</strong> process.</p>
<p>So there need to be a shared memory as a <strong>buffer</strong> between the producer and consumer processes. And there are two kinds of buffer:</p>
<ul>
<li><strong>unbounded buffer</strong> place no practical limit on the size of the buffer</li>
<li><strong>bounded buffer</strong> assumes that there is a fixed buffer size</li>
</ul>
<h2 id="interprocess-communication"><a class="header" href="#interprocess-communication">Interprocess Communication</a></h2>
<p>Interprocess communication is mechanism for processes to communicate and to synchronize their actions. Message system is a system used for processes to communicate with each other without resorting to shared variables.</p>
<p><code>IPC</code> facility provides two operations:</p>
<ul>
<li><code>send(message)</code></li>
<li><code>receive(message)</code></li>
</ul>
<p>The message size can be fixed or variable.</p>
<p>The implementation of <code>IPC</code> must to answer there questions:</p>
<ul>
<li>How are links established?</li>
<li>Can a link be associated with more than two processes?</li>
<li>How many links can there be between every pair of communicating processes?</li>
<li>What is the capacity of a link?</li>
<li>Is the size of a message that the link can accommodate fixed or variable?</li>
<li>Is a link unidirectional or bi-directional?</li>
</ul>
<h3 id="direct-communication"><a class="header" href="#direct-communication">Direct Communication</a></h3>
<p>Processes must name each other explicitly:</p>
<ul>
<li><code>send(P, message)</code>: send a message to process <code>P</code></li>
<li><code>receive(Q, message)</code>: receive a message from process <code>Q</code></li>
</ul>
<h3 id="indirect-communication"><a class="header" href="#indirect-communication">Indirect Communication</a></h3>
<p>Messages are directed and received from mailboxes (ports).</p>
<ul>
<li>Each mailbox has a unique id</li>
<li>Processes can communicate only if they share a mailbox</li>
</ul>
<p>The  indirect communication support operations:</p>
<ul>
<li>create a new mailbox</li>
<li>send and receive messages through mailbox</li>
<li>destroy a mailbox</li>
</ul>
<h4 id="synchronization"><a class="header" href="#synchronization">Synchronization</a></h4>
<p>Message passing may be either blocking or nonblocking. The blocking is considered <strong>synchronous</strong> and nonblocking is considered <strong>asynchronous</strong>.</p>
<p><code>Send</code> and <code>Receive</code> primitives may be either blocking or non-blocking.</p>
<h4 id="buffering"><a class="header" href="#buffering">Buffering</a></h4>
<p>Queue of messages attached to the link, can be implemented in three ways:</p>
<ul>
<li>Zero capacity: sender must wait for receiver</li>
<li>Bounded capacity: finite length of messages; sender must wait if link is full</li>
<li>Unbounded capacity: infinite length and sender never waits</li>
</ul>
<h2 id="communication-in-client-server-systems"><a class="header" href="#communication-in-client-server-systems">Communication in Client-Server Systems</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="process-synchronization"><a class="header" href="#process-synchronization">Process Synchronization</a></h1>
<h2 id="background-1"><a class="header" href="#background-1">Background</a></h2>
<p>Concurrent</p>
<h2 id="the-critical-section-problem"><a class="header" href="#the-critical-section-problem">The Critical-Section Problem</a></h2>
<h2 id="petersons-solution"><a class="header" href="#petersons-solution">Peterson's Solution</a></h2>
<h2 id="synchronization-hardware"><a class="header" href="#synchronization-hardware">Synchronization Hardware</a></h2>
<h2 id="semaphores"><a class="header" href="#semaphores">Semaphores</a></h2>
<h2 id="classic-problems-of-synchronization"><a class="header" href="#classic-problems-of-synchronization">Classic Problems of Synchronization</a></h2>
<h2 id="monitors"><a class="header" href="#monitors">Monitors</a></h2>
<h2 id="synchronization-example"><a class="header" href="#synchronization-example">Synchronization Example</a></h2>
<h2 id="atomic-transactions"><a class="header" href="#atomic-transactions">Atomic Transactions</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cpu-scheduling"><a class="header" href="#cpu-scheduling">CPU Scheduling</a></h1>
<h2 id="basic-concept"><a class="header" href="#basic-concept">Basic Concept</a></h2>
<p>Maximum CPU utilization obtained with multiprogramming.</p>
<p>CPU burst distribution:</p>
<h3 id="cpu-scheduler"><a class="header" href="#cpu-scheduler">CPU Scheduler</a></h3>
<p>Selects from among the processes in memory that are ready to execute, and allocates the CPU to one of them.</p>
<p>The CPU scheduling decisions may take place when a process:</p>
<ul>
<li>Switches from running to waiting</li>
<li>Switches from running to ready (time slot)</li>
<li>Switches from waiting to ready</li>
<li>Process terminates</li>
</ul>
<p><strong>Dispatcher</strong> module gives control of the CPU to he process selected by the short-term scheduler, involving:</p>
<ul>
<li>Switching context</li>
<li>Switching to user mode</li>
<li>Jumping to the proper location in the user program to restart that program</li>
</ul>
<p><strong>Dispatch latency</strong> is the time it takes for the dispatcher to stop one process and start another running.</p>
<h2 id="scheduling-criteria"><a class="header" href="#scheduling-criteria">Scheduling Criteria</a></h2>
<p><strong>CPU utilization</strong>: keep the CPU as busy as possible.</p>
<p><strong>Throughput</strong>: number of processes that complete their execution per time unit.</p>
<p><strong>Turnaround</strong>: amount of time to execute a particular process.</p>
<p><strong>Waiting time</strong>: amount of time a process has been waiting in the ready</p>
<h2 id="scheduling-algorithms"><a class="header" href="#scheduling-algorithms">Scheduling Algorithms</a></h2>
<h3 id="first-come-first-server"><a class="header" href="#first-come-first-server">First-Come First-Server</a></h3>
<h3 id="shortest-job-first"><a class="header" href="#shortest-job-first">Shortest Job First</a></h3>
<h3 id="shortest-remaining-time-first"><a class="header" href="#shortest-remaining-time-first">Shortest Remaining Time First</a></h3>
<h3 id="priority-scheduling"><a class="header" href="#priority-scheduling">Priority Scheduling</a></h3>
<p>A priority number is associated with each process. The CPU is allocated to the process with the highest priority.</p>
<p>And there also can be two ways:</p>
<ul>
<li>Preemptive</li>
<li>Nonpreemptive</li>
</ul>
<p>The shortest job first scheduling is also a priority scheduling where priority is the predicted next CPU burst time.</p>
<p>But the problem is the low priority process may be never execute. We can age every process to make low priority process can be executed after a long time, though calculating priority every time may waste resources.</p>
<h3 id="round-robin"><a class="header" href="#round-robin">Round Robin</a></h3>
<h3 id="multilevel-queue"><a class="header" href="#multilevel-queue">Multilevel Queue</a></h3>
<p>Ready queue is partitioned into two queues:</p>
<ul>
<li>Foreground queue: <code>FCFS</code></li>
<li>Background queue: <code>RR</code></li>
</ul>
<h2 id="multiple-processor-scheduling"><a class="header" href="#multiple-processor-scheduling">Multiple Processor Scheduling</a></h2>
<h2 id="real-time-scheduling"><a class="header" href="#real-time-scheduling">Real Time Scheduling</a></h2>
<h2 id="thread-scheduling"><a class="header" href="#thread-scheduling">Thread Scheduling</a></h2>
<h2 id="operating-system-examples"><a class="header" href="#operating-system-examples">Operating System Examples</a></h2>
<h2 id="algorithm-evaluation"><a class="header" href="#algorithm-evaluation">Algorithm Evaluation</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="threads"><a class="header" href="#threads">Threads</a></h1>
<h3 id="user-threads"><a class="header" href="#user-threads">User Threads</a></h3>
<p>Thread management done by user level threads library. And there are primary thread libraries:</p>
<ul>
<li><code>POSIX</code> threads</li>
<li><code>Win32</code> threads</li>
<li><code>Java</code> threads</li>
</ul>
<h3 id="kernel-threads"><a class="header" href="#kernel-threads">Kernel Threads</a></h3>
<p>Thread management supported by the kernel. Most operating system are supported thread management now.</p>
<h2 id="benefits-of-threads"><a class="header" href="#benefits-of-threads">Benefits Of Threads</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="memory-management-1"><a class="header" href="#memory-management-1">Memory Management</a></h1>
<h2 id="background-2"><a class="header" href="#background-2">Background</a></h2>
<p>The program must be brought into memory from disk and placed within a process for it to be run as main memory and registers are only storage CPU can access directly.</p>
<p>Register access in one CPU clock or less, main memory can take many cycles and cache sits between main memory and CPU registers.</p>
<p>Protection of memory required to ensure correct operation.</p>
<p>A pair of <strong>base</strong> and <strong>limit</strong> registers define the logical address space.</p>
<p><img src="operating-system/./memory-management/image-20231215212454485.png" alt="image-20231215212454485" /></p>
<h3 id="binding-of-instructions-and-data-to-memory"><a class="header" href="#binding-of-instructions-and-data-to-memory">Binding of Instructions and Data to Memory</a></h3>
<p>Address binding of instructions and data to memory addresses can happen at three different stages.</p>
<ol>
<li>
<p>Compile time.</p>
<p>If memory location known a priori, absolute code can be generated. If starting location changed, must recompile code.</p>
</li>
<li>
<p>Load time:</p>
<p>Must generate <strong>relocatable</strong> code if memory location is not known at compile time.</p>
</li>
<li>
<p>Execution time:</p>
<p>Binding delayed until run time if the process can be moved during its execution from one memory segment to another. Need hardware support for address mapping, for example. base and limit registers.</p>
</li>
</ol>
<p><img src="operating-system/./memory-management/image-20231215214041210.png" alt="image-20231215214041210" /></p>
<h4 id="dynamic-loading-and-dynamic-linking"><a class="header" href="#dynamic-loading-and-dynamic-linking">Dynamic Loading and Dynamic Linking</a></h4>
<p>The dynamic loading is that routine is not loaded until it is called. The advantages of dynamic loading are:</p>
<ul>
<li>Better memory space utilization as unused routine is never loaded.</li>
<li>Useful when large amounts of code are needed to handle infrequently occurring cases.</li>
<li>No special support from the operating system is required implemented through program design.</li>
</ul>
<p>The dynamic linking is the linking postponed until execution time. Some small piece of code called <strong>stub</strong> is used to locate the appropriate memory resident library routine. When linking, stub replaces itself with the address of the routine and executes the routine. But operating system needed to check if routine in processes' memory address.</p>
<p>Dynamic linking is particularly useful for libraries.</p>
<h3 id="logical-vs-physical-address-space"><a class="header" href="#logical-vs-physical-address-space">Logical vs Physical Address Space</a></h3>
<p>The <strong>logical address</strong> are generated by the CPU and referred to as virtual address.</p>
<p>The <strong>physical address</strong> are address seen by the memory unit.</p>
<p>The logical addresses and physical addresses are the same in compile-time and load-time address-binding schemes, but differ in execution-time address-binding scheme.</p>
<p>The <strong>Memory-Management Unit</strong> is the hardware device that maps virtual to physical address.</p>
<p>In <code>MMU</code> scheme, the value in the relocation register is added to every address generated by a user process at the time it is send to memory. So the user program deals with logical addresses, it never sees the real physical addresses.</p>
<h3 id="overlays"><a class="header" href="#overlays">Overlays</a></h3>
<p>The overlays is to keep in memory only those instructions and data that are needed at any given time. It is needed when process is larger than amount of memory allocated to it.</p>
<p>The overlays are implemented by user and need no special support needed from operating system. But the programming design of overlay structure is complex.</p>
<h2 id="swapping"><a class="header" href="#swapping">Swapping</a></h2>
<p>A process can be <strong>swapped</strong> temporarily out of memory to a backing store and then brought back into memory for continued execution. The backing store is always fast disk that is large enough to accommodate copies of all memory images for all users.</p>
<p><strong>Roll out, roll in</strong> are swapping variants used for priority-based scheduling algorithms. Lower-priority process is swapped out so higher-priority process can be loaded and executed. Major part of swap time is transfer time, total transfer time is directly proportional to the amount of memory swapped.</p>
<h2 id="contiguous-memory-allocation"><a class="header" href="#contiguous-memory-allocation">Contiguous Memory Allocation</a></h2>
<p>Main memory usually into two partitions:</p>
<ul>
<li>Resident operating system, usually held in low memory with interrupt vector.</li>
<li>User processes then held in high memory.</li>
</ul>
<h3 id="single-partition-allocation"><a class="header" href="#single-partition-allocation">Single Partition Allocation</a></h3>
<p>Relocation register scheme used to protect user processes from each other and operating system code and data.</p>
<ul>
<li>Relocation register contains value of smallest physical address</li>
<li>Limit register contains range of logical addresses</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231216135137349.png" alt="image-20231216135137349" /></p>
<h3 id="multiple-partition-allocation"><a class="header" href="#multiple-partition-allocation">Multiple Partition Allocation</a></h3>
<p>Memory are allocated by <strong>holes</strong>, which are blocks of available memory and holes of various size are scattered throughout memory. When a process arrives, it is allocated memory from a hole large enough to accommodate it.</p>
<p>To achieve such a scheme, the operating system maintains information about:</p>
<ul>
<li>Allocated partitions</li>
<li>Free partitions</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231216135828502.png" alt="image-20231216135828502" /></p>
<p>And there exists a problem: <em>dynamic storage allocation problem</em>, how to satisfy a request of size <em>n</em> from a list of free holes. Some algorithms:</p>
<ul>
<li>First Fit: allocate the first hole that is big enough.</li>
<li>Best Fit: allocate the smallest hole that is big enough. This method must search entire list unless the list has been ordered by size. And using the method can produce the smallest leftover hole.</li>
<li>Worst Fit: allocate the largest hole. This method also must search entire list and produces the largest leftover hole.</li>
</ul>
<p>And allocation may lead to fragmentations:</p>
<ul>
<li>External fragmentation: total memory space exists to satisfy a request, but it is not contiguous.</li>
<li>Internal fragmentation: allocated memory may be slightly larger than requested memory; this size difference is memory internal to a partition but not being used.</li>
</ul>
<p>Can reduce external fragmentation by compaction: shuffle memory contents to place all free memory together in on large block. But compaction is possible <strong>only</strong> if relocation is dynamic and is done at execution time.</p>
<h2 id="paging"><a class="header" href="#paging">Paging</a></h2>
<p>Logical address space of a process can be noncontiguous and process is allocated physical memory whenever the latter is available.</p>
<p>So divide physical memory into fixed-sized blocked called <strong>frames</strong>, the size is power of 2 always between 512 bytes and 8192 bytes. And divide logical memory into blocks of same size as frames called pages.</p>
<p>So achieve such a scheme, operating system needs to keep track of all free frames and when to run a program of size <em>n</em> pages, needs to find <em>n</em> free frames and load program. And operating system needs to set up a page table to translate logical to physical addresses.</p>
<h3 id="address-translation-scheme"><a class="header" href="#address-translation-scheme">Address Translation Scheme</a></h3>
<p>The address generated by CPU is divided into two parts:</p>
<ul>
<li><strong>Page number</strong> used as an index into a page table which contains the base address of each page in physical memory</li>
<li><strong>Page offset</strong> combined with base address to define the physical memory address that is sent to the memory unit</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231216143651256.png" alt="image-20231216143651256" /></p>
<p>And the page table kept in main memory. The page table base register <code>PTBR</code> points to the page table, the page table length register <code>PRLR</code> indicates size of the page table.</p>
<p>But using this scheme lead to a problem that every data or instruction access requires two memory accesses: one for the page table and one for the real data and instruction.</p>
<p>The two memory access problem can be solved by the use of a special fast-lookup hardware cache called <em>associative memory</em> or <em>translation look aside buffers</em>  <code>TLBs</code>.</p>
<p><img src="operating-system/./memory-management/image-20231216151355226.png" alt="image-20231216151355226" /></p>
<p>Having the <code>TLB</code> , the address translation can be illustrated:</p>
<p><img src="operating-system/./memory-management/image-20231216152740811.png" alt="image-20231216152740811" /></p>
<p>And having the <code>TLB</code>, the effective access time will be associated with the <strong>hit ratio</strong>, percentage of times that a page number is found in the associative registers, which is related to number of associative registers. And having the associative lookup costs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> time unit, assuming memory cycle costs <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> time unit and the hit ratio is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>, the effective access time is:
<span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span></p>
<h3 id="memory-protection"><a class="header" href="#memory-protection">Memory Protection</a></h3>
<p>The memory protection is implemented by associating protection bit with each frame. And valid-invalid bit is attached to each entry in the page table:</p>
<ul>
<li><em>Valid</em>  indicates that the associated page is in the process' logical address space and is thus a legal page</li>
<li><em>Invalid</em> indicates that the page is not in the process' logical address space</li>
</ul>
<h3 id="shared-page"><a class="header" href="#shared-page">Shared Page</a></h3>
<h4 id="shared-code"><a class="header" href="#shared-code">Shared Code</a></h4>
<p>One copy of read-only code shared among processes. So shared code must appear in the same location in the logical address sapce of all processes.</p>
<h4 id="private-code-and-data"><a class="header" href="#private-code-and-data">Private Code and Data</a></h4>
<p>Each process keeps a separate copy of the code and data. The pages for the private code and data can appear anywhere in the logical address space.</p>
<p>There is a image for the processes with the same code to share code pages.</p>
<p><img src="operating-system/./memory-management/image-20231106165507807.png" alt="image-20231106165507807" /></p>
<h2 id="structure-of-the-page-table"><a class="header" href="#structure-of-the-page-table">Structure of The Page Table</a></h2>
<h3 id="hierarchical-paging"><a class="header" href="#hierarchical-paging">Hierarchical Paging</a></h3>
<p>Break up the logical address space into multiple page tables. A simple technique is a two-level page table.</p>
<p>For example: a logical address(on 32-bit machine with 4K page size) is divided into:</p>
<ul>
<li>a page number consisting of 20 bits</li>
<li>a page offset consisting of 12 bits</li>
</ul>
<p>And the page table is paged, the page number is further divided into:</p>
<ul>
<li>10-bit page number</li>
<li>10-bit page offset</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231106165942358.png" alt="image-20231106165942358" /></p>
<h3 id="hashed-page-table"><a class="header" href="#hashed-page-table">Hashed Page Table</a></h3>
<p>The virtual page number is hashed into a page table.</p>
<p><img src="operating-system/./memory-management/image-20231106170152406.png" alt="image-20231106170152406" /></p>
<p>The question of hashing to avoid conflict. In this image, we store a chain of elements with the same hash value.</p>
<h3 id="inverted-page-table"><a class="header" href="#inverted-page-table">Inverted Page Table</a></h3>
<p>One entry for each real page of memory. Entry consists of the virtual address of the page stored in that real memory location, with information about the process that owns that page.</p>
<p><img src="operating-system/./memory-management/image-20231216154136616.png" alt="image-20231216154136616" /></p>
<p>Using this table decreases memory needed to store each page table but increases time needed to search the table when a page reference occurs.</p>
<h2 id="segmentation"><a class="header" href="#segmentation">Segmentation</a></h2>
<p>Memory-management scheme that supports user view of memory. A program is a collection of segments. A segment is a logical unit such as:</p>
<ul>
<li>main program</li>
<li>procedure</li>
<li>function</li>
<li>method</li>
<li>...</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231106170757480.png" alt="image-20231106170757480" /></p>
<h3 id="segmentation-architecture"><a class="header" href="#segmentation-architecture">Segmentation Architecture</a></h3>
<p>Logical address consists of two tuples: &lt;segment-number, offset&gt;。</p>
<p><strong>Segment table</strong> maps the physical addresses and table entry has:</p>
<ul>
<li><em>base</em> contains the starting physical address where the segments reside in memory</li>
<li><strong>limit</strong> specifies the length of the segment</li>
</ul>
<p>And the program will has tow special registers:</p>
<ul>
<li>
<p>Segment table base register <strong>STBR</strong>: points to the segment table's location in memory</p>
</li>
<li>
<p>Segment table length register <strong>STLR</strong>: indicates number of segments used by a program</p>
<p>Segment number <em>s</em> is legal when s &lt; STLR</p>
</li>
</ul>
<p><img src="operating-system/./memory-management/image-20231216154754046.png" alt="image-20231216154754046" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtual-memory"><a class="header" href="#virtual-memory">Virtual Memory</a></h1>
<h2 id="background-3"><a class="header" href="#background-3">Background</a></h2>
<p>Virtual memory separation of user logical memory from physical memory. And two benefits gaining:</p>
<ul>
<li>
<p>Only part of the program needs to be in memory for execution</p>
</li>
<li>
<p>Logical address space can therefore be much larger than physical address space</p>
</li>
<li>
<p>Allows address spaces to be shared by several processes</p>
</li>
<li>
<p>Allows for more efficient process creation</p>
</li>
</ul>
<p>Virtual memory can be implemented via:</p>
<ul>
<li>Demand paging</li>
<li>Demand segmentation</li>
</ul>
<h2 id="demand-paging"><a class="header" href="#demand-paging">Demand Paging</a></h2>
<p>The benefits of demand paging: bringing a page into memory only when it is needed:</p>
<ul>
<li>Less IO needed</li>
<li>Less memory needed</li>
<li>Faster response</li>
<li>More users</li>
</ul>
<p>And having a valid-invalid bit to indicate whether the page is in the memory.</p>
<h3 id="page-fault"><a class="header" href="#page-fault">Page Fault</a></h3>
<p>If there is a first reference to a page, OS will trap to page fault.</p>
<p>OS will look at another table to decide:</p>
<ul>
<li>Invalid reference -&gt; abort</li>
<li>Just not in memory -&gt; Get empty frame and swap page into frame.</li>
</ul>
<h2 id="copy-on-write"><a class="header" href="#copy-on-write">Copy-on-Write</a></h2>
<p>Copy-on-write allows both parent and child processes to initially share the same pages in memory. If either process modifies a shared page, only then is the page copied.</p>
<p>Copy-on-write allows more efficient process creation as only modified pages are copied.</p>
<h2 id="page-replacement"><a class="header" href="#page-replacement">Page Replacement</a></h2>
<p>What happens if there is no free frame?</p>
<p><strong>Page replacement</strong>. Find some page in memory but not really in use and swap it out.</p>
<p>And the page replacement is implemented in the page fault service routine to prevent over-allocation of memory.</p>
<blockquote>
<p>Add a <em>modify/dirty</em> bit to indicate a page weather modified. Only the dirty pages are written to disk.</p>
</blockquote>
<h3 id="page-replacement-algorithms"><a class="header" href="#page-replacement-algorithms">Page Replacement Algorithms</a></h3>
<p>We want the lowest page fault rate. And we can using a reference string to simulate reference and computing the number of page faults on that string.</p>
<h4 id="first-in-first-out"><a class="header" href="#first-in-first-out">First In First Out</a></h4>
<p>Replace the frame coming first. More frames, less page faults. But the FIFO replacement may lead to Belady's Anomaly.</p>
<p><img src="operating-system/./virtual-memory/image-20231108081546194.png" alt="image-20231108081546194" /></p>
<h4 id="optimal-algorithm"><a class="header" href="#optimal-algorithm">Optimal Algorithm</a></h4>
<p>Replace page that will not be used for longest period of time.</p>
<h4 id="least-recently-used-algorithm"><a class="header" href="#least-recently-used-algorithm">Least Recently Used Algorithm</a></h4>
<p>Replace pages that used least recently.</p>
<p>There are two ways to implement:</p>
<ul>
<li>
<p>Counter implementation</p>
<p>Every page entry has a counter, every time page is referenced through this entry, copy the clock into the counter. When a page needs to be changed, look at the counters to determine which are to change.</p>
</li>
<li>
<p>Stack implementation</p>
<p>Keep a stack of page numbers in a double link form. When page referenced, move it to the top.</p>
<p>Comparing to counter, stack implementation requires 6 pointers to be changed but no search for replacement.</p>
</li>
<li>
<p><code>LRU</code> approximation Algorithms</p>
<p>Set a reference bit to each page and initially to 0. When page is referenced set the bit to 1. Replace the one which is 0, if one exists.</p>
<p>If page to be replaced has reference bit 1, then set reference bit 0, leave page in memory and replace next page (in clock order) subject to the same rules.</p>
<p><img src="operating-system/./virtual-memory/image-20231108084040487.png" alt="image-20231108084040487" /></p>
</li>
</ul>
<h4 id="counting-algorithms"><a class="header" href="#counting-algorithms">Counting Algorithms</a></h4>
<p>Keep a counter of the number of references that have been made to each page.</p>
<ul>
<li><code>LFU</code> algorithm: replace page with smallest count.</li>
<li><code>MFU</code> algorithm: based on the argument that the page with the smallest count was probably just brought in and has yet to be used.</li>
</ul>
<h2 id="allocation-of-frames"><a class="header" href="#allocation-of-frames">Allocation of Frames</a></h2>
<p>Each process needs minimum number of pages. There are two major allocation schemes:</p>
<ul>
<li>Fixed allocation</li>
<li>Priority allocation</li>
</ul>
<h3 id="fixed-allocation"><a class="header" href="#fixed-allocation">Fixed Allocation</a></h3>
<p>Two ways:</p>
<ul>
<li>Equal allocation. For example, if 100 frames and 5 processes, give each 20 pages.</li>
<li>Proportional allocation. Allocate according to the size of process.</li>
</ul>
<h3 id="priority-allocation"><a class="header" href="#priority-allocation">Priority Allocation</a></h3>
<p>Use a proportional allocation scheme using priorities rather than size. If one process generates a page fault:</p>
<ul>
<li>Select for replacing one of its frames</li>
<li>Select for replacing a frame from a process with lower priority number</li>
</ul>
<p>So there are <strong>global</strong> and <strong>local</strong> allocation:</p>
<ul>
<li>Global replacement: process selects a replacement frame from the set of all frames so one process can take a frame from another.</li>
<li>Local replacement: process select from only its own set of allocated frames.</li>
</ul>
<h2 id="thrashing"><a class="header" href="#thrashing">Thrashing</a></h2>
<p>If a process doesn't have enough pages, the page fault rate may be very high. This leads to</p>
<ul>
<li>low CPU utilization</li>
<li>operating system thinks that is needs to increase the degree of multiprogramming</li>
<li>another process added to the system</li>
</ul>
<p>So <strong>thrashing</strong> is that a process is busy swapping pages in and out.</p>
<h3 id="working-set-model"><a class="header" href="#working-set-model">Working Set Model</a></h3>
<p>Working set of Process <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) is the total number of pages references in the most recent working set window (a fixed number of page references).</p>
<blockquote>
<p>If working set window is too small will not encompass entire locality, but too large will encompass several localities. And is working set windows <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">∞</span></span></span></span>, will encompass entire program.</p>
</blockquote>
<p>Keeping track of the working set: approximate with interval timer and a reference bit. Whenever a timer interrupts copy and sets the values of all reference bits to 0. If one of the bits is 1, this page is in working set.</p>
<h2 id="memory-mapped-files"><a class="header" href="#memory-mapped-files">Memory-Mapped Files</a></h2>
<h2 id="allocating-kernel-memory"><a class="header" href="#allocating-kernel-memory">Allocating Kernel Memory</a></h2>
<h2 id="other-considerations"><a class="header" href="#other-considerations">Other Considerations</a></h2>
<h2 id="operating-system-examples-1"><a class="header" href="#operating-system-examples-1">Operating-System Examples</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h2 id="file-concept"><a class="header" href="#file-concept">File Concept</a></h2>
<p>Contiguous logcial address space.</p>
<h3 id="file-structure"><a class="header" href="#file-structure">File Structure</a></h3>
<ol>
<li>
<p>None</p>
<p>Sequence of words or bytes.</p>
</li>
<li>
<p>Simple record structure</p>
<p>Lines, fixed /variable length</p>
</li>
<li>
<p>Complex Structures</p>
<p>Formatted document</p>
<p>Relocatable load file</p>
<blockquote>
<p>Can simulate last two with first method by inserting appropriate control characters.</p>
</blockquote>
</li>
</ol>
<h3 id="file-attribute"><a class="header" href="#file-attribute">File Attribute</a></h3>
<p>Name: only information kept in human-readable form.</p>
<p>Type: needed for systems that support different types.</p>
<p>Locateion: pointer to file location on device.</p>
<p>Size: current file size.</p>
<p>Protection: controls who can do read, write and execute.</p>
<p>Time, date and user identification: data for protection, security and usage monitoring.</p>
<p>Information about files are kept in the directory structure, which is maintained on the disk.</p>
<h3 id="file-operations"><a class="header" href="#file-operations">File Operations</a></h3>
<ul>
<li>Create</li>
<li>Write</li>
<li>Read</li>
<li>Reposition within file a.k.a file seek</li>
<li>Delete</li>
<li>Truncate</li>
<li>Open: search the directory structure on disk and move the content to the memory</li>
<li>Close: move the content of entry in memory to directory structure on disk</li>
</ul>
<h2 id="access-methods"><a class="header" href="#access-methods">Access Methods</a></h2>
<h3 id="sequential-access"><a class="header" href="#sequential-access">Sequential Access</a></h3>
<p>Supports:</p>
<ul>
<li>read next</li>
<li>write next</li>
<li>reset</li>
</ul>
<p>No read after last write.</p>
<h3 id="direct-access"><a class="header" href="#direct-access">Direct Access</a></h3>
<p>Supports:</p>
<ul>
<li>
<p>read n</p>
</li>
<li>
<p>write n</p>
</li>
<li>
<p>position to n</p>
<p>read next</p>
<p>write next</p>
</li>
<li>
<p>rewrite n</p>
</li>
</ul>
<p><img src="operating-system/./fs-interface/image-20231204154116876.png" alt="image-20231204154116876" /></p>
<p>And using a direct-access file to simulate a sequential access.</p>
<h2 id="directory-structure"><a class="header" href="#directory-structure">Directory Structure</a></h2>
<p>A collection of nodes containing information about all files. Both the directory structure and the files reside on disk.</p>
<p>The information in a device directory:</p>
<ul>
<li>Name</li>
<li>Type</li>
<li>Address</li>
<li>Current length</li>
<li>Maximum length</li>
<li>Date last accessed</li>
<li>Date last updated</li>
<li>Owner ID</li>
<li>Protection Information</li>
</ul>
<p>And the operations performed on a directory:</p>
<ul>
<li>Search for a file</li>
<li>Create a file</li>
<li>Delete a file</li>
<li>List a directory</li>
<li>Rename a file</li>
<li>Traverse the file system</li>
</ul>
<p>The directory can be organized:</p>
<ul>
<li>Single level directory</li>
<li>Tow  level directory</li>
<li>Tree structured directory</li>
<li>Acyclic graph directory</li>
<li>General Graph directory</li>
</ul>
<p>For acyclic graph directory, need to handle dangling pointer problem:</p>
<ul>
<li>Using backpointers to delete all pointers reference the file</li>
<li>The backpointers can be organized using a daisy chain</li>
<li>Entry hold count is also a solution</li>
</ul>
<p>For general graph directory, need to gurantee no cycles:</p>
<ul>
<li>Allow only links to file and not subdirectories</li>
<li>Grabage collections</li>
<li>When creating a new link using a cycle detection algorithm to determine</li>
</ul>
<h2 id="file-system-mounting"><a class="header" href="#file-system-mounting">File System Mounting</a></h2>
<p>A file system must be <strong>mounted</strong> before it can be accessed, a mounted file system is mounted a t a <strong>mount point</strong>.</p>
<h2 id="file-sharing"><a class="header" href="#file-sharing">File Sharing</a></h2>
<h2 id="protection"><a class="header" href="#protection">Protection</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h2 id="file-system-structure"><a class="header" href="#file-system-structure">File System Structure</a></h2>
<p>FS structure contains locgical storage unit and collection of related information.</p>
<p><strong>File Control Block</strong> is a storage block of consisting information of a file.</p>
<h2 id="file-system-implementation"><a class="header" href="#file-system-implementation">File System Implementation</a></h2>
<h2 id="directory-implementation"><a class="header" href="#directory-implementation">Directory Implementation</a></h2>
<h2 id="allocation-methods"><a class="header" href="#allocation-methods">Allocation Methods</a></h2>
<h2 id="free-space-management"><a class="header" href="#free-space-management">Free-Space Management</a></h2>
<h2 id="efficiency-and-performance"><a class="header" href="#efficiency-and-performance">Efficiency and Performance</a></h2>
<h2 id="recovery"><a class="header" href="#recovery">Recovery</a></h2>
<h2 id="log-structured-file-systems"><a class="header" href="#log-structured-file-systems">Log-Structured File Systems</a></h2>
<h2 id="network-file-systems"><a class="header" href="#network-file-systems">Network File Systems</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="毛泽东思想和中国特色社会主义理论体系概论"><a class="header" href="#毛泽东思想和中国特色社会主义理论体系概论">毛泽东思想和中国特色社会主义理论体系概论</a></h1>
<p>授课教师：裴晓军</p>
<p>笔记贡献者：<a href="https://github.com/112292454">112292454</a>（不包含13道课后思考题）</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="毛概期末总结"><a class="header" href="#毛概期末总结">毛概期末总结</a></h1>
<h2 id="各个会议的关键事件"><a class="header" href="#各个会议的关键事件">各个会议的关键事件</a></h2>
<ul>
<li>党的四大：提出工人阶级领导革命</li>
<li>八七会议：确立土地革命和武装起义方针</li>
<li>遵义会议：确立了中国革命的基本方针和毛泽东的领导地位</li>
<li>古田会议：确立思想建党、政治建军的原则</li>
<li>六届六中全会：第一次提出“马克思主义中国化”</li>
<li>六届七中全会：整风运动的胜利，通过了中共中央《关于若干历史问题的决议》。</li>
<li>党的七大：将毛泽东思想确立为全党的指导思想</li>
<li>党的八大：提出我国社会主义建设长期战略目标</li>
<li>十一届三中全会：开启了改革开放和社会主义现代化建设，确立社会主义初级阶段基本路线，创立邓小平理论</li>
<li>十一届四中全会：形成“三个代表”重要思想</li>
<li>十一届六中全会：通过了《关于建国以来党的若干历史问题的决议》，对中共的历史进行了总结和评价（毛泽东的错误）</li>
<li>党的十三大：系统阐述社会主义初级阶段理论，确立新时代党的基本路线</li>
<li>党的十四大：确立社会主义市场经济体制</li>
<li>南方谈话：对社会主义本质作出了总结性的理论概括（见邓小平理论）</li>
<li>党的十五大：把邓小平理论确立为党的指导思想</li>
<li>党的十七大：将中国特色社会主义理论体系和科学发展观（十六届三中全会初步提出）写入党章</li>
<li>党的十八大：中特社进入新时期，习近平中特社</li>
</ul>
<h2 id="绪论"><a class="header" href="#绪论">绪论</a></h2>
<p>马克思主义中国化现代化的提出。节点，会议，内涵。程度，谁提出，邓小平，习的三个，核心问题</p>
<h3 id="毛泽东思想的提出与发展"><a class="header" href="#毛泽东思想的提出与发展">毛泽东思想的提出与发展</a></h3>
<ul>
<li>
<p>1917俄国十月革命一声炮响 ，给中国送来了马克思主义</p>
</li>
<li>
<p>1938，党的六中全会，《论新阶段》，毛泽东提出<strong>马克思主义中国化</strong>（1931左的错误）</p>
</li>
<li>
<p>1945，党的七大，刘少奇指出“<strong>毛泽东思想就是中国化的马克思主义</strong>”，将毛泽东思想写入党章</p>
</li>
</ul>
<h4 id="内涵"><a class="header" href="#内涵">内涵</a></h4>
<p>三层意思：</p>
<ul>
<li>把马克思主义与中国革命实际相结合，用马克思主义的方法论<strong>解决中国革命的实际问题</strong></li>
<li>提炼中国革命经验，<strong>上升为理论</strong>，开辟新境界；</li>
<li>用中国人民的民族语言来阐述马克思主义，使其植根中华文化，具有中国特色，<strong>为人民所喜爱</strong></li>
</ul>
<h4 id="进程"><a class="header" href="#进程">进程</a></h4>
<ul>
<li>
<p>两次飞跃：遵义会议毛泽东思想、中国特色社会主义理论体系</p>
</li>
<li>
<p>新民主主义革命时期，毛泽东为代表，结合实际，<strong>毛泽东思想</strong>，建国。新民主主义革命终结半殖半封</p>
</li>
<li>
<p>1978党的<strong>十一届三中全会</strong>，伟大转折，开启了改革开放和社会主义现代化建设。邓小平确立实事求是，回答了什么是/怎么建设社会主义，初步形成中特社的路线，创立<strong>邓小平理论</strong>。</p>
</li>
<li>
<p>20世纪80末90初，党的<strong>十三届四中全会</strong>后，江泽民提出**“三个代表”重要思想**，推向了21世纪</p>
</li>
<li>
<p>21世纪，党的<strong>十六大</strong>后，胡锦涛形成<strong>科学发展观</strong>，实现新时代新发展</p>
</li>
<li>
<p><strong>十七大</strong>，改革开放和社会主义现代化建设时期，<strong>形成中特社</strong>，<strong>新的飞跃</strong></p>
</li>
<li>
<p>十八大以来，习，回答了<strong>中特社、现代化强国、马克思主义政党（什么样的、怎样去做</strong>，3*2个小问题）。核心问题，<strong>建设什么样的中特社、怎么建设</strong></p>
</li>
</ul>
<h2 id="第一章第二节"><a class="header" href="#第一章第二节">第一章第二节</a></h2>
<p>党的基本路线确立于<em>1987年10月召开的党的十三大</em></p>
<h3 id="毛泽东思想的主要内容"><a class="header" href="#毛泽东思想的主要内容">毛泽东思想的主要内容</a></h3>
<ul>
<li>
<p>a. 新民主主义革命理论（无产阶级领导的，人民大众的反对帝国主义、封建主义、官僚资本主义的革命）</p>
</li>
<li>
<p>b. 社会主义革命与社会主义建设理论（一化三改，十大关系，调动一切积极因素为社会主义事业服务、正确处理社会主义社会矛盾、走中国工业化道路）、</p>
</li>
<li>
<p>c. 革命军队建设和军事战略理论（农村包围城市武装夺取政权）</p>
</li>
<li>
<p>d. 政策和策略的理论：精辟地论证了革命斗争中政策和策略问题的极端重要性；在统一战线中提出了许多重要的政策和策略思想。</p>
</li>
<li>
<p>e. 思想政治工作与文化工作的理论：一定的文化是一定的社会政治和经济的反映，又作用于它；而经济是基础，政治是经济的集中表现</p>
</li>
<li>
<p>f. 党的建设理论（<strong>三大法宝</strong>：统一战线，武装斗争，党的建设）：（隔壁第五题）</p>
<p>统一战线和武装斗争是中国革命的两个基本特点，是战胜敌人的两个基本武器。统一战线是实行武装斗争的统一战线，武装斗争是统一战线的中心支柱，党的组织则是掌握统一战线和武装斗争这两个武器以实行对敌冲锋陷阵的英勇武士。党的建设是核心。</p>
</li>
</ul>
<p>or</p>
<ul>
<li>
<p>第一，创立了<strong>一条思想路线</strong>，即实事求是的思想路线；</p>
</li>
<li>
<p>第二，探索了<strong>三条道路</strong>，即农村包围城市、武装夺取政权的中国式独特的革命道路；中国式的社会主义道路；中国式的社会主义建设道路；</p>
</li>
<li>
<p>第三，形成了<strong>三套理论</strong>，即新民主主义革命理论；中国式社会主义改造理论；中国式社会主义社会矛盾理论。</p>
</li>
</ul>
<h3 id="活的灵魂"><a class="header" href="#活的灵魂">活的灵魂</a></h3>
<p>3个基本方面：<strong>实事求是、群众路线、独立自主</strong>。</p>
<ul>
<li><strong>实事求是</strong>：一切从实际出发，理论联系实际，坚持在实践中检验真理和发展真理。是马克思主义的根本观点，是中国共产党人认识世界、改造世界的根本要求，是我们党的基本思想方法、工作方法、领导方法，是党的根本思想路线。<img src="socialist/./assets/image-20230611200702604.png" alt="image-20230611200702604"  /></li>
<li>**群众路线：一切为了群众，一切依靠群众、从群众中来，到群众中去。**它是党的生命线和根本工作路线，是党永葆青春活力和战斗力的重要传家宝。</li>
<li>**独立自主：**即坚持独立思考，走自己的路，坚定不移地维护民族独立、捍卫国家主权。将立足点放在依靠自己力量的基础上，学习借鉴人类社会创造的一切有益的文明成果。</li>
</ul>
<p>https://www.233.com/kaoyan/mzt/202106/15112005864801.html</p>
<h2 id="第二章第二节"><a class="header" href="#第二章第二节">第二章第二节</a></h2>
<h3 id="新民主主义革命的总路线"><a class="header" href="#新民主主义革命的总路线">新民主主义革命的总路线</a></h3>
<p>​	<strong>无产阶级领导的，人民大众的，反对帝国主义、封建主义和官僚资本主义的革命</strong>。它的目标是无产阶级牢牢掌握革命领导权，彻底完成反帝反封建的历史任务，并及时实现由新民主主义向社会主义的过渡。</p>
<p>革命<strong>对象</strong>：帝国主义+封建主义（靠山与走狗）+官僚资本主义（又拉又打）</p>
<p>革命<strong>动力</strong>：无产阶级（领导者，最基本的动力）、农民（革命的主力军）、城市小资产阶级（可靠的同盟军）、民族资产阶级（两面性，动力之一）</p>
<p>革命的<strong>领导</strong>：无产阶级，而非资产阶级，是区分于民主主义革命的根本区别。</p>
<p>革命的<strong>性质</strong>： 特殊的资产阶级民主主义革命，是社会主义革命的上半篇。</p>
<h3 id="基本纲领三大"><a class="header" href="#基本纲领三大">基本纲领（三大）</a></h3>
<p><strong>政治纲领</strong>:（推翻压迫建共和）推翻帝国主义和封建主义的统治，建立无产阶级领导的、以工农联盟为基础的、各革命阶级联合专政（国体）的新民主主义的共和国。政体：<strong>民主集中制的人民代表大会制度</strong></p>
<p><strong>经济纲领</strong>:（<strong>两个没收一保护</strong>)没收封建地主阶级的土地归农民所有，没收官僚资产阶级的垄断资本归新民主主义的国家所有，保护民族工商业。</p>
<p><strong>文化纲领</strong>:（<strong>民族科学大众</strong>化)是无产阶级领导的人民大众的反帝反封建的文化，即民族的科学的大众的文化。</p>
<h2 id="第三章第二节"><a class="header" href="#第三章第二节">第三章第二节</a></h2>
<h3 id="社会主义改造道路"><a class="header" href="#社会主义改造道路">社会主义改造道路</a></h3>
<p>三大改造（1956基本完成）：积极引导，稳步前进</p>
<ul>
<li><strong>农业</strong>：互助合作，自愿互利、典型示范、国家帮助，稳步发展，分配土地</li>
<li><strong>手工业</strong>：由小到大，由低级到高；手工业供销小组到手工业生产合作社</li>
<li><strong>资本主义工商业</strong>：以<strong>和平赎买</strong>的方式，完成对资本主义工商业的改造；有偿的变为国营：给资本家逐年付钱取得所有权（<strong>隔壁第九题</strong>）</li>
</ul>
<h3 id="改造的基本经验"><a class="header" href="#改造的基本经验">改造的基本经验：</a></h3>
<ul>
<li>坚持社会主义改造与社会主义工业化并举。实现社会主义工业化以及个体农业、手工业、资本主义工商业改造（一化三改）</li>
<li>采取积极引导、逐步过渡的措施。以从低级到高级的国家资本主义形式完成对资本主义工商业的改造，采用自愿互利、典型示范、国家帮助的形式进行农业改造等。</li>
<li>采用和平方式改造。以和平赎买的方式完成对资本主义工商业的改造。</li>
</ul>
<h2 id="第四章"><a class="header" href="#第四章">第四章</a></h2>
<h3 id="党在社会主义建设道路的初步探索中取得了哪些重要成果"><a class="header" href="#党在社会主义建设道路的初步探索中取得了哪些重要成果">党在社会主义建设道路的初步探索中取得了哪些重要成果</a></h3>
<ul>
<li>调动一切积极因素，为社会主义事业服务</li>
<li>正确处理、认识社会主义社会的矛盾（敌我矛盾/人民内部矛盾）</li>
<li>走中国工业化道路</li>
</ul>
<h4 id="如何认识党对社会主义建设道路初步探索的重大意义"><a class="header" href="#如何认识党对社会主义建设道路初步探索的重大意义">如何认识党对社会主义建设道路初步探索的重大意义</a></h4>
<ul>
<li>巩固和发展了我国的社会主义制度</li>
<li>为开创中国特色社会主义提供了宝贵经验、理论准备、物质基础</li>
<li>丰富了科学社会主义的理论和实践</li>
</ul>
<h3 id="党对社会主义建设道路的初步探索有哪些经验教训"><a class="header" href="#党对社会主义建设道路的初步探索有哪些经验教训">党对社会主义建设道路的初步探索有哪些经验教训</a></h3>
<ul>
<li>
<p>必须将马克思主义的原理与中国实际相结合，探索符合中国特点的社会主义建设道路。</p>
</li>
<li>
<p>必须正确认识社会主义社会的主要矛盾，集中力量发展生产力。</p>
</li>
<li>
<p>必须从实际出发进行社会主义建设，建设的规模与速度要与国力相匹配，不能急于求成。</p>
</li>
<li>
<p>必须发展社会主义民主，健全社会主义法治。</p>
</li>
<li>
<p>必须坚持党的民主集中制和党的集体领导制度，加强执政党建设。</p>
</li>
<li>
<p>必须坚持对外开放，借鉴和吸收人类文明成果以建设社会主义，不能关起门来搞建设。</p>
</li>
</ul>
<p>见隔壁10~12题</p>
<h2 id="第六章-邓小平理论"><a class="header" href="#第六章-邓小平理论">第六章 邓小平理论</a></h2>
<p>回答了“什么是社会主义、怎样建设社会主义”</p>
<p>提出于<em>1997年召开的中共第十五次全国代表大会</em>,</p>
<h3 id="首要的基本的理论问题"><a class="header" href="#首要的基本的理论问题">首要的基本的理论问题</a></h3>
<p><strong>什么是社会主义、怎样建设社会主义</strong>是邓小平理论要回答的首要基本的理论问题。</p>
<p>具具体来说，邓小平在毛泽东探索的基础上，根据马克思主义基本原理和社会主义的实践经验，在1992年南方谈话中明确提出：<strong>社会主义的本质，是解放生产力，发展生产力，消灭剥削，消除两级分化，最终达到共同富裕</strong>。</p>
<h3 id="精髓"><a class="header" href="#精髓">精髓</a></h3>
<p>坚持解放思想，实事求是</p>
<h3 id="主要内容"><a class="header" href="#主要内容">主要内容</a></h3>
<ul>
<li>
<p><strong>社会主义初级阶段理论</strong>：我国已经进入社会主义社会，必须坚持而不能离开社会主义。我国的社会主义社会目前处在，也将长期处在不发达的阶段，必须正视而不能超越初级阶段。</p>
</li>
<li>
<p><strong>党</strong>在社会主义初级阶段<strong>的基本路线</strong>：领导和团结全国各族人民，以经济建设为中心，坚持四项基本原则，坚持改革开放，自力更生，艰苦创业，为把我国建设成为富强、民主、文明的社会主义现代化国家而奋斗。</p>
</li>
<li>
<p><strong>社会主义根本任务</strong>的理论：生产力是社会发展的最根本的决定性因素，社会主义的根本任务是发展生产力。社会主义革命是为了解放生产力，发展生产力。</p>
</li>
<li>
<p>“三步走”基本实现现代化的<strong>发展战略</strong>：把我国社会主义现代化建设的目标具体化为切实可行的步骤，为基本实现现代化明确了发展方向，成为全国人民为共同理想而努力奋斗的行动纲领。（1990 GDP翻番，解决温饱——20世纪末再翻一倍，达到小康——21世纪中叶，达到中等发达国家，基本实现现代化），提出了“台阶式”发展的思想</p>
</li>
<li>
<p><strong>社会主义改革开放理论</strong>：邓小平强调改革是中国的第二次革命，是中国现代化的必由之路。他指出，对外开放是建设中国特色社会主义的一项基本国策，应该吸收和利用世界各国包括资本主义发达国家所创造的一切先进文明成果来发展社会主义。这就为中国特色社会主义建设提供了根本动力，创造了必要的外部条件。</p>
<p>改革是社会主义社会发展的直接动力。以是否有利于发展社会主义社会的生产力，是否有利于增强社会主义国家的综合国力，是否有利于提高人民的生活水平为标准。</p>
</li>
<li>
<p><strong>社会主义市场经济理论</strong>：计划经济和市场经济不是划分社会制度的标志，计划经济不等于社会主义，市场经济也不等于资本主义。从根本上破除了把计划经济视为社会基本制度的思想束缚，为促进我国经济发展和社会进步注入了强大活力。</p>
</li>
<li>
<p><strong>“两手抓，两手都要硬”</strong>：即一手抓物质文明建设、一手抓精神文明建设；一手抓四项基本原则、一手抓改革开放；一手抓建设、一手抓法制等。坚持了辩证法的全面性，坚持了两点论和重点论的统一</p>
</li>
<li>
<p>“和平统一、一国两制”伟大构想的<strong>提出</strong>是从解决台湾问题开始的，在实践中首先运用于解决香港问题、澳门问题。</p>
</li>
<li>
<p>“一国两制”构想的<strong>意义</strong>：“一国两制”是从中国的实际出发，解决台湾问题、香港问题和澳门问题，实现祖国和平统一的伟大构想。不局限于中国问题，而是世界通用的。</p>
</li>
</ul>
<h3 id="历史地位"><a class="header" href="#历史地位">历史地位</a></h3>
<p>邓小平理论的历史地位主要体现为：</p>
<p>（1）邓小平理论，是马克思列宁主义基本原理与当代中国实际和时代特征相结合的产物，<strong>是马克思列宁主义、毛泽东思想的继承和发展</strong>，是全党全国人民集体智慧的结晶。</p>
<p>（2）<strong>中国特色社会主义理论体系的开篇之作</strong>。邓小平作为中国特色社会主义理论的创立者，做出把党和国家工作中心转移到经济建设上来、实行改革开放的历史性决策，深刻揭示社会主义本质，确立社会主义初级阶段基本路线，明确提出走自己的路、建设中国特色社会主义，<strong>为建设中国特色社会主义提供了根本的科学指南</strong>。</p>
<h2 id="第七章-三个代表重要思想"><a class="header" href="#第七章-三个代表重要思想">第七章 三个代表重要思想</a></h2>
<p>回答了“建设什么样的党，怎样建设党”的问题</p>
<h3 id="核心观点"><a class="header" href="#核心观点">核心观点</a></h3>
<p>（详细的转隔壁15）</p>
<p>“三个代表"重要思想集中概括为:中国共产党必须</p>
<ul>
<li><strong>始终代表中国先进生产力的发展要求</strong>：党需推动经济发展，适应先进生产力需求，制定正确政策，促进生产关系与上层建筑相适应，满足先进生产力的发展需求。</li>
<li><strong>始终代表中国先进文化的前进方向</strong>：发展社会主义先进文化，满足人民需求，建设精神文明，发展现代化、科学的社会主义文化，弘扬民族精神，加强思想道德建设。</li>
<li><strong>始终代表中国最广大人民的根本利益</strong>：代表人民利益：党以人民为根本力量，关注最广大人民利益，保障人民共享发展成果，处理利益关系，确保工作符合人民根本利益。</li>
</ul>
<h2 id="第八章-科学发展观"><a class="header" href="#第八章-科学发展观">第八章 科学发展观</a></h2>
<p>对“实现什么样的发展、怎样发展”问题的集中而全面的回答</p>
<h3 id="科学内涵"><a class="header" href="#科学内涵">科学内涵</a></h3>
<ul>
<li><strong>第一要义：推动经济社会发展是科学发展观的第一要义。</strong> 在当代中国，坚持发展的本质要求就是坚持科学发展观。</li>
<li><strong>立场：以人为本是科学发展观的核心立场</strong>。“人”是指人民群众，“本”是指出发点和落脚点。集中体现了马克思主义历史唯物论的基本原理，体现了党全心全意为人民服务的根本宗旨和推动经济社会发展的根本目的。</li>
<li><strong>基本要求：全面协调可持续发展是科学发展观的基本要求。</strong>“全面”是指发展要有全面性、整体性，不仅经济发展，而且各个方面都要发展；“协调”是指发展要有协调性、均衡性，各个方面、各个环节的发展要相互适应、相互促进。“可持续”是指发展要有持久性、连续性，不仅当前要发展，而且要保证长远发展。</li>
<li><strong>方法：统筹兼顾是科学发展观的根本方法。</strong> 深刻体现了唯物辩证法在发展问题上的科学运用，深刻揭示了实现科学发展、促进社会和谐的基本途径，是正确处理经济社会发展中重大关系的方针原则。</li>
<li>科学发展观的提出，是我们党对现代化建设指导思想的重大发展。</li>
</ul>
<p>最后三章的主题合起来就是<strong>中国特色社会主义理论体系</strong>回答的三大问题</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="毛概-课后大题"><a class="header" href="#毛概-课后大题">毛概 课后大题</a></h1>
<h2 id="1-如何把握毛泽东思想的主要内容和活的灵魂"><a class="header" href="#1-如何把握毛泽东思想的主要内容和活的灵魂">1 、如何把握毛泽东思想的主要内容和活的灵魂。</a></h2>
<h3 id="毛泽东思想的主要内容-1"><a class="header" href="#毛泽东思想的主要内容-1">毛泽东思想的主要内容：</a></h3>
<ul>
<li>a. 新民主主义革命理论（无产阶级领导的，人民大众的反对帝国主义、封建主义、官僚资本主义的革命）</li>
<li>b. 社会主义革命与社会主义建设理论（一化三改，十大关系，调动一切积极因素为社会主义事业服务、正确处理社会主义社会矛盾、走中国工业化道路）、</li>
<li>c. 革命军队建设和军队战略理论（农村包围城市武装夺取政权）</li>
<li>d. 政策和策略的理论</li>
<li>e. 思想政治工作与文化工作的理论</li>
<li>f. 党的建设理论（三大法宝）</li>
</ul>
<h3 id="毛泽东思想的活的灵魂"><a class="header" href="#毛泽东思想的活的灵魂">毛泽东思想的活的灵魂：</a></h3>
<ul>
<li>a. 实事求是（马克思主义的两次结合）</li>
<li>b. 独立自主（掌握本国国情，走符合中国国情的道路）</li>
<li>c. 群众路线（一切从群众中来，一切为了人民）</li>
</ul>
<h2 id="2-新民主主义革命的总路线"><a class="header" href="#2-新民主主义革命的总路线">2 、新民主主义革命的总路线：</a></h2>
<p>无产阶级领导的，人民大众的，反对帝国主义、封建主义、官僚资本主义的革命。</p>
<h2 id="3-新民主主义的基本纲领"><a class="header" href="#3-新民主主义的基本纲领">3 、新民主主义的基本纲领</a></h2>
<ul>
<li>政治纲领：推翻帝国主义与封建主义的统治，建立无产阶级领导的、以工农联盟为基础的、各个革命阶级联合专政的新民主主义共和国</li>
<li>经济纲领：没收封建地主阶级的土地归农民所有，魔兽官僚资产阶级的垄断资本归新民主主义的国家所有，保护民族工商业。</li>
<li>文化纲领：无产阶级领导的人民大众的反帝反封建的文化。</li>
</ul>
<h2 id="4-新旧民主主义革命的根本区别"><a class="header" href="#4-新旧民主主义革命的根本区别">4 、新旧民主主义革命的根本区别</a></h2>
<p>无产阶级的领导权是中国革命的中心问题，也是新民主主义革命理论的核心问题。区别新旧两种不同范畴的民主主义革命的根本标志是，革命的领导权是掌握在无产阶级手中还是掌握在资产阶级手中。</p>
<h2 id="5-三大法宝及其联系"><a class="header" href="#5-三大法宝及其联系">5 、三大法宝及其联系</a></h2>
<p>统一战线和武装斗争是中国革命的两个基本特点，是战胜敌人的两个基本武器。统一战线是实行武装斗争的统一战线，武装斗争是统一战线的中心支柱，党的组织则是掌握统一战线和武装斗争这两个武器以实行对地冲锋陷阵的英勇武士。党的建设是核心。</p>
<h2 id="6-如何认识我国社会主义改造的基本经验"><a class="header" href="#6-如何认识我国社会主义改造的基本经验">6 、如何认识我国社会主义改造的基本经验？</a></h2>
<ul>
<li>坚持社会主义改造于社会主义工业化并举，实现社会主义工业化，个体农业、手工业、资本主义工商业改造</li>
<li>采取积极引导、逐步过渡的措施。以从低级到高级的国家资本主义形式完成对资本主义工商业的改造，采用自愿互利、典型示范、国家帮助的形式进行农业改造等。</li>
<li>采用和平方式改造。以和平赎买的方式完成对资本主义工商业的改造。</li>
</ul>
<h2 id="7-新民主主义社会的定性"><a class="header" href="#7-新民主主义社会的定性">7 、新民主主义社会的定性</a></h2>
<p>新民主主义社会是一个过渡性的社会，通过社会主义改造转变到社会主义社会是历史的必然。</p>
<h2 id="8-前三年后三年关系"><a class="header" href="#8-前三年后三年关系">8 、“前三年”“后三年”关系</a></h2>
<p>全国解放后，从 1949 年到 1952 年，党领导人民集中力量恢复国民经济，继续完成民主革命遗留的任务。国民经济得以恢复时，我国社会主义生活产生新的矛盾，两极分化开始出现，党在新的时期提出了过渡时期总路线， 1953 年到 1956 年集中社会主义工业化、施行对个体农业、手工业、资本主义工商业的社会主义改造。</p>
<h2 id="9-民族工商业的改造"><a class="header" href="#9-民族工商业的改造">9 、民族工商业的改造</a></h2>
<ul>
<li>采用和平赎买的形式进行民族主义工商业改造（四马分肥，原先的企业主分得利润）</li>
<li>采用从低级到高级的国家资本主义的过渡形式（国家首先实行委托加工、计划订货、统购包销，在进行个别企业的公私合营，第三部实行全行业的公私合营）</li>
<li>将资本主义工商业者改造成自食其力的社会主义劳动者</li>
</ul>
<h2 id="10--党在社会主义建设道路的初步探索中取得了哪些重要成果"><a class="header" href="#10--党在社会主义建设道路的初步探索中取得了哪些重要成果">10 、 党在社会主义建设道路的初步探索中取得了哪些重要成果</a></h2>
<ul>
<li>调动一切积极因素，为社会主义事业服务</li>
<li>正确处理、认识社会主义社会的矛盾（敌我矛盾/人民内部矛盾）</li>
<li>走中国工业化道路</li>
</ul>
<h4 id="11如何认识党对社会主义建设道路初步探索的重大意义"><a class="header" href="#11如何认识党对社会主义建设道路初步探索的重大意义">11、如何认识党对社会主义建设道路初步探索的重大意义</a></h4>
<ul>
<li>巩固和发展了我国的社会主义制度</li>
<li>为开创中国特色社会主义提供了宝贵经验、理论准备、物质基础</li>
<li>丰富了科学社会主义的理论和实践</li>
</ul>
<h2 id="12党对社会主义建设道路的初步探索有哪些经验教训"><a class="header" href="#12党对社会主义建设道路的初步探索有哪些经验教训">12、党对社会主义建设道路的初步探索有哪些经验教训</a></h2>
<ul>
<li>
<p>必须将马克思主义的原理与中国实际相结合，探索符合中国特点的社会主义建设道路。</p>
</li>
<li>
<p>必须正确认识社会主义社会的主要矛盾，集中力量发展生产力。</p>
</li>
<li>
<p>必须从实际出发进行社会主义建设，建设的规模与速度要与国力相匹配，不能急于求成。</p>
</li>
<li>
<p>必须发展社会主义民主，健全社会主义法治。</p>
</li>
<li>
<p>必须坚持党的民主集中制和党的集体领导制度，加强执政党建设。</p>
</li>
<li>
<p>必须坚持对外开放，借鉴和吸收人类文明成果以建设社会主义，不能关起门来搞建设。</p>
</li>
</ul>
<h2 id="13-如何理解邓小平理论首要的基本的理论问题"><a class="header" href="#13-如何理解邓小平理论首要的基本的理论问题">13 、如何理解邓小平理论首要的基本的理论问题？</a></h2>
<p>什么是社会主义、怎样建设社会主义是邓小平理论要回答的首要基本的理论问题。</p>
<p>解放思想，实事求是是邓小平理论的精髓。</p>
<p>具体来说，邓小平在毛泽东探索的基础上，根据马克思主义基本原理和社会主义的实践经验，在1992年南方谈话中明确提出：社会主义的本质，是解放生产力，发展生产力，消灭剥削，消除两级分化，最终达到共同富裕。</p>
<h2 id="14-如何认识邓小平理论的历史地位"><a class="header" href="#14-如何认识邓小平理论的历史地位">14 、如何认识邓小平理论的历史地位</a></h2>
<ul>
<li>
<p>邓小平理论是对马列毛思想的进一步继承与发展。</p>
</li>
<li>
<p>邓小平思想是中特社理论体系的开篇之作。（邓小平紧紧抓住”什么是社会主义，如何发展社会主义“这个基本问题，提出”走自己的路，建设中国特色社会主义“的伟大号召）。</p>
</li>
<li>
<p>邓小平思想是改革开放和社会主义现代化建设的科学指南。</p>
</li>
</ul>
<h4 id="15-三个代表重要思想的核心观点"><a class="header" href="#15-三个代表重要思想的核心观点">15 三个代表重要思想的核心观点</a></h4>
<ul>
<li><strong>代表中国先进生产力的发展要求</strong>：中国共产党必须始终关注和推动先进生产力的发展，确保经济建设始终处于前沿位置。这要求我们准确把握社会生产力的发展趋势，制定正确的路线方针政策，推动生产关系和上层建筑的不断适应和满足先进生产力的发展需求。</li>
<li><strong>代表中国先进文化的前进方向</strong>：我们要大力发展社会主义先进文化，满足人民群众的精神文化需求，建设社会主义精神文明。这要求我们坚持发展面向现代化、面向世界、面向未来的民族科学大众社会主义文化，弘扬民族精神，加强思想道德建设，做好思想政治工作。</li>
<li><strong>代表中国最广大人民的根本利益</strong>：人民是国家的主人，党的一切工作都要以最广大人民群众的根本利益为出发点和归宿。我们要维护好最广大人民的利益，使他们共享经济社会发展成果。党必须始终关心人民群众的冷暖，妥善处理各方面的利益关系，把一切积极因素调动起来，确保党和国家的一切工作符合最广大人民群众的根本利益。</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
